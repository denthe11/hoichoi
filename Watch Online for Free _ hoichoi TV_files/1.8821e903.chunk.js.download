(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[1,103,411],{1077:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},1078:function(e,t,n){var r=n(1102),i=n(1100),a=36e5,o=6e4,s=2,u=/[T ]/,l=/:/,d=/^(\d{2})$/,c=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,h=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,g=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,y=/^-?W(\d{2})-?(\d{1})$/,_=/^(\d{2}([.,]\d*)?)$/,T=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,E=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,b=/([Z+-].*)$/,S=/^(Z)$/,A=/^([+-])(\d{2})$/,w=/^([+-])(\d{2}):?(\d{2})$/;function I(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(i(e))return new Date(e.getTime());if("string"!==typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?s:Number(n);var C=function(e){var t,n={},r=e.split(u);if(l.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var i=b.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),R=function(e,t){var n,r=c[t],i=h[t];if(n=f.exec(e)||i.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=d.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(C.date,n),D=R.year,M=function(e,t){if(null===t)return null;var n,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=p.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=g.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=m.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return r.setUTCFullYear(t,i,s),r}if(n=v.exec(e))return a=parseInt(n[1],10)-1,I(t,a);if(n=y.exec(e)){a=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return I(t,a,u)}return null}(R.restDateString,D);if(M){var O,N=M.getTime(),P=0;if(C.time&&(P=function(e){var t,n,r;if(t=_.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=T.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*o;if(t=E.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*a+r*o+1e3*i}return null}(C.time)),C.timezone)O=function(e){var t,n;return(t=S.exec(e))?0:(t=A.exec(e))?(n=60*parseInt(t[2],10),"+"===t[1]?-n:n):(t=w.exec(e))?(n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n):0}(C.timezone)*o;else{var L=N+P,k=new Date(L);O=r(k);var x=new Date(L);x.setDate(k.getDate()+1);var F=r(x)-r(k);F>0&&(O+=F)}return new Date(N+P+O)}return new Date(e)}},1100:function(e,t){e.exports=function(e){return e instanceof Date}},1102:function(e,t){e.exports=function(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();return t.setSeconds(0,0),6e4*n+t.getTime()%6e4}},1103:function(e,t,n){"use strict";n.r(t);var r,i=n(1239),a=n.n(i),o=n(1311),s=n.n(o),u=n(1484),l=n.n(u),d=n(1485),c=n.n(d),f=n(1486),h=n.n(f),p=n(1487),g=n.n(p),m=n(1488),v=n.n(m),y=n(1489),_=n.n(y),T=n(1492),E=n.n(T),b=n(1496),S=n.n(b),A=n(1498),w=n.n(A),I=n(1499),C=n.n(I),R=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=a.a.location&&a.a.location.href||"");var n="function"===typeof a.a.URL,r=/^\/\//.test(e),i=!a.a.location&&!/\/\//i.test(e);if(n?e=new a.a.URL(e,a.a.location||"http://example.com"):/\/\//i.test(e)||(e=C.a.buildAbsoluteURL(a.a.location&&a.a.location.href||"",e)),n){var o=new URL(t,e);return i?o.href.slice("http://example.com".length):r?o.href.slice(o.protocol.length):o.href}return C.a.buildAbsoluteURL(e,t)},D=n(1500),M=n.n(D),O=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,r=0;r<n;++r)t[r].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,i)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),N=n(1502),P=n.n(N),L=n(1503),k=n.n(L),x=n(1427),F=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return M()(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(O),U=String.fromCharCode(9),B=function(e){var t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),n={};return t[1]&&(n.length=parseInt(t[1],10)),t[2]&&(n.offset=parseInt(t[2],10)),n},j=function(e){for(var t,n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),r={},i=n.length;i--;)""!==n[i]&&((t=/([^=]*)=(.*)/.exec(n[i]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),r[t[0]]=t[1]);return r},G=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}M()(t,e);var n=t.prototype;return n.push=function(e){var t,n,r=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce(function(t,n){var r=n(e);return r===e?t:t.concat([r])},[e]).forEach(function(e){for(var i=0;i<r.customParsers.length;i++)if(r.customParsers[i].call(r,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))r.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return n={type:"tag",tagType:"inf"},t[1]&&(n.duration=parseFloat(t[1])),t[2]&&(n.title=t[2]),void r.trigger("data",n);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"targetduration"},t[1]&&(n.duration=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"version"},t[1]&&(n.version=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"media-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return n={type:"tag",tagType:"playlist-type"},t[1]&&(n.playlistType=t[1]),void r.trigger("data",n);if(t=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(e))return n=P()(B(t[1]),{type:"tag",tagType:"byterange"}),void r.trigger("data",n);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return n={type:"tag",tagType:"allow-cache"},t[1]&&(n.allowed=!/NO/.test(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"map"},t[1]){var a=j(t[1]);a.URI&&(n.uri=a.URI),a.BYTERANGE&&(n.byterange=B(a.BYTERANGE))}r.trigger("data",n)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"stream-inf"},t[1]){if(n.attributes=j(t[1]),n.attributes.RESOLUTION){var o=n.attributes.RESOLUTION.split("x"),s={};o[0]&&(s.width=parseInt(o[0],10)),o[1]&&(s.height=parseInt(o[1],10)),n.attributes.RESOLUTION=s}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}r.trigger("data",n)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return n={type:"tag",tagType:"media"},t[1]&&(n.attributes=j(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-ENDLIST/.exec(e))r.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))r.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return n={type:"tag",tagType:"program-date-time"},t[1]&&(n.dateTimeString=t[1],n.dateTimeObject=new Date(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return n={type:"tag",tagType:"key"},t[1]&&(n.attributes=j(t[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void r.trigger("data",n);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return n={type:"tag",tagType:"start"},t[1]&&(n.attributes=j(t[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void r.trigger("data",n);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out-cont"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-in"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);if((t=/^#EXT-X-SKIP:(.*)$/.exec(e))&&t[1])return(n={type:"tag",tagType:"skip"}).attributes=j(t[1]),n.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(n.attributes["SKIPPED-SEGMENTS"]=parseInt(n.attributes["SKIPPED-SEGMENTS"],10)),n.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(n.attributes["RECENTLY-REMOVED-DATERANGES"]=n.attributes["RECENTLY-REMOVED-DATERANGES"].split(U)),void r.trigger("data",n);if((t=/^#EXT-X-PART:(.*)$/.exec(e))&&t[1])return(n={type:"tag",tagType:"part"}).attributes=j(t[1]),["DURATION"].forEach(function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseFloat(n.attributes[e]))}),["INDEPENDENT","GAP"].forEach(function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=/YES/.test(n.attributes[e]))}),n.attributes.hasOwnProperty("BYTERANGE")&&(n.attributes.byterange=B(n.attributes.BYTERANGE)),void r.trigger("data",n);if((t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e))&&t[1])return(n={type:"tag",tagType:"server-control"}).attributes=j(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseFloat(n.attributes[e]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=/YES/.test(n.attributes[e]))}),void r.trigger("data",n);if((t=/^#EXT-X-PART-INF:(.*)$/.exec(e))&&t[1])return(n={type:"tag",tagType:"part-inf"}).attributes=j(t[1]),["PART-TARGET"].forEach(function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseFloat(n.attributes[e]))}),void r.trigger("data",n);if((t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e))&&t[1])return(n={type:"tag",tagType:"preload-hint"}).attributes=j(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=parseInt(n.attributes[e],10);var t="BYTERANGE-LENGTH"===e?"length":"offset";n.attributes.byterange=n.attributes.byterange||{},n.attributes.byterange[t]=n.attributes[e],delete n.attributes[e]}}),void r.trigger("data",n);if((t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e))&&t[1])return(n={type:"tag",tagType:"rendition-report"}).attributes=j(t[1]),["LAST-MSN","LAST-PART"].forEach(function(e){n.attributes.hasOwnProperty(e)&&(n.attributes[e]=parseInt(n.attributes[e],10))}),void r.trigger("data",n);r.trigger("data",{type:"tag",data:e.slice(4)})}}}else r.trigger("data",{type:"comment",text:e.slice(1)})}):this.trigger("data",{type:"uri",uri:e}))},n.addParser=function(e){var t=this,n=e.expression,r=e.customType,i=e.dataParser,a=e.segment;"function"!==typeof i&&(i=function(e){return e}),this.customParsers.push(function(e){if(n.exec(e))return t.trigger("data",{type:"custom",data:i(e),customType:r,segment:a}),!0})},n.addTagMapper=function(e){var t=e.expression,n=e.map;this.tagMappers.push(function(e){return t.test(e)?n(e):e})},t}(O),q=function(e){var t={};return Object.keys(e).forEach(function(n){var r;t[(r=n,r.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()}))]=e[n]}),t},H=function(e){var t=e.serverControl,n=e.targetDuration,r=e.partTargetDuration;if(t){var i="#EXT-X-SERVER-CONTROL",a="holdBack",o="partHoldBack",s=n&&3*n,u=r&&2*r;n&&!t.hasOwnProperty(a)&&(t[a]=s,this.trigger("info",{message:i+" defaulting HOLD-BACK to targetDuration * 3 ("+s+")."})),s&&t[a]<s&&(this.trigger("warn",{message:i+" clamping HOLD-BACK ("+t[a]+") to targetDuration * 3 ("+s+")"}),t[a]=s),r&&!t.hasOwnProperty(o)&&(t[o]=3*r,this.trigger("info",{message:i+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+t[o]+")."})),r&&t[o]<u&&(this.trigger("warn",{message:i+" clamping PART-HOLD-BACK ("+t[o]+") to partTargetDuration * 2 ("+u+")."}),t[o]=u)}},V=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new F,t.parseStream=new G,t.lineStream.pipe(t.parseStream);var n,r,i=k()(t),a=[],o={},s=!1,u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var d=0,c=0;return t.on("end",function(){o.uri||!o.parts&&!o.preloadHints||(!o.map&&n&&(o.map=n),!o.key&&r&&(o.key=r),o.timeline||"number"!==typeof l||(o.timeline=l),t.manifest.preloadSegment=o)}),t.parseStream.on("data",function(e){var t,f;({tag:function(){({version:function(){e.version&&(this.manifest.version=e.version)},"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(o.byterange=t,t.length=e.length,"offset"in e||(e.offset=d)),"offset"in e&&(o.byterange=t,t.offset=e.offset),d=t.offset+t.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(o.duration=e.duration),0===e.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("com.apple.streamingkeydelivery"===e.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:e.attributes});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:Object(x.a)(e.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},"undefined"!==typeof e.attributes.IV&&(r.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else r=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,l=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){n={},e.uri&&(n.uri=e.uri),e.byterange&&(n.byterange=e.byterange),r&&(n.key=r)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes?(o.attributes||(o.attributes={}),P()(o.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var n=this.manifest.mediaGroups[e.attributes.TYPE];n[e.attributes["GROUP-ID"]]=n[e.attributes["GROUP-ID"]]||{},t=n[e.attributes["GROUP-ID"]],(f={default:/yes/i.test(e.attributes.DEFAULT)}).default?f.autoselect=!0:f.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(f.language=e.attributes.LANGUAGE),e.attributes.URI&&(f.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(f.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(f.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(f.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=f}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){"undefined"===typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),o.dateTimeString=e.dateTimeString,o.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):(this.manifest.targetDuration=e.duration,H.call(this,this.manifest))},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=e.data},"cue-out-cont":function(){o.cueOutCont=e.data},"cue-in":function(){o.cueIn=e.data},skip:function(){this.manifest.skip=q(e.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",e.attributes,["SKIPPED-SEGMENTS"])},part:function(){var t=this;s=!0;var n=this.manifest.segments.length,r=q(e.attributes);o.parts=o.parts||[],o.parts.push(r),r.byterange&&(r.byterange.hasOwnProperty("offset")||(r.byterange.offset=c),c=r.byterange.offset+r.byterange.length);var i=o.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+i+" for segment #"+n,e.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(function(e,n){e.hasOwnProperty("lastPart")||t.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+n+" lacks required attribute(s): LAST-PART"})})},"server-control":function(){var t=this.manifest.serverControl=q(e.attributes);t.hasOwnProperty("canBlockReload")||(t.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),H.call(this,this.manifest),t.canSkipDateranges&&!t.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var t=this.manifest.segments.length,n=q(e.attributes),r=n.type&&"PART"===n.type;o.preloadHints=o.preloadHints||[],o.preloadHints.push(n),n.byterange&&(n.byterange.hasOwnProperty("offset")||(n.byterange.offset=r?c:0,r&&(c=n.byterange.offset+n.byterange.length)));var i=o.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+i+" for segment #"+t,e.attributes,["TYPE","URI"]),n.type)for(var a=0;a<o.preloadHints.length-1;a++){var s=o.preloadHints[a];s.type&&(s.type===n.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+i+" for segment #"+t+" has the same TYPE "+n.type+" as preload hint #"+a}))}},"rendition-report":function(){var t=q(e.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(t);var n=this.manifest.renditionReports.length-1,r=["LAST-MSN","URI"];s&&r.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+n,e.attributes,r)},"part-inf":function(){this.manifest.partInf=q(e.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",e.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),H.call(this,this.manifest)}}[e.tagType]||function(){}).call(i)},uri:function(){o.uri=e.uri,a.push(o),!this.manifest.targetDuration||"duration"in o||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),r&&(o.key=r),o.timeline=l,n&&(o.map=n),c=0,o={}},comment:function(){},custom:function(){e.segment?(o.custom=o.custom||{},o.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(i)}),t}M()(t,e);var n=t.prototype;return n.warnOnMissingAttributes_=function(e,t,n){var r=[];n.forEach(function(e){t.hasOwnProperty(e)||r.push(e)}),r.length&&this.trigger("warn",{message:e+" lacks required attribute(s): "+r.join(", ")})},n.push=function(e){this.lineStream.push(e)},n.end=function(){this.lineStream.push("\n"),this.trigger("end")},n.addParser=function(e){this.parseStream.addParser(e)},n.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(O),K={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Y=["video","audio","text"],W=["Video","Audio","Text"],z=function(e){return e?e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,n){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)}):e},X=function(e){void 0===e&&(e="");var t=e.split(","),n=[];return t.forEach(function(e){var t;e=e.trim(),Y.forEach(function(r){var i=K[r].exec(e.toLowerCase());if(i&&!(i.length<=1)){t=r;var a=e.substring(0,i[1].length),o=e.replace(a,"");n.push({type:a,details:o,mediaType:r})}}),t||n.push({type:e,details:"",mediaType:"unknown"})}),n},Q=function(e){return void 0===e&&(e=""),K.audio.test(e.trim().toLowerCase())},$=function(e){if(e&&"string"===typeof e){var t,n=e.toLowerCase().split(",").map(function(e){return z(e.trim())}),r="video";1===n.length&&Q(n[0])?r="audio":1===n.length&&(void 0===(t=n[0])&&(t=""),K.text.test(t.trim().toLowerCase()))&&(r="application");var i="mp4";return n.every(function(e){return K.mp4.test(e)})?i="mp4":n.every(function(e){return K.webm.test(e)})?i="webm":n.every(function(e){return K.ogg.test(e)})&&(i="ogg"),r+"/"+i+';codecs="'+e+'"'}},Z=function(e){return void 0===e&&(e=""),a.a.MediaSource&&a.a.MediaSource.isTypeSupported&&a.a.MediaSource.isTypeSupported($(e))||!1},J=function(e){return void 0===e&&(e=""),e.toLowerCase().split(",").every(function(e){e=e.trim();for(var t=0;t<W.length;t++){if(K["muxer"+W[t]].test(e))return!0}return!1})},ee=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,te=/^application\/dash\+xml/i,ne=function(e){return ee.test(e)?"hls":te.test(e)?"dash":"application/vnd.videojs.vhs+json"===e?"vhs-json":null},re=n(1504),ie=function(e){return!!e&&"object"===typeof e},ae=function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce(function(t,n){return"object"!==typeof n?t:(Object.keys(n).forEach(function(r){Array.isArray(t[r])&&Array.isArray(n[r])?t[r]=t[r].concat(n[r]):ie(t[r])&&ie(n[r])?t[r]=e(t[r],n[r]):t[r]=n[r]}),t)},{})},oe=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},se=function(e){if(!e.length)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},ue="INVALID_NUMBER_OF_PERIOD",le="DASH_EMPTY_MANIFEST",de="DASH_INVALID_XML",ce="NO_BASE_URL",fe="SEGMENT_TIME_UNSPECIFIED",he="UNSUPPORTED_UTC_TIMING_SCHEME",pe=function(e){var t=e.baseUrl,n=void 0===t?"":t,r=e.source,i=void 0===r?"":r,a=e.range,o=void 0===a?"":a,s=e.indexRange,u=void 0===s?"":s,l={uri:i,resolvedUri:R(n||"",i)};if(o||u){var d=(o||u).split("-"),c=parseInt(d[0],10),f=parseInt(d[1],10);l.byterange={length:f-c+1,offset:c}}return l},ge=function(e){return e&&"number"!==typeof e&&(e=parseInt(e,10)),isNaN(e)?null:e},me={static:function(e){var t=e.duration,n=e.timescale,r=void 0===n?1:n,i=e.sourceDuration,a=ge(e.endNumber);return{start:0,end:"number"===typeof a?a:Math.ceil(i/(t/r))}},dynamic:function(e){var t=e.NOW,n=e.clientOffset,r=e.availabilityStartTime,i=e.timescale,a=void 0===i?1:i,o=e.duration,s=e.start,u=void 0===s?0:s,l=e.minimumUpdatePeriod,d=void 0===l?0:l,c=e.timeShiftBufferDepth,f=void 0===c?1/0:c,h=ge(e.endNumber),p=(t+n)/1e3,g=r+u,m=p+d-g,v=Math.ceil(m*a/o),y=Math.floor((p-g-f)*a/o),_=Math.floor((p-g)*a/o);return{start:Math.max(0,y),end:"number"===typeof h?h:Math.min(v,_)}}},ve=function(e){var t=e.type,n=void 0===t?"static":t,r=e.duration,i=e.timescale,a=void 0===i?1:i,o=e.sourceDuration,s=me[n](e),u=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n}(s.start,s.end).map(function(e){return function(t,n){var r=e.duration,i=e.timescale,a=void 0===i?1:i,o=e.periodIndex,s=e.startNumber;return{number:(void 0===s?1:s)+t,duration:r/a,timeline:o,time:n*r}}}(e));if("static"===n){var l=u.length-1;u[l].duration=o-r/a*l}return u},ye=function(e){var t=e.baseUrl,n=e.initialization,r=void 0===n?{}:n,i=e.sourceDuration,a=e.indexRange,o=void 0===a?"":a,s=e.duration;if(!t)throw new Error(ce);var u=pe({baseUrl:t,source:r.sourceURL,range:r.range}),l=pe({baseUrl:t,source:t,indexRange:o});if(l.map=u,s){var d=ve(e);d.length&&(l.duration=d[0].duration,l.timeline=d[0].timeline)}else i&&(l.duration=i,l.timeline=0);return l.number=0,[l]},_e=function(e,t,n){for(var r=e.sidx.map?e.sidx.map:null,i=e.sidx.duration,a=e.timeline||0,o=e.sidx.byterange,s=o.offset+o.length,u=t.timescale,l=t.references.filter(function(e){return 1!==e.referenceType}),d=[],c=s+t.firstOffset,f=0;f<l.length;f++){var h=t.references[f],p=h.referencedSize,g=h.subsegmentDuration,m=ye({baseUrl:n,timescale:u,timeline:a,periodIndex:a,duration:g,sourceDuration:i,indexRange:c+"-"+(c+p-1)})[0];r&&(m.map=r),d.push(m),c+=p}return e.segments=d,e},Te=function(e){return e&&e.uri+"-"+function(e){var t=e.offset+e.length-1;return e.offset+"-"+t}(e.byterange)},Ee=function(e){var t;return(t=e.reduce(function(e,t){var n,r=t.attributes.id+(t.attributes.lang||"");e[r]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(n=e[r].segments).push.apply(n,t.segments),t.attributes.contentProtection&&(e[r].attributes.contentProtection=t.attributes.contentProtection)):e[r]=t;return e},{}),Object.keys(t).map(function(e){return t[e]})).map(function(e){var t,n;return e.discontinuityStarts=(t=e.segments,n="discontinuity",t.reduce(function(e,t,r){return t[n]&&e.push(r),e},[])),e})},be=function(e,t){var n=Te(e.sidx),r=n&&t[n]&&t[n].sidx;return r&&_e(e,r,e.sidx.resolvedUri),e},Se=function(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var n in e)e[n]=be(e[n],t);return e},Ae=function(e){var t,n=e.attributes,r=e.segments,i=e.sidx,a={attributes:(t={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),i&&(a.sidx=i),a},we=function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video/webm"===t.mimeType||"video"===t.contentType},Ie=function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio/webm"===t.mimeType||"audio"===t.contentType},Ce=function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType},Re=function(e,t,n){var r;if(void 0===n&&(n={}),!e.length)return{};var i=e[0].attributes,a=i.sourceDuration,o=i.type,s=void 0===o?"static":o,u=i.suggestedPresentationDelay,l=i.minimumUpdatePeriod,d=Ee(e.filter(we)).map(Ae),c=Ee(e.filter(Ie)),f=e.filter(Ce),h=e.map(function(e){return e.attributes.captionServices}).filter(Boolean),p={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(r={AUDIO:{},VIDEO:{}},r["CLOSED-CAPTIONS"]={},r.SUBTITLES={},r),uri:"",duration:a,playlists:Se(d,n)};l>=0&&(p.minimumUpdatePeriod=1e3*l),t&&(p.locations=t),"dynamic"===s&&(p.suggestedPresentationDelay=u);var g=0===p.playlists.length;return c.length&&(p.mediaGroups.AUDIO.audio=function(e,t,n){var r;void 0===t&&(t={}),void 0===n&&(n=!1);var i=e.reduce(function(e,i){var a=i.attributes.role&&i.attributes.role.value||"",o=i.attributes.lang||"",s=i.attributes.label||"main";if(o&&!i.attributes.label){var u=a?" ("+a+")":"";s=""+i.attributes.lang+u}e[s]||(e[s]={language:o,autoselect:!0,default:"main"===a,playlists:[],uri:""});var l=be(function(e,t){var n,r=e.attributes,i=e.segments,a=e.sidx,o={attributes:(n={NAME:r.id,BANDWIDTH:r.bandwidth,CODECS:r.codecs},n["PROGRAM-ID"]=1,n),uri:"",endList:"static"===(r.type||"static"),timeline:r.periodIndex,resolvedUri:"",targetDuration:r.duration,segments:i,mediaSequence:i.length?i[0].number:1};return r.contentProtection&&(o.contentProtection=r.contentProtection),a&&(o.sidx=a),t&&(o.attributes.AUDIO="audio",o.attributes.SUBTITLES="subs"),o}(i,n),t);return e[s].playlists.push(l),"undefined"===typeof r&&"main"===a&&((r=i).default=!0),e},{});r||(i[Object.keys(i)[0]].default=!0);return i}(c,n,g)),f.length&&(p.mediaGroups.SUBTITLES.subs=function(e,t){return void 0===t&&(t={}),e.reduce(function(e,n){var r=n.attributes.lang||"text";return e[r]||(e[r]={language:r,default:!1,autoselect:!1,playlists:[],uri:""}),e[r].playlists.push(be(function(e){var t,n=e.attributes,r=e.segments;"undefined"===typeof r&&(r=[{uri:n.baseUrl,timeline:n.periodIndex,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration);var i=((t={NAME:n.id,BANDWIDTH:n.bandwidth})["PROGRAM-ID"]=1,t);return n.codecs&&(i.CODECS=n.codecs),{attributes:i,uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:n.baseUrl||"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1}}(n),t)),e},{})}(f,n)),h.length&&(p.mediaGroups["CLOSED-CAPTIONS"].cc=h.reduce(function(e,t){return t?(t.forEach(function(t){var n=t.channel,r=t.language;e[r]={autoselect:!1,default:!1,instreamId:n,language:r},t.hasOwnProperty("aspectRatio")&&(e[r].aspectRatio=t.aspectRatio),t.hasOwnProperty("easyReader")&&(e[r].easyReader=t.easyReader),t.hasOwnProperty("3D")&&(e[r]["3D"]=t["3D"])}),e):e},{})),p},De=function(e,t,n){var r=e.NOW,i=e.clientOffset,a=e.availabilityStartTime,o=e.timescale,s=void 0===o?1:o,u=e.start,l=void 0===u?0:u,d=e.minimumUpdatePeriod,c=(r+i)/1e3+(void 0===d?0:d)-(a+l);return Math.ceil((c*s-t)/n)},Me=function(e,t){for(var n=e.type,r=void 0===n?"static":n,i=e.minimumUpdatePeriod,a=void 0===i?0:i,o=e.media,s=void 0===o?"":o,u=e.sourceDuration,l=e.timescale,d=void 0===l?1:l,c=e.startNumber,f=void 0===c?1:c,h=e.periodIndex,p=[],g=-1,m=0;m<t.length;m++){var v=t[m],y=v.d,_=v.r||0,T=v.t||0;g<0&&(g=T),T&&T>g&&(g=T);var E=void 0;if(_<0){var b=m+1;E=b===t.length?"dynamic"===r&&a>0&&s.indexOf("$Number$")>0?De(e,g,y):(u*d-g)/y:(t[b].t-g)/y}else E=_+1;for(var S=f+p.length+E,A=f+p.length;A<S;)p.push({number:A,duration:y/d,time:g,timeline:h}),g+=y,A++}return p},Oe=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Ne=function(e,t){return e.replace(Oe,function(e){return function(t,n,r,i){if("$$"===t)return"$";if("undefined"===typeof e[n])return t;var a=""+e[n];return"RepresentationID"===n?a:(i=r?parseInt(i,10):1,a.length>=i?a:""+new Array(i-a.length+1).join("0")+a)}}(t))},Pe=function(e,t){var n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},r=e.initialization,i=void 0===r?{sourceURL:"",range:""}:r,a=pe({baseUrl:e.baseUrl,source:Ne(i.sourceURL,n),range:i.range});return function(e,t){return e.duration||t?e.duration?ve(e):Me(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(e,t).map(function(t){n.Number=t.number,n.Time=t.time;var r=Ne(e.media||"",n),i={uri:r,timeline:t.timeline,duration:t.duration,resolvedUri:R(e.baseUrl||"",r),map:a,number:t.number};return e.presentationTimeOffset&&(i.presentationTimeOffset=e.presentationTimeOffset),i})},Le=function(e,t){var n=e.duration,r=e.segmentUrls,i=void 0===r?[]:r;if(!n&&!t||n&&t)throw new Error(fe);var a,o=i.map(function(t){return function(e,t){var n=e.baseUrl,r=e.initialization,i=void 0===r?{}:r,a=pe({baseUrl:n,source:i.sourceURL,range:i.range}),o=pe({baseUrl:n,source:t.media,range:t.mediaRange});return o.map=a,o}(e,t)});return n&&(a=ve(e)),t&&(a=Me(e,t)),a.map(function(e,t){if(o[t]){var n=o[t];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}}).filter(function(e){return e})},ke=function(e){var t,n,r=e.attributes,i=e.segmentInfo;i.template?(n=Pe,t=ae(r,i.template),i.template.presentationTimeOffset&&(t.presentationTimeOffset=i.template.presentationTimeOffset/i.template.timescale)):i.base?(n=ye,t=ae(r,i.base)):i.list&&(n=Le,t=ae(r,i.list));var a={attributes:r};if(!n)return a;var o=n(t,i.timeline);if(t.duration){var s=t,u=s.duration,l=s.timescale,d=void 0===l?1:l;t.duration=u/d}else o.length?t.duration=o.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):t.duration=0;return a.attributes=t,a.segments=o,i.base&&t.indexRange&&(a.sidx=o[0],a.segments=[]),a},xe=function(e,t){return se(e.childNodes).filter(function(e){return e.tagName===t})},Fe=function(e){return e.textContent.trim()},Ue=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var n=t.slice(1),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5];return 31536e3*parseFloat(r||0)+2592e3*parseFloat(i||0)+86400*parseFloat(a||0)+3600*parseFloat(o||0)+60*parseFloat(s||0)+parseFloat(u||0)},Be={mediaPresentationDuration:function(e){return Ue(e)},availabilityStartTime:function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t=e)&&(t+="Z"),Date.parse(t)/1e3;var t},minimumUpdatePeriod:function(e){return Ue(e)},suggestedPresentationDelay:function(e){return Ue(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return Ue(e)},start:function(e){return Ue(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},presentationTimeOffset:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?Ue(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},je=function(e){return e&&e.attributes?se(e.attributes).reduce(function(e,t){var n=Be[t.name]||Be.DEFAULT;return e[t.name]=n(t.value),e},{}):{}},Ge={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},qe=function(e,t){return t.length?oe(e.map(function(e){return t.map(function(t){return R(e,Fe(t))})})):e},He=function(e){var t=xe(e,"SegmentTemplate")[0],n=xe(e,"SegmentList")[0],r=n&&xe(n,"SegmentURL").map(function(e){return ae({tag:"SegmentURL"},je(e))}),i=xe(e,"SegmentBase")[0],a=n||t,o=a&&xe(a,"SegmentTimeline")[0],s=n||i||t,u=s&&xe(s,"Initialization")[0],l=t&&je(t);l&&u?l.initialization=u&&je(u):l&&l.initialization&&(l.initialization={sourceURL:l.initialization});var d={template:l,timeline:o&&xe(o,"S").map(function(e){return je(e)}),list:n&&ae(je(n),{segmentUrls:r,initialization:je(u)}),base:i&&ae(je(i),{initialization:je(u)})};return Object.keys(d).forEach(function(e){d[e]||delete d[e]}),d},Ve=function(e,t,n){return function(r){var i,a=je(r),o=qe(t,xe(r,"BaseURL")),s=xe(r,"Role")[0],u={role:je(s)},l=ae(e,a,u),d=xe(r,"Accessibility")[0],c="urn:scte:dash:cc:cea-608:2015"===(i=je(d)).schemeIdUri?i.value.split(";").map(function(e){var t,n;if(n=e,/^CC\d=/.test(e)){var r=e.split("=");t=r[0],n=r[1]}else/^CC\d$/.test(e)&&(t=e);return{channel:t,language:n}}):"urn:scte:dash:cc:cea-708:2015"===i.schemeIdUri?i.value.split(";").map(function(e){var t={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(e)){var n=e.split("="),r=n[0],i=n[1],a=void 0===i?"":i;t.channel=r,t.language=e,a.split(",").forEach(function(e){var n=e.split(":"),r=n[0],i=n[1];"lang"===r?t.language=i:"er"===r?t.easyReader=Number(i):"war"===r?t.aspectRatio=Number(i):"3D"===r&&(t["3D"]=Number(i))})}else t.language=e;return t.channel&&(t.channel="SERVICE"+t.channel),t}):void 0;c&&(l=ae(l,{captionServices:c}));var f=xe(r,"Label")[0];if(f&&f.childNodes.length){var h=f.childNodes[0].nodeValue.trim();l=ae(l,{label:h})}var p=xe(r,"ContentProtection").reduce(function(e,t){var n=je(t),r=Ge[n.schemeIdUri];if(r){e[r]={attributes:n};var i=xe(t,"cenc:pssh")[0];if(i){var a=Fe(i),o=a&&Object(x.a)(a);e[r].pssh=o}}return e},{});Object.keys(p).length&&(l=ae(l,{contentProtection:p}));var g=He(r),m=xe(r,"Representation"),v=ae(n,g);return oe(m.map(function(e,t,n){return function(r){var i=xe(r,"BaseURL"),a=qe(t,i),o=ae(e,je(r)),s=He(r);return a.map(function(e){return{segmentInfo:ae(n,s),attributes:ae(o,{baseUrl:e})}})}}(l,o,v)))}},Ke=function(e,t){return function(n,r){var i=qe(t,xe(n,"BaseURL")),o=je(n),s=parseInt(o.id,10),u=a.a.isNaN(s)?r:s,l=ae(e,{periodIndex:u}),d=xe(n,"AdaptationSet"),c=He(n);return oe(d.map(Ve(l,i,c)))}},Ye=function(e){if(""===e)throw new Error(le);var t,n,r=new re.DOMParser;try{n=(t=r.parseFromString(e,"application/xml"))&&"MPD"===t.documentElement.tagName?t.documentElement:null}catch(i){}if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(de);return n},We=function(e,t){void 0===t&&(t={});var n=function(e,t){void 0===t&&(t={});var n=t,r=n.manifestUri,i=void 0===r?"":r,a=n.NOW,o=void 0===a?Date.now():a,s=n.clientOffset,u=void 0===s?0:s,l=xe(e,"Period");if(!l.length)throw new Error(ue);var d=xe(e,"Location"),c=je(e),f=qe([i],xe(e,"BaseURL"));return c.sourceDuration=c.mediaPresentationDuration||0,c.NOW=o,c.clientOffset=u,d.length&&(c.locations=d.map(Fe)),{locations:c.locations,representationInfo:oe(l.map(Ke(c,f)))}}(Ye(e),t),r=n.representationInfo.map(ke);return Re(r,n.locations,t.sidxMapping)},ze=function(e){return function(e){var t=xe(e,"UTCTiming")[0];if(!t)return null;var n=je(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(he)}return n}(Ye(e))},Xe=n(1507),Qe=n.n(Xe),$e=function(e){return e instanceof Uint8Array?e:(Array.isArray(e)||(t=e,ArrayBuffer.isView(t))||e instanceof ArrayBuffer||(e="number"!==typeof e||"number"===typeof e&&e!==e?0:[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0));var t},Ze=a.a.BigInt||Number,Je=[Ze("0x1"),Ze("0x100"),Ze("0x10000"),Ze("0x1000000"),Ze("0x100000000"),Ze("0x10000000000"),Ze("0x1000000000000"),Ze("0x100000000000000"),Ze("0x10000000000000000")],et=(function(){var e=new Uint16Array([65484]),t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);255===t[0]||t[0]}(),function(e,t){var n=void 0===t?{}:t,r=n.signed,i=void 0!==r&&r,a=n.le,o=void 0!==a&&a;e=$e(e);var s=o?"reduce":"reduceRight",u=(e[s]?e[s]:Array.prototype[s]).call(e,function(t,n,r){var i=o?r:Math.abs(r+1-e.length);return t+Ze(n)*Je[i]},Ze(0));if(i){var l=Je[e.length]/Ze(2)-Ze(1);(u=Ze(u))>l&&(u-=l,u-=l,u-=Ze(2))}return Number(u)}),tt=function(e,t){var n=(void 0===t?{}:t).le,r=void 0!==n&&n;("bigint"!==typeof e&&"number"!==typeof e||"number"===typeof e&&e!==e)&&(e=0),e=Ze(e);for(var i,a=(i=e,Math.ceil(function(e){return e.toString(2).length}(i)/8)),o=new Uint8Array(new ArrayBuffer(a)),s=0;s<a;s++){var u=r?s:Math.abs(s+1-o.length);o[u]=Number(e/Je[s]&Ze(255)),e<0&&(o[u]=Math.abs(~o[u]),o[u]-=0===s?1:2)}return o},nt=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var t=String.fromCharCode.apply(null,$e(e));try{return decodeURIComponent(escape(t))}catch(n){}return t},rt=function(e,t){if("string"!==typeof e&&e&&"function"===typeof e.toString&&(e=e.toString()),"string"!==typeof e)return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n},it=function(e,t,n){var r=void 0===n?{}:n,i=r.offset,a=void 0===i?0:i,o=r.mask,s=void 0===o?[]:o;e=$e(e);var u=(t=$e(t)).every?t.every:Array.prototype.every;return t.length&&e.length-a>=t.length&&u.call(t,function(t,n){return t===(s[n]?s[n]&e[a+n]:e[a+n])})},at=$e([73,68,51]),ot=function e(t,n){return void 0===n&&(n=0),(t=$e(t)).length-n<10||!it(t,at,{offset:n})?n:(n+=function(e,t){void 0===t&&(t=0);var n=(e=$e(e))[t+5],r=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&n)>>4?r+20:r+10}(t,n),e(t,n))},st=(new Uint8Array([79,112,117,115,72,101,97,100]),function(e){return"string"===typeof e?rt(e):e}),ut=function(e){e=$e(e);for(var t=[],n=0;e.length>n;){var i=e[n],a=0,o=0,s=e[++o];for(o++;128&s;)a=(127&s)<<7,s=e[o],o++;a+=127&s;for(var u=0;u<r.length;u++){var l=r[u],d=l.id,c=l.parser;if(i===d){t.push(c(e.subarray(o,o+a)));break}}n+=a+o}return t};r=[{id:3,parser:function(e){var t={tag:3,id:e[0]<<8|e[1],flags:e[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(128&t.flags&&(t.dependsOnEsId=e[t.size]<<8|e[t.size+1],t.size+=2),64&t.flags){var n=e[t.size];t.url=nt(e.subarray(t.size+1,t.size+1+n)),t.size+=n}return 32&t.flags&&(t.ocrEsId=e[t.size]<<8|e[t.size+1],t.size+=2),t.descriptors=ut(e.subarray(t.size))||[],t}},{id:4,parser:function(e){return{tag:4,oti:e[0],streamType:e[1],bufferSize:e[2]<<16|e[3]<<8|e[4],maxBitrate:e[5]<<24|e[6]<<16|e[7]<<8|e[8],avgBitrate:e[9]<<24|e[10]<<16|e[11]<<8|e[12],descriptors:ut(e.subarray(13))}}},{id:5,parser:function(e){return{tag:5,bytes:e}}},{id:6,parser:function(e){return{tag:6,bytes:e}}}];var lt=function e(t,n,r){void 0===r&&(r=!1),n=function(e){return Array.isArray(e)?e.map(function(e){return st(e)}):[st(e)]}(n),t=$e(t);var i=[];if(!n.length)return i;for(var a=0;a<t.length;){var o=(t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3])>>>0,s=t.subarray(a+4,a+8);if(0===o)break;var u=a+o;if(u>t.length){if(r)break;u=t.length}var l=t.subarray(a+8,u);it(s,n[0])&&(1===n.length?i.push(l):i.push.apply(i,e(l,n.slice(1),r))),a=u}return i},dt={EBML:$e([26,69,223,163]),DocType:$e([66,130]),Segment:$e([24,83,128,103]),SegmentInfo:$e([21,73,169,102]),Tracks:$e([22,84,174,107]),Track:$e([174]),TrackNumber:$e([215]),DefaultDuration:$e([35,227,131]),TrackEntry:$e([174]),TrackType:$e([131]),FlagDefault:$e([136]),CodecID:$e([134]),CodecPrivate:$e([99,162]),VideoTrack:$e([224]),AudioTrack:$e([225]),Cluster:$e([31,67,182,117]),Timestamp:$e([231]),TimestampScale:$e([42,215,177]),BlockGroup:$e([160]),BlockDuration:$e([155]),Block:$e([161]),SimpleBlock:$e([163])},ct=[128,64,32,16,8,4,2,1],ft=function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=!1);var i=function(e){for(var t=1,n=0;n<ct.length&&!(e&ct[n]);n++)t++;return t}(e[t]),a=e.subarray(t,t+i);return n&&((a=Array.prototype.slice.call(e,t,t+i))[0]^=ct[i-1]),{length:i,value:et(a,{signed:r}),bytes:a}},ht=function e(t){return"string"===typeof t?t.match(/.{1,2}/g).map(function(t){return e(t)}):"number"===typeof t?tt(t):t},pt=function e(t,n,r){if(r>=n.length)return n.length;var i=ft(n,r,!1);if(it(t.bytes,i.bytes))return r;var a=ft(n,r+i.length);return e(t,n,r+a.length+a.value+i.length)},gt=function e(t,n){n=function(e){return Array.isArray(e)?e.map(function(e){return ht(e)}):[ht(e)]}(n),t=$e(t);var r=[];if(!n.length)return r;for(var i=0;i<t.length;){var a=ft(t,i,!1),o=ft(t,i+a.length),s=i+a.length+o.length;127===o.value&&(o.value=pt(a,t,s),o.value!==t.length&&(o.value-=s));var u=s+o.value>t.length?t.length:s+o.value,l=t.subarray(s,u);it(n[0],a.bytes)&&(1===n.length?r.push(l):r=r.concat(e(l,n.slice(1)))),i+=a.length+o.length+l.length}return r},mt=$e([0,0,0,1]),vt=$e([0,0,1]),yt=$e([0,0,3]),_t=function(e){for(var t=[],n=1;n<e.length-2;)it(e.subarray(n,n+3),yt)&&(t.push(n+2),n++),n++;if(0===t.length)return e;var r=e.length-t.length,i=new Uint8Array(r),a=0;for(n=0;n<r;a++,n++)a===t[0]&&(a++,t.shift()),i[n]=e[a];return i},Tt=function(e,t,n,r){void 0===r&&(r=1/0),e=$e(e),n=[].concat(n);for(var i,a=0,o=0;a<e.length&&(o<r||i);){var s=void 0;if(it(e.subarray(a),mt)?s=4:it(e.subarray(a),vt)&&(s=3),s){if(o++,i)return _t(e.subarray(i,a));var u=void 0;"h264"===t?u=31&e[a+s]:"h265"===t&&(u=e[a+s]>>1&63),-1!==n.indexOf(u)&&(i=a+s),a+=s+("h264"===t?1:2)}else a++}return e.subarray(0,0)},Et={webm:$e([119,101,98,109]),matroska:$e([109,97,116,114,111,115,107,97]),flac:$e([102,76,97,67]),ogg:$e([79,103,103,83]),ac3:$e([11,119]),riff:$e([82,73,70,70]),avi:$e([65,86,73]),wav:$e([87,65,86,69]),"3gp":$e([102,116,121,112,51,103]),mp4:$e([102,116,121,112]),fmp4:$e([115,116,121,112]),mov:$e([102,116,121,112,113,116])},bt={aac:function(e){var t=ot(e);return it(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=ot(e);return it(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=gt(e,[dt.EBML,dt.DocType])[0];return it(t,Et.webm)},mkv:function(e){var t=gt(e,[dt.EBML,dt.DocType])[0];return it(t,Et.matroska)},mp4:function(e){return!bt["3gp"](e)&&!bt.mov(e)&&(it(e,Et.mp4,{offset:4})||it(e,Et.fmp4,{offset:4}))},mov:function(e){return it(e,Et.mov,{offset:4})},"3gp":function(e){return it(e,Et["3gp"],{offset:4})},ac3:function(e){var t=ot(e);return it(e,Et.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return 71===e[0];for(var t=0;t+188<e.length&&t<188;){if(71===e[t]&&71===e[t+188])return!0;t+=1}return!1},flac:function(e){var t=ot(e);return it(e,Et.flac,{offset:t})},ogg:function(e){return it(e,Et.ogg)},avi:function(e){return it(e,Et.riff)&&it(e,Et.avi,{offset:8})},wav:function(e){return it(e,Et.riff)&&it(e,Et.wav,{offset:8})},h264:function(e){return function(e,t,n){return Tt(e,"h264",t,n)}(e,7,3).length},h265:function(e){return function(e,t,n){return Tt(e,"h265",t,n)}(e,[32,33],3).length}},St=Object.keys(bt).filter(function(e){return"ts"!==e&&"h264"!==e&&"h265"!==e}).concat(["ts","h264","h265"]);St.forEach(function(e){var t=bt[e];bt[e]=function(e){return t($e(e))}});for(var At,wt=bt,It=function(e){e=$e(e);for(var t=0;t<St.length;t++){var n=St[t];if(wt[n](e))return n}return""},Ct=n(1508),Rt="7.13.3",Dt={prefixed:!0},Mt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Ot=Mt[0],Nt=0;Nt<Mt.length;Nt++)if(Mt[Nt][1]in s.a){At=Mt[Nt];break}if(At){for(var Pt=0;Pt<At.length;Pt++)Dt[Ot[Pt]]=At[Pt];Dt.prefixed=At[0]!==Ot[0]}var Lt=[],kt=function(e,t){return function(n,r,i){var o=t.levels[r],s=new RegExp("^("+o+")$");if("log"!==n&&i.unshift(n.toUpperCase()+":"),i.unshift(e+":"),Lt){Lt.push([].concat(i));var u=Lt.length-1e3;Lt.splice(0,u>0?u:0)}if(a.a.console){var l=a.a.console[n];l||"debug"!==n||(l=a.a.console.info||a.a.console.log),l&&o&&s.test(n)&&l[Array.isArray(i)?"apply":"call"](a.a.console,i)}}};var xt=function e(t){var n,r="info",i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n("log",r,t)};return n=kt(t,i),i.createLogger=function(n){return e(t+": "+n)},i.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},i.level=function(e){if("string"===typeof e){if(!i.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');r=e}return r},(i.history=function(){return Lt?[].concat(Lt):[]}).filter=function(e){return(Lt||[]).filter(function(t){return new RegExp(".*"+e+".*").test(t[0])})},i.history.clear=function(){Lt&&(Lt.length=0)},i.history.disable=function(){null!==Lt&&(Lt.length=0,Lt=null)},i.history.enable=function(){null===Lt&&(Lt=[])},i.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("error",r,t)},i.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("warn",r,t)},i.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("debug",r,t)},i}("VIDEOJS"),Ft=xt.createLogger,Ut=Object.prototype.toString,Bt=function(e){return qt(e)?Object.keys(e):[]};function jt(e,t){Bt(e).forEach(function(n){return t(e[n],n)})}function Gt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.assign?l.a.apply(void 0,[e].concat(n)):(n.forEach(function(t){t&&jt(t,function(t,n){e[n]=t})}),e)}function qt(e){return!!e&&"object"===typeof e}function Ht(e){return qt(e)&&"[object Object]"===Ut.call(e)&&e.constructor===Object}function Vt(e,t){if(!e||!t)return"";if("function"===typeof a.a.getComputedStyle){var n;try{n=a.a.getComputedStyle(e)}catch(r){return""}return n?n.getPropertyValue(t)||n[t]:""}return""}var Kt=a.a.navigator&&a.a.navigator.userAgent||"",Yt=/AppleWebKit\/([\d.]+)/i.exec(Kt),Wt=Yt?parseFloat(Yt.pop()):null,zt=/iPod/i.test(Kt),Xt=function(){var e=Kt.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),Qt=/Android/i.test(Kt),$t=function(){var e=Kt.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),Zt=Qt&&$t<5&&Wt<537,Jt=/Firefox/i.test(Kt),en=/Edg/i.test(Kt),tn=!en&&(/Chrome/i.test(Kt)||/CriOS/i.test(Kt)),nn=function(){var e=Kt.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),rn=function(){var e=/MSIE\s(\d+)\.\d/.exec(Kt),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Kt)&&/rv:11.0/.test(Kt)&&(t=11),t}(),an=/Safari/i.test(Kt)&&!tn&&!Qt&&!en,on=/Windows/i.test(Kt),sn=Boolean(gn()&&("ontouchstart"in a.a||a.a.navigator.maxTouchPoints||a.a.DocumentTouch&&a.a.document instanceof a.a.DocumentTouch)),un=/iPad/i.test(Kt)||an&&sn&&!/iPhone/i.test(Kt),ln=/iPhone/i.test(Kt)&&!un,dn=ln||un||zt,cn=(an||dn)&&!tn,fn=Object.freeze({__proto__:null,IS_IPOD:zt,IOS_VERSION:Xt,IS_ANDROID:Qt,ANDROID_VERSION:$t,IS_NATIVE_ANDROID:Zt,IS_FIREFOX:Jt,IS_EDGE:en,IS_CHROME:tn,CHROME_VERSION:nn,IE_VERSION:rn,IS_SAFARI:an,IS_WINDOWS:on,TOUCH_ENABLED:sn,IS_IPAD:un,IS_IPHONE:ln,IS_IOS:dn,IS_ANY_SAFARI:cn});function hn(e){return"string"===typeof e&&Boolean(e.trim())}function pn(e){if(e.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function gn(){return s.a===a.a.document}function mn(e){return qt(e)&&1===e.nodeType}function vn(){try{return a.a.parent!==a.a.self}catch(e){return!0}}function yn(e){return function(t,n){if(!hn(t))return s.a[e](null);hn(n)&&(n=s.a.querySelector(n));var r=mn(n)?n:s.a;return r[e]&&r[e](t)}}function _n(e,t,n,r){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===n&&(n={});var i=s.a.createElement(e);return Object.getOwnPropertyNames(t).forEach(function(e){var n=t[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(xt.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+n+"."),i.setAttribute(e,n)):"textContent"===e?Tn(i,n):i[e]===n&&"tabIndex"!==e||(i[e]=n)}),Object.getOwnPropertyNames(n).forEach(function(e){i.setAttribute(e,n[e])}),r&&Bn(i,r),i}function Tn(e,t){return"undefined"===typeof e.textContent?e.innerText=t:e.textContent=t,e}function En(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function bn(e,t){return pn(t),e.classList?e.classList.contains(t):(n=t,new RegExp("(^|\\s)"+n+"($|\\s)")).test(e.className);var n}function Sn(e,t){return e.classList?e.classList.add(t):bn(e,t)||(e.className=(e.className+" "+t).trim()),e}function An(e,t){return e.classList?e.classList.remove(t):(pn(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function wn(e,t,n){var r=bn(e,t);if("function"===typeof n&&(n=n(e,t)),"boolean"!==typeof n&&(n=!r),n!==r)return n?Sn(e,t):An(e,t),e}function In(e,t){Object.getOwnPropertyNames(t).forEach(function(n){var r=t[n];null===r||"undefined"===typeof r||!1===r?e.removeAttribute(n):e.setAttribute(n,!0===r?"":r)})}function Cn(e){var t={},n=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&e.attributes.length>0)for(var r=e.attributes,i=r.length-1;i>=0;i--){var a=r[i].name,o=r[i].value;"boolean"!==typeof e[a]&&-1===n.indexOf(","+a+",")||(o=null!==o),t[a]=o}return t}function Rn(e,t){return e.getAttribute(t)}function Dn(e,t,n){e.setAttribute(t,n)}function Mn(e,t){e.removeAttribute(t)}function On(){s.a.body.focus(),s.a.onselectstart=function(){return!1}}function Nn(){s.a.onselectstart=function(){return!0}}function Pn(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n.height||(n.height=parseFloat(Vt(e,"height"))),n.width||(n.width=parseFloat(Vt(e,"width"))),n}}function Ln(e){if(!e||e&&!e.offsetParent)return{left:0,top:0,width:0,height:0};for(var t=e.offsetWidth,n=e.offsetHeight,r=0,i=0;e.offsetParent&&e!==s.a[Dt.fullscreenElement];)r+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{left:r,top:i,width:t,height:n}}function kn(e,t){var n={x:0,y:0};if(dn)for(var r=e;r&&"html"!==r.nodeName.toLowerCase();){var i=Vt(r,"transform");if(/^matrix/.test(i)){var a=i.slice(7,-1).split(/,\s/).map(Number);n.x+=a[4],n.y+=a[5]}else if(/^matrix3d/.test(i)){var o=i.slice(9,-1).split(/,\s/).map(Number);n.x+=o[12],n.y+=o[13]}r=r.parentNode}var s={},u=Ln(t.target),l=Ln(e),d=l.width,c=l.height,f=t.offsetY-(l.top-u.top),h=t.offsetX-(l.left-u.left);return t.changedTouches&&(h=t.changedTouches[0].pageX-l.left,f=t.changedTouches[0].pageY+l.top,dn&&(h-=n.x,f-=n.y)),s.y=1-Math.max(0,Math.min(1,f/c)),s.x=Math.max(0,Math.min(1,h/d)),s}function xn(e){return qt(e)&&3===e.nodeType}function Fn(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function Un(e){return"function"===typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"===typeof e&&(e=e()),mn(e)||xn(e)?e:"string"===typeof e&&/\S/.test(e)?s.a.createTextNode(e):void 0}).filter(function(e){return e})}function Bn(e,t){return Un(t).forEach(function(t){return e.appendChild(t)}),e}function jn(e,t){return Bn(Fn(e),t)}function Gn(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons))}var qn,Hn=yn("querySelector"),Vn=yn("querySelectorAll"),Kn=Object.freeze({__proto__:null,isReal:gn,isEl:mn,isInFrame:vn,createEl:_n,textContent:Tn,prependTo:En,hasClass:bn,addClass:Sn,removeClass:An,toggleClass:wn,setAttributes:In,getAttributes:Cn,getAttribute:Rn,setAttribute:Dn,removeAttribute:Mn,blockTextSelection:On,unblockTextSelection:Nn,getBoundingClientRect:Pn,findPosition:Ln,getPointerPosition:kn,isTextNode:xn,emptyEl:Fn,normalizeContent:Un,appendContent:Bn,insertContent:jn,isSingleLeftClick:Gn,$:Hn,$$:Vn}),Yn=!1,Wn=function(){if(!1!==qn.options.autoSetup){var e=Array.prototype.slice.call(s.a.getElementsByTagName("video")),t=Array.prototype.slice.call(s.a.getElementsByTagName("audio")),n=Array.prototype.slice.call(s.a.getElementsByTagName("video-js")),r=e.concat(t,n);if(r&&r.length>0)for(var i=0,a=r.length;i<a;i++){var o=r[i];if(!o||!o.getAttribute){zn(1);break}void 0===o.player&&null!==o.getAttribute("data-setup")&&qn(o)}else Yn||zn(1)}};function zn(e,t){gn()&&(t&&(qn=t),a.a.setTimeout(Wn,e))}function Xn(){Yn=!0,a.a.removeEventListener("load",Xn)}gn()&&("complete"===s.a.readyState?Xn():a.a.addEventListener("load",Xn));var Qn,$n=function(e){var t=s.a.createElement("style");return t.className=e,t},Zn=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},Jn=3;function er(){return Jn++}a.a.WeakMap||(Qn=function(){function e(){this.vdata="vdata"+Math.floor(a.a.performance&&a.a.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var n=e[this.vdata]||er();return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t];xt("We have no data for this element",e)},t.has=function(e){return e[this.vdata]in this.data},t.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var tr,nr=a.a.WeakMap?new WeakMap:new Qn;function rr(e,t){if(nr.has(e)){var n=nr.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&nr.delete(e)}}function ir(e,t,n,r){n.forEach(function(n){e(t,n,r)})}function ar(e){if(e.fixed_)return e;function t(){return!0}function n(){return!1}if(!e||!e.isPropagationStopped){var r=e||a.a.event;for(var i in e={},r)"layerX"!==i&&"layerY"!==i&&"keyLocation"!==i&&"webkitMovementX"!==i&&"webkitMovementY"!==i&&("returnValue"===i&&r.preventDefault||(e[i]=r[i]));if(e.target||(e.target=e.srcElement||s.a),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){r.preventDefault&&r.preventDefault(),e.returnValue=!1,r.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),e.cancelBubble=!0,r.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!==e.clientX&&void 0!==e.clientX){var o=s.a.documentElement,u=s.a.body;e.pageX=e.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0),e.pageY=e.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e.fixed_=!0,e}var or=function(){if("boolean"!==typeof tr){tr=!1;try{var e=Object.defineProperty({},"passive",{get:function(){tr=!0}});a.a.addEventListener("test",null,e),a.a.removeEventListener("test",null,e)}catch(t){}}return tr},sr=["touchstart","touchmove"];function ur(e,t,n){if(Array.isArray(t))return ir(ur,e,t,n);nr.has(e)||nr.set(e,{});var r=nr.get(e);if(r.handlers||(r.handlers={}),r.handlers[t]||(r.handlers[t]=[]),n.guid||(n.guid=er()),r.handlers[t].push(n),r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,n){if(!r.disabled){t=ar(t);var i=r.handlers[t.type];if(i)for(var a=i.slice(0),o=0,s=a.length;o<s&&!t.isImmediatePropagationStopped();o++)try{a[o].call(e,t,n)}catch(u){xt.error(u)}}}),1===r.handlers[t].length)if(e.addEventListener){var i=!1;or()&&sr.indexOf(t)>-1&&(i={passive:!0}),e.addEventListener(t,r.dispatcher,i)}else e.attachEvent&&e.attachEvent("on"+t,r.dispatcher)}function lr(e,t,n){if(nr.has(e)){var r=nr.get(e);if(r.handlers){if(Array.isArray(t))return ir(lr,e,t,n);var i=function(e,t){r.handlers[t]=[],rr(e,t)};if(void 0!==t){var a=r.handlers[t];if(a)if(n){if(n.guid)for(var o=0;o<a.length;o++)a[o].guid===n.guid&&a.splice(o--,1);rr(e,t)}else i(e,t)}else for(var s in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},s)&&i(e,s)}}}function dr(e,t,n){var r=nr.has(e)?nr.get(e):{},i=e.parentNode||e.ownerDocument;if("string"===typeof t?t={type:t,target:e}:t.target||(t.target=e),t=ar(t),r.dispatcher&&r.dispatcher.call(e,t,n),i&&!t.isPropagationStopped()&&!0===t.bubbles)dr.call(null,i,t,n);else if(!i&&!t.defaultPrevented&&t.target&&t.target[t.type]){nr.has(t.target)||nr.set(t.target,{});var a=nr.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"===typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function cr(e,t,n){if(Array.isArray(t))return ir(cr,e,t,n);var r=function r(){lr(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||er(),ur(e,t,r)}function fr(e,t,n){var r=function r(){lr(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||er(),ur(e,t,r)}var hr,pr=Object.freeze({__proto__:null,fixEvent:ar,on:ur,off:lr,trigger:dr,one:cr,any:fr}),gr=30,mr=function(e,t,n){t.guid||(t.guid=er());var r=t.bind(e);return r.guid=n?n+"_"+t.guid:t.guid,r},vr=function(e,t){var n=a.a.performance.now();return function(){var r=a.a.performance.now();r-n>=t&&(e.apply(void 0,arguments),n=r)}},yr=function(e,t,n,r){var i;void 0===r&&(r=a.a);var o=function(){var a=this,o=arguments,s=function(){i=null,s=null,n||e.apply(a,o)};!i&&n&&e.apply(a,o),r.clearTimeout(i),i=r.setTimeout(s,t)};return o.cancel=function(){r.clearTimeout(i),i=null},o},_r=function(){};_r.prototype.allowedEvents_={},_r.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},ur(this,e,t),this.addEventListener=n},_r.prototype.addEventListener=_r.prototype.on,_r.prototype.off=function(e,t){lr(this,e,t)},_r.prototype.removeEventListener=_r.prototype.off,_r.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},cr(this,e,t),this.addEventListener=n},_r.prototype.any=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},fr(this,e,t),this.addEventListener=n},_r.prototype.trigger=function(e){var t=e.type||e;"string"===typeof e&&(e={type:t}),e=ar(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),dr(this,e)},_r.prototype.dispatchEvent=_r.prototype.trigger,_r.prototype.queueTrigger=function(e){var t=this;hr||(hr=new Map);var n=e.type||e,r=hr.get(this);r||(r=new Map,hr.set(this,r));var i=r.get(n);r.delete(n),a.a.clearTimeout(i);var o=a.a.setTimeout(function(){0===r.size&&(r=null,hr.delete(t)),t.trigger(e)},0);r.set(n,o)};var Tr=function(e){return"function"===typeof e.name?e.name():"string"===typeof e.name?e.name:e.name_?e.name_:e.constructor&&e.constructor.name?e.constructor.name:typeof e},Er=function(e){return e instanceof _r||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(t){return"function"===typeof e[t]})},br=function(e){return"string"===typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Sr=function(e,t,n){if(!e||!e.nodeName&&!Er(e))throw new Error("Invalid target for "+Tr(t)+"#"+n+"; must be a DOM node or evented object.")},Ar=function(e,t,n){if(!br(e))throw new Error("Invalid event type for "+Tr(t)+"#"+n+"; must be a non-empty string or array.")},wr=function(e,t,n){if("function"!==typeof e)throw new Error("Invalid listener for "+Tr(t)+"#"+n+"; must be a function.")},Ir=function(e,t,n){var r,i,a,o=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return o?(r=e.eventBusEl_,t.length>=3&&t.shift(),i=t[0],a=t[1]):(r=t[0],i=t[1],a=t[2]),Sr(r,e,n),Ar(i,e,n),wr(a,e,n),{isTargetingSelf:o,target:r,type:i,listener:a=mr(e,a)}},Cr=function(e,t,n,r){Sr(e,e,t),e.nodeName?pr[t](e,n,r):e[t](n,r)},Rr={on:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Ir(this,n,"on"),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(Cr(o,"on",s,u),!a){var l=function(){return e.off(o,s,u)};l.guid=u.guid;var d=function(){return e.off("dispose",l)};d.guid=u.guid,Cr(this,"on","dispose",l),Cr(o,"on","dispose",d)}},one:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Ir(this,n,"one"),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(a)Cr(o,"one",s,u);else{var l=function t(){e.off(o,s,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];u.apply(null,r)};l.guid=u.guid,Cr(o,"one",s,l)}},any:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Ir(this,n,"any"),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(a)Cr(o,"any",s,u);else{var l=function t(){e.off(o,s,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];u.apply(null,r)};l.guid=u.guid,Cr(o,"any",s,l)}},off:function(e,t,n){if(!e||br(e))lr(this.eventBusEl_,e,t);else{var r=e,i=t;Sr(r,this,"off"),Ar(i,this,"off"),wr(n,this,"off"),n=mr(this,n),this.off("dispose",n),r.nodeName?(lr(r,i,n),lr(r,"dispose",n)):Er(r)&&(r.off(i,n),r.off("dispose",n))}},trigger:function(e,t){Sr(this.eventBusEl_,this,"trigger");var n=e&&"string"!==typeof e?e.type:e;if(!br(n)){var r="Invalid event type for "+Tr(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(!e)throw new Error(r);(this.log||xt).error(r)}return dr(this.eventBusEl_,e,t)}};function Dr(e,t){void 0===t&&(t={});var n=t.eventBusKey;if(n){if(!e[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');e.eventBusEl_=e[n]}else e.eventBusEl_=_n("span",{className:"vjs-event-bus"});return Gt(e,Rr),e.eventedCallbacks&&e.eventedCallbacks.forEach(function(e){e()}),e.on("dispose",function(){e.off(),a.a.setTimeout(function(){e.eventBusEl_=null},0)}),e}var Mr={state:{},setState:function(e){var t,n=this;return"function"===typeof e&&(e=e()),jt(e,function(e,r){n.state[r]!==e&&((t=t||{})[r]={from:n.state[r],to:e}),n.state[r]=e}),t&&Er(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Or(e,t){return Gt(e,Mr),e.state=Gt({},e.state,t),"function"===typeof e.handleStateChanged&&Er(e)&&e.on("statechanged",e.handleStateChanged),e}var Nr=function(e){return"string"!==typeof e?e:e.replace(/./,function(e){return e.toLowerCase()})},Pr=function(e){return"string"!==typeof e?e:e.replace(/./,function(e){return e.toUpperCase()})};function Lr(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){t&&jt(t,function(t,n){Ht(t)?(Ht(e[n])||(e[n]={}),e[n]=Lr(e[n],t)):e[n]=t})}),e}var kr=function(){function e(){this.map_={}}var t=e.prototype;return t.has=function(e){return e in this.map_},t.delete=function(e){var t=this.has(e);return delete this.map_[e],t},t.set=function(e,t){return this.map_[e]=t,this},t.forEach=function(e,t){for(var n in this.map_)e.call(t,this.map_[n],n,this)},e}(),xr=a.a.Map?a.a.Map:kr,Fr=function(){function e(){this.set_={}}var t=e.prototype;return t.has=function(e){return e in this.set_},t.delete=function(e){var t=this.has(e);return delete this.set_[e],t},t.add=function(e){return this.set_[e]=1,this},t.forEach=function(e,t){for(var n in this.set_)e.call(t,n,n,this)},e}(),Ur=a.a.Set?a.a.Set:Fr,Br=function(){function e(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Lr({},this.options_),t=this.options_=Lr(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+er()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&(Dr(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Or(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Ur,this.setIntervalIds_=new Ur,this.rafIds_=new Ur,this.namedRafs_=new xr,this.clearingTimersOnDispose_=!1,!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var t=e.prototype;return t.dispose=function(){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),nr.has(this.el_)&&nr.delete(this.el_),this.el_=null),this.player_=null}},t.isDisposed=function(){return Boolean(this.isDisposed_)},t.player=function(){return this.player_},t.options=function(e){return e?(this.options_=Lr(this.options_,e),this.options_):this.options_},t.el=function(){return this.el_},t.createEl=function(e,t,n){return _n(e,t,n)},t.localize=function(e,t,n){void 0===n&&(n=e);var r=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages(),a=i&&i[r],o=r&&r.split("-")[0],s=i&&i[o],u=n;return a&&a[e]?u=a[e]:s&&s[e]&&(u=s[e]),t&&(u=u.replace(/\{(\d+)\}/g,function(e,n){var r=t[n-1],i=r;return"undefined"===typeof r&&(i=e),i})),u},t.handleLanguagechange=function(){},t.contentEl=function(){return this.contentEl_||this.el_},t.id=function(){return this.id_},t.name=function(){return this.name_},t.children=function(){return this.children_},t.getChildById=function(e){return this.childIndex_[e]},t.getChild=function(e){if(e)return this.childNameIndex_[e]},t.getDescendant=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.reduce(function(e,t){return e.concat(t)},[]);for(var r=this,i=0;i<t.length;i++)if(!(r=r.getChild(t[i]))||!r.getChild)return;return r},t.addChild=function(t,n,r){var i,a;if(void 0===n&&(n={}),void 0===r&&(r=this.children_.length),"string"===typeof t){a=Pr(t);var o=n.componentClass||a;n.name=a;var s=e.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!==typeof s)return null;i=new s(this.player_||this,n)}else i=t;if(i.parentComponent_&&i.parentComponent_.removeChild(i),this.children_.splice(r,0,i),i.parentComponent_=this,"function"===typeof i.id&&(this.childIndex_[i.id()]=i),(a=a||i.name&&Pr(i.name()))&&(this.childNameIndex_[a]=i,this.childNameIndex_[Nr(a)]=i),"function"===typeof i.el&&i.el()){var u=null;this.children_[r+1]&&(this.children_[r+1].el_?u=this.children_[r+1].el_:mn(this.children_[r+1])&&(u=this.children_[r+1])),this.contentEl().insertBefore(i.el(),u)}return i},t.removeChild=function(e){if("string"===typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Pr(e.name())]=null,this.childNameIndex_[Nr(e.name())]=null;var r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},t.initChildren=function(){var t=this,n=this.options_.children;if(n){var r,i=this.options_,a=e.getComponent("Tech");(r=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter(function(e){return!r.some(function(t){return"string"===typeof t?e===t:e===t.name})})).map(function(e){var r,i;return"string"===typeof e?i=n[r=e]||t.options_[r]||{}:(r=e.name,i=e),{name:r,opts:i}}).filter(function(t){var n=e.getComponent(t.opts.componentClass||Pr(t.name));return n&&!a.isTech(n)}).forEach(function(e){var n=e.name,r=e.opts;if(void 0!==i[n]&&(r=i[n]),!1!==r){!0===r&&(r={}),r.playerOptions=t.options_.playerOptions;var a=t.addChild(n,r);a&&(t[n]=a)}})}},t.buildCSSClass=function(){return""},t.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},t.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},t.$=function(e,t){return Hn(e,t||this.contentEl())},t.$$=function(e,t){return Vn(e,t||this.contentEl())},t.hasClass=function(e){return bn(this.el_,e)},t.addClass=function(e){Sn(this.el_,e)},t.removeClass=function(e){An(this.el_,e)},t.toggleClass=function(e,t){wn(this.el_,e,t)},t.show=function(){this.removeClass("vjs-hidden")},t.hide=function(){this.addClass("vjs-hidden")},t.lockShowing=function(){this.addClass("vjs-lock-showing")},t.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.getAttribute=function(e){return Rn(this.el_,e)},t.setAttribute=function(e,t){Dn(this.el_,e,t)},t.removeAttribute=function(e){Mn(this.el_,e)},t.width=function(e,t){return this.dimension("width",e,t)},t.height=function(e,t){return this.dimension("height",e,t)},t.dimensions=function(e,t){this.width(e,!0),this.height(t)},t.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t===t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var r=this.el_.style[e],i=r.indexOf("px");return-1!==i?parseInt(r.slice(0,i),10):parseInt(this.el_["offset"+Pr(e)],10)},t.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=Vt(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var n="offset"+Pr(e);t=this.el_[n]}return t},t.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.currentWidth=function(){return this.currentDimension("width")},t.currentHeight=function(){return this.currentDimension("height")},t.focus=function(){this.el_.focus()},t.blur=function(){this.el_.blur()},t.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},t.handleKeyPress=function(e){this.handleKeyDown(e)},t.emitTapEvents=function(){var e,t=0,n=null;this.on("touchstart",function(r){1===r.touches.length&&(n={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},t=a.a.performance.now(),e=!0)}),this.on("touchmove",function(t){if(t.touches.length>1)e=!1;else if(n){var r=t.touches[0].pageX-n.pageX,i=t.touches[0].pageY-n.pageY;Math.sqrt(r*r+i*i)>10&&(e=!1)}});var r=function(){e=!1};this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",function(r){(n=null,!0===e)&&(a.a.performance.now()-t<200&&(r.preventDefault(),this.trigger("tap")))})},t.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=mr(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},t.setTimeout=function(e,t){var n,r=this;return e=mr(this,e),this.clearTimersOnDispose_(),n=a.a.setTimeout(function(){r.setTimeoutIds_.has(n)&&r.setTimeoutIds_.delete(n),e()},t),this.setTimeoutIds_.add(n),n},t.clearTimeout=function(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),a.a.clearTimeout(e)),e},t.setInterval=function(e,t){e=mr(this,e),this.clearTimersOnDispose_();var n=a.a.setInterval(e,t);return this.setIntervalIds_.add(n),n},t.clearInterval=function(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),a.a.clearInterval(e)),e},t.requestAnimationFrame=function(e){var t,n=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),e=mr(this,e),t=a.a.requestAnimationFrame(function(){n.rafIds_.has(t)&&n.rafIds_.delete(t),e()}),this.rafIds_.add(t),t):this.setTimeout(e,1e3/60)},t.requestNamedAnimationFrame=function(e,t){var n=this;if(!this.namedRafs_.has(e)){this.clearTimersOnDispose_(),t=mr(this,t);var r=this.requestAnimationFrame(function(){t(),n.namedRafs_.has(e)&&n.namedRafs_.delete(e)});return this.namedRafs_.set(e,r),e}},t.cancelNamedAnimationFrame=function(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))},t.cancelAnimationFrame=function(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_.delete(e),a.a.cancelAnimationFrame(e)),e):this.clearTimeout(e)},t.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(t){var n=t[0],r=t[1];e[n].forEach(function(t,n){return e[r](n)})}),e.clearingTimersOnDispose_=!1}))},e.registerComponent=function(t,n){if("string"!==typeof t||!t)throw new Error('Illegal component name, "'+t+'"; must be a non-empty string.');var r,i=e.getComponent("Tech"),a=i&&i.isTech(n),o=e===n||e.prototype.isPrototypeOf(n.prototype);if(a||!o)throw r=a?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+t+'"; '+r+".");t=Pr(t),e.components_||(e.components_={});var s=e.getComponent("Player");if("Player"===t&&s&&s.players){var u=s.players,l=Object.keys(u);if(u&&l.length>0&&l.map(function(e){return u[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return e.components_[t]=n,e.components_[Nr(t)]=n,n},e.getComponent=function(t){if(t&&e.components_)return e.components_[t]},e}();function jr(e,t,n,r){return function(e,t,n){if("number"!==typeof t||t<0||t>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+n+").")}(e,r,n.length-1),n[r][t]}function Gr(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:jr.bind(null,"start",0,e),end:jr.bind(null,"end",1,e)}}function qr(e,t){return Array.isArray(e)?Gr(e):void 0===e||void 0===t?Gr():Gr([[e,t]])}function Hr(e,t){var n,r,i=0;if(!t)return 0;e&&e.length||(e=qr(0,0));for(var a=0;a<e.length;a++)n=e.start(a),(r=e.end(a))>t&&(r=t),i+=r-n;return i/t}function Vr(e){if(e instanceof Vr)return e;"number"===typeof e?this.code=e:"string"===typeof e?this.message=e:qt(e)&&("number"===typeof e.code&&(this.code=e.code),Gt(this,e)),this.message||(this.message=Vr.defaultMessages[this.code]||"")}Br.prototype.supportsRaf_="function"===typeof a.a.requestAnimationFrame&&"function"===typeof a.a.cancelAnimationFrame,Br.registerComponent("Component",Br),Vr.prototype.code=0,Vr.prototype.message="",Vr.prototype.status=null,Vr.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Vr.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Kr=0;Kr<Vr.errorTypes.length;Kr++)Vr[Vr.errorTypes[Kr]]=Kr,Vr.prototype[Vr.errorTypes[Kr]]=Kr;function Yr(e){return void 0!==e&&null!==e&&"function"===typeof e.then}function Wr(e){Yr(e)&&e.then(null,function(e){})}var zr=function(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,n,r){return e[n]&&(t[n]=e[n]),t},{cues:e.cues&&Array.prototype.map.call(e.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})},Xr=function(e){var t=e.$$("track"),n=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=zr(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===n.indexOf(e)}).map(zr))},Qr=function(e,t){return e.forEach(function(e){var n=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return n.addCue(e)})}),t.textTracks()},$r="vjs-modal-dialog",Zr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleKeyDown_=function(e){return r.handleKeyDown(e)},r.close_=function(e){return r.close(e)},r.opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=_n("div",{className:$r+"-content"},{role:"document"}),r.descEl_=_n("p",{className:$r+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),Tn(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},n.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return $r+" vjs-hidden "+e.prototype.buildCSSClass.call(this)},n.label=function(){return this.localize(this.options_.label||"Modal Window")},n.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},n.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},n.opened=function(e){return"boolean"===typeof e&&this[e?"open":"close"](),this.opened_},n.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},n.closeable=function(e){if("boolean"===typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var r=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(n,"close",this.close_)}!t&&n&&(this.off(n,"close",this.close_),this.removeChild(n),n.dispose())}return this.closeable_},n.fill=function(){this.fillWith(this.content())},n.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,r=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),jn(t,e),this.trigger("modalfill"),r?n.insertBefore(t,r):n.appendChild(t);var i=this.getChild("closeButton");i&&n.appendChild(i.el_)},n.empty=function(){this.trigger("beforemodalempty"),Fn(this.contentEl()),this.trigger("modalempty")},n.content=function(e){return"undefined"!==typeof e&&(this.content_=e),this.content_},n.conditionalFocus_=function(){var e=s.a.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())},n.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},n.handleKeyDown=function(e){if(e.stopPropagation(),v.a.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(v.a.isEventKey(e,"Tab")){for(var t,n=this.focusableEls_(),r=this.el_.querySelector(":focus"),i=0;i<n.length;i++)if(r===n[i]){t=i;break}s.a.activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(n[n.length-1].focus(),e.preventDefault()):e.shiftKey||t!==n.length-1||(n[0].focus(),e.preventDefault())}},n.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,function(e){return(e instanceof a.a.HTMLAnchorElement||e instanceof a.a.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof a.a.HTMLInputElement||e instanceof a.a.HTMLSelectElement||e instanceof a.a.HTMLTextAreaElement||e instanceof a.a.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof a.a.HTMLIFrameElement||e instanceof a.a.HTMLObjectElement||e instanceof a.a.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")})},t}(Br);Zr.prototype.options_={pauseOnOpen:!0,temporary:!0},Br.registerComponent("ModalDialog",Zr);var Jr=function(e){function t(t){var n;void 0===t&&(t=[]),(n=e.call(this)||this).tracks_=[],Object.defineProperty(c()(n),"length",{get:function(){return this.tracks_.length}});for(var r=0;r<t.length;r++)n.addTrack(t[r]);return n}h()(t,e);var n=t.prototype;return n.addTrack=function(e){var t=this,n=this.tracks_.length;""+n in this||Object.defineProperty(this,n,{get:function(){return this.tracks_[n]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=function(){t.trigger({track:e,type:"labelchange",target:t})},Er(e)&&e.addEventListener("labelchange",e.labelchange_)},n.removeTrack=function(e){for(var t,n=0,r=this.length;n<r;n++)if(this[n]===e){(t=this[n]).off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},n.getTrackById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},t}(_r);for(var ei in Jr.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"},Jr.prototype.allowedEvents_)Jr.prototype["on"+ei]=null;var ti=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)},ni=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].enabled){ti(t,t[r]);break}return(n=e.call(this,t)||this).changing_=!1,n}h()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.enabled&&ti(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){n.changing_||(n.changing_=!0,ti(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(Jr),ri=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)},ii=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].selected){ri(t,t[r]);break}return(n=e.call(this,t)||this).changing_=!1,Object.defineProperty(c()(n),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),n}h()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.selected&&ri(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){n.changing_||(n.changing_=!0,ri(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(Jr),ai=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(Jr),oi=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,r=this.trackElements_.length;n<r;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"===typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"===typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),si=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,n=0,r=e.length;this.cues_=e,this.length_=e.length;var i=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<r)for(n=t;n<r;n++)i.call(this,n)},t.getCueById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},e}(),ui={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},li={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},di={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},ci={disabled:"disabled",hidden:"hidden",showing:"showing"},fi=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var r={id:t.id||"vjs_track_"+er(),kind:t.kind||"",language:t.language||""},i=t.label||"",a=function(e){Object.defineProperty(c()(n),e,{get:function(){return r[e]},set:function(){}})};for(var o in r)a(o);return Object.defineProperty(c()(n),"label",{get:function(){return i},set:function(e){e!==i&&(i=e,this.trigger("labelchange"))}}),n}return h()(t,e),t}(_r),hi=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"],n=s.a.createElement("a");n.href=e;var r,i=""===n.host&&"file:"!==n.protocol;i&&((r=s.a.createElement("div")).innerHTML='<a href="'+e+'"></a>',n=r.firstChild,r.setAttribute("style","display:none; position:absolute;"),s.a.body.appendChild(r));for(var o={},u=0;u<t.length;u++)o[t[u]]=n[t[u]];return"http:"===o.protocol&&(o.host=o.host.replace(/:80$/,"")),"https:"===o.protocol&&(o.host=o.host.replace(/:443$/,"")),o.protocol||(o.protocol=a.a.location.protocol),i&&s.a.body.removeChild(r),o},pi=function(e){if(!e.match(/^https?:\/\//)){var t=s.a.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e},gi=function(e){if("string"===typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""},mi=function(e,t){void 0===t&&(t=a.a.location);var n=hi(e);return(":"===n.protocol?t.protocol:n.protocol)+n.host!==t.protocol+t.host},vi=Object.freeze({__proto__:null,parseUrl:hi,getAbsoluteURL:pi,getFileExtension:gi,isCrossOrigin:mi}),yi=function(e,t){var n=new a.a.WebVTT.Parser(a.a,a.a.vttjs,a.a.WebVTT.StringDecoder()),r=[];n.oncue=function(e){t.addCue(e)},n.onparsingerror=function(e){r.push(e)},n.onflush=function(){t.trigger({type:"loadeddata",target:t})},n.parse(e),r.length>0&&(a.a.console&&a.a.console.groupCollapsed&&a.a.console.groupCollapsed("Text Track parsing errors for "+t.src),r.forEach(function(e){return xt.error(e)}),a.a.console&&a.a.console.groupEnd&&a.a.console.groupEnd()),n.flush()},_i=function(e,t){var n={uri:e},r=mi(e);r&&(n.cors=r);var i="use-credentials"===t.tech_.crossOrigin();i&&(n.withCredentials=i),_()(n,mr(this,function(e,n,r){if(e)return xt.error(e,n);t.loaded_=!0,"function"!==typeof a.a.WebVTT?t.tech_&&t.tech_.any(["vttjsloaded","vttjserror"],function(e){if("vttjserror"!==e.type)return yi(r,t);xt.error("vttjs failed to load, stopping trying to process "+t.src)}):yi(r,t)}))},Ti=function(e){function t(t){var n;if(void 0===t&&(t={}),!t.tech)throw new Error("A tech was not provided.");var r=Lr(t,{kind:di[t.kind]||"subtitles",language:t.language||t.srclang||""}),i=ci[r.mode]||"disabled",a=r.default;"metadata"!==r.kind&&"chapters"!==r.kind||(i="hidden"),(n=e.call(this,r)||this).tech_=r.tech,n.cues_=[],n.activeCues_=[],n.preload_=!1!==n.tech_.preloadTextTracks;var o=new si(n.cues_),s=new si(n.activeCues_),u=!1,l=mr(c()(n),function(){this.tech_.isReady_&&!this.tech_.isDisposed()&&(this.activeCues=this.activeCues,u&&(this.trigger("cuechange"),u=!1))});return n.tech_.one("dispose",function(){n.tech_.off("timeupdate",l)}),"disabled"!==i&&n.tech_.on("timeupdate",l),Object.defineProperties(c()(n),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return i},set:function(e){ci[e]&&i!==e&&(i=e,this.preload_||"disabled"===i||0!==this.cues.length||_i(this.src,this),this.tech_.off("timeupdate",l),"disabled"!==i&&this.tech_.on("timeupdate",l),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?o:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return s;for(var e=this.tech_.currentTime(),t=[],n=0,r=this.cues.length;n<r;n++){var i=this.cues[n];i.startTime<=e&&i.endTime>=e?t.push(i):i.startTime===i.endTime&&i.startTime<=e&&i.startTime+.5>=e&&t.push(i)}if(u=!1,t.length!==this.activeCues_.length)u=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(u=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set:function(){}}}),r.src?(n.src=r.src,n.preload_||(n.loaded_=!0),(n.preload_||"subtitles"!==r.kind&&"captions"!==r.kind)&&_i(n.src,c()(n))):n.loaded_=!0,n}h()(t,e);var n=t.prototype;return n.addCue=function(e){var t=e;if(a.a.vttjs&&!(e instanceof a.a.vttjs.VTTCue)){for(var n in t=new a.a.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)n in t||(t[n]=e[n]);t.id=e.id,t.originalCue_=e}for(var r=this.tech_.textTracks(),i=0;i<r.length;i++)r[i]!==this&&r[i].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},n.removeCue=function(e){for(var t=this.cues_.length;t--;){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},t}(fi);Ti.prototype.allowedEvents_={cuechange:"cuechange"};var Ei=function(e){function t(t){var n;void 0===t&&(t={});var r=Lr(t,{kind:li[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(c()(n),"enabled",{get:function(){return i},set:function(e){"boolean"===typeof e&&e!==i&&(i=e,this.trigger("enabledchange"))}}),r.enabled&&(n.enabled=r.enabled),n.loaded_=!0,n}return h()(t,e),t}(fi),bi=function(e){function t(t){var n;void 0===t&&(t={});var r=Lr(t,{kind:ui[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(c()(n),"selected",{get:function(){return i},set:function(e){"boolean"===typeof e&&e!==i&&(i=e,this.trigger("selectedchange"))}}),r.selected&&(n.selected=r.selected),n}return h()(t,e),t}(fi),Si=0,Ai=2,wi=function(e){function t(t){var n,r;void 0===t&&(t={}),n=e.call(this)||this;var i=new Ti(t);return n.kind=i.kind,n.src=i.src,n.srclang=i.language,n.label=i.label,n.default=i.default,Object.defineProperties(c()(n),{readyState:{get:function(){return r}},track:{get:function(){return i}}}),r=Si,i.addEventListener("loadeddata",function(){r=Ai,n.trigger({type:"load",target:c()(n)})}),n}return h()(t,e),t}(_r);wi.prototype.allowedEvents_={load:"load"},wi.NONE=Si,wi.LOADING=1,wi.LOADED=Ai,wi.ERROR=3;var Ii={audio:{ListClass:ni,TrackClass:Ei,capitalName:"Audio"},video:{ListClass:ii,TrackClass:bi,capitalName:"Video"},text:{ListClass:ai,TrackClass:Ti,capitalName:"Text"}};Object.keys(Ii).forEach(function(e){Ii[e].getterName=e+"Tracks",Ii[e].privateName=e+"Tracks_"});var Ci={remoteText:{ListClass:ai,TrackClass:Ti,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:oi,TrackClass:wi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Ri=l()({},Ii,Ci);Ci.names=Object.keys(Ci),Ii.names=Object.keys(Ii),Ri.names=[].concat(Ci.names).concat(Ii.names);var Di=function(e){function t(t,n){var r;return void 0===t&&(t={}),void 0===n&&(n=function(){}),t.reportTouchActivity=!1,(r=e.call(this,null,t,n)||this).onDurationChange_=function(e){return r.onDurationChange(e)},r.trackProgress_=function(e){return r.trackProgress(e)},r.trackCurrentTime_=function(e){return r.trackCurrentTime(e)},r.stopTrackingCurrentTime_=function(e){return r.stopTrackingCurrentTime(e)},r.disposeSourceHandler_=function(e){return r.disposeSourceHandler(e)},r.hasStarted_=!1,r.on("playing",function(){this.hasStarted_=!0}),r.on("loadstart",function(){this.hasStarted_=!1}),Ri.names.forEach(function(e){var n=Ri[e];t&&t[n.getterName]&&(r[n.privateName]=t[n.getterName])}),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(e){!1===t["native"+e+"Tracks"]&&(r["featuresNative"+e+"Tracks"]=!1)}),!1===t.nativeCaptions||!1===t.nativeTextTracks?r.featuresNativeTextTracks=!1:!0!==t.nativeCaptions&&!0!==t.nativeTextTracks||(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.preloadTextTracks=!1!==t.preloadTextTracks,r.autoRemoteTextTracks_=new Ri.text.ListClass,r.initTrackListeners(),t.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}h()(t,e);var n=t.prototype;return n.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},n.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)},n.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)},n.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(mr(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()}),500)},n.onDurationChange=function(e){this.duration_=this.duration()},n.buffered=function(){return qr(0,0)},n.bufferedPercent=function(){return Hr(this.buffered(),this.duration_)},n.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},n.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)},n.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)},n.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},n.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.dispose=function(){this.clearTracks(Ii.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),e.prototype.dispose.call(this)},n.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach(function(e){for(var n=t[e+"Tracks"]()||[],r=n.length;r--;){var i=n[r];"text"===e&&t.removeRemoteTextTrack(i),n.removeTrack(i)}})},n.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var n=e[t];this.removeRemoteTextTrack(n)}},n.reset=function(){},n.crossOrigin=function(){},n.setCrossOrigin=function(){},n.error=function(e){return void 0!==e&&(this.error_=new Vr(e),this.trigger("error")),this.error_},n.played=function(){return this.hasStarted_?qr(0,0):qr()},n.play=function(){},n.setScrubbing=function(){},n.scrubbing=function(){},n.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.initTrackListeners=function(){var e=this;Ii.names.forEach(function(t){var n=Ii[t],r=function(){e.trigger(t+"trackchange")},i=e[n.getterName]();i.addEventListener("removetrack",r),i.addEventListener("addtrack",r),e.on("dispose",function(){i.removeEventListener("removetrack",r),i.removeEventListener("addtrack",r)})})},n.addWebVttScript_=function(){var e=this;if(!a.a.WebVTT)if(s.a.body.contains(this.el())){if(!this.options_["vtt.js"]&&Ht(E.a)&&Object.keys(E.a).length>0)return void this.trigger("vttjsloaded");var t=s.a.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",function(){t.onload=null,t.onerror=null}),a.a.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},n.emulateTextTracks=function(){var e=this,t=this.textTracks(),n=this.remoteTextTracks(),r=function(e){return t.addTrack(e.track)},i=function(e){return t.removeTrack(e.track)};n.on("addtrack",r),n.on("removetrack",i),this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")},o=function(){a();for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("cuechange",a),"showing"===n.mode&&n.addEventListener("cuechange",a)}};o(),t.addEventListener("change",o),t.addEventListener("addtrack",o),t.addEventListener("removetrack",o),this.on("dispose",function(){n.off("addtrack",r),n.off("removetrack",i),t.removeEventListener("change",o),t.removeEventListener("addtrack",o),t.removeEventListener("removetrack",o);for(var e=0;e<t.length;e++){t[e].removeEventListener("cuechange",a)}})},n.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,r,i){void 0===i&&(i={});var a=e.textTracks();i.kind=t,n&&(i.label=n),r&&(i.language=r),i.tech=e;var o=new Ri.text.TrackClass(i);return a.addTrack(o),o}(this,e,t,n)},n.createRemoteTextTrack=function(e){var t=Lr(e,{tech:this});return new Ci.remoteTextEl.TrackClass(t)},n.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var r=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(xt.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),!0!==t&&this.ready(function(){return n.autoRemoteTextTracks_.addTrack(r.track)}),r},n.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},n.getVideoPlaybackQuality=function(){return{}},n.requestPictureInPicture=function(){var e=this.options_.Promise||a.a.Promise;if(e)return e.reject()},n.disablePictureInPicture=function(){return!0},n.setDisablePictureInPicture=function(){},n.setPoster=function(){},n.playsinline=function(){},n.setPlaysinline=function(){},n.overrideNativeAudioTracks=function(){},n.overrideNativeVideoTracks=function(){},n.canPlayType=function(){return""},t.canPlayType=function(){return""},t.canPlaySource=function(e,n){return t.canPlayType(e.type)},t.isTech=function(e){return e.prototype instanceof t||e instanceof t||e===t},t.registerTech=function(e,n){if(t.techs_||(t.techs_={}),!t.isTech(n))throw new Error("Tech "+e+" must be a Tech");if(!t.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!t.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Pr(e),t.techs_[e]=n,t.techs_[Nr(e)]=n,"Tech"!==e&&t.defaultTechOrder_.push(e),n},t.getTech=function(e){if(e)return t.techs_&&t.techs_[e]?t.techs_[e]:(e=Pr(e),a.a&&a.a.videojs&&a.a.videojs[e]?(xt.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),a.a.videojs[e]):void 0)},t}(Br);Ri.names.forEach(function(e){var t=Ri[e];Di.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),Di.prototype.featuresVolumeControl=!0,Di.prototype.featuresMuteControl=!0,Di.prototype.featuresFullscreenResize=!1,Di.prototype.featuresPlaybackRate=!1,Di.prototype.featuresProgressEvents=!1,Di.prototype.featuresSourceset=!1,Di.prototype.featuresTimeupdateEvents=!1,Di.prototype.featuresNativeTextTracks=!1,Di.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){var r=e.sourceHandlers;r||(r=e.sourceHandlers=[]),void 0===n&&(n=r.length),r.splice(n,0,t)},e.canPlayType=function(t){for(var n,r=e.sourceHandlers||[],i=0;i<r.length;i++)if(n=r[i].canPlayType(t))return n;return""},e.selectSourceHandler=function(t,n){for(var r=e.sourceHandlers||[],i=0;i<r.length;i++)if(r[i].canHandleSource(t,n))return r[i];return null},e.canPlaySource=function(t,n){var r=e.selectSourceHandler(t,n);return r?r.canHandleSource(t,n):""};["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"===typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},e.prototype),e.prototype.setSource=function(t){var n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:xt.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Br.registerComponent("Tech",Di),Di.registerTech("Tech",Di),Di.defaultTechOrder_=[];var Mi={},Oi={},Ni={};function Pi(e,t,n){e.setTimeout(function(){return function e(t,n,r,i,a,o){void 0===t&&(t={});void 0===n&&(n=[]);void 0===a&&(a=[]);void 0===o&&(o=!1);var s=n,u=s[0],l=s.slice(1);if("string"===typeof u)e(t,Mi[u],r,i,a,o);else if(u){var d=function(e,t){var n=Oi[e.id()],r=null;if(void 0===n||null===n)return r=t(e),Oi[e.id()]=[[t,r]],r;for(var i=0;i<n.length;i++){var a=n[i],o=a[0],s=a[1];o===t&&(r=s)}null===r&&(r=t(e),n.push([t,r]));return r}(i,u);if(!d.setSource)return a.push(d),e(t,l,r,i,a,o);d.setSource(Gt({},t),function(n,s){if(n)return e(t,l,r,i,a,o);a.push(d),e(s,t.type===s.type?l:Mi[s.type],r,i,a,o)})}else l.length?e(t,l,r,i,a,o):o?r(t,a):e(t,Mi["*"],r,i,a,!0)}(t,Mi[t.type],n,e)},1)}function Li(e,t,n,r){void 0===r&&(r=null);var i="call"+Pr(n),a=e.reduce(Ui(i),r),o=a===Ni,s=o?null:t[n](a);return function(e,t,n,r){for(var i=e.length-1;i>=0;i--){var a=e[i];a[t]&&a[t](r,n)}}(e,n,s,o),s}var ki={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},xi={setCurrentTime:1,setMuted:1,setVolume:1},Fi={play:1,pause:1};function Ui(e){return function(t,n){return t===Ni?Ni:n[e]?n[e](t):t}}var Bi={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},ji=function(e){void 0===e&&(e="");var t=gi(e);return Bi[t.toLowerCase()]||""};function Gi(e){if(!e.type){var t=ji(e.src);t&&(e.type=t)}return e}var qi=function(e){function t(t,n,r){var i,a=Lr({createEl:!1},n);if(i=e.call(this,t,a,r)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)t.src(n.playerOptions.sources);else for(var o=0,s=n.playerOptions.techOrder;o<s.length;o++){var u=Pr(s[o]),l=Di.getTech(u);if(u||(l=Br.getComponent(u)),l&&l.isSupported()){t.loadTech_(u);break}}return i}return h()(t,e),t}(Br);Br.registerComponent("MediaLoader",qi);var Hi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleMouseOver_=function(e){return r.handleMouseOver(e)},r.handleMouseOut_=function(e){return r.handleMouseOut(e)},r.handleClick_=function(e){return r.handleClick(e)},r.handleKeyDown_=function(e){return r.handleKeyDown(e)},r.emitTapEvents(),r.enable(),r}h()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){void 0===t&&(t="div"),void 0===n&&(n={}),void 0===r&&(r={}),n=Gt({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===t&&xt.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),r=Gt({role:"button"},r),this.tabIndex_=n.tabIndex;var i=e.prototype.createEl.call(this,t,n,r);return this.createControlTextEl(i),i},n.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},n.createControlTextEl=function(e){return this.controlTextEl_=_n("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},n.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,Tn(this.controlTextEl_,n),this.nonIconControl||this.player_.options_.noUITitleAttributes||t.setAttribute("title",n)},n.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},n.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!==typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))},n.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),"undefined"!==typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)},n.handleLanguagechange=function(){this.controlText(this.controlText_)},n.handleClick=function(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},n.handleKeyDown=function(t){v.a.isEventKey(t,"Space")||v.a.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Br);Br.registerComponent("ClickableComponent",Hi);var Vi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update(),r.update_=function(e){return r.update(e)},t.on("posterchange",r.update_),r}h()(t,e);var n=t.prototype;return n.dispose=function(){this.player().off("posterchange",this.update_),e.prototype.dispose.call(this)},n.createEl=function(){return _n("div",{className:"vjs-poster",tabIndex:-1})},n.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.handleClick=function(e){if(this.player_.controls()){var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;!this.player_.tech(!0)||(rn||en)&&t||this.player_.tech(!0).focus(),this.player_.paused()?Wr(this.player_.play()):this.player_.pause()}},t}(Hi);Br.registerComponent("PosterImage",Vi);var Ki={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Yi(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function Wi(e,t,n){try{e.style[t]=n}catch(r){return}}var zi=function(e){function t(t,n,r){var i;i=e.call(this,t,n,r)||this;var o=function(e){return i.updateDisplay(e)};return t.on("loadstart",function(e){return i.toggleDisplay(e)}),t.on("texttrackchange",o),t.on("loadedmetadata",function(e){return i.preselectTrack(e)}),t.ready(mr(c()(i),function(){if(t.tech_&&t.tech_.featuresNativeTextTracks)this.hide();else{t.on("fullscreenchange",o),t.on("playerresize",o),a.a.addEventListener("orientationchange",o),t.on("dispose",function(){return a.a.removeEventListener("orientationchange",o)});for(var e=this.options_.playerOptions.tracks||[],n=0;n<e.length;n++)this.player_.addRemoteTextTrack(e[n],!0);this.preselectTrack()}})),i}h()(t,e);var n=t.prototype;return n.preselectTrack=function(){for(var e,t,n,r={captions:1,subtitles:1},i=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<i.length;o++){var s=i[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in r?s.kind===a.kind?n=s:n||(n=s):a&&!a.enabled?(n=null,e=null,t=null):s.default&&("descriptions"!==s.kind||e?s.kind in r&&!t&&(t=s):e=s)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},n.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},n.clearDisplay=function(){"function"===typeof a.a.WebVTT&&a.a.WebVTT.processCues(a.a,[],this.el_)},n.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var n=[],r=0;r<e.length;++r){var i=e[r];"showing"===i.mode&&n.push(i)}this.updateForTrack(n)}else{for(var a=null,o=null,s=e.length;s--;){var u=e[s];"showing"===u.mode&&("descriptions"===u.kind?a=u:o=u)}o?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},n.updateDisplayState=function(e){for(var t=this.player_.textTrackSettings.getValues(),n=e.activeCues,r=n.length;r--;){var i=n[r];if(i){var o=i.displayState;if(t.color&&(o.firstChild.style.color=t.color),t.textOpacity&&Wi(o.firstChild,"color",Yi(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(o.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Wi(o.firstChild,"backgroundColor",Yi(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Wi(o,"backgroundColor",Yi(t.windowColor,t.windowOpacity)):o.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===t.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),t.fontPercent&&1!==t.fontPercent){var s=a.a.parseFloat(o.style.fontSize);o.style.fontSize=s*t.fontPercent+"px",o.style.height="auto",o.style.top="auto"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=Ki[t.fontFamily])}}},n.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),"function"===typeof a.a.WebVTT&&!e.every(function(e){return!e.activeCues})){for(var t=[],n=0;n<e.length;++n)for(var r=e[n],i=0;i<r.activeCues.length;++i)t.push(r.activeCues[i]);a.a.WebVTT.processCues(a.a,t,this.el_);for(var o=0;o<e.length;++o){for(var s=e[o],u=0;u<s.activeCues.length;++u){var l=s.activeCues[u].displayState;Sn(l,"vjs-text-track-cue"),Sn(l,"vjs-text-track-cue-"+(s.language?s.language:o))}this.player_.textTrackSettings&&this.updateDisplayState(s)}}},t}(Br);Br.registerComponent("TextTrackDisplay",zi);var Xi=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),r=_n("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),i=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return i.appendChild(r),i},t}(Br);Br.registerComponent("LoadingSpinner",Xi);var Qi=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t=Gt({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=Gt({type:"button"},n);var r=Br.prototype.createEl.call(this,"button",t,n);return this.createControlTextEl(r),r},n.addChild=function(e,t){void 0===t&&(t={});var n=this.constructor.name;return xt.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),Br.prototype.addChild.call(this,e,t)},n.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyDown=function(t){v.a.isEventKey(t,"Space")||v.a.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(Hi);Br.registerComponent("Button",Qi);var $i=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).mouseused_=!1,r.on("mousedown",function(e){return r.handleMouseDown(e)}),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-big-play-button"},n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var n=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;return Wr(t),void(!this.player_.tech(!0)||(rn||en)&&n||this.player_.tech(!0).focus())}var r=this.player_.getChild("controlBar"),i=r&&r.getChild("playToggle");if(i){var a=function(){return i.focus()};Yr(t)?t.then(a,function(){}):this.setTimeout(a,1)}else this.player_.tech(!0).focus()},n.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},n.handleMouseDown=function(e){this.mouseused_=!0},t}(Qi);$i.prototype.controlText_="Play Video",Br.registerComponent("BigPlayButton",$i);var Zi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).controlText(n&&n.controlText||r.localize("Close")),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},n.handleKeyDown=function(t){v.a.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Qi);Br.registerComponent("CloseButton",Zi);var Ji=function(e){function t(t,n){var r;return void 0===n&&(n={}),r=e.call(this,t,n)||this,n.replay=void 0===n.replay||n.replay,r.on(t,"play",function(e){return r.handlePlay(e)}),r.on(t,"pause",function(e){return r.handlePause(e)}),n.replay&&r.on(t,"ended",function(e){return r.handleEnded(e)}),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.paused()?Wr(this.player_.play()):this.player_.pause()},n.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.handleEnded=function(e){var t=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",function(e){return t.handleSeeked(e)})},t}(Qi);Ji.prototype.controlText_="Play",Br.registerComponent("PlayToggle",Ji);var ea=function(e,t){e=e<0?0:e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(i=r=n="-"),(i=i>0||o>0?i+":":"")+(r=((i||a>=10)&&r<10?"0"+r:r)+":")+(n=n<10?"0"+n:n)},ta=ea;function na(e,t){return void 0===t&&(t=e),ta(e,t)}var ra=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,["timeupdate","ended"],function(e){return r.updateContent(e)}),r.updateTextNode_(),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=this.buildCSSClass(),n=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"\xa0</span>"});return this.contentEl_=_n("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),n.appendChild(this.contentEl_),n},n.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},n.updateTextNode_=function(e){var t=this;void 0===e&&(e=0),e=na(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(t.contentEl_){var e=t.textNode_;e&&t.contentEl_.firstChild!==e&&(e=null,xt.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),t.textNode_=s.a.createTextNode(t.formattedTime_),t.textNode_&&(e?t.contentEl_.replaceChild(t.textNode_,e):t.contentEl_.appendChild(t.textNode_))}}))},n.updateContent=function(e){},t}(Br);ra.prototype.labelText_="Time",ra.prototype.controlText_="Time",Br.registerComponent("TimeDisplay",ra);var ia=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-current-time"},n.updateContent=function(e){var t;t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)},t}(ra);ia.prototype.labelText_="Current Time",ia.prototype.controlText_="Current Time",Br.registerComponent("CurrentTimeDisplay",ia);var aa=function(e){function t(t,n){var r,i=function(e){return r.updateContent(e)};return(r=e.call(this,t,n)||this).on(t,"durationchange",i),r.on(t,"loadstart",i),r.on(t,"loadedmetadata",i),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-duration"},n.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)},t}(ra);aa.prototype.labelText_="Duration",aa.prototype.controlText_="Duration",Br.registerComponent("DurationDisplay",aa);var oa=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(Br);Br.registerComponent("TimeDivider",oa);var sa=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"durationchange",function(e){return r.updateContent(e)}),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-remaining-time"},n.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(_n("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},n.updateContent=function(e){var t;"number"===typeof this.player_.duration()&&(t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t))},t}(ra);sa.prototype.labelText_="Remaining Time",sa.prototype.controlText_="Remaining Time",Br.registerComponent("RemainingTimeDisplay",sa);var ua=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).updateShowing(),r.on(r.player(),"durationchange",function(e){return r.updateShowing(e)}),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=_n("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"\xa0</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(Br);Br.registerComponent("LiveDisplay",ua);var la=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).updateLiveEdgeStatus(),r.player_.liveTracker&&(r.updateLiveEdgeStatusHandler_=function(e){return r.updateLiveEdgeStatus(e)},r.on(r.player_.liveTracker,"liveedgechange",r.updateLiveEdgeStatusHandler_)),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=_n("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},n.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},n.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},n.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,e.prototype.dispose.call(this)},t}(Qi);la.prototype.controlText_="Seek to live, currently playing live",Br.registerComponent("SeekToLive",la);var da=function(e,t,n){return e=Number(e),Math.min(n,Math.max(t,isNaN(e)?t:e))},ca=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleMouseDown_=function(e){return r.handleMouseDown(e)},r.handleMouseUp_=function(e){return r.handleMouseUp(e)},r.handleKeyDown_=function(e){return r.handleKeyDown(e)},r.handleClick_=function(e){return r.handleClick(e)},r.handleMouseMove_=function(e){return r.handleMouseMove(e)},r.update_=function(e){return r.update(e)},r.bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}h()(t,e);var n=t.prototype;return n.enabled=function(){return this.enabled_},n.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.createEl=function(t,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),n.className=n.className+" vjs-slider",n=Gt({tabIndex:0},n),r=Gt({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),e.prototype.createEl.call(this,t,n,r)},n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||tn||e.preventDefault(),On(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e)},n.handleMouseMove=function(e){},n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;Nn(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.update()},n.update=function(){var e=this;if(this.el_&&this.bar){var t=this.getProgress();return t===this.progress_?t:(this.progress_=t,this.requestNamedAnimationFrame("Slider#update",function(){var n=e.vertical()?"height":"width";e.bar.el().style[n]=(100*t).toFixed(2)+"%"}),t)}},n.getProgress=function(){return Number(da(this.getPercent(),0,1).toFixed(4))},n.calculateDistance=function(e){var t=kn(this.el_,e);return this.vertical()?t.y:t.x},n.handleKeyDown=function(t){v.a.isEventKey(t,"Left")||v.a.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):v.a.isEventKey(t,"Right")||v.a.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){e.stopPropagation(),e.preventDefault()},n.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},t}(Br);Br.registerComponent("Slider",ca);var fa=function(e,t){return da(e/t*100,0,100).toFixed(2)+"%"},ha=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).partEls_=[],r.on(t,"progress",function(e){return r.update(e)}),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),n=_n("span",{className:"vjs-control-text"}),r=_n("span",{textContent:this.localize("Loaded")}),i=s.a.createTextNode(": ");return this.percentageEl_=_n("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),t.appendChild(n),n.appendChild(r),n.appendChild(i),n.appendChild(this.percentageEl_),t},n.dispose=function(){this.partEls_=null,this.percentageEl_=null,e.prototype.dispose.call(this)},n.update=function(e){var t=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var e=t.player_.liveTracker,n=t.player_.buffered(),r=e&&e.isLive()?e.seekableEnd():t.player_.duration(),i=t.player_.bufferedEnd(),a=t.partEls_,o=fa(i,r);t.percent_!==o&&(t.el_.style.width=o,Tn(t.percentageEl_,o),t.percent_=o);for(var s=0;s<n.length;s++){var u=n.start(s),l=n.end(s),d=a[s];d||(d=t.el_.appendChild(_n()),a[s]=d),d.dataset.start===u&&d.dataset.end===l||(d.dataset.start=u,d.dataset.end=l,d.style.left=fa(u,i),d.style.width=fa(l-u,i))}for(var c=a.length;c>n.length;c--)t.el_.removeChild(a[c-1]);a.length=n.length})},t}(Br);Br.registerComponent("LoadProgressBar",ha);var pa=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=vr(mr(c()(r),r.update),gr),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},n.update=function(e,t,n){var r=Ln(this.el_),i=Pn(this.player_.el()),a=e.width*t;if(i&&r){var o=e.left-i.left+a,s=e.width-a+(i.right-e.right),u=r.width/2;o<u?u+=u-o:s<u&&(u=s),u<0?u=0:u>r.width&&(u=r.width),u=Math.round(u),this.el_.style.right="-"+u+"px",this.write(n)}},n.write=function(e){Tn(this.el_,e)},n.updateTime=function(e,t,n,r){var i=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var a,o=i.player_.duration();if(i.player_.liveTracker&&i.player_.liveTracker.isLive()){var s=i.player_.liveTracker.liveWindow(),u=s-t*s;a=(u<1?"":"-")+na(u,s)}else a=na(n,o);i.update(e,t,a),r&&r()})},t}(Br);Br.registerComponent("TimeTooltip",pa);var ga=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=vr(mr(c()(r),r.update),gr),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},n.update=function(e,t){var n=this.getChild("timeTooltip");if(n){var r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,r)}},t}(Br);ga.prototype.options_={children:[]},dn||Qt||ga.prototype.options_.children.push("timeTooltip"),Br.registerComponent("PlayProgressBar",ga);var ma=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=vr(mr(c()(r),r.update),gr),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t){var n=this,r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,r,function(){n.el_.style.left=e.width*t+"px"})},t}(Br);ma.prototype.options_={children:["timeTooltip"]},Br.registerComponent("MouseTimeDisplay",ma);var va=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).setEventHandlers_(),r}h()(t,e);var n=t.prototype;return n.setEventHandlers_=function(){var e=this;this.update_=mr(this,this.update),this.update=vr(this.update_,gr),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(t){return e.enableInterval_(t)},this.disableIntervalHandler_=function(t){return e.disableInterval_(t)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in s.a&&"visibilityState"in s.a&&this.on(s.a,"visibilitychange",this.toggleVisibility_)},n.toggleVisibility_=function(e){"hidden"===s.a.visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())},n.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,gr))},n.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},n.update=function(t){var n=this;if("hidden"!==s.a.visibilityState){var r=e.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var e=n.player_.ended()?n.player_.duration():n.getCurrentTime_(),t=n.player_.liveTracker,i=n.player_.duration();t&&t.isLive()&&(i=n.player_.liveTracker.liveCurrentTime()),n.percent_!==r&&(n.el_.setAttribute("aria-valuenow",(100*r).toFixed(2)),n.percent_=r),n.currentTime_===e&&n.duration_===i||(n.el_.setAttribute("aria-valuetext",n.localize("progress bar timing: currentTime={1} duration={2}",[na(e,i),na(i,i)],"{1} of {2}")),n.currentTime_=e,n.duration_=i),n.bar&&n.bar.update(Pn(n.el()),n.getProgress())}),r}},n.userSeek_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)},n.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},n.getPercent=function(){var e,t=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(t-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e},n.handleMouseDown=function(t){Gn(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},n.handleMouseMove=function(e){if(Gn(e)){var t,n=this.calculateDistance(e),r=this.player_.liveTracker;if(r&&r.isLive()){if(n>=.99)return void r.seekToLiveEdge();var i=r.seekableStart(),a=r.liveCurrentTime();if((t=i+n*r.liveWindow())>=a&&(t=a),t<=i&&(t=i+.1),t===1/0)return}else(t=n*this.player_.duration())===this.player_.duration()&&(t-=.1);this.userSeek_(t)}},n.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},n.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},n.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Wr(this.player_.play()):this.update_()},n.stepForward=function(){this.userSeek_(this.player_.currentTime()+5)},n.stepBack=function(){this.userSeek_(this.player_.currentTime()-5)},n.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleKeyDown=function(t){var n=this.player_.liveTracker;if(v.a.isEventKey(t,"Space")||v.a.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(v.a.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.userSeek_(0);else if(v.a.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),n&&n.isLive()?this.userSeek_(n.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(v()(t))){t.preventDefault(),t.stopPropagation();var r=10*(v.a.codes[v()(t)]-v.a.codes[0])/100;n&&n.isLive()?this.userSeek_(n.seekableStart()+n.liveWindow()*r):this.userSeek_(this.player_.duration()*r)}else v.a.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):v.a.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,t)},n.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in s.a&&"visibilityState"in s.a&&this.off(s.a,"visibilitychange",this.toggleVisibility_),e.prototype.dispose.call(this)},t}(ca);va.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},dn||Qt||va.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Br.registerComponent("SeekBar",va);var ya=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleMouseMove=vr(mr(c()(r),r.handleMouseMove),gr),r.throttledHandleMouseSeek=vr(mr(c()(r),r.handleMouseSeek),gr),r.handleMouseUpHandler_=function(e){return r.handleMouseUp(e)},r.handleMouseDownHandler_=function(e){return r.handleMouseDown(e)},r.enable(),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("playProgressBar"),r=t.getChild("mouseTimeDisplay");if(n||r){var i=t.el(),a=Ln(i),o=kn(i,e).x;o=da(o,0,1),r&&r.update(a,o),n&&n.update(a,t.getProgress())}}},n.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.enabled=function(){return this.enabled_},n.disable=function(){if(this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&Wr(this.player_.play())}},n.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.removeListenersAddedOnMousedownAndTouchstart=function(){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)},n.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)},n.handleMouseUp=function(e){var t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()},t}(Br);ya.prototype.options_={children:["seekBar"]},Br.registerComponent("ProgressControl",ya);var _a=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,["enterpictureinpicture","leavepictureinpicture"],function(e){return r.handlePictureInPictureChange(e)}),r.on(t,["disablepictureinpicturechanged","loadedmetadata"],function(e){return r.handlePictureInPictureEnabledChange(e)}),r.disable(),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},n.handlePictureInPictureEnabledChange=function(){s.a.pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()?this.enable():this.disable()},n.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},n.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},t}(Qi);_a.prototype.controlText_="Picture-in-Picture",Br.registerComponent("PictureInPictureToggle",_a);var Ta=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"fullscreenchange",function(e){return r.handleFullscreenChange(e)}),!1===s.a[t.fsApi_.fullscreenEnabled]&&r.disable(),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},n.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},n.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},t}(Qi);Ta.prototype.controlText_="Fullscreen",Br.registerComponent("FullscreenToggle",Ta);var Ea=function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},ba=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(Br);Br.registerComponent("VolumeLevel",ba);var Sa=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=vr(mr(c()(r),r.update),gr),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})},n.update=function(e,t,n,r){if(!n){var i=Pn(this.el_),a=Pn(this.player_.el()),o=e.width*t;if(!a||!i)return;var s=e.left-a.left+o,u=e.width-o+(a.right-e.right),l=i.width/2;s<l?l+=l-s:u<l&&(l=u),l<0?l=0:l>i.width&&(l=i.width),this.el_.style.right="-"+l+"px"}this.write(r+"%")},n.write=function(e){Tn(this.el_,e)},n.updateVolume=function(e,t,n,r,i){var a=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",function(){a.update(e,t,n,r.toFixed(0)),i&&i()})},t}(Br);Br.registerComponent("VolumeLevelTooltip",Sa);var Aa=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=vr(mr(c()(r),r.update),gr),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t,n){var r=this,i=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,n,i,function(){n?r.el_.style.bottom=e.height*t+"px":r.el_.style.left=e.width*t+"px"})},t}(Br);Aa.prototype.options_={children:["volumeLevelTooltip"]},Br.registerComponent("MouseVolumeLevelDisplay",Aa);var wa=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on("slideractive",function(e){return r.updateLastVolume_(e)}),r.on(t,"volumechange",function(e){return r.updateARIAAttributes(e)}),t.ready(function(){return r.updateARIAAttributes()}),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.handleMouseDown=function(t){Gn(t)&&e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){var t=this.getChild("mouseVolumeLevelDisplay");if(t){var n=this.el(),r=Pn(n),i=this.vertical(),a=kn(n,e);a=i?a.y:a.x,a=da(a,0,1),t.update(r,a,i)}Gn(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},t}(ca);wa.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},dn||Qt||wa.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),wa.prototype.playerEvent="volumechange",Br.registerComponent("VolumeBar",wa);var Ia=function(e){function t(t,n){var r;return void 0===n&&(n={}),n.vertical=n.vertical||!1,("undefined"===typeof n.volumeBar||Ht(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),r=e.call(this,t,n)||this,Ea(c()(r),t),r.throttledHandleMouseMove=vr(mr(c()(r),r.handleMouseMove),gr),r.handleMouseUpHandler_=function(e){return r.handleMouseUp(e)},r.on("mousedown",function(e){return r.handleMouseDown(e)}),r.on("touchstart",function(e){return r.handleMouseDown(e)}),r.on("mousemove",function(e){return r.handleMouseMove(e)}),r.on(r.volumeBar,["focus","slideractive"],function(){r.volumeBar.addClass("vjs-slider-active"),r.addClass("vjs-slider-active"),r.trigger("slideractive")}),r.on(r.volumeBar,["blur","sliderinactive"],function(){r.volumeBar.removeClass("vjs-slider-active"),r.removeClass("vjs-slider-active"),r.trigger("sliderinactive")}),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},n.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)},n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(Br);Ia.prototype.options_={children:["volumeBar"]},Br.registerComponent("VolumeControl",Ia);var Ca=function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},Ra=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,Ca(c()(r),t),r.on(t,["loadstart","volumechange"],function(e){return r.update(e)}),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){var t=this.player_.volume(),n=this.player_.lastVolume_();if(0===t){var r=n<.1?.1:n;this.player_.volume(r),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},n.update=function(e){this.updateIcon_(),this.updateControlText_()},n.updateIcon_=function(){var e=this.player_.volume(),t=3;dn&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)An(this.el_,"vjs-vol-"+n);Sn(this.el_,"vjs-vol-"+t)},n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(Qi);Ra.prototype.controlText_="Mute",Br.registerComponent("MuteToggle",Ra);var Da=function(e){function t(t,n){var r;return void 0===n&&(n={}),"undefined"!==typeof n.inline?n.inline=n.inline:n.inline=!0,("undefined"===typeof n.volumeControl||Ht(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(r=e.call(this,t,n)||this).handleKeyPressHandler_=function(e){return r.handleKeyPress(e)},r.on(t,["loadstart"],function(e){return r.volumePanelState_(e)}),r.on(r.muteToggle,"keyup",function(e){return r.handleKeyPress(e)}),r.on(r.volumeControl,"keyup",function(e){return r.handleVolumeControlKeyUp(e)}),r.on("keydown",function(e){return r.handleKeyPress(e)}),r.on("mouseover",function(e){return r.handleMouseOver(e)}),r.on("mouseout",function(e){return r.handleMouseOut(e)}),r.on(r.volumeControl,["slideractive"],r.sliderActive_),r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_),r}h()(t,e);var n=t.prototype;return n.sliderActive_=function(){this.addClass("vjs-slider-active")},n.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},n.dispose=function(){this.handleMouseOut(),e.prototype.dispose.call(this)},n.handleVolumeControlKeyUp=function(e){v.a.isEventKey(e,"Esc")&&this.muteToggle.focus()},n.handleMouseOver=function(e){this.addClass("vjs-hover"),ur(s.a,"keyup",this.handleKeyPressHandler_)},n.handleMouseOut=function(e){this.removeClass("vjs-hover"),lr(s.a,"keyup",this.handleKeyPressHandler_)},n.handleKeyPress=function(e){v.a.isEventKey(e,"Esc")&&this.handleMouseOut()},t}(Br);Da.prototype.options_={children:["muteToggle","volumeControl"]},Br.registerComponent("VolumePanel",Da);var Ma=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,n&&(r.menuButton_=n.menuButton),r.focusedChild_=-1,r.on("keydown",function(e){return r.handleKeyDown(e)}),r.boundHandleBlur_=function(e){return r.handleBlur(e)},r.boundHandleTapClick_=function(e){return r.handleTapClick(e)},r}h()(t,e);var n=t.prototype;return n.addEventListenerForItem=function(e){e instanceof Br&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},n.removeEventListenerForItem=function(e){e instanceof Br&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},n.removeChild=function(t){"string"===typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},n.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},n.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=_n(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),ur(n,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),n},n.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},n.handleBlur=function(e){var t=e.relatedTarget||s.a.activeElement;if(!this.children().some(function(e){return e.el()===t})){var n=this.menuButton_;n&&n.buttonPressed_&&t!==n.el().firstChild&&n.unpressButton()}},n.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var n=t.filter(function(t){return t.el()===e.target})[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},n.handleKeyDown=function(e){v.a.isEventKey(e,"Left")||v.a.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(v.a.isEventKey(e,"Right")||v.a.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},n.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},n.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},n.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},t}(Br);Br.registerComponent("Menu",Ma);var Oa=function(e){function t(t,n){var r;void 0===n&&(n={}),(r=e.call(this,t,n)||this).menuButton_=new Qi(t,n),r.menuButton_.controlText(r.controlText_),r.menuButton_.el_.setAttribute("aria-haspopup","true");var i=Qi.prototype.buildCSSClass();r.menuButton_.el_.className=r.buildCSSClass()+" "+i,r.menuButton_.removeClass("vjs-control"),r.addChild(r.menuButton_),r.update(),r.enabled_=!0;var a=function(e){return r.handleClick(e)};return r.handleMenuKeyUp_=function(e){return r.handleMenuKeyUp(e)},r.on(r.menuButton_,"tap",a),r.on(r.menuButton_,"click",a),r.on(r.menuButton_,"keydown",function(e){return r.handleKeyDown(e)}),r.on(r.menuButton_,"mouseenter",function(){r.addClass("vjs-hover"),r.menu.show(),ur(s.a,"keyup",r.handleMenuKeyUp_)}),r.on("mouseleave",function(e){return r.handleMouseLeave(e)}),r.on("keydown",function(e){return r.handleSubmenuKeyDown(e)}),r}h()(t,e);var n=t.prototype;return n.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},n.createMenu=function(){var e=new Ma(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=_n("li",{className:"vjs-menu-title",innerHTML:Pr(this.options_.title),tabIndex:-1}),n=new Br(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var r=0;r<this.items.length;r++)e.addItem(this.items[r]);return e},n.createItems=function(){},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},n.buildWrapperCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+Qi.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},n.buildCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)},n.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},n.dispose=function(){this.handleMouseLeave(),e.prototype.dispose.call(this)},n.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},n.handleMouseLeave=function(e){this.removeClass("vjs-hover"),lr(s.a,"keyup",this.handleMenuKeyUp_)},n.focus=function(){this.menuButton_.focus()},n.blur=function(){this.menuButton_.blur()},n.handleKeyDown=function(e){v.a.isEventKey(e,"Esc")||v.a.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),v.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(v.a.isEventKey(e,"Up")||v.a.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},n.handleMenuKeyUp=function(e){(v.a.isEventKey(e,"Esc")||v.a.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},n.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},n.handleSubmenuKeyDown=function(e){(v.a.isEventKey(e,"Esc")||v.a.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),v.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},n.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),dn&&vn())return;this.menu.focus()}},n.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},n.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},n.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(Br);Br.registerComponent("MenuButton",Oa);var Na=function(e){function t(t,n){var r,i=n.tracks;if((r=e.call(this,t,n)||this).items.length<=1&&r.hide(),!i)return c()(r);var a=mr(c()(r),r.update);return i.addEventListener("removetrack",a),i.addEventListener("addtrack",a),i.addEventListener("labelchange",a),r.player_.on("ready",a),r.player_.on("dispose",function(){i.removeEventListener("removetrack",a),i.removeEventListener("addtrack",a),i.removeEventListener("labelchange",a)}),r}return h()(t,e),t}(Oa);Br.registerComponent("TrackButton",Na);var Pa=["Tab","Esc","Up","Down","Right","Left"],La=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).selectable=n.selectable,r.isSelected_=n.selected||!1,r.multiSelectable=n.multiSelectable,r.selected(r.isSelected_),r.selectable?r.multiSelectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitemradio"):r.el_.setAttribute("role","menuitem"),r}h()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",Gt({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),r)},n.handleKeyDown=function(t){Pa.some(function(e){return v.a.isEventKey(t,e)})||e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){this.selected(!0)},n.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(Hi);Br.registerComponent("MenuItem",La);var ka=function(e){function t(t,n){var r,i=n.track,o=t.textTracks();n.label=i.label||i.language||"Unknown",n.selected="showing"===i.mode,(r=e.call(this,t,n)||this).track=i,r.kinds=(n.kinds||[n.kind||r.track.kind]).filter(Boolean);var u,l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(c()(r),t)},d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleSelectedLanguageChange.apply(c()(r),t)};(t.on(["loadstart","texttrackchange"],l),o.addEventListener("change",l),o.addEventListener("selectedlanguagechange",d),r.on("dispose",function(){t.off(["loadstart","texttrackchange"],l),o.removeEventListener("change",l),o.removeEventListener("selectedlanguagechange",d)}),void 0===o.onchange)&&r.on(["tap","click"],function(){if("object"!==typeof a.a.Event)try{u=new a.a.Event("change")}catch(e){}u||(u=s.a.createEvent("Event")).initEvent("change",!0,!0),o.dispatchEvent(u)});return r.handleTracksChange(),r}h()(t,e);var n=t.prototype;return n.handleClick=function(t){var n=this.track,r=this.player_.textTracks();if(e.prototype.handleClick.call(this,t),r)for(var i=0;i<r.length;i++){var a=r[i];-1!==this.kinds.indexOf(a.kind)&&(a===n?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},n.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},n.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},n.dispose=function(){this.track=null,e.prototype.dispose.call(this)},t}(La);Br.registerComponent("TextTrackMenuItem",ka);var xa=function(e){function t(t,n){return n.track={player:t,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}h()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var a=t[r];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},n.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var a=t[r];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(ka);Br.registerComponent("OffTextTrackMenuItem",xa);var Fa=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.textTracks(),e.call(this,t,n)||this}return h()(t,e),t.prototype.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=ka),this.label_&&(n=this.label_+" off"),e.push(new xa(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var i=0;i<r.length;i++){var a=r[i];if(this.kinds_.indexOf(a.kind)>-1){var o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},t}(Na);Br.registerComponent("TextTrackButton",Fa);var Ua=function(e){function t(t,n){var r,i=n.track,a=n.cue,o=t.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=a.text,n.selected=a.startTime<=o&&o<a.endTime,(r=e.call(this,t,n)||this).track=i,r.cue=a,i.addEventListener("cuechange",mr(c()(r),r.update)),r}h()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},n.update=function(e){var t=this.cue,n=this.player_.currentTime();this.selected(t.startTime<=n&&n<t.endTime)},t}(La);Br.registerComponent("ChaptersTrackMenuItem",Ua);var Ba=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},n.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},n.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var n=e[t];if(n.kind===this.kind_)return n}},n.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Pr(this.kind_))},n.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},n.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,r=t.length;n<r;n++){var i=t[n],a=new Ua(this.player_,{track:this.track_,cue:i});e.push(a)}return e},t}(Fa);Ba.prototype.kind_="chapters",Ba.prototype.controlText_="Chapters",Br.registerComponent("ChaptersButton",Ba);var ja=function(e){function t(t,n,r){var i;i=e.call(this,t,n,r)||this;var a=t.textTracks(),o=mr(c()(i),i.handleTracksChange);return a.addEventListener("change",o),i.on("dispose",function(){a.removeEventListener("change",o)}),i}h()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!1,r=0,i=t.length;r<i;r++){var a=t[r];if(a.kind!==this.kind_&&"showing"===a.mode){n=!0;break}}n?this.disable():this.enable()},n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Fa);ja.prototype.kind_="descriptions",ja.prototype.controlText_="Descriptions",Br.registerComponent("DescriptionsButton",ja);var Ga=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Fa);Ga.prototype.kind_="subtitles",Ga.prototype.controlText_="Subtitles",Br.registerComponent("SubtitlesButton",Ga);var qa=function(e){function t(t,n){var r;return n.track={player:t,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",(r=e.call(this,t,n)||this).addClass("vjs-texttrack-settings"),r.controlText(", opens "+n.kind+" settings dialog"),r}return h()(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(ka);Br.registerComponent("CaptionSettingsMenuItem",qa);var Ha=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new qa(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(Fa);Ha.prototype.kind_="captions",Ha.prototype.controlText_="Captions",Br.registerComponent("CaptionsButton",Ha);var Va=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),i+="</span>",e.prototype.createEl.call(this,t,Gt({innerHTML:i},n),r)},t}(ka);Br.registerComponent("SubsCapsMenuItem",Va);var Ka=function(e){function t(t,n){var r;return void 0===n&&(n={}),(r=e.call(this,t,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1&&(r.label_="captions"),r.menuButton_.controlText(Pr(r.label_)),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new qa(this.player_,{kind:this.label_})),this.hideThreshold_+=1),t=e.prototype.createItems.call(this,t,Va)},t}(Fa);Ka.prototype.kinds_=["captions","subtitles"],Ka.prototype.controlText_="Subtitles",Br.registerComponent("SubsCapsButton",Ka);var Ya=function(e){function t(t,n){var r,i=n.track,a=t.audioTracks();n.label=i.label||i.language||"Unknown",n.selected=i.enabled,(r=e.call(this,t,n)||this).track=i,r.addClass("vjs-"+i.kind+"-menu-item");var o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(c()(r),t)};return a.addEventListener("change",o),r.on("dispose",function(){a.removeEventListener("change",o)}),r}h()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),i+="</span>",e.prototype.createEl.call(this,t,Gt({innerHTML:i},n),r)},n.handleClick=function(t){e.prototype.handleClick.call(this,t),this.track.enabled=!0},n.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(La);Br.registerComponent("AudioTrackMenuItem",Ya);var Wa=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.audioTracks(),e.call(this,t,n)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++){var r=t[n];e.push(new Ya(this.player_,{track:r,selectable:!0,multiSelectable:!1}))}return e},t}(Na);Wa.prototype.controlText_="Audio Track",Br.registerComponent("AudioTrackButton",Wa);var za=function(e){function t(t,n){var r,i=n.rate,a=parseFloat(i,10);return n.label=i,n.selected=a===t.playbackRate(),n.selectable=!0,n.multiSelectable=!1,(r=e.call(this,t,n)||this).label=i,r.rate=a,r.on(t,"ratechange",function(e){return r.update(e)}),r}h()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},n.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(La);za.prototype.contentElType="button",Br.registerComponent("PlaybackRateMenuItem",za);var Xa=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).menuButton_.el_.setAttribute("aria-describedby",r.labelElId_),r.updateVisibility(),r.updateLabel(),r.on(t,"loadstart",function(e){return r.updateVisibility(e)}),r.on(t,"ratechange",function(e){return r.updateLabel(e)}),r.on(t,"playbackrateschange",function(e){return r.handlePlaybackRateschange(e)}),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=_n("div",{className:"vjs-playback-rate-value",id:this.labelElId_,innerHTML:"1x"}),t.appendChild(this.labelEl_),t},n.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){for(var e=this.playbackRates(),t=[],n=e.length-1;n>=0;n--)t.push(new za(this.player(),{rate:e[n]+"x"}));return t},n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.handleClick=function(e){for(var t=this.player().playbackRate(),n=this.playbackRates(),r=n[0],i=0;i<n.length;i++)if(n[i]>t){r=n[i];break}this.player().playbackRate(r)},n.handlePlaybackRateschange=function(e){this.update()},n.playbackRates=function(){var e=this.player();return e.playbackRates&&e.playbackRates()||[]},n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},n.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(Oa);Xa.prototype.controlText_="Playback Rate",Br.registerComponent("PlaybackRateMenuButton",Xa);var Qa=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(Br);Br.registerComponent("Spacer",Qa);var $a=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="\xa0",t},t}(Qa);Br.registerComponent("CustomControlSpacer",$a);var Za=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(Br);Za.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in s.a&&Za.prototype.options_.children.splice(Za.prototype.options_.children.length-1,0,"pictureInPictureToggle"),Br.registerComponent("ControlBar",Za);var Ja=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"error",function(e){return r.open(e)}),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},n.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(Zr);Ja.prototype.options_=l()({},Zr.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Br.registerComponent("ErrorDisplay",Ja);var eo=["#000","Black"],to=["#00F","Blue"],no=["#0FF","Cyan"],ro=["#0F0","Green"],io=["#F0F","Magenta"],ao=["#F00","Red"],oo=["#FFF","White"],so=["#FF0","Yellow"],uo=["1","Opaque"],lo=["0.5","Semi-Transparent"],co=["0","Transparent"],fo={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[eo,oo,ao,ro,to,so,io,no]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[uo,lo,co]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[oo,eo,ao,ro,to,so,io,no]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[uo,lo]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[co,lo,uo]}};function ho(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}fo.windowColor.options=fo.backgroundColor.options;var po=function(e){function t(t,n){var r;return n.temporary=!1,(r=e.call(this,t,n)||this).updateDisplay=r.updateDisplay.bind(c()(r)),r.fill(),r.hasBeenOpened_=r.hasBeenFilled_=!0,r.endDialog=_n("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")}),r.el().appendChild(r.endDialog),r.setDefaults(),void 0===n.persistTextTrackSettings&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings),r.on(r.$(".vjs-done-button"),"click",function(){r.saveSettings(),r.close()}),r.on(r.$(".vjs-default-button"),"click",function(){r.setDefaults(),r.updateDisplay()}),jt(fo,function(e){r.on(r.$(e.selector),"change",r.updateDisplay)}),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}h()(t,e);var n=t.prototype;return n.dispose=function(){this.endDialog=null,e.prototype.dispose.call(this)},n.createElSelect_=function(e,t,n){var r=this;void 0===t&&(t=""),void 0===n&&(n="label");var i=fo[e],a=i.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+n+' id="'+a+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(i.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(i.options.map(function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',r.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},n.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},n.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},n.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},n.createElColors_=function(){return _n("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},n.createElFont_=function(){return _n("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},n.createElControls_=function(){var e=this.localize("restore all settings to the default values");return _n("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},n.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},n.label=function(){return this.localize("Caption Settings Dialog")},n.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},n.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},n.getValues=function(){var e,t,n,r=this;return t=function(e,t,n){var i,a,o=(i=r.$(t.selector),a=t.parser,ho(i.options[i.options.selectedIndex].value,a));return void 0!==o&&(e[n]=o),e},void 0===(n={})&&(n=0),Bt(e=fo).reduce(function(n,r){return t(n,e[r],r)},n)},n.setValues=function(e){var t=this;jt(fo,function(n,r){!function(e,t,n){if(t)for(var r=0;r<e.options.length;r++)if(ho(e.options[r].value,n)===t){e.selectedIndex=r;break}}(t.$(n.selector),e[r],n.parser)})},n.setDefaults=function(){var e=this;jt(fo,function(t){var n=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=n})},n.restoreSettings=function(){var e;try{e=JSON.parse(a.a.localStorage.getItem("vjs-text-track-settings"))}catch(t){xt.warn(t)}e&&this.setValues(e)},n.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?a.a.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e)):a.a.localStorage.removeItem("vjs-text-track-settings")}catch(t){xt.warn(t)}}},n.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},n.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,n=e&&e.captionsButton;t?t.focus():n&&n.focus()},t}(Zr);Br.registerComponent("TextTrackSettings",po);var go=function(e){function t(t,n){var r,i=n.ResizeObserver||a.a.ResizeObserver;null===n.ResizeObserver&&(i=!1);var o=Lr({createEl:!i,reportTouchActivity:!1},n);return(r=e.call(this,t,o)||this).ResizeObserver=n.ResizeObserver||a.a.ResizeObserver,r.loadListener_=null,r.resizeObserver_=null,r.debouncedHandler_=yr(function(){r.resizeHandler()},100,!1,c()(r)),i?(r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_),r.resizeObserver_.observe(t.el())):(r.loadListener_=function(){if(r.el_&&r.el_.contentWindow){var e=r.debouncedHandler_,t=r.unloadListener_=function(){lr(this,"resize",e),lr(this,"unload",t),t=null};ur(r.el_.contentWindow,"unload",t),ur(r.el_.contentWindow,"resize",e)}},r.one("load",r.loadListener_)),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},n.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},n.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,e.prototype.dispose.call(this)},t}(Br);Br.registerComponent("ResizeManager",go);var mo={trackingThreshold:30,liveTolerance:15},vo=function(e){function t(t,n){var r,i=Lr(mo,n,{createEl:!1});return(r=e.call(this,t,i)||this).handleVisibilityChange_=function(e){return r.handleVisibilityChange(e)},r.trackLiveHandler_=function(){return r.trackLive_()},r.handlePlay_=function(e){return r.handlePlay(e)},r.handleFirstTimeupdate_=function(e){return r.handleFirstTimeupdate(e)},r.handleSeeked_=function(e){return r.handleSeeked(e)},r.seekToLiveEdge_=function(e){return r.seekToLiveEdge(e)},r.reset_(),r.on(r.player_,"durationchange",function(e){return r.handleDurationchange(e)}),r.one(r.player_,"canplay",function(){return r.toggleTracking()}),rn&&"hidden"in s.a&&"visibilityState"in s.a&&r.on(s.a,"visibilitychange",r.handleVisibilityChange_),r}h()(t,e);var n=t.prototype;return n.handleVisibilityChange=function(){this.player_.duration()===1/0&&(s.a.hidden?this.stopTracking():this.startTracking())},n.trackLive_=function(){var e=this.player_.seekable();if(e&&e.length){var t=Number(a.a.performance.now().toFixed(4)),n=-1===this.lastTime_?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+n;var r=this.liveCurrentTime(),i=this.player_.currentTime(),o=this.player_.paused()||this.seekedBehindLive_||Math.abs(r-i)>this.options_.liveTolerance;this.timeupdateSeen_&&r!==1/0||(o=!1),o!==this.behindLiveEdge_&&(this.behindLiveEdge_=o,this.trigger("liveedgechange"))}},n.handleDurationchange=function(){this.toggleTracking()},n.toggleTracking=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},n.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,gr),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))},n.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)},n.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()},n.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)},n.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)},n.nextSeekedFromUser=function(){this.nextSeekedFromUser_=!0},n.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},n.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0},n.seekableStart=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.start(n));return t.length?t.sort()[0]:0},n.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()},n.isLive=function(){return this.isTracking()},n.atLiveEdge=function(){return!this.behindLiveEdge()},n.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},n.pastSeekEnd=function(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},n.behindLiveEdge=function(){return this.behindLiveEdge_},n.isTracking=function(){return"number"===typeof this.trackingInterval_},n.seekToLiveEdge=function(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))},n.dispose=function(){this.off(s.a,"visibilitychange",this.handleVisibilityChange_),this.stopTracking(),e.prototype.dispose.call(this)},t}(Br);Br.registerComponent("LiveTracker",vo);var yo,_o=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),r=[],i="";if(!n.length)return!1;for(var a=0;a<n.length;a++){var o=n[a].src;o&&-1===r.indexOf(o)&&r.push(o)}return!!r.length&&(1===r.length&&(i=r[0]),e.triggerSourceset(i),!0)},To=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=s.a.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var n=s.a.createDocumentFragment();t.childNodes.length;)n.appendChild(t.childNodes[0]);return this.innerText="",a.a.Element.prototype.appendChild.call(this,n),this.innerHTML}}),Eo=function(e,t){for(var n={},r=0;r<e.length&&!((n=Object.getOwnPropertyDescriptor(e[r],t))&&n.set&&n.get);r++);return n.enumerable=!0,n.configurable=!0,n},bo=function(e){var t=e.el();if(!t.resetSourceWatch_){var n={},r=function(e){return Eo([e.el(),a.a.HTMLMediaElement.prototype,a.a.Element.prototype,To],"innerHTML")}(e),i=function(n){return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=n.apply(t,i);return _o(e),o}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){t[e]&&(n[e]=t[e],t[e]=i(n[e]))}),Object.defineProperty(t,"innerHTML",Lr(r,{set:i(r.set)})),t.resetSourceWatch_=function(){t.resetSourceWatch_=null,Object.keys(n).forEach(function(e){t[e]=n[e]}),Object.defineProperty(t,"innerHTML",r)},e.one("sourceset",t.resetSourceWatch_)}},So=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?pi(a.a.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return a.a.Element.prototype.setAttribute.call(this,"src",e),e}}),Ao=function(e){if(e.featuresSourceset){var t=e.el();if(!t.resetSourceset_){var n=function(e){return Eo([e.el(),a.a.HTMLMediaElement.prototype,So],"src")}(e),r=t.setAttribute,i=t.load;Object.defineProperty(t,"src",Lr(n,{set:function(r){var i=n.set.call(t,r);return e.triggerSourceset(t.src),i}})),t.setAttribute=function(n,i){var a=r.call(t,n,i);return/src/i.test(n)&&e.triggerSourceset(t.src),a},t.load=function(){var n=i.call(t);return _o(e)||(e.triggerSourceset(""),bo(e)),n},t.currentSrc?e.triggerSourceset(t.currentSrc):_o(e)||bo(e),t.resetSourceset_=function(){t.resetSourceset_=null,t.load=i,t.setAttribute=r,Object.defineProperty(t,"src",n),t.resetSourceWatch_&&t.resetSourceWatch_()}}}},wo=function(e,t,n,r){void 0===r&&(r=!0);var i=function(n){return Object.defineProperty(e,t,{value:n,enumerable:!0,writable:!0})},a={configurable:!0,enumerable:!0,get:function(){var e=n();return i(e),e}};return r&&(a.set=i),Object.defineProperty(e,t,a)},Io=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i=t.source,a=!1;if(i&&(r.el_.currentSrc!==i.src||t.tag&&3===t.tag.initNetworkState_)?r.setSource(i):r.handleLateInit_(r.el_),t.enableSourceset&&r.setupSourcesetHandling_(),r.isScrubbing_=!1,r.el_.hasChildNodes()){for(var o=r.el_.childNodes,s=o.length,u=[];s--;){var l=o[s];"track"===l.nodeName.toLowerCase()&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(l),r.remoteTextTracks().addTrack(l.track),r.textTracks().addTrack(l.track),a||r.el_.hasAttribute("crossorigin")||!mi(l.src)||(a=!0)):u.push(l))}for(var d=0;d<u.length;d++)r.el_.removeChild(u[d])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&a&&xt.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),r.restoreMetadataTracksInIOSNativePlayer_(),(sn||ln||Zt)&&!0===t.nativeControlsForTouch&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}h()(t,e);var n=t.prototype;return n.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),t.disposeMediaElement(this.el_),this.options_=null,e.prototype.dispose.call(this)},n.setupSourcesetHandling_=function(){Ao(this)},n.restoreMetadataTracksInIOSNativePlayer_=function(){var e,t=this.textTracks(),n=function(){e=[];for(var n=0;n<t.length;n++){var r=t[n];"metadata"===r.kind&&e.push({track:r,storedMode:r.mode})}};n(),t.addEventListener("change",n),this.on("dispose",function(){return t.removeEventListener("change",n)});var r=function n(){for(var r=0;r<e.length;r++){var i=e[r];"disabled"===i.track.mode&&i.track.mode!==i.storedMode&&(i.track.mode=i.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",function(){t.removeEventListener("change",n),t.removeEventListener("change",r),t.addEventListener("change",r)}),this.on("webkitendfullscreen",function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",r)})},n.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var r=e.toLowerCase();this[r+"TracksListeners_"]&&Object.keys(this[r+"TracksListeners_"]).forEach(function(e){n.el()[r+"Tracks"].removeEventListener(e,n[r+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[r+"TracksListeners_"]=null,this.proxyNativeTracksForType_(r)}},n.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},n.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},n.proxyNativeTracksForType_=function(e){var t=this,n=Ii[e],r=this.el()[n.getterName],i=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&r&&r.addEventListener){var a={change:function(n){var r={type:"change",target:i,currentTarget:i,srcElement:i};i.trigger(r),"text"===e&&t[Ci.remoteText.getterName]().trigger(r)},addtrack:function(e){i.addTrack(e.track)},removetrack:function(e){i.removeTrack(e.track)}},o=function(){for(var e=[],t=0;t<i.length;t++){for(var n=!1,a=0;a<r.length;a++)if(r[a]===i[t]){n=!0;break}n||e.push(i[t])}for(;e.length;)i.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=a,Object.keys(a).forEach(function(e){var n=a[e];r.addEventListener(e,n),t.on("dispose",function(t){return r.removeEventListener(e,n)})}),this.on("loadstart",o),this.on("dispose",function(e){return t.off("loadstart",o)})}},n.proxyNativeTracks_=function(){var e=this;Ii.names.forEach(function(t){e.proxyNativeTracksForType_(t)})},n.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),t.disposeMediaElement(e),e=n}else{e=s.a.createElement("video");var r=Lr({},this.options_.tag&&Cn(this.options_.tag));sn&&!0===this.options_.nativeControlsForTouch||delete r.controls,In(e,Gt(r,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}"undefined"!==typeof this.options_.preload&&Dn(e,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);for(var i=["loop","muted","playsinline","autoplay"],a=0;a<i.length;a++){var o=i[a],u=this.options_[o];"undefined"!==typeof u&&(u?Dn(e,o,o):Mn(e,o),e[o]=u)}return e},n.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,n=function(){t=!0};this.on("loadstart",n);var r=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",r),void this.ready(function(){this.off("loadstart",n),this.off("loadedmetadata",r),t||this.trigger("loadstart")})}var i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(e){this.trigger(e)},this)})}},n.setScrubbing=function(e){this.isScrubbing_=e},n.scrubbing=function(){return this.isScrubbing_},n.setCurrentTime=function(e){try{this.isScrubbing_&&this.el_.fastSeek&&cn?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){xt(t,"Video is not ready. (Video.js)")}},n.duration=function(){var e=this;if(this.el_.duration===1/0&&Qt&&tn&&0===this.el_.currentTime){return this.on("timeupdate",function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))}),NaN}return this.el_.duration||NaN},n.width=function(){return this.el_.offsetWidth},n.height=function(){return this.el_.offsetHeight},n.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)})}},n.supportsFullScreen=function(){if("function"===typeof this.el_.webkitEnterFullScreen){var e=a.a.navigator&&a.a.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},n.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Wr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},n.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},n.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},n.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},n.reset=function(){t.resetMediaElement(this.el_)},n.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},n.setControls=function(e){this.el_.controls=!!e},n.addTextTrack=function(t,n,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,n,r):e.prototype.addTextTrack.call(this,t,n,r)},n.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return e.prototype.createRemoteTextTrack.call(this,t);var n=s.a.createElement("track");return t.kind&&(n.kind=t.kind),t.label&&(n.label=t.label),(t.language||t.srclang)&&(n.srclang=t.language||t.srclang),t.default&&(n.default=t.default),t.id&&(n.id=t.id),t.src&&(n.src=t.src),n},n.addRemoteTextTrack=function(t,n){var r=e.prototype.addRemoteTextTrack.call(this,t,n);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},n.removeRemoteTextTrack=function(t){if(e.prototype.removeRemoteTextTrack.call(this,t),this.featuresNativeTextTracks)for(var n=this.$$("track"),r=n.length;r--;)t!==n[r]&&t!==n[r].track||this.el().removeChild(n[r])},n.getVideoPlaybackQuality=function(){if("function"===typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return"undefined"!==typeof this.el().webkitDroppedFrameCount&&"undefined"!==typeof this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),a.a.performance&&"function"===typeof a.a.performance.now?e.creationTime=a.a.performance.now():a.a.performance&&a.a.performance.timing&&"number"===typeof a.a.performance.timing.navigationStart&&(e.creationTime=a.a.Date.now()-a.a.performance.timing.navigationStart),e},t}(Di);wo(Io,"TEST_VID",function(){if(gn()){var e=s.a.createElement("video"),t=s.a.createElement("track");return t.kind="captions",t.srclang="en",t.label="English",e.appendChild(t),e}}),Io.isSupported=function(){try{Io.TEST_VID.volume=.5}catch(e){return!1}return!(!Io.TEST_VID||!Io.TEST_VID.canPlayType)},Io.canPlayType=function(e){return Io.TEST_VID.canPlayType(e)},Io.canPlaySource=function(e,t){return Io.canPlayType(e.type)},Io.canControlVolume=function(){try{var e=Io.TEST_VID.volume;return Io.TEST_VID.volume=e/2+.1,e!==Io.TEST_VID.volume}catch(t){return!1}},Io.canMuteVolume=function(){try{var e=Io.TEST_VID.muted;return Io.TEST_VID.muted=!e,Io.TEST_VID.muted?Dn(Io.TEST_VID,"muted","muted"):Mn(Io.TEST_VID,"muted"),e!==Io.TEST_VID.muted}catch(t){return!1}},Io.canControlPlaybackRate=function(){if(Qt&&tn&&nn<58)return!1;try{var e=Io.TEST_VID.playbackRate;return Io.TEST_VID.playbackRate=e/2+.1,e!==Io.TEST_VID.playbackRate}catch(t){return!1}},Io.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(s.a.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(s.a.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(s.a.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(s.a.createElement("audio"),"innerHTML",{get:e,set:e})}catch(t){return!1}return!0},Io.supportsNativeTextTracks=function(){return cn||dn&&tn},Io.supportsNativeVideoTracks=function(){return!(!Io.TEST_VID||!Io.TEST_VID.videoTracks)},Io.supportsNativeAudioTracks=function(){return!(!Io.TEST_VID||!Io.TEST_VID.audioTracks)},Io.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(e){var t=e[0],n=e[1];wo(Io.prototype,t,function(){return Io[n]()},!0)}),Io.prototype.movingMediaElementInDOM=!dn,Io.prototype.featuresFullscreenResize=!0,Io.prototype.featuresProgressEvents=!0,Io.prototype.featuresTimeupdateEvents=!0,Io.patchCanPlayType=function(){$t>=4&&!Jt&&!tn&&(yo=Io.TEST_VID&&Io.TEST_VID.constructor.prototype.canPlayType,Io.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(e)?"maybe":yo.call(this,e)})},Io.unpatchCanPlayType=function(){var e=Io.TEST_VID.constructor.prototype.canPlayType;return yo&&(Io.TEST_VID.constructor.prototype.canPlayType=yo),e},Io.patchCanPlayType(),Io.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"===typeof e.load&&function(){try{e.load()}catch(t){}}()}},Io.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),n=t.length;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"===typeof e.load&&function(){try{e.load()}catch(t){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Io.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(e){Io.prototype["set"+Pr(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(e){Io.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(e){Io.prototype["set"+Pr(e)]=function(t){this.el_[e]=t}}),["pause","load","play"].forEach(function(e){Io.prototype[e]=function(){return this.el_[e]()}}),Di.withSourceHandlers(Io),Io.nativeSourceHandler={},Io.nativeSourceHandler.canPlayType=function(e){try{return Io.TEST_VID.canPlayType(e)}catch(t){return""}},Io.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Io.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=gi(e.src);return Io.nativeSourceHandler.canPlayType("video/"+n)}return""},Io.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Io.nativeSourceHandler.dispose=function(){},Io.registerSourceHandler(Io.nativeSourceHandler),Di.registerTech("Html5",Io);var Co=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Ro={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Do=["tiny","xsmall","small","medium","large","xlarge","huge"],Mo={};Do.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Mo[e]="vjs-layout-"+t});var Oo={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},No=function(e){function t(n,r,i){var a;if(n.id=n.id||r.id||"vjs_video_"+er(),(r=Gt(t.getTagSettings(n),r)).initChildren=!1,r.createEl=!1,r.evented=!1,r.reportTouchActivity=!1,!r.language)if("function"===typeof n.closest){var o=n.closest("[lang]");o&&o.getAttribute&&(r.language=o.getAttribute("lang"))}else for(var u=n;u&&1===u.nodeType;){if(Cn(u).hasOwnProperty("lang")){r.language=u.getAttribute("lang");break}u=u.parentNode}if((a=e.call(this,null,r,i)||this).boundDocumentFullscreenChange_=function(e){return a.documentFullscreenChange_(e)},a.boundFullWindowOnEscKey_=function(e){return a.fullWindowOnEscKey(e)},a.boundUpdateStyleEl_=function(e){return a.updateStyleEl_(e)},a.boundApplyInitTime_=function(e){return a.applyInitTime_(e)},a.boundUpdateCurrentBreakpoint_=function(e){return a.updateCurrentBreakpoint_(e)},a.boundHandleTechClick_=function(e){return a.handleTechClick_(e)},a.boundHandleTechDoubleClick_=function(e){return a.handleTechDoubleClick_(e)},a.boundHandleTechTouchStart_=function(e){return a.handleTechTouchStart_(e)},a.boundHandleTechTouchMove_=function(e){return a.handleTechTouchMove_(e)},a.boundHandleTechTouchEnd_=function(e){return a.handleTechTouchEnd_(e)},a.boundHandleTechTap_=function(e){return a.handleTechTap_(e)},a.isFullscreen_=!1,a.log=Ft(a.id_),a.fsApi_=Dt,a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,a.debugEnabled_=!1,!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=n,a.tagAttributes=n&&Cn(n),a.language(a.options_.language),r.languages){var l={};Object.getOwnPropertyNames(r.languages).forEach(function(e){l[e.toLowerCase()]=r.languages[e]}),a.languages_=l}else a.languages_=t.prototype.options_.languages;a.resetCache_(),a.poster_=r.poster||"",a.controls_=!!r.controls,n.controls=!1,n.removeAttribute("controls"),a.changingSrc_=!1,a.playCallbacks_=[],a.playTerminatedQueue_=[],n.hasAttribute("autoplay")?a.autoplay(!0):a.autoplay(a.options_.autoplay),r.plugins&&Object.keys(r.plugins).forEach(function(e){if("function"!==typeof a[e])throw new Error('plugin "'+e+'" does not exist')}),a.scrubbing_=!1,a.el_=a.createEl(),Dr(c()(a),{eventBusKey:"el_"}),a.fsApi_.requestFullscreen&&(ur(s.a,a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_),a.on(a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_)),a.fluid_&&a.on(["playerreset","resize"],a.boundUpdateStyleEl_);var d=Lr(a.options_);r.plugins&&Object.keys(r.plugins).forEach(function(e){a[e](r.plugins[e])}),r.debug&&a.debug(!0),a.options_.playerOptions=d,a.middleware_=[],a.playbackRates(r.playbackRates),a.initChildren(),a.isAudio("audio"===n.nodeName.toLowerCase()),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),sn&&a.addClass("vjs-touch-enabled"),dn||a.addClass("vjs-workinghover"),t.players[a.id_]=c()(a);var f=Rt.split(".")[0];return a.addClass("vjs-v"+f),a.userActive(!0),a.reportUserActivity(),a.one("play",function(e){return a.listenForUserActivity_(e)}),a.on("stageclick",function(e){return a.handleStageClick_(e)}),a.on("keydown",function(e){return a.handleKeyDown(e)}),a.on("languagechange",function(e){return a.handleLanguagechange(e)}),a.breakpoints(a.options_.breakpoints),a.responsive(a.options_.responsive),a}h()(t,e);var n=t.prototype;return n.dispose=function(){var n=this;this.trigger("dispose"),this.off("dispose"),lr(s.a,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),lr(s.a,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),t.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Oi[this.id()]=null,Ri.names.forEach(function(e){var t=Ri[e],r=n[t.getterName]();r&&r.off&&r.off()}),e.prototype.dispose.call(this)},n.createEl=function(){var t,n=this.tag,r=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),i="video-js"===this.tag.tagName.toLowerCase();r?t=this.el_=n.parentNode:i||(t=this.el_=e.prototype.createEl.call(this,"div"));var o=Cn(n);if(i){for(t=this.el_=n,n=this.tag=s.a.createElement("video");t.children.length;)n.appendChild(t.firstChild);bn(t,"video-js")||Sn(t,"video-js"),t.appendChild(n),r=this.playerElIngest_=t,Object.keys(t).forEach(function(e){try{n[e]=t[e]}catch(r){}})}if(n.setAttribute("tabindex","-1"),o.tabindex="-1",(rn||tn&&on)&&(n.setAttribute("role","application"),o.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in o&&delete o.width,"height"in o&&delete o.height,Object.getOwnPropertyNames(o).forEach(function(e){i&&"class"===e||t.setAttribute(e,o[e]),i&&n.setAttribute(e,o[e])}),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=t.player=this,this.addClass("vjs-paused"),!0!==a.a.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=$n("vjs-styles-dimensions");var u=Hn(".vjs-styles-defaults"),l=Hn("head");l.insertBefore(this.styleEl_,u?u.nextSibling:l.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var d=n.getElementsByTagName("a"),c=0;c<d.length;c++){var f=d.item(c);Sn(f,"vjs-hidden"),f.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!r&&n.parentNode.insertBefore(t,n),En(n,t),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=t,t},n.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");"anonymous"===e||"use-credentials"===e?this.techCall_("setCrossOrigin",e):xt.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"')},n.width=function(e){return this.dimension("width",e)},n.height=function(e){return this.dimension("height",e)},n.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t||"auto"===t)return this[n]=void 0,void this.updateStyleEl_();var r=parseFloat(t);isNaN(r)?xt.error('Improper value "'+t+'" supplied for for '+e):(this[n]=r,this.updateStyleEl_())},n.fluid=function(e){var t,n,r=this;if(void 0===e)return!!this.fluid_;this.fluid_=!!e,Er(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),n=function(){r.on(["playerreset","resize"],r.boundUpdateStyleEl_)},Er(t=this)?n():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(n))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},n.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},n.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},n.updateStyleEl_=function(){if(!0!==a.a.VIDEOJS_NO_DYNAMIC_STYLE){var e,t,n,r=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),i=r[1]/r[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/i:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*i,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),Zn(this.styleEl_,"\n      ."+n+" {\n        width: "+e+"px;\n        height: "+t+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*i+"%;\n      }\n    ")}else{var o="number"===typeof this.width_?this.width_:this.options_.width,s="number"===typeof this.height_?this.height_:this.options_.height,u=this.tech_&&this.tech_.el();u&&(o>=0&&(u.width=o),s>=0&&(u.height=s))}},n.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var r=Pr(e),i=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==r&&this.tag&&(Di.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;var a=this.autoplay();("string"===typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay)&&(a=!1);var o={source:t,autoplay:a,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+i+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Ri.names.forEach(function(e){var t=Ri[e];o[t.getterName]=n[t.privateName]}),Gt(o,this.options_[r]),Gt(o,this.options_[i]),Gt(o,this.options_[e.toLowerCase()]),this.tag&&(o.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(o.startTime=this.cache_.currentTime);var s=Di.getTech(e);if(!s)throw new Error("No Tech named '"+r+"' exists! '"+r+"' should be registered using videojs.registerTech()'");this.tech_=new s(o),this.tech_.ready(mr(this,this.handleTechReady_),!0),Qr(this.textTracksJson_||[],this.tech_),Co.forEach(function(e){n.on(n.tech_,e,function(t){return n["handleTech"+Pr(e)+"_"](t)})}),Object.keys(Ro).forEach(function(e){n.on(n.tech_,e,function(t){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+Ro[e]+"_"].bind(n),event:t}):n["handleTech"+Ro[e]+"_"](t)})}),this.on(this.tech_,"loadstart",function(e){return n.handleTechLoadStart_(e)}),this.on(this.tech_,"sourceset",function(e){return n.handleTechSourceset_(e)}),this.on(this.tech_,"waiting",function(e){return n.handleTechWaiting_(e)}),this.on(this.tech_,"ended",function(e){return n.handleTechEnded_(e)}),this.on(this.tech_,"seeking",function(e){return n.handleTechSeeking_(e)}),this.on(this.tech_,"play",function(e){return n.handleTechPlay_(e)}),this.on(this.tech_,"firstplay",function(e){return n.handleTechFirstPlay_(e)}),this.on(this.tech_,"pause",function(e){return n.handleTechPause_(e)}),this.on(this.tech_,"durationchange",function(e){return n.handleTechDurationChange_(e)}),this.on(this.tech_,"fullscreenchange",function(e,t){return n.handleTechFullscreenChange_(e,t)}),this.on(this.tech_,"fullscreenerror",function(e,t){return n.handleTechFullscreenError_(e,t)}),this.on(this.tech_,"enterpictureinpicture",function(e){return n.handleTechEnterPictureInPicture_(e)}),this.on(this.tech_,"leavepictureinpicture",function(e){return n.handleTechLeavePictureInPicture_(e)}),this.on(this.tech_,"error",function(e){return n.handleTechError_(e)}),this.on(this.tech_,"posterchange",function(e){return n.handleTechPosterChange_(e)}),this.on(this.tech_,"textdata",function(e){return n.handleTechTextData_(e)}),this.on(this.tech_,"ratechange",function(e){return n.handleTechRateChange_(e)}),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===r&&this.tag||En(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},n.unloadTech_=function(){var e=this;Ri.names.forEach(function(t){var n=Ri[t];e[n.privateName]=e[n.getterName]()}),this.textTracksJson_=Xr(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},n.tech=function(e){return void 0===e&&xt.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},n.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)},n.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"mouseup",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)},n.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},n.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())},n.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"===typeof e){var n,r=function(){var e=t.muted();t.muted(!0);var n=function(){t.muted(e)};t.playTerminatedQueue_.push(n);var r=t.play();if(Yr(r))return r.catch(n)};if("any"===e&&!0!==this.muted()?Yr(n=this.play())&&(n=n.catch(r)):n="muted"===e&&!0!==this.muted()?r():this.play(),Yr(n))return n.then(function(){t.trigger({type:"autoplay-success",autoplay:e})}).catch(function(n){t.trigger({type:"autoplay-failure",autoplay:e})})}},n.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!==typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter(function(e){return e.src===t});if(n.length)return n[0].type;for(var r=e.$$("source"),i=0;i<r.length;i++){var a=r[i];if(a.type&&a.src&&a.src===t)return a.type}return ji(t)}(this,t)),this.cache_.source=Lr({},e,{src:t,type:n});for(var r=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),i=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var u=Cn(a[s]);i.push(u),u.src&&u.src===t&&o.push(u.src)}o.length&&!r.length?this.cache_.sources=i:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},n.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var n=function(e){return t.updateSourceCaches_(e)},r=this.currentSource().src,i=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(i)&&(!this.lastSource_||this.lastSource_.tech!==i&&this.lastSource_.player!==r)&&(n=function(){}),n(i),e.src||this.tech_.any(["sourceset","loadstart"],function(e){if("sourceset"!==e.type){var n=t.techGet("currentSrc");t.lastSource_.tech=n,t.updateSourceCaches_(n)}})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},n.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},n.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},n.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},n.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",function n(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",n))})},n.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},n.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},n.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},n.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},n.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},n.handleTechFirstPlay_=function(){this.options_.starttime&&(xt.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},n.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},n.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},n.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},n.handleTechClick_=function(e){Gn(e)&&this.controls_&&(this.paused()?Wr(this.play()):this.pause())},n.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(e.target)})||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"===typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},n.handleTechTap_=function(){this.userActive(!this.userActive())},n.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},n.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},n.handleTechTouchEnd_=function(e){e.cancelable&&e.preventDefault()},n.handleStageClick_=function(){this.reportUserActivity()},n.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},n.documentFullscreenChange_=function(e){var t=e.target.player;if(!t||t===this){var n=this.el(),r=s.a[this.fsApi_.fullscreenElement]===n;!r&&n.matches?r=n.matches(":"+this.fsApi_.fullscreen):!r&&n.msMatchesSelector&&(r=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(r)}},n.handleTechFullscreenChange_=function(e,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},n.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)},n.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},n.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},n.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},n.handleTechError_=function(){var e=this.tech_.error();this.error(e)},n.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},n.getCache=function(){return this.cache_},n.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}},n.techCall_=function(e,t){this.ready(function(){if(e in xi)return function(e,t,n,r){return t[n](e.reduce(Ui(n),r))}(this.middleware_,this.tech_,e,t);if(e in Fi)return Li(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(n){throw xt(n),n}},!0)},n.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in ki)return function(e,t,n){return e.reduceRight(Ui(n),t[n]())}(this.middleware_,this.tech_,e);if(e in Fi)return Li(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw xt("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t;if("TypeError"===t.name)throw xt("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t;throw xt(t),t}}},n.play=function(){var e=this,t=this.options_.Promise||a.a.Promise;return t?new t(function(t){e.play_(t)}):this.play_()},n.play_=function(e){var t=this;void 0===e&&(e=Wr),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!cn&&!dn||this.load());var r=this.techGet_("play");null===r?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r)},n.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(e){e()})},n.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(t){t(e)})},n.pause=function(){this.techCall_("pause")},n.paused=function(){return!1!==this.techGet_("paused")},n.played=function(){return this.techGet_("played")||qr(0,0)},n.scrubbing=function(e){if("undefined"===typeof e)return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},n.currentTime=function(e){return"undefined"!==typeof e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),void this.one("canplay",this.boundApplyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},n.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},n.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},n.remainingTime=function(){return this.duration()-this.currentTime()},n.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},n.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=qr(0,0)),e},n.bufferedPercent=function(){return Hr(this.buffered(),this.duration())},n.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return n>t&&(n=t),n},n.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},n.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},n.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},n.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},n.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},n.isFullscreen=function(e){if(void 0!==e){var t=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_},n.requestFullscreen=function(e){var t=this.options_.Promise||a.a.Promise;if(t){var n=this;return new t(function(t,r){function i(){n.off("fullscreenerror",o),n.off("fullscreenchange",a)}function a(){i(),t()}function o(e,t){i(),r(t)}n.one("fullscreenchange",a),n.one("fullscreenerror",o);var s=n.requestFullscreenHelper_(e);if(s)return s.then(i,i),s})}return this.requestFullscreenHelper_()},n.requestFullscreenHelper_=function(e){var t,n=this;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){var r=this.el_[this.fsApi_.requestFullscreen](t);return r&&r.then(function(){return n.isFullscreen(!0)},function(){return n.isFullscreen(!1)}),r}this.tech_.supportsFullScreen()&&!0===!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()},n.exitFullscreen=function(){var e=this.options_.Promise||a.a.Promise;if(e){var t=this;return new e(function(e,n){function r(){t.off("fullscreenerror",a),t.off("fullscreenchange",i)}function i(){r(),e()}function a(e,t){r(),n(t)}t.one("fullscreenchange",i),t.one("fullscreenerror",a);var o=t.exitFullscreenHelper_();if(o)return o.then(r,r),o})}return this.exitFullscreenHelper_()},n.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var t=s.a[this.fsApi_.exitFullscreen]();return t&&t.then(function(){return e.isFullscreen(!1)}),t}this.tech_.supportsFullScreen()&&!0===!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},n.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=s.a.documentElement.style.overflow,ur(s.a,"keydown",this.boundFullWindowOnEscKey_),s.a.documentElement.style.overflow="hidden",Sn(s.a.body,"vjs-full-window"),this.trigger("enterFullWindow")},n.fullWindowOnEscKey=function(e){v.a.isEventKey(e,"Esc")&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())},n.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,lr(s.a,"keydown",this.boundFullWindowOnEscKey_),s.a.documentElement.style.overflow=this.docOrigOverflow,An(s.a.body,"vjs-full-window"),this.trigger("exitFullWindow")},n.disablePictureInPicture=function(e){if(void 0===e)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")},n.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},n.requestPictureInPicture=function(){if("pictureInPictureEnabled"in s.a&&!1===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")},n.exitPictureInPicture=function(){if("pictureInPictureEnabled"in s.a)return s.a.exitPictureInPicture()},n.handleKeyDown=function(e){var t=this.options_.userActions;if(t&&t.hotkeys){(function(e){var t=e.tagName.toLowerCase();if(e.isContentEditable)return!0;if("input"===t)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type);return-1!==["textarea"].indexOf(t)})(this.el_.ownerDocument.activeElement)||("function"===typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))}},n.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},n=t.fullscreenKey,r=void 0===n?function(e){return v.a.isEventKey(e,"f")}:n,i=t.muteKey,a=void 0===i?function(e){return v.a.isEventKey(e,"m")}:i,o=t.playPauseKey,u=void 0===o?function(e){return v.a.isEventKey(e,"k")||v.a.isEventKey(e,"Space")}:o;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();var l=Br.getComponent("FullscreenToggle");!1!==s.a[this.fsApi_.fullscreenEnabled]&&l.prototype.handleClick.call(this,e)}else if(a.call(this,e)){e.preventDefault(),e.stopPropagation(),Br.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(u.call(this,e)){e.preventDefault(),e.stopPropagation(),Br.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},n.canPlayType=function(e){for(var t,n=0,r=this.options_.techOrder;n<r.length;n++){var i=r[n],a=Di.getTech(i);if(a||(a=Br.getComponent(i)),a){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else xt.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.')}return""},n.selectSource=function(e){var t,n=this,r=this.options_.techOrder.map(function(e){return[e,Di.getTech(e)]}).filter(function(e){var t=e[0],n=e[1];return n?n.isSupported():(xt.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),i=function(e,t,n){var r;return e.some(function(e){return t.some(function(t){if(r=n(e,t))return!0})}),r},a=function(e,t){var r=e[0];if(e[1].canPlaySource(t,n.options_[r.toLowerCase()]))return{source:t,tech:r}};return(this.options_.sourceOrder?i(e,r,(t=a,function(e,n){return t(n,e)})):i(r,e,a))||!1},n.handleSrc_=function(e,t){var n=this;if("undefined"===typeof e)return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var r=function e(t){if(Array.isArray(t)){var n=[];t.forEach(function(t){t=e(t),Array.isArray(t)?n=n.concat(t):qt(t)&&n.push(t)}),t=n}else t="string"===typeof t&&t.trim()?[Gi({src:t})]:qt(t)&&"string"===typeof t.src&&t.src&&t.src.trim()?[Gi(t)]:[];return t}(e);if(r.length){if(this.changingSrc_=!0,t||(this.cache_.sources=r),this.updateSourceCaches_(r[0]),Pi(this,r[0],function(e,i){var a,o;if(n.middleware_=i,t||(n.cache_.sources=r),n.updateSourceCaches_(e),n.src_(e))return r.length>1?n.handleSrc_(r.slice(1)):(n.changingSrc_=!1,n.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void n.triggerReady());a=i,o=n.tech_,a.forEach(function(e){return e.setTech&&e.setTech(o)})}),this.options_.retryOnError&&r.length>1){var i=function(){n.error(null),n.handleSrc_(r.slice(1),!0)},a=function(){n.off("error",i)};this.one("error",i),this.one("playing",a),this.resetRetryOnError_=function(){n.off("error",i),n.off("playing",a)}}}else this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},n.src=function(e){return this.handleSrc_(e,!1)},n.src_=function(e){var t,n,r=this,i=this.selectSource([e]);return!i||(t=i.tech,n=this.techName_,Pr(t)!==Pr(n)?(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(function(){r.changingSrc_=!1}),!1):(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1))},n.load=function(){this.techCall_("load")},n.reset=function(){var e=this,t=this.options_.Promise||a.a.Promise;this.paused()||!t?this.doReset_():Wr(this.play().then(function(){return e.doReset_()}))},n.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Er(this)&&this.trigger("playerreset")},n.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},n.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,n=e.remainingTimeDisplay;t&&t.updateContent(),n&&n.updateContent()},n.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},n.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},n.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},n.currentSource=function(){return this.cache_.source||{}},n.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},n.currentType=function(){return this.currentSource()&&this.currentSource().type||""},n.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},n.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"===typeof e&&/(any|play|muted)/.test(e)||!0===e&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_("string"===typeof e?e:"play"),t=!1):this.options_.autoplay=!!e,t="undefined"===typeof t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},n.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},n.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},n.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},n.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},n.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},n.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},n.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&4===e.code){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",function(){this.off(["click","touchstart"],t)})}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Vr(e),this.addClass("vjs-error"),xt.error("(CODE:"+this.error_.code+" "+Vr.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},n.reportUserActivity=function(e){this.userActivity_=!0},n.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},n.listenForUserActivity_=function(){var e,t,n,r=mr(this,this.reportUserActivity),i=function(t){r(),this.clearInterval(e)};this.on("mousedown",function(){r(),this.clearInterval(e),e=this.setInterval(r,250)}),this.on("mousemove",function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,r())}),this.on("mouseup",i),this.on("mouseleave",i);var a,o=this.getChild("controlBar");!o||dn||Qt||(o.on("mouseenter",function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),o.on("mouseleave",function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",r),this.on("keyup",r),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a);var e=this.options_.inactivityTimeout;e<=0||(a=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},n.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},n.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},n.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},n.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},n.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},n.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)},n.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},n.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},n.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},n.language=function(e){if(void 0===e)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),Er(this)&&this.trigger("languagechange"))},n.languages=function(){return Lr(t.prototype.options_.languages,this.languages_)},n.toJSON=function(){var e=Lr(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var r=t[n];(r=Lr(r)).player=void 0,e.tracks[n]=r}return e},n.createModal=function(e,t){var n=this;(t=t||{}).content=e||"";var r=new Zr(this,t);return this.addChild(r),r.on("dispose",function(){n.removeChild(r)}),r.open(),r},n.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<Do.length;n++){var r=Do[n];if(t<=this.breakpoints_[r]){if(e===r)return;e&&this.removeClass(Mo[e]),this.addClass(Mo[r]),this.breakpoint_=r;break}}},n.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},n.breakpoints=function(e){return void 0===e?Gt(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Gt({},Oo,e),this.updateCurrentBreakpoint_(),Gt(this.breakpoints_))},n.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},n.currentBreakpoint=function(){return this.breakpoint_},n.currentBreakpointClass=function(){return Mo[this.breakpoint_]||""},n.loadMedia=function(e,t){var n=this;if(e&&"object"===typeof e){this.reset(),this.cache_.media=Lr(e);var r=this.cache_.media,i=r.artwork,a=r.poster,o=r.src,s=r.textTracks;!i&&a&&(this.cache_.media.artwork=[{src:a,type:ji(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(s)&&s.forEach(function(e){return n.addRemoteTextTrack(e,!1)}),this.ready(t)}},n.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}})};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:ji(t.poster)}]),t}return Lr(this.cache_.media)},t.getTagSettings=function(e){var t={sources:[],tracks:[]},n=Cn(e),r=n["data-setup"];if(bn(e,"vjs-fill")&&(n.fill=!0),bn(e,"vjs-fluid")&&(n.fluid=!0),null!==r){var i=g()(r||"{}"),a=i[0],o=i[1];a&&xt.error(a),Gt(n,o)}if(Gt(t,n),e.hasChildNodes())for(var s=e.childNodes,u=0,l=s.length;u<l;u++){var d=s[u],c=d.nodeName.toLowerCase();"source"===c?t.sources.push(Cn(d)):"track"===c&&t.tracks.push(Cn(d))}return t},n.flexNotSupported_=function(){var e=s.a.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},n.debug=function(e){if(void 0===e)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},n.playbackRates=function(e){if(void 0===e)return this.cache_.playbackRates;Array.isArray(e)&&e.every(function(e){return"number"===typeof e})&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))},t}(Br);Ri.names.forEach(function(e){var t=Ri[e];No.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),No.prototype.crossorigin=No.prototype.crossOrigin,No.players={};var Po=a.a.navigator;No.prototype.options_={techOrder:Di.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Po&&(Po.languages&&Po.languages[0]||Po.userLanguage||Po.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){No.prototype[e]=function(){return this.techGet_(e)}}),Co.forEach(function(e){No.prototype["handleTech"+Pr(e)+"_"]=function(){return this.trigger(e)}}),Br.registerComponent("Player",No);var Lo={},ko=function(e){return Lo.hasOwnProperty(e)},xo=function(e){return ko(e)?Lo[e]:void 0},Fo=function(e,t){e.activePlugins_=e.activePlugins_||{},e.activePlugins_[t]=!0},Uo=function(e,t,n){var r=(n?"before":"")+"pluginsetup";e.trigger(r,t),e.trigger(r+":"+t.name,t)},Bo=function(e,t){return t.prototype.name=e,function(){Uo(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=S()(t,[this].concat(r));return this[e]=function(){return a},Uo(this,a.getEventHash()),a}},jo=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,this.log||(this.log=this.player.log.createLogger(this.name)),Dr(this),delete this.trigger,Or(this,this.constructor.defaultState),Fo(t,this.name),this.dispose=this.dispose.bind(this),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),dr(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t.activePlugins_[e]=!1,this.player=this.state=null,t[e]=Bo(e,Lo[e])},e.isBasic=function(t){var n="string"===typeof t?xo(t):t;return"function"===typeof n&&!e.prototype.isPrototypeOf(n.prototype)},e.registerPlugin=function(t,n){if("string"!==typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(ko(t))xt.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(No.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!==typeof n)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof n+".");return Lo[t]=n,"plugin"!==t&&(e.isBasic(n)?No.prototype[t]=function(e,t){var n=function(){Uo(this,{name:e,plugin:t,instance:null},!0);var n=t.apply(this,arguments);return Fo(this,e),Uo(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach(function(e){n[e]=t[e]}),n}(t,n):No.prototype[t]=Bo(t,n)),n},e.deregisterPlugin=function(e){if("plugin"===e)throw new Error("Cannot de-register base plugin.");ko(e)&&(delete Lo[e],delete No.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(Lo)),e.forEach(function(e){var n=xo(e);n&&((t=t||{})[e]=n)}),t},e.getPluginVersion=function(e){var t=xo(e);return t&&t.VERSION||""},e}();jo.getPlugin=xo,jo.BASE_PLUGIN_NAME="plugin",jo.registerPlugin("plugin",jo),No.prototype.usingPlugin=function(e){return!!this.activePlugins_&&!0===this.activePlugins_[e]},No.prototype.hasPlugin=function(e){return!!ko(e)};var Go=function(e){return 0===e.indexOf("#")?e.slice(1):e};function qo(e,t,n){var r=qo.getPlayer(e);if(r)return t&&xt.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&r.ready(n),r;var i="string"===typeof e?Hn("#"+Go(e)):e;if(!mn(i))throw new TypeError("The element or ID supplied is not valid. (videojs)");i.ownerDocument.defaultView&&i.ownerDocument.body.contains(i)||xt.warn("The element supplied is not included in the DOM"),t=t||{},qo.hooks("beforesetup").forEach(function(e){var n=e(i,Lr(t));qt(n)&&!Array.isArray(n)?t=Lr(t,n):xt.error("please return an object in beforesetup hooks")});var a=Br.getComponent("Player");return r=new a(i,t,n),qo.hooks("setup").forEach(function(e){return e(r)}),r}if(qo.hooks_={},qo.hooks=function(e,t){return qo.hooks_[e]=qo.hooks_[e]||[],t&&(qo.hooks_[e]=qo.hooks_[e].concat(t)),qo.hooks_[e]},qo.hook=function(e,t){qo.hooks(e,t)},qo.hookOnce=function(e,t){qo.hooks(e,[].concat(t).map(function(t){return function n(){return qo.removeHook(e,n),t.apply(void 0,arguments)}}))},qo.removeHook=function(e,t){var n=qo.hooks(e).indexOf(t);return!(n<=-1)&&(qo.hooks_[e]=qo.hooks_[e].slice(),qo.hooks_[e].splice(n,1),!0)},!0!==a.a.VIDEOJS_NO_DYNAMIC_STYLE&&gn()){var Ho=Hn(".vjs-styles-defaults");if(!Ho){Ho=$n("vjs-styles-defaults");var Vo=Hn("head");Vo&&Vo.insertBefore(Ho,Vo.firstChild),Zn(Ho,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}zn(1,qo),qo.VERSION=Rt,qo.options=No.prototype.options_,qo.getPlayers=function(){return No.players},qo.getPlayer=function(e){var t,n=No.players;if("string"===typeof e){var r=Go(e),i=n[r];if(i)return i;t=Hn("#"+r)}else t=e;if(mn(t)){var a=t,o=a.player,s=a.playerId;if(o||n[s])return o||n[s]}},qo.getAllPlayers=function(){return Object.keys(No.players).map(function(e){return No.players[e]}).filter(Boolean)},qo.players=No.players,qo.getComponent=Br.getComponent,qo.registerComponent=function(e,t){Di.isTech(t)&&xt.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Br.registerComponent.call(Br,e,t)},qo.getTech=Di.getTech,qo.registerTech=Di.registerTech,qo.use=function(e,t){Mi[e]=Mi[e]||[],Mi[e].push(t)},Object.defineProperty(qo,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(qo.middleware,"TERMINATOR",{value:Ni,writeable:!1,enumerable:!0}),qo.browser=fn,qo.TOUCH_ENABLED=sn,qo.extend=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},r={};for(var i in"object"===typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),r=t):"function"===typeof t&&(n=t),w()(n,e),e&&(n.super_=e),r)r.hasOwnProperty(i)&&(n.prototype[i]=r[i]);return n},qo.mergeOptions=Lr,qo.bind=mr,qo.registerPlugin=jo.registerPlugin,qo.deregisterPlugin=jo.deregisterPlugin,qo.plugin=function(e,t){return xt.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),jo.registerPlugin(e,t)},qo.getPlugins=jo.getPlugins,qo.getPlugin=jo.getPlugin,qo.getPluginVersion=jo.getPluginVersion,qo.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),qo.options.languages=Lr(qo.options.languages,((n={})[e]=t,n)),qo.options.languages[e]},qo.log=xt,qo.createLogger=Ft,qo.createTimeRange=qo.createTimeRanges=qr,qo.formatTime=na,qo.setFormatTime=function(e){ta=e},qo.resetFormatTime=function(){ta=ea},qo.parseUrl=hi,qo.isCrossOrigin=mi,qo.EventTarget=_r,qo.on=ur,qo.one=cr,qo.off=lr,qo.trigger=dr,qo.xhr=_.a,qo.TextTrack=Ti,qo.AudioTrack=Ei,qo.VideoTrack=bi,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){qo[e]=function(){return xt.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Kn[e].apply(null,arguments)}}),qo.computedStyle=Vt,qo.dom=Kn,qo.url=vi,qo.defineLazyProperty=wo,qo.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});var Ko=R,Yo=function(e,t,n){return e&&n&&n.responseURL&&t!==n.responseURL?n.responseURL:t},Wo=function(e){return qo.log.debug?qo.log.debug.bind(qo,"VHS:",e+" >"):function(){}},zo=function(e,t){var n,r=[];if(e&&e.length)for(n=0;n<e.length;n++)t(e.start(n),e.end(n))&&r.push([e.start(n),e.end(n)]);return qo.createTimeRanges(r)},Xo=function(e,t){return zo(e,function(e,n){return e-.1<=t&&n+.1>=t})},Qo=function(e,t){return zo(e,function(e){return e-1/30>=t})},$o=function(e){var t=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")},Zo=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},Jo=function(e){if(e&&e.length&&e.end)return e.end(e.length-1)},es=qo.createTimeRange,ts=function(e){return(e.segments||[]).reduce(function(e,t,n){return t.parts?t.parts.forEach(function(r,i){e.push({duration:r.duration,segmentIndex:n,partIndex:i,part:r,segment:t})}):e.push({duration:t.duration,segmentIndex:n,partIndex:null,segment:t,part:null}),e},[])},ns=function(e){var t=e.segments&&e.segments.length&&e.segments[e.segments.length-1];return t&&t.parts||[]},rs=function(e){var t=e.preloadSegment;if(t){var n=t.parts,r=(t.preloadHints||[]).reduce(function(e,t){return e+("PART"===t.type?1:0)},0);return r+=n&&n.length?n.length:0}},is=function(e,t){if(t.endList)return 0;if(e&&e.suggestedPresentationDelay)return e.suggestedPresentationDelay;var n=ns(t).length>0;return n&&t.serverControl&&t.serverControl.partHoldBack?t.serverControl.partHoldBack:n&&t.partTargetDuration?3*t.partTargetDuration:t.serverControl&&t.serverControl.holdBack?t.serverControl.holdBack:t.targetDuration?3*t.targetDuration:0},as=function(e,t,n){if("undefined"===typeof t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence)return 0;var r=function(e,t){var n=0,r=t-e.mediaSequence,i=e.segments[r];if(i){if("undefined"!==typeof i.start)return{result:i.start,precise:!0};if("undefined"!==typeof i.end)return{result:i.end-i.duration,precise:!0}}for(;r--;){if("undefined"!==typeof(i=e.segments[r]).end)return{result:n+i.end,precise:!0};if(n+=i.duration,"undefined"!==typeof i.start)return{result:n+i.start,precise:!0}}return{result:n,precise:!1}}(e,t);if(r.precise)return r.result;var i=function(e,t){for(var n,r=0,i=t-e.mediaSequence;i<e.segments.length;i++){if("undefined"!==typeof(n=e.segments[i]).start)return{result:n.start-r,precise:!0};if(r+=n.duration,"undefined"!==typeof n.end)return{result:n.end-r,precise:!0}}return{result:-1,precise:!1}}(e,t);return i.precise?i.result:r.result+n},os=function(e,t,n){if(!e)return 0;if("number"!==typeof n&&(n=0),"undefined"===typeof t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return a.a.Infinity}return as(e,t,n)},ss=function(e){var t=e.defaultDuration,n=e.durationList,r=e.startIndex,i=e.endIndex,a=0;if(r>i){var o=[i,r];r=o[0],i=o[1]}if(r<0){for(var s=r;s<Math.min(0,i);s++)a+=t;r=0}for(var u=r;u<i;u++)a+=n[u].duration;return a},us=function(e,t,n,r){if(!e||!e.segments)return null;if(e.endList)return os(e);if(null===t)return null;t=t||0;var i=as(e,e.mediaSequence+e.segments.length,t);return n&&(i-=r="number"===typeof r?r:is(null,e)),Math.max(0,i)},ls=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},ds=function(e){return e.excludeUntil&&e.excludeUntil===1/0},cs=function(e){var t=ls(e);return!e.disabled&&!t},fs=function(e,t){return t.attributes&&t.attributes[e]},hs=function(e,t){if(1===e.playlists.length)return!0;var n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!cs(e)&&(e.attributes.BANDWIDTH||0)<n}).length},ps=function(e,t){return!(!e&&!t||!e&&t||e&&!t)&&(e===t||(!(!e.id||!t.id||e.id!==t.id)||(!(!e.resolvedUri||!t.resolvedUri||e.resolvedUri!==t.resolvedUri)||!(!e.uri||!t.uri||e.uri!==t.uri))))},gs=function(e,t){var n=e&&e.mediaGroups&&e.mediaGroups.AUDIO||{},r=!1;for(var i in n){for(var a in n[i])if(r=t(n[i][a]))break;if(r)break}return!!r},ms=function(e){if(!e||!e.playlists||!e.playlists.length)return gs(e,function(e){return e.playlists&&e.playlists.length||e.uri});for(var t=function(t){var n=e.playlists[t],r=n.attributes&&n.attributes.CODECS;return r&&r.split(",").every(function(e){return Q(e)})?"continue":gs(e,function(e){return ps(n,e)})?"continue":{v:!1}},n=0;n<e.playlists.length;n++){var r=t(n);if("continue"!==r&&"object"===typeof r)return r.v}return!0},vs={liveEdgeDelay:is,duration:os,seekable:function(e,t,n){var r=t||0,i=us(e,t,!0,n);return null===i?es():es(r,i)},getMediaInfoForTime:function(e){for(var t=e.playlist,n=e.currentTime,r=e.startingSegmentIndex,i=e.startingPartIndex,a=e.startTime,o=n-a,s=ts(t),u=0,l=0;l<s.length;l++){var d=s[l];if(r===d.segmentIndex&&("number"!==typeof i||"number"!==typeof d.partIndex||i===d.partIndex)){u=l;break}}if(o<0){if(u>0)for(var c=u-1;c>=0;c--){var f=s[c];if((o+=f.duration)+1/30>0)return{partIndex:f.partIndex,segmentIndex:f.segmentIndex,startTime:a-ss({defaultDuration:t.targetDuration,durationList:s,startIndex:u,endIndex:c})}}return{partIndex:s[0]&&s[0].partIndex||null,segmentIndex:s[0]&&s[0].segmentIndex||0,startTime:n}}if(u<0){for(var h=u;h<0;h++)if((o-=t.targetDuration)<0)return{partIndex:s[0]&&s[0].partIndex||null,segmentIndex:s[0]&&s[0].segmentIndex||0,startTime:n};u=0}for(var p=u;p<s.length;p++){var g=s[p];if((o-=g.duration)-1/30<0)return{partIndex:g.partIndex,segmentIndex:g.segmentIndex,startTime:a+ss({defaultDuration:t.targetDuration,durationList:s,startIndex:u,endIndex:p})}}return{segmentIndex:s[s.length-1].segmentIndex,partIndex:s[s.length-1].partIndex,startTime:n}},isEnabled:cs,isDisabled:function(e){return e.disabled},isBlacklisted:ls,isIncompatible:ds,playlistEnd:us,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},hasAttribute:fs,estimateSegmentRequestTime:function(e,t,n,r){return void 0===r&&(r=0),fs("BANDWIDTH",n)?(e*n.attributes.BANDWIDTH-8*r)/t:NaN},isLowestEnabledRendition:hs,isAudioOnly:ms,playlistMatch:ps},ys=qo.log,_s=function(e,t){return e+"-"+t},Ts=function(e,t){e.mediaGroups&&["AUDIO","SUBTITLES"].forEach(function(n){if(e.mediaGroups[n])for(var r in e.mediaGroups[n])for(var i in e.mediaGroups[n][r]){var a=e.mediaGroups[n][r][i];t(a,n,r,i)}})},Es=function(e){var t=e.playlist,n=e.uri,r=e.id;t.id=r,t.playlistErrors_=0,n&&(t.uri=n),t.attributes=t.attributes||{}},bs=function(e,t){e.uri=t;for(var n=0;n<e.playlists.length;n++)if(!e.playlists[n].uri){var r="placeholder-uri-"+n;e.playlists[n].uri=r}Ts(e,function(t,n,r,i){var a="placeholder-uri-"+n+"-"+r+"-"+i;t.playlists&&t.playlists.length||(t.playlists=[l()({},t)]),t.playlists.forEach(function(t,n){var r=_s(n,a);t.uri?t.resolvedUri=t.resolvedUri||Ko(e.uri,t.uri):(t.uri=0===n?a:r,t.resolvedUri=t.uri),t.id=t.id||r,t.attributes=t.attributes||{},e.playlists[t.id]=t,e.playlists[t.uri]=t})}),function(e){for(var t=e.playlists.length;t--;){var n=e.playlists[t];Es({playlist:n,id:_s(t,n.uri)}),n.resolvedUri=Ko(e.uri,n.uri),e.playlists[n.id]=n,e.playlists[n.uri]=n,n.attributes.BANDWIDTH||ys.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}(e),function(e){Ts(e,function(t){t.uri&&(t.resolvedUri=Ko(e.uri,t.uri))})}(e)},Ss=qo.mergeOptions,As=qo.EventTarget,ws=function(e,t){if(!e)return t;var n=Ss(e,t);if(e.preloadHints&&!t.preloadHints&&delete n.preloadHints,e.parts&&!t.parts)delete n.parts;else if(e.parts&&t.parts)for(var r=0;r<t.parts.length;r++)e.parts&&e.parts[r]&&(n.parts[r]=Ss(e.parts[r],t.parts[r]));return!e.skipped&&t.skipped&&(n.skipped=!1),e.preload&&!t.preload&&(n.preload=!1),n},Is=function(e,t){!e.resolvedUri&&e.uri&&(e.resolvedUri=Ko(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=Ko(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=Ko(t,e.map.uri)),e.map&&e.map.key&&!e.map.key.resolvedUri&&(e.map.key.resolvedUri=Ko(t,e.map.key.uri)),e.parts&&e.parts.length&&e.parts.forEach(function(e){e.resolvedUri||(e.resolvedUri=Ko(t,e.uri))}),e.preloadHints&&e.preloadHints.length&&e.preloadHints.forEach(function(e){e.resolvedUri||(e.resolvedUri=Ko(t,e.uri))})},Cs=function(e){var t=e.segments||[],n=e.preloadSegment;if(n&&n.parts&&n.parts.length){if(n.preloadHints)for(var r=0;r<n.preloadHints.length;r++)if("MAP"===n.preloadHints[r].type)return t;n.duration=e.targetDuration,n.preload=!0,t.push(n)}return t},Rs=function(e,t){return e===t||e.segments&&t.segments&&e.segments.length===t.segments.length&&e.endList===t.endList&&e.mediaSequence===t.mediaSequence},Ds=function(e,t,n){void 0===n&&(n=Rs);var r=Ss(e,{}),i=r.playlists[t.id];if(!i)return null;if(n(i,t))return null;t.segments=Cs(t);var a=Ss(i,t);if(a.preloadSegment&&!t.preloadSegment&&delete a.preloadSegment,i.segments){if(t.skip){t.segments=t.segments||[];for(var o=0;o<t.skip.skippedSegments;o++)t.segments.unshift({skipped:!0})}a.segments=function(e,t,n){var r=e.slice(),i=t.slice();n=n||0;for(var a,o=[],s=0;s<i.length;s++){var u=r[s+n],l=i[s];u?(a=u.map||a,o.push(ws(u,l))):(a&&!l.map&&(l.map=a),o.push(l))}return o}(i.segments,t.segments,t.mediaSequence-i.mediaSequence)}a.segments.forEach(function(e){Is(e,a.resolvedUri)});for(var s=0;s<r.playlists.length;s++)r.playlists[s].id===t.id&&(r.playlists[s]=a);return r.playlists[t.id]=a,r.playlists[t.uri]=a,Ts(e,function(e,n,r,i){if(e.playlists)for(var a=0;a<e.playlists.length;a++)t.id===e.playlists[a].id&&(e.playlists[a]=t)}),r},Ms=function(e,t){var n=e.segments[e.segments.length-1],r=n&&n.parts&&n.parts[n.parts.length-1],i=r&&r.duration||n&&n.duration;return t&&i?1e3*i:500*(e.partTargetDuration||e.targetDuration||10)},Os=function(e){function t(t,n,r){var i;if(void 0===r&&(r={}),i=e.call(this)||this,!t)throw new Error("A non-empty playlist URL or object is required");i.logger_=Wo("PlaylistLoader");var a=r,o=a.withCredentials,s=void 0!==o&&o,u=a.handleManifestRedirects,l=void 0!==u&&u;i.src=t,i.vhs_=n,i.withCredentials=s,i.handleManifestRedirects=l;var d=n.options_;return i.customTagParsers=d&&d.customTagParsers||[],i.customTagMappers=d&&d.customTagMappers||[],i.experimentalLLHLS=d&&d.experimentalLLHLS||!1,i.state="HAVE_NOTHING",i.handleMediaupdatetimeout_=i.handleMediaupdatetimeout_.bind(c()(i)),i.on("mediaupdatetimeout",i.handleMediaupdatetimeout_),i}h()(t,e);var n=t.prototype;return n.handleMediaupdatetimeout_=function(){var e=this;if("HAVE_METADATA"===this.state){var t=this.media(),n=Ko(this.master.uri,t.uri);this.experimentalLLHLS&&(n=function(e,t){if(t.endList)return e;var n=[];if(t.serverControl&&t.serverControl.canBlockReload){var r=t.preloadSegment,i=t.mediaSequence+t.segments.length;if(r){var a=r.parts||[],o=rs(t)-1;o>-1&&o!==a.length-1&&n.push("_HLS_part="+o),(o>-1||a.length)&&i--}n.unshift("_HLS_msn="+i)}return t.serverControl&&t.serverControl.canSkipUntil&&n.unshift("_HLS_skip="+(t.serverControl.canSkipDateranges?"v2":"YES")),n.forEach(function(t,n){e+=(0===n?"?":"&")+t}),e}(n,t)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:n,withCredentials:this.withCredentials},function(t,n){if(e.request)return t?e.playlistRequestError(e.request,e.media(),"HAVE_METADATA"):void e.haveMetadata({playlistString:e.request.responseText,url:e.media().uri,id:e.media().id})})}},n.playlistRequestError=function(e,t,n){var r=t.uri,i=t.id;this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[i],status:e.status,message:"HLS playlist request error at URL: "+r+".",responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")},n.parseManifest_=function(e){var t=this,n=e.url;return function(e){var t=e.onwarn,n=e.oninfo,r=e.manifestString,i=e.customTagParsers,a=void 0===i?[]:i,o=e.customTagMappers,s=void 0===o?[]:o,u=e.experimentalLLHLS,l=new V;t&&l.on("warn",t),n&&l.on("info",n),a.forEach(function(e){return l.addParser(e)}),s.forEach(function(e){return l.addTagMapper(e)}),l.push(r),l.end();var d=l.manifest;if(u||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(e){d.hasOwnProperty(e)&&delete d[e]}),d.segments&&d.segments.forEach(function(e){["parts","preloadHints"].forEach(function(t){e.hasOwnProperty(t)&&delete e[t]})})),!d.targetDuration){var c=10;d.segments&&d.segments.length&&(c=d.segments.reduce(function(e,t){return Math.max(e,t.duration)},0)),t&&t("manifest has no targetDuration defaulting to "+c),d.targetDuration=c}var f=ns(d);if(f.length&&!d.partTargetDuration){var h=f.reduce(function(e,t){return Math.max(e,t.duration)},0);t&&(t("manifest has no partTargetDuration defaulting to "+h),ys.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),d.partTargetDuration=h}return d}({onwarn:function(e){var r=e.message;return t.logger_("m3u8-parser warn for "+n+": "+r)},oninfo:function(e){var r=e.message;return t.logger_("m3u8-parser info for "+n+": "+r)},manifestString:e.manifestString,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})},n.haveMetadata=function(e){var t=this,n=e.playlistString,r=e.playlistObject,i=e.url,o=e.id;this.request=null,this.state="HAVE_METADATA";var s=r||this.parseManifest_({url:i,manifestString:n});s.lastRequest=Date.now(),Es({playlist:s,uri:i,id:o});var u=Ds(this.master,s);this.targetDuration=s.partTargetDuration||s.targetDuration,u?(this.master=u,this.media_=this.master.playlists[o]):this.trigger("playlistunchanged"),this.media().endList||(a.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=a.a.setTimeout(function(){t.trigger("mediaupdatetimeout")},Ms(this.media(),!!u))),this.trigger("loadedplaylist")},n.dispose=function(){this.trigger("dispose"),this.stopRequest(),a.a.clearTimeout(this.mediaUpdateTimeout),a.a.clearTimeout(this.finalRenditionTimeout),this.off()},n.stopRequest=function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},n.media=function(e,t){var n=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"===typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}if(a.a.clearTimeout(this.finalRenditionTimeout),t){var r=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=a.a.setTimeout(this.media.bind(this,e,!1),r)}else{var i=this.state,o=!this.media_||e.id!==this.media_.id,s=this.master.playlists[e.id];if(s&&s.endList||e.endList&&e.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,void(o&&(this.trigger("mediachanging"),"HAVE_MASTER"===i?this.trigger("loadedmetadata"):this.trigger("mediachange")));if(o){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},function(t,r){if(n.request){if(e.lastRequest=Date.now(),e.resolvedUri=Yo(n.handleManifestRedirects,e.resolvedUri,r),t)return n.playlistRequestError(n.request,e,i);n.haveMetadata({playlistString:r.responseText,url:e.uri,id:e.id}),"HAVE_MASTER"===i?n.trigger("loadedmetadata"):n.trigger("mediachange")}})}}},n.pause=function(){this.stopRequest(),a.a.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")},n.load=function(e){var t=this;a.a.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(e){var r=n?(n.partTargetDuration||n.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=a.a.setTimeout(function(){return t.load()},r)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()},n.start=function(){var e=this;if(this.started=!0,"object"===typeof this.src)return this.src.uri||(this.src.uri=a.a.location.href),this.src.resolvedUri=this.src.uri,void setTimeout(function(){e.setupInitialPlaylist(e.src)},0);this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"HLS playlist request error at URL: "+e.src+".",responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.src=Yo(e.handleManifestRedirects,e.src,n);var r=e.parseManifest_({manifestString:n.responseText,url:e.src});e.setupInitialPlaylist(r)}})},n.srcUri=function(){return"string"===typeof this.src?this.src:this.src.uri},n.setupInitialPlaylist=function(e){if(this.state="HAVE_MASTER",e.playlists)return this.master=e,bs(this.master,this.srcUri()),e.playlists.forEach(function(e){e.segments=Cs(e),e.segments.forEach(function(t){Is(t,e.resolvedUri)})}),this.trigger("loadedplaylist"),void(this.request||this.media(this.master.playlists[0]));var t=this.srcUri()||a.a.location.href;this.master=function(e,t){var n=_s(0,t),r={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:a.a.location.href,resolvedUri:a.a.location.href,playlists:[{uri:t,id:n,resolvedUri:t,attributes:{}}]};return r.playlists[n]=r.playlists[0],r.playlists[t]=r.playlists[0],r}(0,t),this.haveMetadata({playlistObject:e,url:t,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},t}(As),Ns=qo.xhr,Ps=qo.mergeOptions,Ls=function(e,t,n,r){var i="arraybuffer"===e.responseType?e.response:e.responseText;!t&&i&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=i.byteLength||i.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),n.headers&&(e.responseHeaders=n.headers),t&&"ETIMEDOUT"===t.code&&(e.timedout=!0),t||e.aborted||200===n.statusCode||206===n.statusCode||0===n.statusCode||(t=new Error("XHR Failed with a response of: "+(e&&(i||e.responseText)))),r(t,e)},ks=function(){var e=function e(t,n){t=Ps({timeout:45e3},t);var r=e.beforeRequest||qo.Vhs.xhr.beforeRequest;if(r&&"function"===typeof r){var i=r(t);i&&(t=i)}var a=(!0===qo.Vhs.xhr.original?Ns:qo.Vhs.xhr)(t,function(e,t){return Ls(a,e,t,n)}),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a};return e.original=!0,e},xs=function(e){var t={};return e.byterange&&(t.Range=function(e){var t=e.offset+e.length-1;return"bytes="+e.offset+"-"+t}(e.byterange)),t},Fs=function(e,t){return e.start(t)+"-"+e.end(t)},Us=function(e,t){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")},Bs=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},js=function(e){var t={};return Object.keys(e).forEach(function(n){var r=e[n];ArrayBuffer.isView(r)?t[n]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:t[n]=r}),t},Gs=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},qs=function(e){return e.resolvedUri},Hs=function(e){for(var t=Array.prototype.slice.call(e),n="",r=0;r<t.length/16;r++)n+=t.slice(16*r,16*r+16).map(Us).join("")+" "+t.slice(16*r,16*r+16).map(Bs).join("")+"\n";return n},Vs=Object.freeze({__proto__:null,createTransferableMessage:js,initSegmentId:Gs,segmentKeyId:qs,hexDump:Hs,tagDump:function(e){var t=e.bytes;return Hs(t)},textRanges:function(e){var t,n="";for(t=0;t<e.length;t++)n+=Fs(e,t)+" ";return n}}),Ks=function(e){var t=e.playlist,n=e.time,r=void 0===n?void 0:n,i=e.callback;if(!i)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===r)return i({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var n,r=0,i=0;i<t.segments.length&&!(e<=(r=(n=t.segments[i]).videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:r+n.duration));i++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>r){if(e>r+.25*a.duration)return null;n=a}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:r-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}}(r,t);if(!a)return i({message:"valid programTime was not found"});if("estimate"===a.type)return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:r},s=function(e,t){if(!t.dateTimeObject)return null;var n=t.videoTimingInfo.transmuxerPrependedSeconds,r=e-(t.videoTimingInfo.transmuxedPresentationStart+n);return new Date(t.dateTimeObject.getTime()+1e3*r)}(r,a.segment);return s&&(o.programDateTime=s.toISOString()),i(null,o)},Ys=function e(t){var n=t.programTime,r=t.playlist,i=t.retryCount,a=void 0===i?2:i,o=t.seekTo,s=t.pauseAfterSeek,u=void 0===s||s,l=t.tech,d=t.callback;if(!d)throw new Error("seekToProgramTime: callback must be provided");if("undefined"===typeof n||!r||!o)return d({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!r.endList&&!l.hasStarted_)return d({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++)if(!e.segments[t].dateTimeObject)return!1;return!0}(r))return d({message:"programDateTime tags must be provided in the manifest "+r.resolvedUri});var c=function(e,t){var n;try{n=new Date(e)}catch(l){return null}if(!t||!t.segments||0===t.segments.length)return null;var r=t.segments[0];if(n<r.dateTimeObject)return null;for(var i=0;i<t.segments.length-1&&(r=t.segments[i],!(n<t.segments[i+1].dateTimeObject));i++);var a,o=t.segments[t.segments.length-1],s=o.dateTimeObject,u=o.videoTimingInfo?(a=o.videoTimingInfo).transmuxedPresentationEnd-a.transmuxedPresentationStart-a.transmuxerPrependedSeconds:o.duration+.25*o.duration;return n>new Date(s.getTime()+1e3*u)?null:(n>s&&(r=o),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:vs.duration(t,t.mediaSequence+t.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})}(n,r);if(!c)return d({message:n+" was not found in the stream"});var f=c.segment,h=function(e,t){var n,r;try{n=new Date(e),r=new Date(t)}catch(a){}var i=n.getTime();return(r.getTime()-i)/1e3}(f.dateTimeObject,n);if("estimate"===c.type)return 0===a?d({message:n+" is not buffered yet. Try again"}):(o(c.estimatedStart+h),void l.one("seeked",function(){e({programTime:n,playlist:r,retryCount:a-1,seekTo:o,pauseAfterSeek:u,tech:l,callback:d})}));var p=f.start+h;l.one("seeked",function(){return d(null,l.currentTime())}),u&&l.pause(),o(p)},Ws=function(e,t){if(4===e.readyState)return t()},zs=function(e,t,n){var r,i=[],a=!1,o=function(e,t,r,i){return t.abort(),a=!0,n(e,t,r,i)},s=function(e,t){if(!a){if(e)return o(e,t,"",i);var n=t.responseText.substring(i&&i.byteLength||0,t.responseText.length);if(i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if((t=t.filter(function(e){return e&&(e.byteLength||e.length)&&"string"!==typeof e})).length<=1)return $e(t[0]);var r=t.reduce(function(e,t,n){return e+(t.byteLength||t.length)},0),i=new Uint8Array(r),a=0;return t.forEach(function(e){e=$e(e),i.set(e,a),a+=e.byteLength}),i}(i,rt(n,!0)),r=r||ot(i),i.length<10||r&&i.length<r+2)return Ws(t,function(){return o(e,t,"",i)});var s=It(i);return"ts"===s&&i.length<188?Ws(t,function(){return o(e,t,"",i)}):!s&&i.length<376?Ws(t,function(){return o(e,t,"",i)}):o(null,t,s,i)}},u=t({uri:e,beforeSend:function(e){e.overrideMimeType("text/plain; charset=x-user-defined"),e.addEventListener("progress",function(t){return t.total,t.loaded,Ls(e,null,{statusCode:e.status},s)})}},function(e,t){return Ls(u,e,t,s)});return u},Xs=qo.EventTarget,Qs=qo.mergeOptions,$s=function(e,t){if(!Rs(e,t))return!1;if(e.sidx&&t.sidx&&(e.sidx.offset!==t.sidx.offset||e.sidx.length!==t.sidx.length))return!1;if(!e.sidx&&t.sidx||e.sidx&&!t.sidx)return!1;if(e.segments&&!t.segments||!e.segments&&t.segments)return!1;if(!e.segments&&!t.segments)return!0;for(var n=0;n<e.segments.length;n++){var r=e.segments[n],i=t.segments[n];if(r.uri!==i.uri)return!1;if(r.byterange||i.byterange){var a=r.byterange,o=i.byterange;if(a&&!o||!a&&o)return!1;if(a.offset!==o.offset||a.length!==o.length)return!1}}return!0},Zs=function(e,t){var n,r,i={};for(var a in e){var o=e[a].sidx;if(o){var s=Te(o);if(!t[s])break;var u=t[s].sidxInfo;n=u,r=o,(Boolean(!n.map&&!r.map)||Boolean(n.map&&r.map&&n.map.byterange.offset===r.map.byterange.offset&&n.map.byterange.length===r.map.byterange.length))&&n.uri===r.uri&&n.byterange.offset===r.byterange.offset&&n.byterange.length===r.byterange.length&&(i[s]=t[s])}}return i},Js=function(e){function t(t,n,r,i){var a;void 0===r&&(r={}),(a=e.call(this)||this).masterPlaylistLoader_=i||c()(a),i||(a.isMaster_=!0);var o=r,s=o.withCredentials,u=void 0!==s&&s,l=o.handleManifestRedirects,d=void 0!==l&&l;if(a.vhs_=n,a.withCredentials=u,a.handleManifestRedirects=d,!t)throw new Error("A non-empty playlist URL or object is required");return a.on("minimumUpdatePeriod",function(){a.refreshXml_()}),a.on("mediaupdatetimeout",function(){a.refreshMedia_(a.media().id)}),a.state="HAVE_NOTHING",a.loadedPlaylists_={},a.logger_=Wo("DashPlaylistLoader"),a.isMaster_?(a.masterPlaylistLoader_.srcUrl=t,a.masterPlaylistLoader_.sidxMapping_={}):a.childPlaylist_=t,a}h()(t,e);var n=t.prototype;return n.requestErrored_=function(e,t,n){return!this.request||(this.request=null,e?(this.error="object"!==typeof e||e instanceof Error?{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2}:e,n&&(this.state=n),this.trigger("error"),!0):void 0)},n.addSidxSegments_=function(e,t,n){var r=this,i=e.sidx&&Te(e.sidx);if(e.sidx&&i&&!this.masterPlaylistLoader_.sidxMapping_[i]){var o=Yo(this.handleManifestRedirects,e.sidx.resolvedUri),s=function(a,o){if(!r.requestErrored_(a,o,t)){var s,u=r.masterPlaylistLoader_.sidxMapping_;try{s=Qe()($e(o.response).subarray(8))}catch(l){return void r.requestErrored_(l,o,t)}return u[i]={sidxInfo:e.sidx,sidx:s},_e(e,s,e.sidx.resolvedUri),n(!0)}};this.request=zs(o,this.vhs_.xhr,function(t,n,i,a){if(t)return s(t,n);if(!i||"mp4"!==i)return s({status:n.status,message:"Unsupported "+(i||"unknown")+" container type for sidx segment at URL: "+o,response:"",playlist:e,internal:!0,blacklistDuration:1/0,code:2},n);var u=e.sidx.byterange,l=u.offset,d=u.length;if(a.length>=d+l)return s(t,{response:a.subarray(l,l+d),status:n.status,uri:n.uri});r.request=r.vhs_.xhr({uri:o,responseType:"arraybuffer",headers:xs({byterange:e.sidx.byterange})},s)})}else this.mediaRequest_=a.a.setTimeout(function(){return n(!1)},0)},n.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},a.a.clearTimeout(this.minimumUpdatePeriodTimeout_),a.a.clearTimeout(this.mediaRequest_),a.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.off()},n.hasPendingRequest=function(){return this.request||this.mediaRequest_},n.stopRequest=function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},n.media=function(e){var t=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if("string"===typeof e){if(!this.masterPlaylistLoader_.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.masterPlaylistLoader_.master.playlists[e]}var r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList)return this.state="HAVE_METADATA",this.media_=e,void(r&&(this.trigger("mediachanging"),this.trigger("mediachange")));r&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,n,function(r){t.haveMetadata({startingState:n,playlist:e})}))},n.haveMetadata=function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.id]=n,this.mediaRequest_=null,this.refreshMedia_(n.id),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")},n.pause=function(){this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),a.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMaster_&&(a.a.clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_),this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)},n.load=function(e){var t=this;a.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var n=this.media();if(e){var r=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=a.a.setTimeout(function(){return t.load()},r)}else this.started?n&&!n.endList?(this.isMaster_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()},n.start=function(){var e=this;this.started=!0,this.isMaster_?this.requestMaster_(function(t,n){e.haveMaster_(),e.hasPendingRequest()||e.media_||e.media(e.masterPlaylistLoader_.master.playlists[0])}):this.mediaRequest_=a.a.setTimeout(function(){return e.haveMaster_()},0)},n.requestMaster_=function(e){var t=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},function(n,r){if(!t.requestErrored_(n,r)){var i=r.responseText!==t.masterPlaylistLoader_.masterXml_;return t.masterPlaylistLoader_.masterXml_=r.responseText,r.responseHeaders&&r.responseHeaders.date?t.masterLoaded_=Date.parse(r.responseHeaders.date):t.masterLoaded_=Date.now(),t.masterPlaylistLoader_.srcUrl=Yo(t.handleManifestRedirects,t.masterPlaylistLoader_.srcUrl,r),i?(t.handleMaster_(),void t.syncClientServerClock_(function(){return e(r,i)})):e(r,i)}"HAVE_NOTHING"===t.state&&(t.started=!1)})},n.syncClientServerClock_=function(e){var t=this,n=ze(this.masterPlaylistLoader_.masterXml_);return null===n?(this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===n.method?(this.masterPlaylistLoader_.clientOffset_=n.value-Date.now(),e()):void(this.request=this.vhs_.xhr({uri:Ko(this.masterPlaylistLoader_.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},function(r,i){if(t.request){if(r)return t.masterPlaylistLoader_.clientOffset_=t.masterLoaded_-Date.now(),e();var a;a="HEAD"===n.method?i.responseHeaders&&i.responseHeaders.date?Date.parse(i.responseHeaders.date):t.masterLoaded_:Date.parse(i.responseText),t.masterPlaylistLoader_.clientOffset_=a-Date.now(),e()}}))},n.haveMaster_=function(){this.state="HAVE_MASTER",this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},n.handleMaster_=function(){this.mediaRequest_=null;var e=function(e){var t=e.masterXml,n=e.srcUrl,r=e.clientOffset,i=e.sidxMapping,a=We(t,{manifestUri:n,clientOffset:r,sidxMapping:i});return bs(a,n),a}({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_}),t=this.masterPlaylistLoader_.master;t&&(e=function(e,t,n){for(var r=!0,i=Qs(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),a=0;a<t.playlists.length;a++){var o=t.playlists[a];if(o.sidx){var s=Te(o.sidx);n&&n[s]&&n[s].sidx&&_e(o,n[s].sidx,o.sidx.resolvedUri)}var u=Ds(i,o,$s);u&&(i=u,r=!1)}return Ts(t,function(e,t,n,a){if(e.playlists&&e.playlists.length){var o=e.playlists[0].id,s=Ds(i,e.playlists[0],$s);s&&((i=s).mediaGroups[t][n][a].playlists[0]=i.playlists[o],r=!1)}}),t.minimumUpdatePeriod!==e.minimumUpdatePeriod&&(r=!1),r?null:i}(t,e,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=e||t;var n=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];return n&&n!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=n),(!t||e&&e.minimumUpdatePeriod!==t.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(e)},n.updateMinimumUpdatePeriodTimeout_=function(){var e=this.masterPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(a.a.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);var t=e.master&&e.master.minimumUpdatePeriod;0===t&&(e.media()?t=1e3*e.media().targetDuration:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),"number"!==typeof t||t<=0?t<0&&this.logger_("found invalid minimumUpdatePeriod of "+t+", not setting a timeout"):this.createMUPTimeout_(t)},n.createMUPTimeout_=function(e){var t=this.masterPlaylistLoader_;t.minimumUpdatePeriodTimeout_=a.a.setTimeout(function(){t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)},e)},n.refreshXml_=function(){var e=this;this.requestMaster_(function(t,n){n&&(e.media_&&(e.media_=e.masterPlaylistLoader_.master.playlists[e.media_.id]),e.masterPlaylistLoader_.sidxMapping_=function(e,t){var n=Zs(e.playlists,t);return Ts(e,function(e,r,i,a){if(e.playlists&&e.playlists.length){var o=e.playlists;n=Qs(n,Zs(o,t))}}),n}(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.sidxMapping_),e.addSidxSegments_(e.media(),e.state,function(t){e.refreshMedia_(e.media().id)}))})},n.refreshMedia_=function(e){var t=this;if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();var n=this.masterPlaylistLoader_.master.playlists,r=!this.media_||this.media_!==n[e];if(r?this.media_=n[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){!function e(){t.media().endList||(t.mediaUpdateTimeout=a.a.setTimeout(function(){t.trigger("mediaupdatetimeout"),e()},Ms(t.media(),Boolean(r))))}()}this.trigger("loadedplaylist")},t}(Xs),eu={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},tu=function(e){return e.on=e.addEventListener,e.off=e.removeEventListener,e},nu=function(e){return function(){var t=function(e){try{return URL.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch(n){var t=new BlobBuilder;return t.append(e),URL.createObjectURL(t.getBlob())}}(e),n=tu(new Worker(t));n.objURL=t;var r=n.terminate;return n.on=n.addEventListener,n.off=n.removeEventListener,n.terminate=function(){return URL.revokeObjectURL(t),r.call(this)},n}},ru=function(e){return"var browserWorkerPolyFill = "+tu.toString()+";\nbrowserWorkerPolyFill(self);\n"+e},iu=function(e){return e.toString().replace(/^function.+?{/,"").slice(0,-1)},au=nu(ru(iu(function(){var e=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var r;return!!e[t]&&(r=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(r,1),r>-1)},this.trigger=function(t){var n,r,i,a;if(n=e[t])if(2===arguments.length)for(i=n.length,r=0;r<i;++r)n[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(i=n.length,r=0;r<i;++r)n[r].apply(this,a)}},this.dispose=function(){e={}}}};e.prototype.pipe=function(e){return this.on("data",function(t){e.push(t)}),this.on("done",function(t){e.flush(t)}),this.on("partialdone",function(t){e.partialFlush(t)}),this.on("endedtimeline",function(t){e.endTimeline(t)}),this.on("reset",function(t){e.reset(t)}),e},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var t,n,r,i,a,o,s,u,l,d,c,f,h,p,g,m,v,y,_,T,E,b,S,A,w,I,C,R,D,M,O,N,P,L,k,x,F=e,U=Math.pow(2,32)-1;!function(){var e;if(S={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!==typeof Uint8Array){for(e in S)S.hasOwnProperty(e)&&(S[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);A=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),I=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),w=new Uint8Array([0,0,0,1]),C=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),R=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),D={video:C,audio:R},N=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),O=new Uint8Array([0,0,0,0,0,0,0,0]),P=new Uint8Array([0,0,0,0,0,0,0,0]),L=P,k=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),x=P,M=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),t=function(e){var t,n,r=[],i=0;for(t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)i+=r[t].byteLength;for(n=new Uint8Array(i+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,i=8;t<r.length;t++)n.set(r[t],i),i+=r[t].byteLength;return n},n=function(){return t(S.dinf,t(S.dref,N))},r=function(e){return t(S.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},i=function(){return t(S.ftyp,A,w,A,I)},m=function(e){return t(S.hdlr,D[e])},a=function(e){return t(S.mdat,e)},g=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(n[12]=e.samplerate>>>24&255,n[13]=e.samplerate>>>16&255,n[14]=e.samplerate>>>8&255,n[15]=255&e.samplerate),t(S.mdhd,n)},p=function(e){return t(S.mdia,g(e),m(e.type),s(e))},o=function(e){return t(S.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},s=function(e){return t(S.minf,"video"===e.type?t(S.vmhd,M):t(S.smhd,O),n(),y(e))},u=function(e,n){for(var r=[],i=n.length;i--;)r[i]=T(n[i]);return t.apply(null,[S.moof,o(e)].concat(r))},l=function(e){for(var n=e.length,r=[];n--;)r[n]=f(e[n]);return t.apply(null,[S.moov,c(4294967295)].concat(r).concat(d(e)))},d=function(e){for(var n=e.length,r=[];n--;)r[n]=E(e[n]);return t.apply(null,[S.mvex].concat(r))},c=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t(S.mvhd,n)},v=function(e){var n,r,i=e.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return t(S.sdtp,a)},y=function(e){return t(S.stbl,_(e),t(S.stts,x),t(S.stsc,L),t(S.stsz,k),t(S.stco,P))},function(){var e,n;_=function(r){return t(S.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===r.type?e(r):n(r))},e=function(e){var n,r,i=e.sps||[],a=e.pps||[],o=[],s=[];for(n=0;n<i.length;n++)o.push((65280&i[n].byteLength)>>>8),o.push(255&i[n].byteLength),o=o.concat(Array.prototype.slice.call(i[n]));for(n=0;n<a.length;n++)s.push((65280&a[n].byteLength)>>>8),s.push(255&a[n].byteLength),s=s.concat(Array.prototype.slice.call(a[n]));if(r=[S.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(S.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([i.length],o,[a.length],s))),t(S.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var u=e.sarRatio[0],l=e.sarRatio[1];r.push(t(S.pasp,new Uint8Array([(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u,(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l])))}return t.apply(null,r)},n=function(e){return t(S.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),r(e))}}(),h=function(e){var n=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return t(S.tkhd,n)},T=function(e){var n,r,i,a,o,s;return n=t(S.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),o=Math.floor(e.baseMediaDecodeTime/(U+1)),s=Math.floor(e.baseMediaDecodeTime%(U+1)),r=t(S.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),92,"audio"===e.type?(i=b(e,92),t(S.traf,n,r,i)):(a=v(e),i=b(e,a.length+92),t(S.traf,n,r,i,a))},f=function(e){return e.duration=e.duration||4294967295,t(S.trak,h(e),p(e))},E=function(e){var n=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(n[n.length-1]=0),t(S.trex,n)},function(){var e,n,r;r=function(e,t){var n=0,r=0,i=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(r=2),void 0!==e[0].flags&&(i=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|r|i|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},n=function(e,n){var i,a,o,s,u,l;for(n+=20+16*(s=e.samples||[]).length,o=r(s,n),(a=new Uint8Array(o.length+16*s.length)).set(o),i=o.length,l=0;l<s.length;l++)u=s[l],a[i++]=(4278190080&u.duration)>>>24,a[i++]=(16711680&u.duration)>>>16,a[i++]=(65280&u.duration)>>>8,a[i++]=255&u.duration,a[i++]=(4278190080&u.size)>>>24,a[i++]=(16711680&u.size)>>>16,a[i++]=(65280&u.size)>>>8,a[i++]=255&u.size,a[i++]=u.flags.isLeading<<2|u.flags.dependsOn,a[i++]=u.flags.isDependedOn<<6|u.flags.hasRedundancy<<4|u.flags.paddingValue<<1|u.flags.isNonSyncSample,a[i++]=61440&u.flags.degradationPriority,a[i++]=15&u.flags.degradationPriority,a[i++]=(4278190080&u.compositionTimeOffset)>>>24,a[i++]=(16711680&u.compositionTimeOffset)>>>16,a[i++]=(65280&u.compositionTimeOffset)>>>8,a[i++]=255&u.compositionTimeOffset;return t(S.trun,a)},e=function(e,n){var i,a,o,s,u,l;for(n+=20+8*(s=e.samples||[]).length,o=r(s,n),(i=new Uint8Array(o.length+8*s.length)).set(o),a=o.length,l=0;l<s.length;l++)u=s[l],i[a++]=(4278190080&u.duration)>>>24,i[a++]=(16711680&u.duration)>>>16,i[a++]=(65280&u.duration)>>>8,i[a++]=255&u.duration,i[a++]=(4278190080&u.size)>>>24,i[a++]=(16711680&u.size)>>>16,i[a++]=(65280&u.size)>>>8,i[a++]=255&u.size;return t(S.trun,i)},b=function(t,r){return"audio"===t.type?e(t,r):n(t,r)}}();var B,j,G,q,H,V,K,Y,W=a,z=u,X=function(e){var t,n=i(),r=l(e);return(t=new Uint8Array(n.byteLength+r.byteLength)).set(n),t.set(r,n.byteLength),t},Q=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},$=function(e){var t,n,r=[],i=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,r.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(r.length&&(r.duration=n.dts-r.dts,i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r)),(r=[n]).byteLength=n.data.byteLength,r.pts=n.pts,r.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(r.keyFrame=!0),r.duration=n.dts-r.dts,r.byteLength+=n.data.byteLength,r.push(n));return i.length&&(!r.duration||r.duration<=0)&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r),i},Z=function(e){var t,n,r=[],i=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(r.length&&(i.push(r),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration),(r=[n]).nalCount=n.length,r.byteLength=n.byteLength,r.pts=n.pts,r.dts=n.dts,r.duration=n.duration):(r.duration+=n.duration,r.nalCount+=n.length,r.byteLength+=n.byteLength,r.push(n));return i.length&&r.duration<=0&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration,i.push(r),i},J=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},ee=function(e,t){var n,r,i,a,o,s=t||0,u=[];for(n=0;n<e.length;n++)for(a=e[n],r=0;r<a.length;r++)o=a[r],s+=(i=Q(o,s)).size,u.push(i);return u},te=function(e){var t,n,r,i,a,o,s=0,u=e.byteLength,l=e.nalCount,d=new Uint8Array(u+4*l),c=new DataView(d.buffer);for(t=0;t<e.length;t++)for(i=e[t],n=0;n<i.length;n++)for(a=i[n],r=0;r<a.length;r++)o=a[r],c.setUint32(s,o.data.byteLength),s+=4,d.set(o.data,s),s+=o.data.byteLength;return d},ne=[33,16,5,32,164,27],re=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ie=function(e){for(var t=[];e--;)t.push(0);return t},ae=function(){if(!B){var e={96000:[ne,[227,64],ie(154),[56]],88200:[ne,[231],ie(170),[56]],64000:[ne,[248,192],ie(240),[56]],48000:[ne,[255,192],ie(268),[55,148,128],ie(54),[112]],44100:[ne,[255,192],ie(268),[55,163,128],ie(84),[112]],32000:[ne,[255,192],ie(268),[55,234],ie(226),[112]],24000:[ne,[255,192],ie(268),[55,255,128],ie(268),[111,112],ie(126),[224]],16000:[ne,[255,192],ie(268),[55,255,128],ie(268),[111,255],ie(269),[223,108],ie(195),[1,192]],12000:[re,ie(268),[3,127,248],ie(268),[6,255,240],ie(268),[13,255,224],ie(268),[27,253,128],ie(259),[56]],11025:[re,ie(268),[3,127,248],ie(268),[6,255,240],ie(268),[13,255,224],ie(268),[27,255,192],ie(268),[55,175,128],ie(108),[112]],8000:[re,ie(268),[3,121,16],ie(47),[7]]};t=e,B=Object.keys(t).reduce(function(e,n){return e[n]=new Uint8Array(t[n].reduce(function(e,t){return e.concat(t)},[])),e},{})}var t;return B};V=function(e,t){return j(H(e,t))},K=function(e,t){return G(q(e),t)},Y=function(e,t,n){return q(n?e:e-t)};var oe=9e4,se=j=function(e){return 9e4*e},ue=(G=function(e,t){return e*t},q=function(e){return e/9e4}),le=(H=function(e,t){return e/t},V),de=K,ce=Y,fe=function(e,t,n,r){var i,a,o,s,u,l=0,d=0,c=0;if(t.length&&(i=le(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(oe/(e.samplerate/1024)),n&&r&&(l=i-Math.max(n,r),c=(d=Math.floor(l/a))*a),!(d<1||c>oe/2))){for((o=ae()[e.samplerate])||(o=t[0].data),s=0;s<d;s++)u=t[0],t.splice(0,0,{data:o,dts:u.dts-a,pts:u.pts-a});return e.baseMediaDecodeTime-=Math.floor(de(c,e.samplerate)),c}},he=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},pe=function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e[t],r.push({size:n.data.byteLength,duration:1024});return r},ge=function(e){var t,n,r=0,i=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],i.set(n.data,r),r+=n.data.byteLength;return i},me=oe,ve=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},ye=function(e,t){var n,r=e.minSegmentDts;return t||(r-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=r,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/me,n=Math.floor(n)),n},_e=function(e,t){"number"===typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"===typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},Te=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},r=0,i=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)i+=255,t++;if(i+=e[t++],!n.payload&&4===r){if("GA94"===String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6])){n.payloadType=r,n.payloadSize=i,n.payload=e.subarray(t,t+i);break}n.payload=void 0}t+=i,r=0,i=0}return n},Ee=function(e){return 181!==e.payload[0]?null:49!==(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},be=function(e,t){var n,r,i,a,o=[];if(!(64&t[0]))return o;for(r=31&t[0],n=0;n<r;n++)a={type:3&t[2+(i=3*n)],pts:e},4&t[i+2]&&(a.ccData=t[i+3]<<8|t[i+4],o.push(a));return o},Se=function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},Ae=4,we=function e(t){t=t||{},e.prototype.init.call(this),this.parse708captions_="boolean"!==typeof t.parse708captions||t.parse708captions,this.captionPackets_=[],this.ccStreams_=[new ke(0,0),new ke(0,1),new ke(1,0),new ke(1,1)],this.parse708captions_&&(this.cc708Stream_=new Me),this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};(we.prototype=new F).push=function(e){var t,n,r;if("sei_rbsp"===e.nalUnitType&&(t=Te(e.escapedRBSP)).payload&&t.payloadType===Ae&&(n=Ee(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=be(e.pts,n),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},we.prototype.flushCCStreams=function(e){this.ccStreams_.forEach(function(t){return"flush"===e?t.flush():t.partialFlush()},this)},we.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2?this.dispatchCea608Packet(e):this.dispatchCea708Packet(e)},this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},we.prototype.flush=function(){return this.flushStream("flush")},we.prototype.partialFlush=function(){return this.flushStream("partialFlush")},we.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},we.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},we.prototype.setsChannel1Active=function(e){return 4096===(30720&e.ccData)},we.prototype.setsChannel2Active=function(e){return 6144===(30720&e.ccData)},we.prototype.setsTextOrXDSActive=function(e){return 256===(28928&e.ccData)||4138===(30974&e.ccData)||6186===(30974&e.ccData)},we.prototype.dispatchCea708Packet=function(e){this.parse708captions_&&this.cc708Stream_.push(e)};var Ie={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Ce=function(e){return 32<=e&&e<=127||160<=e&&e<=255},Re=function(e){this.windowNum=e,this.reset()};Re.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Re.prototype.getText=function(){return this.rows.join("\n")},Re.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Re.prototype.newLine=function(e){for(this.rows.length>=this.virtualRowCount&&"function"===typeof this.beforeRowOverflow&&this.beforeRowOverflow(e),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Re.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},Re.prototype.addText=function(e){this.rows[this.rowIdx]+=e},Re.prototype.backspace=function(){if(!this.isEmpty()){var e=this.rows[this.rowIdx];this.rows[this.rowIdx]=e.substr(0,e.length-1)}};var De=function(e){this.serviceNum=e,this.text="",this.currentWindow=new Re(-1),this.windows=[]};De.prototype.init=function(e,t){this.startPts=e;for(var n=0;n<8;n++)this.windows[n]=new Re(n),"function"===typeof t&&(this.windows[n].beforeRowOverflow=t)},De.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]};var Me=function e(){e.prototype.init.call(this);var t=this;this.current708Packet=null,this.services={},this.push=function(e){3===e.type?(t.new708Packet(),t.add708Bytes(e)):(null===t.current708Packet&&t.new708Packet(),t.add708Bytes(e))}};Me.prototype=new F,Me.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Me.prototype.add708Bytes=function(e){var t=e.ccData,n=t>>>8,r=255&t;this.current708Packet.ptsVals.push(e.pts),this.current708Packet.data.push(n),this.current708Packet.data.push(r)},Me.prototype.push708Packet=function(){var e=this.current708Packet,t=e.data,n=null,r=null,i=0,a=t[i++];for(e.seq=a>>6,e.sizeCode=63&a;i<t.length;i++)r=31&(a=t[i++]),7===(n=a>>5)&&r>0&&(n=a=t[i++]),this.pushServiceBlock(n,i,r),r>0&&(i+=r-1)},Me.prototype.pushServiceBlock=function(e,t,n){var r,i=t,a=this.current708Packet.data,o=this.services[e];for(o||(o=this.initService(e,i));i<t+n&&i<a.length;i++)r=a[i],Ce(r)?i=this.handleText(i,o):16===r?i=this.extendedCommands(i,o):128<=r&&r<=135?i=this.setCurrentWindow(i,o):152<=r&&r<=159?i=this.defineWindow(i,o):136===r?i=this.clearWindows(i,o):140===r?i=this.deleteWindows(i,o):137===r?i=this.displayWindows(i,o):138===r?i=this.hideWindows(i,o):139===r?i=this.toggleWindows(i,o):151===r?i=this.setWindowAttributes(i,o):144===r?i=this.setPenAttributes(i,o):145===r?i=this.setPenColor(i,o):146===r?i=this.setPenLocation(i,o):143===r?o=this.reset(i,o):8===r?o.currentWindow.backspace():12===r?o.currentWindow.clearText():13===r?o.currentWindow.pendingNewLine=!0:14===r?o.currentWindow.clearText():141===r&&i++},Me.prototype.extendedCommands=function(e,t){var n=this.current708Packet.data[++e];return Ce(n)&&(e=this.handleText(e,t,!0)),e},Me.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]},Me.prototype.initService=function(e,t){var n=this;return this.services[e]=new De(e),this.services[e].init(this.getPts(t),function(t){n.flushDisplayed(t,n.services[e])}),this.services[e]},Me.prototype.handleText=function(e,t,n){var r=function(e){var t=Ie[e]||e;return 4096&e&&e===t?"":String.fromCharCode(t)}((n?4096:0)|this.current708Packet.data[e]),i=t.currentWindow;return i.pendingNewLine&&!i.isEmpty()&&i.newLine(this.getPts(e)),i.pendingNewLine=!1,i.addText(r),e},Me.prototype.setCurrentWindow=function(e,t){var n=7&this.current708Packet.data[e];return t.setCurrentWindow(n),e},Me.prototype.defineWindow=function(e,t){var n=this.current708Packet.data,r=n[e],i=7&r;t.setCurrentWindow(i);var a=t.currentWindow;return r=n[++e],a.visible=(32&r)>>5,a.rowLock=(16&r)>>4,a.columnLock=(8&r)>>3,a.priority=7&r,r=n[++e],a.relativePositioning=(128&r)>>7,a.anchorVertical=127&r,r=n[++e],a.anchorHorizontal=r,r=n[++e],a.anchorPoint=(240&r)>>4,a.rowCount=15&r,r=n[++e],a.columnCount=63&r,r=n[++e],a.windowStyle=(56&r)>>3,a.penStyle=7&r,a.virtualRowCount=a.rowCount+1,e},Me.prototype.setWindowAttributes=function(e,t){var n=this.current708Packet.data,r=n[e],i=t.currentWindow.winAttr;return r=n[++e],i.fillOpacity=(192&r)>>6,i.fillRed=(48&r)>>4,i.fillGreen=(12&r)>>2,i.fillBlue=3&r,r=n[++e],i.borderType=(192&r)>>6,i.borderRed=(48&r)>>4,i.borderGreen=(12&r)>>2,i.borderBlue=3&r,r=n[++e],i.borderType+=(128&r)>>5,i.wordWrap=(64&r)>>6,i.printDirection=(48&r)>>4,i.scrollDirection=(12&r)>>2,i.justify=3&r,r=n[++e],i.effectSpeed=(240&r)>>4,i.effectDirection=(12&r)>>2,i.displayEffect=3&r,e},Me.prototype.flushDisplayed=function(e,t){for(var n=[],r=0;r<8;r++)t.windows[r].visible&&!t.windows[r].isEmpty()&&n.push(t.windows[r].getText());t.endPts=e,t.text=n.join("\n\n"),this.pushCaption(t),t.startPts=e},Me.prototype.pushCaption=function(e){""!==e.text&&(this.trigger("data",{startPts:e.startPts,endPts:e.endPts,text:e.text,stream:"cc708_"+e.serviceNum}),e.text="",e.startPts=e.endPts)},Me.prototype.displayWindows=function(e,t){var n=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var i=0;i<8;i++)n&1<<i&&(t.windows[i].visible=1);return e},Me.prototype.hideWindows=function(e,t){var n=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var i=0;i<8;i++)n&1<<i&&(t.windows[i].visible=0);return e},Me.prototype.toggleWindows=function(e,t){var n=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var i=0;i<8;i++)n&1<<i&&(t.windows[i].visible^=1);return e},Me.prototype.clearWindows=function(e,t){var n=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var i=0;i<8;i++)n&1<<i&&t.windows[i].clearText();return e},Me.prototype.deleteWindows=function(e,t){var n=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var i=0;i<8;i++)n&1<<i&&t.windows[i].reset();return e},Me.prototype.setPenAttributes=function(e,t){var n=this.current708Packet.data,r=n[e],i=t.currentWindow.penAttr;return r=n[++e],i.textTag=(240&r)>>4,i.offset=(12&r)>>2,i.penSize=3&r,r=n[++e],i.italics=(128&r)>>7,i.underline=(64&r)>>6,i.edgeType=(56&r)>>3,i.fontStyle=7&r,e},Me.prototype.setPenColor=function(e,t){var n=this.current708Packet.data,r=n[e],i=t.currentWindow.penColor;return r=n[++e],i.fgOpacity=(192&r)>>6,i.fgRed=(48&r)>>4,i.fgGreen=(12&r)>>2,i.fgBlue=3&r,r=n[++e],i.bgOpacity=(192&r)>>6,i.bgRed=(48&r)>>4,i.bgGreen=(12&r)>>2,i.bgBlue=3&r,r=n[++e],i.edgeRed=(48&r)>>4,i.edgeGreen=(12&r)>>2,i.edgeBlue=3&r,e},Me.prototype.setPenLocation=function(e,t){var n=this.current708Packet.data,r=n[e],i=t.currentWindow.penLoc;return t.currentWindow.pendingNewLine=!0,r=n[++e],i.row=15&r,r=n[++e],i.column=63&r,e},Me.prototype.reset=function(e,t){var n=this.getPts(e);return this.flushDisplayed(n,t),this.initService(t.serviceNum,e)};var Oe={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ne=function(e){return null===e?"":(e=Oe[e]||e,String.fromCharCode(e))},Pe=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Le=function(){for(var e=[],t=15;t--;)e.push("");return e},ke=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,r,i,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096===(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Le();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Le();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Le()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,i))a=Ne((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Ne((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,i))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14===(14&i)&&this.addFormatting(e.pts,["i"]),1===(1&i)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,i))this.column_+=3&i;else if(this.isPAC(r,i)){var o=Pe.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16===(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(i)&&14===(14&i)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===i&&(i=null),a=Ne(r),a+=Ne(i),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};ke.prototype=new F,ke.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(t){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},ke.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Le(),this.nonDisplayed_=Le(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},ke.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},ke.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},ke.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},ke.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},ke.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},ke.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},ke.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},ke.prototype.isNormalChar=function(e){return e>=32&&e<=127},ke.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Le(),this.displayed_=Le()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},ke.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,n)},ke.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},ke.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},ke.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},ke.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},ke.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var xe={CaptionStream:we,Cea608Stream:ke,Cea708Stream:Me},Fe={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Ue=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Be=function e(t){var n,r;e.prototype.init.call(this),this.type_=t||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===r&&(r=e.dts),e.dts=Ue(e.dts,r),e.pts=Ue(e.pts,r),n=e.dts,this.trigger("data",e))},this.flush=function(){r=n,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){r=void 0,n=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Be.prototype=new F;var je,Ge=Be,qe=Ue,He=function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i},Ve=function(e,t,n){return decodeURIComponent(He(e,t,n))},Ke=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Ye={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ve(e.data,1,t),e.value=Ve(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ve(e.data,1,t),e.url=Ve(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(He(n,0,t)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(je=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},r=0,i=[],a=0;if(je.prototype.init.call(this),this.dispatchType=Fe.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,u,l;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,i.length=0),0===i.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(i.push(e),a+=e.data.byteLength,1===i.length&&(r=Ke(e.data.subarray(6,10)),r+=10),!(a<r)){for(t={data:new Uint8Array(r),frames:[],pts:i[0].pts,dts:i[0].dts},l=0;l<r;)t.data.set(i[0].data.subarray(0,r-l),l),l+=i[0].data.byteLength,a-=i[0].data.byteLength,i.shift();o=10,64&t.data[5]&&(o+=4,o+=Ke(t.data.subarray(10,14)),r-=Ke(t.data.subarray(16,20)));do{if((s=Ke(t.data.subarray(o+4,o+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((u={id:String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),data:t.data.subarray(o+10,o+s+10)}).key=u.id,Ye[u.id]&&(Ye[u.id](u),"com.apple.streaming.transportStreamTimestamp"===u.owner)){var d=u.data,c=(1&d[3])<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;c*=4,c+=3&d[7],u.timeStamp=c,void 0===t.pts&&void 0===t.dts&&(t.pts=u.timeStamp,t.dts=u.timeStamp),this.trigger("timestamp",u)}t.frames.push(u),o+=10,o+=s}while(o<r);this.trigger("data",t)}}}).prototype=new F;var We,ze,Xe,Qe=je,$e=Ge;(We=function(){var e=new Uint8Array(188),t=0;We.prototype.init.call(this),this.push=function(n){var r,i=0,a=188;for(t?((r=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),r.set(n,t),t=0):r=n;a<r.byteLength;)71!==r[i]||71!==r[a]?(i++,a++):(this.trigger("data",r.subarray(i,a)),i+=188,a+=188);i<r.byteLength&&(e.set(r.subarray(i),0),t=r.byteLength-i)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}}).prototype=new F,(ze=function(){var e,t,n,r;ze.prototype.init.call(this),r=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,r){var i=0;r.payloadUnitStartIndicator&&(i+=e[i]+1),"pat"===r.type?t(e.subarray(i),r):n(e.subarray(i),r)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],r.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=r.pmtPid},n=function(e,t){var n,i;if(1&e[5]){for(r.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,i=12+((15&e[10])<<8|e[11]);i<n;){var a=e[i],o=(31&e[i+1])<<8|e[i+2];a===Fe.H264_STREAM_TYPE&&null===r.programMapTable.video?r.programMapTable.video=o:a===Fe.ADTS_STREAM_TYPE&&null===r.programMapTable.audio?r.programMapTable.audio=o:a===Fe.METADATA_STREAM_TYPE&&(r.programMapTable["timed-metadata"][o]=a),i+=5+((15&e[i+3])<<8|e[i+4])}t.programMapTable=r.programMapTable}},this.push=function(t){var n={},r=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(r+=t[r]+1),0===n.pid)n.type="pat",e(t.subarray(r),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(r),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,r,n]):this.processPes_(t,r,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=Fe.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Fe.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new F,ze.STREAM_TYPES={h264:27,adts:15},(Xe=function(){var e,t=this,n={data:[],size:0},r={data:[],size:0},i={data:[],size:0},a=function(e,n,r){var i,a,o=new Uint8Array(e.size),s={type:n},u=0,l=0;if(e.data.length&&!(e.size<9)){for(s.trackId=e.data[0].pid,u=0;u<e.data.length;u++)a=e.data[u],o.set(a.data,l),l+=a.data.byteLength;!function(e,t){var n,r=e[0]<<16|e[1]<<8|e[2];t.data=new Uint8Array,1===r&&(t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!==(4&e[6]),192&(n=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&n&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8]))}(o,s),i="video"===n||s.packetLength<=e.size,(r||i)&&(e.size=0,e.data.length=0),i&&t.trigger("data",s)}};Xe.prototype.init.call(this),this.push=function(o){({pat:function(){},pes:function(){var e,t;switch(o.streamType){case Fe.H264_STREAM_TYPE:e=n,t="video";break;case Fe.ADTS_STREAM_TYPE:e=r,t="audio";break;case Fe.METADATA_STREAM_TYPE:e=i,t="timed-metadata";break;default:return}o.payloadUnitStartIndicator&&a(e,t,!0),e.data.push(o),e.size+=o.data.byteLength},pmt:function(){var n={type:"metadata",tracks:[]};null!==(e=o.programMapTable).video&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),t.trigger("data",n)}})[o.type]()},this.reset=function(){n.size=0,n.data.length=0,r.size=0,r.data.length=0,this.trigger("reset")},this.flushStreams_=function(){a(n,"video"),a(r,"audio"),a(i,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new F;var Ze={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:We,TransportParseStream:ze,ElementaryStream:Xe,TimestampRolloverStream:$e,CaptionStream:xe.CaptionStream,Cea608Stream:xe.Cea608Stream,Cea708Stream:xe.Cea708Stream,MetadataStream:Qe};for(var Je in Fe)Fe.hasOwnProperty(Je)&&(Ze[Je]=Fe[Je]);var et,tt=Ze,nt=oe,rt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(et=function(e){var t,n=0;et.prototype.init.call(this),this.push=function(r){var i,a,o,s,u,l,d=0;if(e||(n=0),"audio"===r.type)for(t?(s=t,(t=new Uint8Array(s.byteLength+r.data.byteLength)).set(s),t.set(r.data,s.byteLength)):t=r.data;d+5<t.length;)if(255===t[d]&&240===(246&t[d+1])){if(a=2*(1&~t[d+1]),i=(3&t[d+3])<<11|t[d+4]<<3|(224&t[d+5])>>5,l=(u=1024*(1+(3&t[d+6])))*nt/rt[(60&t[d+2])>>>2],o=d+i,t.byteLength<o)return;if(this.trigger("data",{pts:r.pts+n*l,dts:r.dts+n*l,sampleCount:u,audioobjecttype:1+(t[d+2]>>>6&3),channelcount:(1&t[d+2])<<2|(192&t[d+3])>>>6,samplerate:rt[(60&t[d+2])>>>2],samplingfrequencyindex:(60&t[d+2])>>>2,samplesize:16,data:t.subarray(d+7+a,o)}),n++,t.byteLength===o)return void(t=void 0);t=t.subarray(o)}else d++},this.flush=function(){n=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}}).prototype=new F;var it,at,ot,st=et,ut=function(e){var t=e.byteLength,n=0,r=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+r},this.loadWord=function(){var i=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(i,i+o)),n=new DataView(a.buffer).getUint32(0),r=8*o,t-=o},this.skipBits=function(e){var i;r>e?(n<<=e,r-=e):(e-=r,e-=8*(i=Math.floor(e/8)),t-=i,this.loadWord(),n<<=e,r-=e)},this.readBits=function(e){var i=Math.min(r,e),a=n>>>32-i;return(r-=i)>0?n<<=i:t>0&&this.loadWord(),(i=e-i)>0?a<<i|this.readBits(i):a},this.skipLeadingZeros=function(){var e;for(e=0;e<r;++e)if(0!==(n&2147483648>>>e))return n<<=e,r-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(at=function(){var e,t,n=0;at.prototype.init.call(this),this.push=function(r){var i;t?((i=new Uint8Array(t.byteLength+r.data.byteLength)).set(t),i.set(r.data,t.byteLength),t=i):t=r.data;for(var a=t.byteLength;n<a-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<a;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<a);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.reset=function(){t=null,n=0,this.trigger("reset")},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new F,ot={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(it=function(){var e,t,n,r,i,a,o,s=new at;it.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,r=e.dts,s.push(e))},s.on("data",function(o){var s={trackId:t,pts:n,dts:r,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=i(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=i(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",s)}),s.on("done",function(){e.trigger("done")}),s.on("partialdone",function(){e.trigger("partialdone")}),s.on("reset",function(){e.trigger("reset")}),s.on("endedtimeline",function(){e.trigger("endedtimeline")}),this.flush=function(){s.flush()},this.partialFlush=function(){s.partialFlush()},this.reset=function(){s.reset()},this.endTimeline=function(){s.endTimeline()},o=function(e,t){var n,r=8,i=8;for(n=0;n<e;n++)0!==i&&(i=(r+t.readExpGolomb()+256)%256),r=0===i?r:i},i=function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},a=function(e){var t,n,r,i,a,s,u,l,d,c,f,h,p,g=0,m=0,v=0,y=0,_=1;if(n=(t=new ut(e)).readUnsignedByte(),i=t.readUnsignedByte(),r=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),ot[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(f=3!==a?8:12,p=0;p<f;p++)t.readBoolean()&&o(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),u=t.readUnsignedExpGolomb(),p=0;p<u;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),l=t.readUnsignedExpGolomb(),d=t.readUnsignedExpGolomb(),0===(c=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;case 255:h=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}h&&(_=h[0]/h[1])}return{profileIdc:n,levelIdc:r,profileCompatibility:i,width:Math.ceil((16*(l+1)-2*g-2*m)*_),height:(2-c)*(d+1)*16-2*v-2*y,sarRatio:h}}}).prototype=new F;var lt,dt={H264Stream:it,NalByteStream:at},ct=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],ft=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return n=n>=0?n:0,(16&e[t+5])>>4?n+20:n+10},ht=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},pt={isLikelyAacData:function(e){var t=function e(t,n){return t.length-n<10||t[n]!=="I".charCodeAt(0)||t[n+1]!=="D".charCodeAt(0)||t[n+2]!=="3".charCodeAt(0)?n:e(t,n+=ft(t,n))}(e,0);return e.length>=t+2&&255===(255&e[t])&&240===(240&e[t+1])&&16===(22&e[t+1])},parseId3TagSize:ft,parseAdtsSize:function(e,t){var n=(224&e[t+5])>>5,r=e[t+4]<<3;return 6144&e[t+3]|r|n},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240===(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240===(246&e[t+1]))return ct[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,n,r;t=10,64&e[5]&&(t+=4,t+=ht(e.subarray(10,14)));do{if((n=ht(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){r=e.subarray(t+10,t+n+10);for(var i=0;i<r.byteLength;i++)if(0===r[i]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i}(r,0,i))){var a=r.subarray(i+1),o=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return o*=4,o+=3&a[7]}break}}t+=10,t+=n}while(t<e.byteLength);return null}};(lt=function(){var e=new Uint8Array,t=0;lt.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var r,i,a,o,s=0,u=0;for(e.length?(o=e.length,(e=new Uint8Array(n.byteLength+o)).set(e.subarray(0,o)),e.set(n,o)):e=n;e.length-u>=3;)if(e[u]!=="I".charCodeAt(0)||e[u+1]!=="D".charCodeAt(0)||e[u+2]!=="3".charCodeAt(0))if(255!==(255&e[u])||240!==(240&e[u+1]))u++;else{if(e.length-u<7)break;if(u+(s=pt.parseAdtsSize(e,u))>e.length)break;a={type:"audio",data:e.subarray(u,u+s),pts:t,dts:t},this.trigger("data",a),u+=s}else{if(e.length-u<10)break;if(u+(s=pt.parseId3TagSize(e,u))>e.length)break;i={type:"timed-metadata",data:e.subarray(u,u+s)},this.trigger("data",i),u+=s}r=e.length-u,e=r>0?e.subarray(u):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new F;var gt,mt,vt,yt,_t=lt,Tt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Et=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],bt=dt.H264Stream,St=pt.isLikelyAacData,At=oe,wt=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},It=function(e,t,n,r,i,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(r-t),pts:e+(i-n)},prependedContentDuration:a,baseMediaDecodeTime:e}};(mt=function(e,t){var n=[],r=0,i=0,a=0,o=1/0;t=t||{},mt.prototype.init.call(this),this.push=function(t){_e(e,t),e&&Tt.forEach(function(n){e[n]=t[n]}),n.push(t)},this.setEarliestDts=function(e){i=e},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,u,l,d,c,f,h;0!==n.length?(s=he(n,e,i),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),h=fe(e,s,a,o),e.samples=pe(s),l=W(ge(s)),n=[],u=z(r,[e]),d=new Uint8Array(u.byteLength+l.byteLength),r++,d.set(u),d.set(l,u.byteLength),ve(e),c=Math.ceil(1024*At/e.samplerate),s.length&&(f=s.length*c,this.trigger("segmentTimingInfo",It(le(e.baseMediaDecodeTime,e.samplerate),s[0].dts,s[0].pts,s[0].dts+f,s[0].pts+f,h||0)),this.trigger("timingInfo",{start:s[0].pts,end:s[0].pts+f})),this.trigger("data",{track:e,boxes:d}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){ve(e),n=[],this.trigger("reset")}}).prototype=new F,(gt=function(e,t){var n,r,i=0,a=[],o=[];t=t||{},gt.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){_e(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],Et.forEach(function(t){e[t]=n[t]},this)),"pic_parameter_set_rbsp"!==t.nalUnitType||r||(r=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var n,r,s,u,l,d,c,f,h=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=$(a),(s=Z(n))[0][0].keyFrame||((r=this.getGopForFusion_(a[0],e))?(h=r.duration,s.unshift(r),s.byteLength+=r.byteLength,s.nalCount+=r.nalCount,s.pts=r.pts,s.dts=r.dts,s.duration+=r.duration):s=J(s)),o.length){var p;if(!(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s)))return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");ve(e),s=p}_e(e,s),e.samples=ee(s),l=W(te(s)),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),c=s[0],f=s[s.length-1],this.trigger("segmentTimingInfo",It(e.baseMediaDecodeTime,c.dts,c.pts,f.dts+f.duration,f.pts+f.duration,h)),this.trigger("timingInfo",{start:s[0].pts,end:s[s.length-1].pts+s[s.length-1].duration}),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),u=z(i,[e]),d=new Uint8Array(u.byteLength+l.byteLength),i++,d.set(u),d.set(l,u.byteLength),this.trigger("data",{track:e,boxes:d}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),a=[],this.gopCache_.length=0,o.length=0,this.trigger("reset")},this.resetStream_=function(){ve(e),n=void 0,r=void 0},this.getGopForFusion_=function(t){var n,r,i,a,o,s=1/0;for(o=0;o<this.gopCache_.length;o++)i=(a=this.gopCache_[o]).gop,e.pps&&wt(e.pps[0],a.pps[0])&&e.sps&&wt(e.sps[0],a.sps[0])&&(i.dts<e.timelineStartInfo.dts||(n=t.dts-i.dts-i.duration)>=-1e4&&n<=45e3&&(!r||s>n)&&(r=a,s=n));return r?r.gop:null},this.alignGopsAtStart_=function(e){var t,n,r,i,a,s,u,l;for(a=e.byteLength,s=e.nalCount,u=e.duration,t=n=0;t<o.length&&n<e.length&&(r=o[t],i=e[n],r.pts!==i.pts);)i.pts>r.pts?t++:(n++,a-=i.byteLength,s-=i.nalCount,u-=i.duration);return 0===n?e:n===e.length?null:((l=e.slice(n)).byteLength=a,l.duration=u,l.nalCount=s,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(e){var t,n,r,i,a,s,u;for(t=o.length-1,n=e.length-1,a=null,s=!1;t>=0&&n>=0;){if(r=o[t],i=e[n],r.pts===i.pts){s=!0;break}r.pts>i.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(0===(u=s?n:a))return e;var l=e.slice(u),d=l.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return l.byteLength=d.byteLength,l.duration=d.duration,l.nalCount=d.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(e){o=e}}).prototype=new F,(yt=function(e,t){this.numberOfTracks=0,this.metadataStream=t,"undefined"!==typeof(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"===typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,yt.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new F,yt.prototype.flush=function(e){var t,n,r,i,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,Et.forEach(function(e){o.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,Tt.forEach(function(e){o.info[e]=this.audioTrack[e]},this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,r=X(this.pendingTracks),o.initSegment=new Uint8Array(r.byteLength),o.initSegment.set(r),o.data=new Uint8Array(this.pendingBytes),i=0;i<this.pendingBoxes.length;i++)o.data.set(this.pendingBoxes[i],a),a+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)(t=this.pendingCaptions[i]).startTime=ce(t.startPts,s,this.keepOriginalTimestamps),t.endTime=ce(t.endPts,s,this.keepOriginalTimestamps),o.captionStreams[t.stream]=!0,o.captions.push(t);for(i=0;i<this.pendingMetadata.length;i++)(n=this.pendingMetadata[i]).cueTime=ce(n.pts,s,this.keepOriginalTimestamps),o.metadata.push(n);for(o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),i=0;i<o.captions.length;i++)t=o.captions[i],this.trigger("caption",t);for(i=0;i<o.metadata.length;i++)n=o.metadata[i],this.trigger("id3Frame",n)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},yt.prototype.setRemux=function(e){this.remuxTracks=e},(vt=function(e){var t,n,r=this,i=!0;vt.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="aac",i.metadataStream=new tt.MetadataStream,i.aacStream=new _t,i.audioTimestampRolloverStream=new tt.TimestampRolloverStream("audio"),i.timedMetadataTimestampRolloverStream=new tt.TimestampRolloverStream("timed-metadata"),i.adtsStream=new st,i.coalesceStream=new yt(e,i.metadataStream),i.headOfPipeline=i.aacStream,i.aacStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream),i.aacStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream),i.metadataStream.on("timestamp",function(e){i.aacStream.setTimestamp(e.timeStamp)}),i.aacStream.on("data",function(a){"timed-metadata"!==a.type&&"audio"!==a.type||i.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"},i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new mt(n,e),i.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream),r.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t}))}),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="ts",i.metadataStream=new tt.MetadataStream,i.packetStream=new tt.TransportPacketStream,i.parseStream=new tt.TransportParseStream,i.elementaryStream=new tt.ElementaryStream,i.timestampRolloverStream=new tt.TimestampRolloverStream,i.adtsStream=new st,i.h264Stream=new bt,i.captionStream=new tt.CaptionStream(e),i.coalesceStream=new yt(e,i.metadataStream),i.headOfPipeline=i.packetStream,i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream).pipe(i.timestampRolloverStream),i.timestampRolloverStream.pipe(i.h264Stream),i.timestampRolloverStream.pipe(i.adtsStream),i.timestampRolloverStream.pipe(i.metadataStream).pipe(i.coalesceStream),i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream),i.elementaryStream.on("data",function(a){var o;if("metadata"===a.type){for(o=a.tracks.length;o--;)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||((n=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime):(t=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime;t&&!i.videoSegmentStream&&(i.coalesceStream.numberOfTracks++,i.videoSegmentStream=new gt(t,e),i.videoSegmentStream.on("timelineStartInfo",function(t){n&&!e.keepOriginalTimestamps&&(n.timelineStartInfo=t,i.audioSegmentStream.setEarliestDts(t.dts-r.baseMediaDecodeTime))}),i.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo")),i.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo")),i.videoSegmentStream.on("baseMediaDecodeTime",function(e){n&&i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),i.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo")),i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)),n&&!i.audioSegmentStream&&(i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new mt(n,e),i.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),i.audioSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"audioSegmentTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),r.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})}}),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("id3Frame",function(e){e.dispatchType=i.metadataStream.dispatchType,r.trigger("id3Frame",e)}),i.coalesceStream.on("caption",this.trigger.bind(this,"caption")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(r){var i=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=r),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,ve(n),i.audioTimestampRolloverStream&&i.audioTimestampRolloverStream.discontinuity()),t&&(i.videoSegmentStream&&(i.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,ve(t),i.captionStream.reset()),i.timestampRolloverStream&&i.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(t){var n=this.transmuxPipeline_;e.remux=t,n&&n.coalesceStream&&n.coalesceStream.setRemux(t)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(i){var t=St(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),i=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){i=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new F;var Ct,Rt,Dt,Mt={Transmuxer:vt,VideoSegmentStream:gt,AudioSegmentStream:mt,AUDIO_PROPERTIES:Tt,VIDEO_PROPERTIES:Et,generateSegmentTimingInfo:It},Ot=function(e){return e>>>0},Nt=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},Pt=Ot,Lt=function e(t,n){var r,i,a,o,s,u=[];if(!n.length)return null;for(r=0;r<t.byteLength;)i=Pt(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]),a=Nt(t.subarray(r+4,r+8)),o=i>1?r+i:t.byteLength,a===n[0]&&(1===n.length?u.push(t.subarray(r+8,o)):(s=e(t.subarray(r+8,o),n.slice(1))).length&&(u=u.concat(s))),r=o;return u},kt=Ot,xt=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:kt(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=kt(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},Ft=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Ut=function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],s=2&n.flags[1],u=4&n.flags[1],l=8&n.flags[1],d=r.getUint32(4),c=8;for(i&&(n.dataOffset=r.getInt32(c),c+=4),a&&d&&(t={flags:Ft(e.subarray(c,c+4))},c+=4,o&&(t.duration=r.getUint32(c),c+=4),s&&(t.size=r.getUint32(c),c+=4),l&&(1===n.version?t.compositionTimeOffset=r.getInt32(c):t.compositionTimeOffset=r.getUint32(c),c+=4),n.samples.push(t),d--);d--;)t={},o&&(t.duration=r.getUint32(c),c+=4),s&&(t.size=r.getUint32(c),c+=4),u&&(t.flags=Ft(e.subarray(c,c+4)),c+=4),l&&(1===n.version?t.compositionTimeOffset=r.getInt32(c):t.compositionTimeOffset=r.getUint32(c),c+=4),n.samples.push(t);return n},Bt=function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},i=1&r.flags[2],a=2&r.flags[2],o=8&r.flags[2],s=16&r.flags[2],u=32&r.flags[2],l=65536&r.flags[0],d=131072&r.flags[0];return t=8,i&&(t+=4,r.baseDataOffset=n.getUint32(12),t+=4),a&&(r.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(r.defaultSampleDuration=n.getUint32(t),t+=4),s&&(r.defaultSampleSize=n.getUint32(t),t+=4),u&&(r.defaultSampleFlags=n.getUint32(t)),l&&(r.durationIsEmpty=!0),!i&&d&&(r.baseDataOffsetIsMoof=!0),r},jt=Se,Gt=xe.CaptionStream,qt=function(e,t){for(var n=e,r=0;r<t.length;r++){var i=t[r];if(n<i.size)return i;n-=i.size}return null},Ht=function(e,t){var n=Lt(e,["moof","traf"]),r=Lt(e,["mdat"]),i={},a=[];return r.forEach(function(e,t){var r=n[t];a.push({mdat:e,traf:r})}),a.forEach(function(e){var n,r=e.mdat,a=e.traf,o=Lt(a,["tfhd"]),s=Bt(o[0]),u=s.trackId,l=Lt(a,["tfdt"]),d=l.length>0?xt(l[0]).baseMediaDecodeTime:0,c=Lt(a,["trun"]);t===u&&c.length>0&&(n=function(e,t,n){var r,i,a,o,s=new DataView(e.buffer,e.byteOffset,e.byteLength),u=[];for(i=0;i+4<e.length;i+=a)if(a=s.getUint32(i),i+=4,!(a<=0))switch(31&e[i]){case 6:var l=e.subarray(i+1,i+1+a),d=qt(i,t);if(r={nalUnitType:"sei_rbsp",size:a,data:l,escapedRBSP:jt(l),trackId:n},d)r.pts=d.pts,r.dts=d.dts,o=d;else{if(!o){console.log("We've encountered a nal unit without data. See mux.js#233.");break}r.pts=o.pts,r.dts=o.dts}u.push(r)}return u}(r,function(e,t,n){var r=t,i=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,o=n.trackId,s=[];return e.forEach(function(e){var t=Ut(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=i),void 0===e.size&&(e.size=a),e.trackId=o,e.dts=r,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=r+e.compositionTimeOffset,r+=e.duration}),s=s.concat(t)}),s}(c,d,s),u),i[u]||(i[u]=[]),i[u]=i[u].concat(n))}),i},Vt=function(){var e,t,n,r,i,a,o=!1;this.isInitialized=function(){return o},this.init=function(t){e=new Gt,o=!0,a=!!t&&t.isPartial,e.on("data",function(e){e.startTime=e.startPts/r,e.endTime=e.endPts/r,i.captions.push(e),i.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"===typeof t&&0===Object.keys(t).length)&&(n!==e[0]||r!==t[n])},this.parse=function(e,a,o){var s;if(!this.isInitialized())return null;if(!a||!o)return null;if(this.isNewInit(a,o))n=a[0],r=o[n];else if(null===n||!r)return t.push(e),null;for(;t.length>0;){var u=t.shift();this.parse(u,a,o)}return null!==(s=function(e,t,n){return null===t?null:{seiNals:Ht(e,t)[t],timescale:n}}(e,n,r))&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),i):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach(function(t){e.push(t)})},this.flushStream=function(){if(!this.isInitialized())return null;a?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){i.captions=[],i.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,r=null,i?this.clearParsedCaptions():i={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()},Kt=Ot,Yt=function(e){return("00"+e.toString(16)).slice(-2)};Ct=function(e,t){var n,r,i;return n=Lt(t,["moof","traf"]),r=[].concat.apply([],n.map(function(t){return Lt(t,["tfhd"]).map(function(n){var r,i,a;return r=Kt(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),i=e[r]||9e4,(a="number"!==typeof(a=Lt(t,["tfdt"]).map(function(e){var t,n;return t=e[0],n=Kt(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=Kt(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n})[0])||isNaN(a)?1/0:a)/i})})),i=Math.min.apply(null,r),isFinite(i)?i:0},Rt=function(e){var t=Lt(e,["moov","trak"]),n=[];return t.forEach(function(e){var t,r,i={},a=Lt(e,["tkhd"])[0];a&&(r=(t=new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint8(0),i.id=0===r?t.getUint32(12):t.getUint32(20));var o=Lt(e,["mdia","hdlr"])[0];if(o){var s=Nt(o.subarray(8,12));i.type="vide"===s?"video":"soun"===s?"audio":s}var u=Lt(e,["mdia","minf","stbl","stsd"])[0];if(u){var l=u.subarray(8);i.codec=Nt(l.subarray(4,8));var d,c=Lt(l,[i.codec])[0];c&&(/^[a-z]vc[1-9]$/i.test(i.codec)?(d=c.subarray(78),"avcC"===Nt(d.subarray(4,8))&&d.length>11?(i.codec+=".",i.codec+=Yt(d[9]),i.codec+=Yt(d[10]),i.codec+=Yt(d[11])):i.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(i.codec)?(d=c.subarray(28),"esds"===Nt(d.subarray(4,8))&&d.length>20&&0!==d[19]?(i.codec+="."+Yt(d[19]),i.codec+="."+Yt(d[20]>>>2&63).replace(/^0/,"")):i.codec="mp4a.40.2"):i.codec=i.codec.toLowerCase())}var f=Lt(e,["mdia","mdhd"])[0];f&&(i.timescale=Dt(f)),n.push(i)}),n};var Wt=Ct,zt=Rt,Xt=(Dt=function(e){var t=0===e[0]?12:20;return Kt(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])},function(e){var t=31&e[1];return t<<=8,t|=e[2]}),Qt=function(e){return!!(64&e[1])},$t=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},Zt=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Jt={parseType:function(e,t){var n=Xt(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},parsePat:function(e){var t=Qt(e),n=4+$t(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},parsePmt:function(e){var t={},n=Qt(e),r=4+$t(e);if(n&&(r+=e[r]+1),1&e[r+5]){var i;i=3+((15&e[r+1])<<8|e[r+2])-4;for(var a=12+((15&e[r+10])<<8|e[r+11]);a<i;){var o=r+a;t[(31&e[o+1])<<8|e[o+2]]=e[o],a+=5+((15&e[o+3])<<8|e[o+4])}return t}},parsePayloadUnitStartIndicator:Qt,parsePesType:function(e,t){switch(t[Xt(e)]){case Fe.H264_STREAM_TYPE:return"video";case Fe.ADTS_STREAM_TYPE:return"audio";case Fe.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!Qt(e))return null;var t=4+$t(e);if(t>=e.byteLength)return null;var n,r=null;return 192&(n=e[t+7])&&((r={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,r.pts*=4,r.pts+=(6&e[t+13])>>>1,r.dts=r.pts,64&n&&(r.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,r.dts*=4,r.dts+=(6&e[t+18])>>>1)),r},videoPacketContainsKeyFrame:function(e){for(var t=4+$t(e),n=e.subarray(t),r=0,i=0,a=!1;i<n.byteLength-3;i++)if(1===n[i+2]){r=i+5;break}for(;r<n.byteLength;)switch(n[r]){case 0:if(0!==n[r-1]){r+=2;break}if(0!==n[r-2]){r++;break}i+3!==r-2&&"slice_layer_without_partitioning_rbsp_idr"===Zt(31&n[i+3])&&(a=!0);do{r++}while(1!==n[r]&&r<n.length);i=r-2,r+=3;break;case 1:if(0!==n[r-1]||0!==n[r-2]){r+=3;break}"slice_layer_without_partitioning_rbsp_idr"===Zt(31&n[i+3])&&(a=!0),i=r-2,r+=3;break;default:r+=3}return n=n.subarray(i),r-=i,i=0,n&&n.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===Zt(31&n[i+3])&&(a=!0),a}},en=qe,tn={};tn.ts=Jt,tn.aac=pt;var nn=oe,rn=function(e,t,n){for(var r,i,a,o,s=0,u=188,l=!1;u<=e.byteLength;)if(71!==e[s]||71!==e[u]&&u!==e.byteLength)s++,u++;else{switch(r=e.subarray(s,u),tn.ts.parseType(r,t.pid)){case"pes":i=tn.ts.parsePesType(r,t.table),a=tn.ts.parsePayloadUnitStartIndicator(r),"audio"===i&&a&&(o=tn.ts.parsePesTime(r))&&(o.type="audio",n.audio.push(o),l=!0)}if(l)break;s+=188,u+=188}for(s=(u=e.byteLength)-188,l=!1;s>=0;)if(71!==e[s]||71!==e[u]&&u!==e.byteLength)s--,u--;else{switch(r=e.subarray(s,u),tn.ts.parseType(r,t.pid)){case"pes":i=tn.ts.parsePesType(r,t.table),a=tn.ts.parsePayloadUnitStartIndicator(r),"audio"===i&&a&&(o=tn.ts.parsePesTime(r))&&(o.type="audio",n.audio.push(o),l=!0)}if(l)break;s-=188,u-=188}},an=function(e,t,n){for(var r,i,a,o,s,u,l,d=0,c=188,f=!1,h={data:[],size:0};c<e.byteLength;)if(71!==e[d]||71!==e[c])d++,c++;else{switch(r=e.subarray(d,c),tn.ts.parseType(r,t.pid)){case"pes":if(i=tn.ts.parsePesType(r,t.table),a=tn.ts.parsePayloadUnitStartIndicator(r),"video"===i&&(a&&!f&&(o=tn.ts.parsePesTime(r))&&(o.type="video",n.video.push(o),f=!0),!n.firstKeyFrame)){if(a&&0!==h.size){for(s=new Uint8Array(h.size),u=0;h.data.length;)l=h.data.shift(),s.set(l,u),u+=l.byteLength;if(tn.ts.videoPacketContainsKeyFrame(s)){var p=tn.ts.parsePesTime(s);p?(n.firstKeyFrame=p,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}h.size=0}h.data.push(r),h.size+=r.byteLength}}if(f&&n.firstKeyFrame)break;d+=188,c+=188}for(d=(c=e.byteLength)-188,f=!1;d>=0;)if(71!==e[d]||71!==e[c])d--,c--;else{switch(r=e.subarray(d,c),tn.ts.parseType(r,t.pid)){case"pes":i=tn.ts.parsePesType(r,t.table),a=tn.ts.parsePayloadUnitStartIndicator(r),"video"===i&&a&&(o=tn.ts.parsePesTime(r))&&(o.type="video",n.video.push(o),f=!0)}if(f)break;d-=188,c-=188}},on=function(e){var t={pid:null,table:null},n={};for(var r in function(e,t){for(var n,r=0,i=188;i<e.byteLength;)if(71!==e[r]||71!==e[i])r++,i++;else{switch(n=e.subarray(r,i),tn.ts.parseType(n,t.pid)){case"pat":t.pid=tn.ts.parsePat(n);break;case"pmt":var a=tn.ts.parsePmt(n);t.table=t.table||{},Object.keys(a).forEach(function(e){t.table[e]=a[e]})}r+=188,i+=188}}(e,t),t.table){if(t.table.hasOwnProperty(r))switch(t.table[r]){case Fe.H264_STREAM_TYPE:n.video=[],an(e,t,n),0===n.video.length&&delete n.video;break;case Fe.ADTS_STREAM_TYPE:n.audio=[],rn(e,t,n),0===n.audio.length&&delete n.audio}}return n},sn=function(e,t){var n;return(n=tn.aac.isLikelyAacData(e)?function(e){for(var t,n=!1,r=0,i=null,a=null,o=0,s=0;e.length-s>=3;){switch(tn.aac.parseType(e,s)){case"timed-metadata":if(e.length-s<10){n=!0;break}if((o=tn.aac.parseId3TagSize(e,s))>e.length){n=!0;break}null===a&&(t=e.subarray(s,s+o),a=tn.aac.parseAacTimestamp(t)),s+=o;break;case"audio":if(e.length-s<7){n=!0;break}if((o=tn.aac.parseAdtsSize(e,s))>e.length){n=!0;break}null===i&&(t=e.subarray(s,s+o),i=tn.aac.parseSampleRate(t)),r++,s+=o;break;default:s++}if(n)return null}if(null===i||null===a)return null;var u=nn/i;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*r*u,pts:a+1024*r*u}]}}(e):on(e))&&(n.audio||n.video)?(function(e,t){if(e.audio&&e.audio.length){var n=t;("undefined"===typeof n||isNaN(n))&&(n=e.audio[0].dts),e.audio.forEach(function(e){e.dts=en(e.dts,n),e.pts=en(e.pts,n),e.dtsTime=e.dts/nn,e.ptsTime=e.pts/nn})}if(e.video&&e.video.length){var r=t;if(("undefined"===typeof r||isNaN(r))&&(r=e.video[0].dts),e.video.forEach(function(e){e.dts=en(e.dts,r),e.pts=en(e.pts,r),e.dtsTime=e.dts/nn,e.ptsTime=e.pts/nn}),e.firstKeyFrame){var i=e.firstKeyFrame;i.dts=en(i.dts,r),i.pts=en(i.pts,r),i.dtsTime=i.dts/nn,i.ptsTime=i.pts/nn}}}(n,t),n):null},un=function(){function e(e,t){this.options=t||{},this.self=e,this.init()}var t=e.prototype;return t.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Mt.Transmuxer(this.options),function(e,t){t.on("data",function(t){var n=t.initSegment;t.initSegment={data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength};var r=t.data;t.data=r.buffer,e.postMessage({action:"data",segment:t,byteOffset:r.byteOffset,byteLength:r.byteLength},[t.data])}),t.on("done",function(t){e.postMessage({action:"done"})}),t.on("gopInfo",function(t){e.postMessage({action:"gopInfo",gopInfo:t})}),t.on("videoSegmentTimingInfo",function(t){var n={start:{decode:ue(t.start.dts),presentation:ue(t.start.pts)},end:{decode:ue(t.end.dts),presentation:ue(t.end.pts)},baseMediaDecodeTime:ue(t.baseMediaDecodeTime)};t.prependedContentDuration&&(n.prependedContentDuration=ue(t.prependedContentDuration)),e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:n})}),t.on("audioSegmentTimingInfo",function(t){var n={start:{decode:ue(t.start.dts),presentation:ue(t.start.pts)},end:{decode:ue(t.end.dts),presentation:ue(t.end.pts)},baseMediaDecodeTime:ue(t.baseMediaDecodeTime)};t.prependedContentDuration&&(n.prependedContentDuration=ue(t.prependedContentDuration)),e.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:n})}),t.on("id3Frame",function(t){e.postMessage({action:"id3Frame",id3Frame:t})}),t.on("caption",function(t){e.postMessage({action:"caption",caption:t})}),t.on("trackinfo",function(t){e.postMessage({action:"trackinfo",trackInfo:t})}),t.on("audioTimingInfo",function(t){e.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:ue(t.start),end:ue(t.end)}})}),t.on("videoTimingInfo",function(t){e.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:ue(t.start),end:ue(t.end)}})})}(this.self,this.transmuxer)},t.pushMp4Captions=function(e){this.captionParser||(this.captionParser=new Vt,this.captionParser.init());var t=new Uint8Array(e.data,e.byteOffset,e.byteLength),n=this.captionParser.parse(t,e.trackIds,e.timescales);this.self.postMessage({action:"mp4Captions",captions:n&&n.captions||[],data:t.buffer},[t.buffer])},t.probeMp4StartTime=function(e){var t=e.timescales,n=e.data,r=Wt(t,n);this.self.postMessage({action:"probeMp4StartTime",startTime:r,data:n},[n.buffer])},t.probeMp4Tracks=function(e){var t=e.data,n=zt(t);this.self.postMessage({action:"probeMp4Tracks",tracks:n,data:t},[t.buffer])},t.probeTs=function(e){var t=e.data,n=e.baseStartTime,r="number"!==typeof n||isNaN(n)?void 0:n*oe,i=sn(t,r),a=null;i&&((a={hasVideo:i.video&&2===i.video.length||!1,hasAudio:i.audio&&2===i.audio.length||!1}).hasVideo&&(a.videoStart=i.video[0].ptsTime),a.hasAudio&&(a.audioStart=i.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:a,data:t},[t.buffer])},t.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},t.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},t.push=function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)},t.reset=function(){this.transmuxer.reset()},t.setTimestampOffset=function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(se(t)))},t.setAudioAppendStart=function(e){this.transmuxer.setAudioAppendStart(Math.ceil(se(e.appendStart)))},t.setRemux=function(e){this.transmuxer.setRemux(e.remux)},t.flush=function(e){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})},t.endTimeline=function(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})},t.alignGopsWith=function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())},e}();self.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new un(self,e.data.options):(this.messageHandlers||(this.messageHandlers=new un(self)),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}))),ou=function(e){var t=e.transmuxer,n=e.bytes,r=e.audioAppendStart,i=e.gopsToAlignWith,a=e.remux,o=e.onData,s=e.onTrackInfo,u=e.onAudioTimingInfo,l=e.onVideoTimingInfo,d=e.onVideoSegmentTimingInfo,c=e.onAudioSegmentTimingInfo,f=e.onId3,h=e.onCaptions,p=e.onDone,g=e.onEndedTimeline,m=e.isEndOfTimeline,v={buffer:[]},y=m;if(t.onmessage=function(n){t.currentTransmux===e&&("data"===n.data.action&&function(e,t,n){var r=e.data.segment,i=r.type,a=r.initSegment,o=r.captions,s=r.captionStreams,u=r.metadata,l=r.videoFrameDtsTime,d=r.videoFramePtsTime;t.buffer.push({captions:o,captionStreams:s,metadata:u});var c=e.data.segment.boxes||{data:e.data.segment.data},f={type:i,data:new Uint8Array(c.data,c.data.byteOffset,c.data.byteLength),initSegment:new Uint8Array(a.data,a.byteOffset,a.byteLength)};"undefined"!==typeof l&&(f.videoFrameDtsTime=l),"undefined"!==typeof d&&(f.videoFramePtsTime=d),n(f)}(n,v,o),"trackinfo"===n.data.action&&s(n.data.trackInfo),"gopInfo"===n.data.action&&function(e,t){t.gopInfo=e.data.gopInfo}(n,v),"audioTimingInfo"===n.data.action&&u(n.data.audioTimingInfo),"videoTimingInfo"===n.data.action&&l(n.data.videoTimingInfo),"videoSegmentTimingInfo"===n.data.action&&d(n.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===n.data.action&&c(n.data.audioSegmentTimingInfo),"id3Frame"===n.data.action&&f([n.data.id3Frame],n.data.id3Frame.dispatchType),"caption"===n.data.action&&h(n.data.caption),"endedtimeline"===n.data.action&&(y=!1,g()),"transmuxed"===n.data.type&&(y||(t.onmessage=null,function(e){var t=e.transmuxedData,n=e.callback;t.buffer=[],n(t)}({transmuxedData:v,callback:p}),su(t))))},r&&t.postMessage({action:"setAudioAppendStart",appendStart:r}),Array.isArray(i)&&t.postMessage({action:"alignGopsWith",gopsToAlignWith:i}),"undefined"!==typeof a&&t.postMessage({action:"setRemux",remux:a}),n.byteLength){var _=n instanceof ArrayBuffer?n:n.buffer,T=n instanceof ArrayBuffer?0:n.byteOffset;t.postMessage({action:"push",data:_,byteOffset:T,byteLength:n.byteLength},[_])}m&&t.postMessage({action:"endTimeline"}),t.postMessage({action:"flush"})},su=function(e){e.currentTransmux=null,e.transmuxQueue.length&&(e.currentTransmux=e.transmuxQueue.shift(),"function"===typeof e.currentTransmux?e.currentTransmux():ou(e.currentTransmux))},uu=function(e,t){e.postMessage({action:t}),su(e)},lu=function(e,t){if(!t.currentTransmux)return t.currentTransmux=e,void uu(t,e);t.transmuxQueue.push(uu.bind(null,t,e))},du=function(e){if(!e.transmuxer.currentTransmux)return e.transmuxer.currentTransmux=e,void ou(e);e.transmuxer.transmuxQueue.push(e)},cu=function(e){lu("reset",e)},fu=function(e){var t=new au;t.currentTransmux=null,t.transmuxQueue=[];var n=t.terminate;return t.terminate=function(){return t.currentTransmux=null,t.transmuxQueue.length=0,n.call(t)},t.postMessage({action:"init",options:e}),t},hu=function(e){var t=e.transmuxer,n=e.endAction||e.action,r=e.callback,i=l()({},e,{endAction:null,transmuxer:null,callback:null});if(t.addEventListener("message",function i(a){a.data.action===n&&(t.removeEventListener("message",i),a.data.data&&(a.data.data=new Uint8Array(a.data.data,e.byteOffset||0,e.byteLength||a.data.data.byteLength),e.data&&(e.data=a.data.data)),r(a.data))}),e.data){var a=e.data instanceof ArrayBuffer;i.byteOffset=a?0:e.data.byteOffset,i.byteLength=e.data.byteLength;var o=[a?e.data:e.data.buffer];t.postMessage(i,o)}else t.postMessage(i)},pu=2,gu=-101,mu=-102,vu=function(e){e.forEach(function(e){e.abort()})},yu=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:gu,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:mu,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:pu,xhr:t}:"arraybuffer"===t.responseType&&0===t.response.byteLength?{status:t.status,message:"Empty HLS response at URL: "+t.uri,code:pu,xhr:t}:null},_u=function(e,t,n){return function(r,i){var a=i.response,o=yu(r,i);if(o)return n(o,e);if(16!==a.byteLength)return n({status:i.status,message:"Invalid HLS key at URL: "+i.uri,code:pu,xhr:i},e);for(var s=new DataView(a),u=new Uint32Array([s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12)]),l=0;l<t.length;l++)t[l].bytes=u;return n(null,e)}},Tu=function(e,t){var n=It(e.map.bytes);if("mp4"!==n){var r=e.map.resolvedUri||e.map.uri;return t({internal:!0,message:"Found unsupported "+(n||"unknown")+" container for initialization segment at URL: "+r,code:pu})}hu({action:"probeMp4Tracks",data:e.map.bytes,transmuxer:e.transmuxer,callback:function(n){var r=n.tracks,i=n.data;return e.map.bytes=i,r.forEach(function(t){e.map.tracks=e.map.tracks||{},e.map.tracks[t.type]||(e.map.tracks[t.type]=t,"number"===typeof t.id&&t.timescale&&(e.map.timescales=e.map.timescales||{},e.map.timescales[t.id]=t.timescale))}),t(null)}})},Eu=function(e){var t=e.segment,n=e.finishProcessingFn,r=e.responseType;return function(e,i){var a=yu(e,i);if(a)return n(a,t);var o="arraybuffer"!==r&&i.responseText?function(e){for(var t=new Uint8Array(new ArrayBuffer(e.length)),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}(i.responseText.substring(t.lastReachedChar||0)):i.response;return t.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(i),t.key?t.encryptedBytes=new Uint8Array(o):t.bytes=new Uint8Array(o),n(null,t)}},bu=function(e){var t=e.segment,n=e.bytes,r=e.trackInfoFn,i=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,s=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,f=e.doneFn,h=t.map&&t.map.tracks||{},p=Boolean(h.audio&&h.video),g=i.bind(null,t,"audio","start"),m=i.bind(null,t,"audio","end"),v=i.bind(null,t,"video","start"),y=i.bind(null,t,"video","end");hu({action:"probeTs",transmuxer:t.transmuxer,data:n,baseStartTime:t.baseStartTime,callback:function(e){t.bytes=n=e.data;var i=e.result;i&&(r(t,{hasAudio:i.hasAudio,hasVideo:i.hasVideo,isMuxed:p}),r=null,i.hasAudio&&!p&&g(i.audioStart),i.hasVideo&&v(i.videoStart),g=null,v=null),du({bytes:n,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,remux:p,onData:function(e){e.type="combined"===e.type?"video":e.type,c(t,e)},onTrackInfo:function(e){r&&(p&&(e.isMuxed=!0),r(t,e))},onAudioTimingInfo:function(e){g&&"undefined"!==typeof e.start&&(g(e.start),g=null),m&&"undefined"!==typeof e.end&&m(e.end)},onVideoTimingInfo:function(e){v&&"undefined"!==typeof e.start&&(v(e.start),v=null),y&&"undefined"!==typeof e.end&&y(e.end)},onVideoSegmentTimingInfo:function(e){a(e)},onAudioSegmentTimingInfo:function(e){o(e)},onId3:function(e,n){s(t,e,n)},onCaptions:function(e){u(t,[e])},isEndOfTimeline:l,onEndedTimeline:function(){d()},onDone:function(e){f&&(e.type="combined"===e.type?"video":e.type,f(null,t,e))}})}})},Su=function(e){var t=e.segment,n=e.bytes,r=e.trackInfoFn,i=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,s=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,f=e.doneFn,h=new Uint8Array(n);if(function(e){return lt(e,["moof"]).length>0}(h)){t.isFmp4=!0;var p=t.map.tracks,g={isFmp4:!0,hasVideo:!!p.video,hasAudio:!!p.audio};p.audio&&p.audio.codec&&"enca"!==p.audio.codec&&(g.audioCodec=p.audio.codec),p.video&&p.video.codec&&"encv"!==p.video.codec&&(g.videoCodec=p.video.codec),p.video&&p.audio&&(g.isMuxed=!0),r(t,g);var m=function(e){c(t,{data:h,type:g.hasAudio&&!g.isMuxed?"audio":"video"}),e&&e.length&&u(t,e),f(null,t,{})};hu({action:"probeMp4StartTime",timescales:t.map.timescales,data:h,transmuxer:t.transmuxer,callback:function(e){var r=e.data,a=e.startTime;n=r.buffer,t.bytes=h=r,g.hasAudio&&!g.isMuxed&&i(t,"audio","start",a),g.hasVideo&&i(t,"video","start",a),p.video&&r.byteLength&&t.transmuxer?hu({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:t.transmuxer,data:h,timescales:t.map.timescales,trackIds:[p.video.id],callback:function(e){n=e.data.buffer,t.bytes=h=e.data,m(e.captions)}}):m()}})}else if(t.transmuxer){if("undefined"===typeof t.container&&(t.container=It(h)),"ts"!==t.container&&"aac"!==t.container)return r(t,{hasAudio:!1,hasVideo:!1}),void f(null,t,{});bu({segment:t,bytes:n,trackInfoFn:r,timingInfoFn:i,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:o,id3Fn:s,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:f})}else f(null,t,{})},Au=function(e,t){var n,r=e.id,i=e.key,a=e.encryptedBytes,o=e.decryptionWorker;o.addEventListener("message",function e(n){if(n.data.source===r){o.removeEventListener("message",e);var i=n.data.decrypted;t(new Uint8Array(i.bytes,i.byteOffset,i.byteLength))}}),n=i.bytes.slice?i.bytes.slice():new Uint32Array(Array.prototype.slice.call(i.bytes)),o.postMessage(js({source:r,encrypted:a,key:n,iv:i.iv}),[a.buffer,n.buffer])},wu=function(e){var t=e.activeXhrs,n=e.decryptionWorker,r=e.trackInfoFn,i=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,s=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,f=e.doneFn,h=0,p=!1;return function(e,g){if(!p){if(e)return p=!0,vu(t),f(e,g);if((h+=1)===t.length){var m=function(){if(g.encryptedBytes)return function(e){var t=e.decryptionWorker,n=e.segment,r=e.trackInfoFn,i=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,s=e.id3Fn,u=e.captionsFn,l=e.isEndOfTimeline,d=e.endedTimelineFn,c=e.dataFn,f=e.doneFn;Au({id:n.requestId,key:n.key,encryptedBytes:n.encryptedBytes,decryptionWorker:t},function(e){n.bytes=e,Su({segment:n,bytes:n.bytes,trackInfoFn:r,timingInfoFn:i,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:o,id3Fn:s,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:f})})}({decryptionWorker:n,segment:g,trackInfoFn:r,timingInfoFn:i,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:o,id3Fn:s,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:f});Su({segment:g,bytes:g.bytes,trackInfoFn:r,timingInfoFn:i,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:o,id3Fn:s,captionsFn:u,isEndOfTimeline:l,endedTimelineFn:d,dataFn:c,doneFn:f})};if(g.endOfAllRequests=Date.now(),g.map&&g.map.encryptedBytes&&!g.map.bytes)return Au({decryptionWorker:n,id:g.requestId+"-init",encryptedBytes:g.map.encryptedBytes,key:g.map.key},function(e){g.map.bytes=e,Tu(g,function(e){if(e)return vu(t),f(e,g);m()})});m()}}}},Iu=function(e){var t=e.segment,n=e.progressFn;return e.trackInfoFn,e.timingInfoFn,e.videoSegmentTimingInfoFn,e.audioSegmentTimingInfoFn,e.id3Fn,e.captionsFn,e.isEndOfTimeline,e.endedTimelineFn,e.dataFn,function(e){if(!e.target.aborted)return t.stats=qo.mergeOptions(t.stats,function(e){var t=e.target,n={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return n.bytesReceived=e.loaded,n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3),n}(e)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),n(e,t)}},Cu=function(e){var t=e.xhr,n=e.xhrOptions,r=e.decryptionWorker,i=e.segment,a=e.abortFn,o=e.progressFn,s=e.trackInfoFn,u=e.timingInfoFn,l=e.videoSegmentTimingInfoFn,d=e.audioSegmentTimingInfoFn,c=e.id3Fn,f=e.captionsFn,h=e.isEndOfTimeline,p=e.endedTimelineFn,g=e.dataFn,m=e.doneFn,v=[],y=wu({activeXhrs:v,decryptionWorker:r,trackInfoFn:s,timingInfoFn:u,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:c,captionsFn:f,isEndOfTimeline:h,endedTimelineFn:p,dataFn:g,doneFn:m});if(i.key&&!i.key.bytes){var _=[i.key];i.map&&!i.map.bytes&&i.map.key&&i.map.key.resolvedUri===i.key.resolvedUri&&_.push(i.map.key);var T=t(qo.mergeOptions(n,{uri:i.key.resolvedUri,responseType:"arraybuffer"}),_u(i,_,y));v.push(T)}if(i.map&&!i.map.bytes){if(i.map.key&&(!i.key||i.key.resolvedUri!==i.map.key.resolvedUri)){var E=t(qo.mergeOptions(n,{uri:i.map.key.resolvedUri,responseType:"arraybuffer"}),_u(i,[i.map.key],y));v.push(E)}var b=t(qo.mergeOptions(n,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:xs(i.map)}),function(e){var t=e.segment,n=e.finishProcessingFn;return function(e,r){var i=yu(e,r);if(i)return n(i,t);var a=new Uint8Array(r.response);if(t.map.key)return t.map.encryptedBytes=a,n(null,t);t.map.bytes=a,Tu(t,function(e){if(e)return e.xhr=r,e.status=r.status,n(e,t);n(null,t)})}}({segment:i,finishProcessingFn:y}));v.push(b)}var S=qo.mergeOptions(n,{uri:i.part&&i.part.resolvedUri||i.resolvedUri,responseType:"arraybuffer",headers:xs(i)}),A=t(S,Eu({segment:i,finishProcessingFn:y,responseType:S.responseType}));A.addEventListener("progress",Iu({segment:i,progressFn:o,trackInfoFn:s,timingInfoFn:u,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:c,captionsFn:f,isEndOfTimeline:h,endedTimelineFn:p,dataFn:g})),v.push(A);var w={};return v.forEach(function(e){e.addEventListener("loadend",function(e){var t=e.loadendState,n=e.abortFn;return function(e){e.target.aborted&&n&&!t.calledAbortFn&&(n(),t.calledAbortFn=!0)}}({loadendState:w,abortFn:a}))}),function(){return vu(v)}},Ru=Wo("CodecUtils"),Du=function(e,t){var n=t.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&n.AUDIO&&e.mediaGroups.AUDIO[n.AUDIO]},Mu=function(e){var t={};return e.forEach(function(e){var n=e.mediaType,r=e.type,i=e.details;t[n]=t[n]||[],t[n].push(z(""+r+i))}),Object.keys(t).forEach(function(e){if(t[e].length>1)return Ru("multiple "+e+" codecs found as attributes: "+t[e].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs."),void(t[e]=null);t[e]=t[e][0]}),t},Ou=function(e){var t=0;return e.audio&&t++,e.video&&t++,t},Nu=function(e,t){var n=t.attributes||{},r=Mu(function(e){var t=e.attributes||{};if(t.CODECS)return X(t.CODECS)}(t)||[]);if(Du(e,t)&&!r.audio&&!function(e,t){if(!Du(e,t))return!0;var n=t.attributes||{},r=e.mediaGroups.AUDIO[n.AUDIO];for(var i in r)if(!r[i].uri&&!r[i].playlists)return!0;return!1}(e,t)){var i=Mu(function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var r in n){var i=n[r];if(i.default&&i.playlists)return X(i.playlists[0].attributes.CODECS)}return null}(e,n.AUDIO)||[]);i.audio&&(r.audio=i.audio)}return r},Pu=Wo("PlaylistSelector"),Lu=function(e){if(e&&e.playlist){var t=e.playlist;return JSON.stringify({id:t.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:t.attributes&&t.attributes.CODECS||""})}},ku=function(e,t){if(!e)return"";var n=a.a.getComputedStyle(e);return n?n[t]:""},xu=function(e,t){var n=e.slice();e.sort(function(e,r){var i=t(e,r);return 0===i?n.indexOf(e)-n.indexOf(r):i})},Fu=function(e,t){var n,r;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||a.a.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(r=t.attributes.BANDWIDTH),n-(r=r||a.a.Number.MAX_VALUE)},Uu=function(e,t,n,r,i,o){if(e){var s={bandwidth:t,width:n,height:r,limitRenditionByPlayerDimensions:i},u=e.playlists;vs.isAudioOnly(e)&&(u=o.getAudioTrackPlaylists_(),s.audioOnly=!0);var l=u.map(function(e){var t=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,n=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;return{bandwidth:e.attributes&&e.attributes.BANDWIDTH||a.a.Number.MAX_VALUE,width:t,height:n,playlist:e}});xu(l,function(e,t){return e.bandwidth-t.bandwidth});var d=(l=l.filter(function(e){return!vs.isIncompatible(e.playlist)})).filter(function(e){return vs.isEnabled(e.playlist)});d.length||(d=l.filter(function(e){return!vs.isDisabled(e.playlist)}));var c=d.filter(function(e){return e.bandwidth*eu.BANDWIDTH_VARIANCE<t}),f=c[c.length-1],h=c.filter(function(e){return e.bandwidth===f.bandwidth})[0];if(!1===i){var p=h||d[0]||l[0];if(p&&p.playlist){var g="sortedPlaylistReps";return h&&(g="bandwidthBestRep"),d[0]&&(g="enabledPlaylistReps"),Pu("choosing "+Lu(p)+" using "+g+" with options",s),p.playlist}return Pu("could not choose a playlist with options",s),null}var m=c.filter(function(e){return e.width&&e.height});xu(m,function(e,t){return e.width-t.width});var v=m.filter(function(e){return e.width===n&&e.height===r});f=v[v.length-1];var y,_,T,E=v.filter(function(e){return e.bandwidth===f.bandwidth})[0];E||(_=(y=m.filter(function(e){return e.width>n||e.height>r})).filter(function(e){return e.width===y[0].width&&e.height===y[0].height}),f=_[_.length-1],T=_.filter(function(e){return e.bandwidth===f.bandwidth})[0]);var b=T||E||h||d[0]||l[0];if(b&&b.playlist){var S="sortedPlaylistReps";return T?S="resolutionPlusOneRep":E?S="resolutionBestRep":h?S="bandwidthBestRep":d[0]&&(S="enabledPlaylistReps"),Pu("choosing "+Lu(b)+" using "+S+" with options",s),b.playlist}return Pu("could not choose a playlist with options",s),null}},Bu=function(){var e=this.useDevicePixelRatio&&a.a.devicePixelRatio||1;return Uu(this.playlists.master,this.systemBandwidth,parseInt(ku(this.tech_.el(),"width"),10)*e,parseInt(ku(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)},ju=function(e){var t=e.inbandTextTracks,n=e.metadataArray,r=e.timestampOffset,i=e.videoDuration;if(n){var o=a.a.WebKitDataCue||a.a.VTTCue,s=t.metadataTrack_;if(s&&(n.forEach(function(e){var t=e.cueTime+r;!("number"!==typeof t||a.a.isNaN(t)||t<0)&&t<1/0&&e.frames.forEach(function(e){var n=new o(t,t,e.value||e.url||e.data||"");n.frame=e,n.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return qo.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return qo.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return qo.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(n),s.addCue(n)})}),s.cues&&s.cues.length)){for(var u=s.cues,l=[],d=0;d<u.length;d++)u[d]&&l.push(u[d]);var c=l.reduce(function(e,t){var n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e},{}),f=Object.keys(c).sort(function(e,t){return Number(e)-Number(t)});f.forEach(function(e,t){var n=c[e],r=Number(f[t+1])||i;n.forEach(function(e){e.endTime=r})})}}},Gu=function(e,t,n){var r,i;if(n&&n.cues)for(r=n.cues.length;r--;)(i=n.cues[r]).startTime>=e&&i.endTime<=t&&n.removeCue(i)},qu=function(e){return"number"===typeof e&&isFinite(e)},Hu=function(e){var t=e.startOfSegment,n=e.duration,r=e.segment,i=e.part,a=e.playlist,o=a.mediaSequence,s=a.id,u=a.segments,l=void 0===u?[]:u,d=e.mediaIndex,c=e.partIndex,f=e.timeline,h=l.length-1,p="mediaIndex/partIndex increment";e.getMediaInfoForTime?p="getMediaInfoForTime ("+e.getMediaInfoForTime+")":e.isSyncRequest&&(p="getSyncSegmentCandidate (isSyncRequest)");var g="number"===typeof c,m=e.segment.uri?"segment":"pre-segment",v=g?rs({preloadSegment:r})-1:0;return m+" ["+(o+d)+"/"+(o+h)+"]"+(g?" part ["+c+"/"+v+"]":"")+" segment start/end ["+r.start+" => "+r.end+"]"+(g?" part start/end ["+i.start+" => "+i.end+"]":"")+" startOfSegment ["+t+"] duration ["+n+"] timeline ["+f+"] selected by ["+p+"] playlist ["+s+"]"},Vu=function(e){return e+"TimingInfo"},Ku=function(e){var t=e.timelineChangeController,n=e.currentTimeline,r=e.segmentTimeline,i=e.loaderType,a=e.audioDisabled;if(n===r)return!1;if("audio"===i){var o=t.lastTimelineChange({type:"main"});return!o||o.to!==r}if("main"===i&&a){var s=t.pendingTimelineChange({type:"audio"});return!s||s.to!==r}return!1},Yu=function(e){var t=e.segmentDuration,n=e.maxDuration;return!!t&&Math.round(t)>n+1/30},Wu=function(e,t){if("hls"!==t)return null;var n=function(e,t){var n=e&&"number"===typeof e.start&&"number"===typeof e.end?e.end-e.start:0,r=t&&"number"===typeof t.start&&"number"===typeof t.end?t.end-t.start:0;return Math.max(n,r)}(e.audioTimingInfo,e.videoTimingInfo);if(!n)return null;var r=e.playlist.targetDuration,i=Yu({segmentDuration:n,maxDuration:2*r}),a=Yu({segmentDuration:n,maxDuration:r}),o="Segment with index "+e.mediaIndex+" from playlist "+e.playlist.id+" has a duration of "+n+" when the reported duration is "+e.duration+" and the target duration is "+r+". For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";return i||a?{severity:i?"warn":"info",message:o}:null},zu=function(e){function t(t,n){var r;if(r=e.call(this)||this,!t)throw new TypeError("Initialization settings are required");if("function"!==typeof t.currentTime)throw new TypeError("No currentTime getter specified");if(!t.mediaSource)throw new TypeError("No MediaSource specified");return r.bandwidth=t.bandwidth,r.throughput={rate:0,count:0},r.roundTrip=NaN,r.resetStats_(),r.mediaIndex=null,r.partIndex=null,r.hasPlayed_=t.hasPlayed,r.currentTime_=t.currentTime,r.seekable_=t.seekable,r.seeking_=t.seeking,r.duration_=t.duration,r.mediaSource_=t.mediaSource,r.vhs_=t.vhs,r.loaderType_=t.loaderType,r.currentMediaInfo_=void 0,r.startingMediaInfo_=void 0,r.segmentMetadataTrack_=t.segmentMetadataTrack,r.goalBufferLength_=t.goalBufferLength,r.sourceType_=t.sourceType,r.sourceUpdater_=t.sourceUpdater,r.inbandTextTracks_=t.inbandTextTracks,r.state_="INIT",r.timelineChangeController_=t.timelineChangeController,r.shouldSaveSegmentTimingInfo_=!0,r.parse708captions_=t.parse708captions,r.checkBufferTimeout_=null,r.error_=void 0,r.currentTimeline_=-1,r.pendingSegment_=null,r.xhrOptions_=null,r.pendingSegments_=[],r.audioDisabled_=!1,r.isPendingTimestampOffset_=!1,r.gopBuffer_=[],r.timeMapping_=0,r.safeAppend_=qo.browser.IE_VERSION>=11,r.appendInitSegment_={audio:!0,video:!0},r.playlistOfLastInitSegment_={audio:null,video:null},r.callQueue_=[],r.loadQueue_=[],r.metadataQueue_={id3:[],caption:[]},r.waitingOnRemove_=!1,r.quotaExceededErrorRetryTimeout_=null,r.activeInitSegmentId_=null,r.initSegments_={},r.cacheEncryptionKeys_=t.cacheEncryptionKeys,r.keyCache_={},r.decrypter_=t.decrypter,r.syncController_=t.syncController,r.syncPoint_={segmentIndex:0,time:0},r.transmuxer_=r.createTransmuxer_(),r.triggerSyncInfoUpdate_=function(){return r.trigger("syncinfoupdate")},r.syncController_.on("syncinfoupdate",r.triggerSyncInfoUpdate_),r.mediaSource_.addEventListener("sourceopen",function(){r.isEndOfStream_()||(r.ended_=!1)}),r.fetchAtBuffer_=!1,r.logger_=Wo("SegmentLoader["+r.loaderType_+"]"),Object.defineProperty(c()(r),"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e,this.trigger("statechange"))}}),r.sourceUpdater_.on("ready",function(){r.hasEnoughInfoToAppend_()&&r.processCallQueue_()}),"main"===r.loaderType_&&r.timelineChangeController_.on("pendingtimelinechange",function(){r.hasEnoughInfoToAppend_()&&r.processCallQueue_()}),"audio"===r.loaderType_&&r.timelineChangeController_.on("timelinechange",function(){r.hasEnoughInfoToLoad_()&&r.processLoadQueue_(),r.hasEnoughInfoToAppend_()&&r.processCallQueue_()}),r}h()(t,e);var n=t.prototype;return n.createTransmuxer_=function(){return fu({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_})},n.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0},n.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&a.a.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},n.setAudio=function(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},n.abort=function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)},n.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,a.a.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null},n.checkForAbort_=function(e){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==e:(this.state="READY",!0)},n.error=function(e){return"undefined"!==typeof e&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_},n.endOfStream=function(){this.ended_=!0,this.transmuxer_&&cu(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},n.buffered_=function(){if(!this.sourceUpdater_||!this.startingMediaInfo_)return qo.createTimeRanges();if("main"===this.loaderType_){var e=this.startingMediaInfo_,t=e.hasAudio,n=e.hasVideo,r=e.isMuxed;if(n&&t&&!this.audioDisabled_&&!r)return this.sourceUpdater_.buffered();if(n)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},n.initSegmentForMap=function(e,t){if(void 0===t&&(t=!1),!e)return null;var n=Gs(e),r=this.initSegments_[n];return t&&!r&&e.bytes&&(this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),r||e},n.segmentKey=function(e,t){if(void 0===t&&(t=!1),!e)return null;var n=qs(e),r=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!r&&e.bytes&&(this.keyCache_[n]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});var i={resolvedUri:(r||e).resolvedUri};return r&&(i.bytes=r.bytes),i},n.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},n.load=function(){if(this.monitorBuffer_(),this.playlist_)return"INIT"===this.state&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY"))},n.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},n.playlist=function(e,t){if(void 0===t&&(t={}),e){var n=this.playlist_,r=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,"INIT"===this.state&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(e));var i=null;if(n&&(n.id?i=n.id:n.uri&&(i=n.uri)),this.logger_("playlist update ["+i+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!n||n.uri!==e.uri)return null!==this.mediaIndex&&this.resyncLoader(),this.currentMediaInfo_=void 0,void this.trigger("playlistupdate");var a=e.mediaSequence-n.mediaSequence;if(this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex)if(this.mediaIndex-=a,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{var o=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!o.parts||!o.parts.length||!o.parts[this.partIndex])){var s=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists."),this.resetLoader(),this.mediaIndex=s}}r&&(r.mediaIndex-=a,r.mediaIndex<0?(r.mediaIndex=null,r.partIndex=null):(r.mediaIndex>=0&&(r.segment=e.segments[r.mediaIndex]),r.partIndex>=0&&r.segment.parts&&(r.part=r.segment.parts[r.partIndex]))),this.syncController_.saveExpiredSegmentInfo(n,e)}},n.pause=function(){this.checkBufferTimeout_&&(a.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},n.paused=function(){return null===this.checkBufferTimeout_},n.resetEverything=function(e){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"})},n.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},n.resyncLoader=function(){this.transmuxer_&&cu(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},n.remove=function(e,t,n,r){if(void 0===n&&(n=function(){}),void 0===r&&(r=!1),t===1/0&&(t=this.duration_()),t<=e)this.logger_("skipping remove because end ${end} is <= start ${start}");else if(this.sourceUpdater_&&this.startingMediaInfo_){var i=1,a=function(){0===--i&&n()};for(var o in!r&&this.audioDisabled_||(i++,this.sourceUpdater_.removeAudio(e,t,a)),(r||"main"===this.loaderType_)&&(this.gopBuffer_=function(e,t,n,r){for(var i=Math.ceil((t-r)*Ct.ONE_SECOND_IN_TS),a=Math.ceil((n-r)*Ct.ONE_SECOND_IN_TS),o=e.slice(),s=e.length;s--&&!(e[s].pts<=a););if(-1===s)return o;for(var u=s+1;u--&&!(e[u].pts<=i););return u=Math.max(u,0),o.splice(u,s-u+1),o}(this.gopBuffer_,e,t,this.timeMapping_),i++,this.sourceUpdater_.removeVideo(e,t,a)),this.inbandTextTracks_)Gu(e,t,this.inbandTextTracks_[o]);Gu(e,t,this.segmentMetadataTrack_),a()}else this.logger_("skipping remove because no source updater or starting media info")},n.monitorBuffer_=function(){this.checkBufferTimeout_&&a.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=a.a.setTimeout(this.monitorBufferTick_.bind(this),1)},n.monitorBufferTick_=function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&a.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=a.a.setTimeout(this.monitorBufferTick_.bind(this),500)},n.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){var e=this.chooseNextRequest_();e&&("number"===typeof e.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}},n.isEndOfStream_=function(e,t,n){if(void 0===e&&(e=this.mediaIndex),void 0===t&&(t=this.playlist_),void 0===n&&(n=this.partIndex),!t||!this.mediaSource_)return!1;var r="number"===typeof e&&t.segments[e],i=e+1===t.segments.length,a=!r||!r.parts||n+1===r.parts.length;return t.endList&&"open"===this.mediaSource_.readyState&&i&&a},n.chooseNextRequest_=function(){var e=Jo(this.buffered_())||0,t=Math.max(0,e-this.currentTime_()),n=!this.hasPlayed_()&&t>=1,r=t>=this.goalBufferLength_(),i=this.playlist_.segments;if(!i.length||n||r)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var a={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(a.isSyncRequest)a.mediaIndex=function(e,t,n){t=t||[];for(var r=[],i=0,a=0;a<t.length;a++){var o=t[a];if(e===o.timeline&&(r.push(a),(i+=o.duration)>n))return a}return 0===r.length?0:r[r.length-1]}(this.currentTimeline_,i,e);else if(null!==this.mediaIndex){var o=i[this.mediaIndex],s="number"===typeof this.partIndex?this.partIndex:-1;a.startOfSegment=o.end?o.end:e,o.parts&&o.parts[s+1]?(a.mediaIndex=this.mediaIndex,a.partIndex=s+1):a.mediaIndex=this.mediaIndex+1}else{var u=vs.getMediaInfoForTime({playlist:this.playlist_,currentTime:this.fetchAtBuffer_?e:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),l=u.segmentIndex,d=u.startTime,c=u.partIndex;a.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd":"currentTime",a.mediaIndex=l,a.startOfSegment=d,a.partIndex=c}var f=i[a.mediaIndex],h=f&&"number"===typeof a.partIndex&&f.parts&&f.parts[a.partIndex];if(!f||"number"===typeof a.partIndex&&!h)return null;"number"!==typeof a.partIndex&&f.parts&&(a.partIndex=0);var p=this.mediaSource_&&"ended"===this.mediaSource_.readyState;return a.mediaIndex>=i.length-1&&p&&!this.seeking_()?null:this.generateSegmentInfo_(a)},n.generateSegmentInfo_=function(e){var t=e.playlist,n=e.mediaIndex,r=e.startOfSegment,i=e.isSyncRequest,a=e.partIndex,o=e.forceTimestampOffset,s=e.getMediaInfoForTime,u=t.segments[n],l="number"===typeof a&&u.parts[a],d={requestId:"segment-loader-"+Math.random(),uri:l&&l.resolvedUri||u.resolvedUri,mediaIndex:n,partIndex:l?a:null,isSyncRequest:i,startOfSegment:r,playlist:t,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:u.timeline,duration:l&&l.duration||u.duration,segment:u,part:l,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:s},c="undefined"!==typeof o?o:this.isPendingTimestampOffset_;d.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:u.timeline,currentTimeline:this.currentTimeline_,startOfSegment:r,buffered:this.buffered_(),overrideCheck:c});var f=Jo(this.sourceUpdater_.audioBuffered());return"number"===typeof f&&(d.audioAppendStart=f-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(d.gopsToAlignWith=function(e,t,n){if("undefined"===typeof t||null===t||!e.length)return[];var r,i=Math.ceil((t-n+3)*Ct.ONE_SECOND_IN_TS);for(r=0;r<e.length&&!(e[r].pts>i);r++);return e.slice(r)}(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),d},n.timestampOffsetForSegment_=function(e){return function(e){var t=e.segmentTimeline,n=e.currentTimeline,r=e.startOfSegment,i=e.buffered;return e.overrideCheck||t!==n?t<n?r:i.length?i.end(i.length-1):r:null}(e)},n.earlyAbortWhenNeeded_=function(e){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)){var t=this.currentTime_(),n=e.bandwidth,r=this.pendingSegment_.duration,i=vs.estimateSegmentRequestTime(r,n,this.playlist_,e.bytesReceived),a=function(e,t,n){return void 0===n&&(n=1),((e.length?e.end(e.length-1):0)-t)/n}(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(!(i<=a)){var o=function(e){var t=e.master,n=e.currentTime,r=e.bandwidth,i=e.duration,a=e.segmentDuration,o=e.timeUntilRebuffer,s=e.currentTimeline,u=e.syncController,l=t.playlists.filter(function(e){return!vs.isIncompatible(e)}),d=l.filter(vs.isEnabled);d.length||(d=l.filter(function(e){return!vs.isDisabled(e)}));var c=d.filter(vs.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var t=u.getSyncPoint(e,i,s,n)?1:2;return{playlist:e,rebufferingImpact:vs.estimateSegmentRequestTime(a,r,e)*t-o}}),f=c.filter(function(e){return e.rebufferingImpact<=0});return xu(f,function(e,t){return Fu(t.playlist,e.playlist)}),f.length?f[0]:(xu(c,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),c[0]||null)}({master:this.vhs_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=i-a-o.rebufferingImpact,u=.5;a<=1/30&&(u=1),!o.playlist||o.playlist.uri===this.playlist_.uri||s<u||(this.bandwidth=o.playlist.attributes.BANDWIDTH*eu.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}},n.handleAbort_=function(e){this.logger_("Aborting "+Hu(e)),this.mediaRequestsAborted+=1},n.handleProgress_=function(e,t){this.earlyAbortWhenNeeded_(t.stats),this.checkForAbort_(t.requestId)||this.trigger("progress")},n.handleTrackInfo_=function(e,t){this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId)||this.checkForIllegalMediaSwitch(t)||(t=t||{},function(e,t){if(!e&&!t||!e&&t||e&&!t)return!1;if(e===t)return!0;var n=Object.keys(e).sort(),r=Object.keys(t).sort();if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(a!==r[i])return!1;if(e[a]!==t[a])return!1}return!0}(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),this.checkForAbort_(e.requestId)||(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))},n.handleTimingInfo_=function(e,t,n,r){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)){var i=this.pendingSegment_,a=Vu(t);i[a]=i[a]||{},i[a][n]=r,this.logger_("timinginfo: "+t+" - "+n+" - "+r),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},n.handleCaptions_=function(e,t){var n=this;if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(0!==t.length)if(this.pendingSegment_.hasAppendedData_){var r=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),i={};t.forEach(function(e){i[e.stream]=i[e.stream]||{startTime:1/0,captions:[],endTime:0};var t=i[e.stream];t.startTime=Math.min(t.startTime,e.startTime+r),t.endTime=Math.max(t.endTime,e.endTime+r),t.captions.push(e)}),Object.keys(i).forEach(function(e){var t=i[e],o=t.startTime,s=t.endTime,u=t.captions,l=n.inbandTextTracks_;n.logger_("adding cues from "+o+" -> "+s+" for "+e),function(e,t,n){if(!e[n]){t.trigger({type:"usage",name:"vhs-608"}),t.trigger({type:"usage",name:"hls-608"});var r=n;/^cc708_/.test(n)&&(r="SERVICE"+n.split("_")[1]);var i=t.textTracks().getTrackById(r);if(i)e[n]=i;else{var a=n,o=n,s=!1,u=(t.options_.vhs&&t.options_.vhs.captionServices||{})[r];u&&(a=u.label,o=u.language,s=u.default),e[n]=t.addRemoteTextTrack({kind:"captions",id:r,default:s,label:a,language:o},!1).track}}}(l,n.vhs_.tech_,e),Gu(o,s,l[e]),function(e){var t=e.inbandTextTracks,n=e.captionArray,r=e.timestampOffset;if(n){var i=a.a.WebKitDataCue||a.a.VTTCue;n.forEach(function(e){var n=e.stream;t[n].addCue(new i(e.startTime+r,e.endTime+r,e.text))})}}({captionArray:u,inbandTextTracks:l,timestampOffset:r})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));else this.logger_("SegmentLoader received no captions from a caption event")},n.handleId3_=function(e,t,n){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(this.pendingSegment_.hasAppendedData_){var r=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();!function(e,t,n){e.metadataTrack_||(e.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=t)}(this.inbandTextTracks_,n,this.vhs_.tech_),ju({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:r,videoDuration:this.duration_()})}else this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,n))},n.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(e){return e()}),this.metadataQueue_.caption.forEach(function(e){return e()}),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},n.processCallQueue_=function(){var e=this.callQueue_;this.callQueue_=[],e.forEach(function(e){return e()})},n.processLoadQueue_=function(){var e=this.loadQueue_;this.loadQueue_=[],e.forEach(function(e){return e()})},n.hasEnoughInfoToLoad_=function(){if("audio"!==this.loaderType_)return!0;var e=this.pendingSegment_;return!!e&&(!this.currentMediaInfo_||!Ku({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},n.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready())return!1;if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;var e=this.pendingSegment_;if(!e||!e.trackInfo)return!1;var t=this.currentMediaInfo_,n=t.hasAudio,r=t.hasVideo,i=t.isMuxed;return!(r&&!e.videoTimingInfo)&&(!(n&&!this.audioDisabled_&&!i&&!e.audioTimingInfo)&&!Ku({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},n.handleData_=function(e,t){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(!this.callQueue_.length&&this.hasEnoughInfoToAppend_()){var n=this.pendingSegment_;if(this.setTimeMapping_(n.timeline),this.updateMediaSecondsLoaded_(n.segment),"closed"!==this.mediaSource_.readyState){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),n.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),n.isFmp4=e.isFmp4,n.timingInfo=n.timingInfo||{},n.isFmp4)this.trigger("fmp4"),n.timingInfo.start=n[Vu(t.type)].start;else{var r,i="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo;i&&(r=n.videoTimingInfo.start),n.timingInfo.start=this.trueSegmentStart_({currentStart:n.timingInfo.start,playlist:n.playlist,mediaIndex:n.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:i,firstVideoFrameTimeForData:r,videoTimingInfo:n.videoTimingInfo,audioTimingInfo:n.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(n,t.type),this.updateSourceBufferTimestampOffset_(n),n.isSyncRequest){this.updateTimingInfoEnd_(n),this.syncController_.saveSegmentTimingInfo({segmentInfo:n,shouldSaveTimelineMapping:"main"===this.loaderType_});var a=this.chooseNextRequest_();if(a.mediaIndex!==n.mediaIndex||a.partIndex!==n.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}n.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(n,t)}}else this.callQueue_.push(this.handleData_.bind(this,e,t))},n.updateAppendInitSegmentStatus=function(e,t){"main"!==this.loaderType_||"number"!==typeof e.timestampOffset||e.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)},n.getInitSegmentAndUpdateState_=function(e){var t=e.type,n=e.initSegment,r=e.map,i=e.playlist;if(r){var a=Gs(r);if(this.activeInitSegmentId_===a)return null;n=this.initSegmentForMap(r,!0).bytes,this.activeInitSegmentId_=a}return n&&this.appendInitSegment_[t]?(this.playlistOfLastInitSegment_[t]=i,this.appendInitSegment_[t]=!1,this.activeInitSegmentId_=null,n):null},n.handleQuotaExceededError_=function(e,t){var n=this,r=e.segmentInfo,i=e.type,o=e.bytes,s=this.sourceUpdater_.audioBuffered(),u=this.sourceUpdater_.videoBuffered();s.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Zo(s).join(", ")),u.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Zo(u).join(", "));var l=s.length?s.start(0):0,d=s.length?s.end(s.length-1):0,c=u.length?u.start(0):0,f=u.length?u.end(u.length-1):0;if(d-l<=1&&f-c<=1)return this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: "+o.byteLength+", audio buffer: "+Zo(s).join(", ")+", video buffer: "+Zo(u).join(", ")+", "),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),void this.trigger("error");this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:r,type:i,bytes:o}));var h=this.currentTime_()-1;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+h),this.remove(0,h,function(){n.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),n.waitingOnRemove_=!1,n.quotaExceededErrorRetryTimeout_=a.a.setTimeout(function(){n.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),n.quotaExceededErrorRetryTimeout_=null,n.processCallQueue_()},1e3)},!0)},n.handleAppendError_=function(e,t){var n=e.segmentInfo,r=e.type,i=e.bytes;t&&(22!==t.code?(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",t),this.error(r+" append of "+i.length+"b failed for segment #"+n.mediaIndex+" in playlist "+n.playlist.id),this.trigger("appenderror")):this.handleQuotaExceededError_({segmentInfo:n,type:r,bytes:i}))},n.appendToSourceBuffer_=function(e){var t=e.segmentInfo,n=e.type,r=e.initSegment,i=e.data,a=e.bytes;if(!a){var o=[i],s=i.byteLength;r&&(o.unshift(r),s+=r.byteLength),a=function(e){var t,n=0;return e.bytes&&(t=new Uint8Array(e.bytes),e.segments.forEach(function(e){t.set(e,n),n+=e.byteLength})),t}({bytes:s,segments:o})}this.sourceUpdater_.appendBuffer({segmentInfo:t,type:n,bytes:a},this.handleAppendError_.bind(this,{segmentInfo:t,type:n,bytes:a}))},n.handleSegmentTimingInfo_=function(e,t,n){if(this.pendingSegment_&&t===this.pendingSegment_.requestId){var r=this.pendingSegment_.segment,i=e+"TimingInfo";r[i]||(r[i]={}),r[i].transmuxerPrependedSeconds=n.prependedContentDuration||0,r[i].transmuxedPresentationStart=n.start.presentation,r[i].transmuxedDecodeStart=n.start.decode,r[i].transmuxedPresentationEnd=n.end.presentation,r[i].transmuxedDecodeEnd=n.end.decode,r[i].baseMediaDecodeTime=n.baseMediaDecodeTime}},n.appendData_=function(e,t){var n=t.type,r=t.data;if(r&&r.byteLength&&("audio"!==n||!this.audioDisabled_)){var i=this.getInitSegmentAndUpdateState_({type:n,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:n,initSegment:i,data:r})}},n.loadSegment_=function(e){var t=this;this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),"number"===typeof e.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(e):this.loadQueue_.push(function(){var n=l()({},e,{forceTimestampOffset:!0});l()(e,t.generateSegmentInfo_(n)),t.isPendingTimestampOffset_=!1,t.updateTransmuxerAndRequestSegment_(e)})},n.updateTransmuxerAndRequestSegment_=function(e){var t=this;this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));var n=this.createSimplifiedSegmentObj_(e),r=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),i=null!==this.mediaIndex,a=e.timeline!==this.currentTimeline_&&e.timeline>0,o=r||i&&a;this.logger_("Requesting "+Hu(e)),n.map&&!n.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=Cu({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:n,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:o,endedTimelineFn:function(){t.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this)})},n.trimBackBuffer_=function(e){var t=function(e,t,n){var r=t-eu.BACK_BUFFER_LENGTH;e.length&&(r=Math.max(r,e.start(0)));var i=t-n;return Math.min(i,r)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)},n.createSimplifiedSegmentObj_=function(e){var t=e.segment,n=e.part,r={resolvedUri:n?n.resolvedUri:t.resolvedUri,byterange:n?n.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},i=e.playlist.segments[e.mediaIndex-1];if(i&&i.timeline===t.timeline&&(i.videoTimingInfo?r.baseStartTime=i.videoTimingInfo.transmuxedDecodeEnd:i.audioTimingInfo&&(r.baseStartTime=i.audioTimingInfo.transmuxedDecodeEnd)),t.key){var a=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);r.key=this.segmentKey(t.key),r.key.iv=a}return t.map&&(r.map=this.initSegmentForMap(t.map)),r},n.saveTransferStats_=function(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)},n.saveBandwidthRelatedStats_=function(e,t){this.pendingSegment_.byteLength=t.bytesReceived,e<1/60?this.logger_("Ignoring segment's bandwidth because its duration of "+e+" is less than the min to record "+1/60):(this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime)},n.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate")},n.segmentRequestFinished_=function(e,t,n){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,n));else if(this.saveTransferStats_(t.stats),this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId){if(e){if(this.pendingSegment_=null,this.state="READY",e.code===mu)return;return this.pause(),e.code===gu?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error"))}var r=this.pendingSegment_;this.saveBandwidthRelatedStats_(r.duration,t.stats),r.endOfAllRequests=t.endOfAllRequests,n.gopInfo&&(this.gopBuffer_=function(e,t,n){if(!t.length)return e;if(n)return t.slice();for(var r=t[0].pts,i=0;i<e.length&&!(e[i].pts>=r);i++);return e.slice(0,i).concat(t)}(this.gopBuffer_,n.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(r)}},n.setTimeMapping_=function(e){var t=this.syncController_.mappingForTimeline(e);null!==t&&(this.timeMapping_=t)},n.updateMediaSecondsLoaded_=function(e){"number"===typeof e.start&&"number"===typeof e.end?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration},n.shouldUpdateTransmuxerTimestampOffset_=function(e){return null!==e&&("main"===this.loaderType_&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset())},n.trueSegmentStart_=function(e){var t=e.currentStart,n=e.playlist,r=e.mediaIndex,i=e.firstVideoFrameTimeForData,a=e.currentVideoTimestampOffset,o=e.useVideoTimingInfo,s=e.videoTimingInfo,u=e.audioTimingInfo;if("undefined"!==typeof t)return t;if(!o)return u.start;var l=n.segments[r-1];return 0!==r&&l&&"undefined"!==typeof l.start&&l.end===i+a?s.start:i},n.waitForAppendsToComplete_=function(e){if(!this.currentMediaInfo_)return this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),void this.trigger("error");var t=this.currentMediaInfo_,n=t.hasAudio,r=t.hasVideo,i=t.isMuxed,a="main"===this.loaderType_&&r,o=!this.audioDisabled_&&n&&!i;if(e.waitingOnAppends=0,!e.hasAppendedData_)return e.timingInfo||"number"!==typeof e.timestampOffset||(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),void this.checkAppendsDone_(e);a&&e.waitingOnAppends++,o&&e.waitingOnAppends++,a&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),o&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))},n.checkAppendsDone_=function(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,0===e.waitingOnAppends&&this.handleAppendsDone_())},n.checkForIllegalMediaSwitch=function(e){var t=function(e,t,n){return"main"===e&&t&&n?n.hasAudio||n.hasVideo?t.hasVideo&&!n.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.hasVideo&&n.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.currentMediaInfo_,e);return!!t&&(this.error({message:t,blacklistDuration:1/0}),this.trigger("error"),!0)},n.updateSourceBufferTimestampOffset_=function(e){if(null!==e.timestampOffset&&"number"===typeof e.timingInfo.start&&!e.changedTimestampOffset&&"main"===this.loaderType_){var t=!1;e.timestampOffset-=e.timingInfo.start,e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}},n.updateTimingInfoEnd_=function(e){e.timingInfo=e.timingInfo||{};var t="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;t&&(e.timingInfo.end="number"===typeof t.end?t.end:t.start+e.duration)},n.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_;this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:"main"===this.loaderType_});var t=Wu(e,this.sourceType_);if(t&&("warn"===t.severity?qo.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",!e.isSyncRequest||(this.trigger("syncinfoupdate"),e.hasAppendedData_)){this.logger_("Appended "+Hu(e)),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");var n=e.segment;if(n.end&&this.currentTime_()-n.end>3*e.playlist.targetDuration)this.resetEverything();else null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}else this.logger_("Throwing away un-appended sync request "+Hu(e))},n.recordThroughput_=function(e){if(e.duration<1/60)this.logger_("Ignoring segment's throughput because its duration of "+e.duration+" is less than the min to record "+1/60);else{var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,r=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(r-t)/++this.throughput.count}},n.addSegmentMetadataCue_=function(e){if(this.segmentMetadataTrack_){var t=e.segment,n=t.start,r=t.end;if(qu(n)&&qu(r)){Gu(n,r,this.segmentMetadataTrack_);var i=a.a.WebKitDataCue||a.a.VTTCue,o={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:n,end:r},s=new i(n,r,JSON.stringify(o));s.value=o,this.segmentMetadataTrack_.addCue(s)}}},t}(qo.EventTarget);function Xu(){}var Qu,$u=function(e){return"string"!==typeof e?e:e.replace(/./,function(e){return e.toUpperCase()})},Zu=["video","audio"],Ju=function(e,t){var n=t[e+"Buffer"];return n&&n.updating||t.queuePending[e]},el=function e(t,n){if(0!==n.queue.length){var r=0,i=n.queue[r];if("mediaSource"!==i.type){if("mediaSource"!==t&&n.ready()&&"closed"!==n.mediaSource.readyState&&!Ju(t,n)){if(i.type!==t){if(null===(r=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("mediaSource"===r.type)return null;if(r.type===e)return n}return null}(t,n.queue)))return;i=n.queue[r]}return n.queue.splice(r,1),n.queuePending[t]=i,i.action(t,n),i.doneFn?void 0:(n.queuePending[t]=null,void e(t,n))}}else n.updating()||"closed"===n.mediaSource.readyState||(n.queue.shift(),i.action(n),i.doneFn&&i.doneFn(),e("audio",n),e("video",n))}},tl=function(e,t){var n=t[e+"Buffer"],r=$u(e);n&&(n.removeEventListener("updateend",t["on"+r+"UpdateEnd_"]),n.removeEventListener("error",t["on"+r+"Error_"]),t.codecs[e]=null,t[e+"Buffer"]=null)},nl=function(e,t){return e&&t&&-1!==Array.prototype.indexOf.call(e.sourceBuffers,t)},rl=function(e,t,n){return function(r,i){var a=i[r+"Buffer"];if(nl(i.mediaSource,a)){i.logger_("Appending segment "+t.mediaIndex+"'s "+e.length+" bytes to "+r+"Buffer");try{a.appendBuffer(e)}catch(o){i.logger_("Error with code "+o.code+" "+(22===o.code?"(QUOTA_EXCEEDED_ERR) ":"")+"when appending segment "+t.mediaIndex+" to "+r+"Buffer"),i.queuePending[r]=null,n(o)}}}},il=function(e,t){return function(n,r){var i=r[n+"Buffer"];if(nl(r.mediaSource,i)){r.logger_("Removing "+e+" to "+t+" from "+n+"Buffer");try{i.remove(e,t)}catch(a){r.logger_("Remove "+e+" to "+t+" from "+n+"Buffer failed")}}}},al=function(e){return function(t,n){var r=n[t+"Buffer"];nl(n.mediaSource,r)&&(n.logger_("Setting "+t+"timestampOffset to "+e),r.timestampOffset=e)}},ol=function(e){return function(t,n){e()}},sl=function(e){return function(t){if("open"===t.mediaSource.readyState){t.logger_("Calling mediaSource endOfStream("+(e||"")+")");try{t.mediaSource.endOfStream(e)}catch(n){qo.log.warn("Failed to call media source endOfStream",n)}}}},ul=function(e){return function(t){t.logger_("Setting mediaSource duration to "+e);try{t.mediaSource.duration=e}catch(n){qo.log.warn("Failed to set media source duration",n)}}},ll=function(){return function(e,t){if("open"===t.mediaSource.readyState){var n=t[e+"Buffer"];if(nl(t.mediaSource,n)){t.logger_("calling abort on "+e+"Buffer");try{n.abort()}catch(r){qo.log.warn("Failed to abort on "+e+"Buffer",r)}}}}},dl=function(e,t){return function(n){var r=$u(e),i=$(t);n.logger_("Adding "+e+"Buffer with codec "+t+" to mediaSource");var a=n.mediaSource.addSourceBuffer(i);a.addEventListener("updateend",n["on"+r+"UpdateEnd_"]),a.addEventListener("error",n["on"+r+"Error_"]),n.codecs[e]=t,n[e+"Buffer"]=a}},cl=function(e){return function(t){var n=t[e+"Buffer"];if(tl(e,t),nl(t.mediaSource,n)){t.logger_("Removing "+e+"Buffer with codec "+t.codecs[e]+" from mediaSource");try{t.mediaSource.removeSourceBuffer(n)}catch(r){qo.log.warn("Failed to removeSourceBuffer "+e+"Buffer",r)}}}},fl=function(e){return function(t,n){var r=n[t+"Buffer"],i=$(e);nl(n.mediaSource,r)&&n.codecs[t]!==e&&(n.logger_("changing "+t+"Buffer codec from "+n.codecs[t]+" to "+e),r.changeType(i),n.codecs[t]=e)}},hl=function(e){var t=e.type,n=e.sourceUpdater,r=e.action,i=e.doneFn,a=e.name;n.queue.push({type:t,action:r,doneFn:i,name:a}),el(t,n)},pl=function(e,t){return function(n){if(t.queuePending[e]){var r=t.queuePending[e].doneFn;t.queuePending[e]=null,r&&r(t[e+"Error_"])}el(e,t)}},gl=function(e){function t(t){var n;return(n=e.call(this)||this).mediaSource=t,n.sourceopenListener_=function(){return el("mediaSource",c()(n))},n.mediaSource.addEventListener("sourceopen",n.sourceopenListener_),n.logger_=Wo("SourceUpdater"),n.audioTimestampOffset_=0,n.videoTimestampOffset_=0,n.queue=[],n.queuePending={audio:null,video:null},n.delayedAudioAppendQueue_=[],n.videoAppendQueued_=!1,n.codecs={},n.onVideoUpdateEnd_=pl("video",c()(n)),n.onAudioUpdateEnd_=pl("audio",c()(n)),n.onVideoError_=function(e){n.videoError_=e},n.onAudioError_=function(e){n.audioError_=e},n.createdSourceBuffers_=!1,n.initializedEme_=!1,n.triggeredReady_=!1,n}h()(t,e);var n=t.prototype;return n.initializedEme=function(){this.initializedEme_=!0,this.triggerReady()},n.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_},n.hasInitializedAnyEme=function(){return this.initializedEme_},n.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},n.createSourceBuffers=function(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},n.triggerReady=function(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},n.addSourceBuffer=function(e,t){hl({type:"mediaSource",sourceUpdater:this,action:dl(e,t),name:"addSourceBuffer"})},n.abort=function(e){hl({type:e,sourceUpdater:this,action:ll(e),name:"abort"})},n.removeSourceBuffer=function(e){this.canRemoveSourceBuffer()?hl({type:"mediaSource",sourceUpdater:this,action:cl(e),name:"removeSourceBuffer"}):qo.log.error("removeSourceBuffer is not supported!")},n.canRemoveSourceBuffer=function(){return!qo.browser.IE_VERSION&&!qo.browser.IS_FIREFOX&&a.a.MediaSource&&a.a.MediaSource.prototype&&"function"===typeof a.a.MediaSource.prototype.removeSourceBuffer},t.canChangeType=function(){return a.a.SourceBuffer&&a.a.SourceBuffer.prototype&&"function"===typeof a.a.SourceBuffer.prototype.changeType},n.canChangeType=function(){return this.constructor.canChangeType()},n.changeType=function(e,t){this.canChangeType()?hl({type:e,sourceUpdater:this,action:fl(t),name:"changeType"}):qo.log.error("changeType is not supported!")},n.addOrChangeSourceBuffers=function(e){var t=this;if(!e||"object"!==typeof e||0===Object.keys(e).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(function(n){var r=e[n];if(!t.hasCreatedSourceBuffers())return t.addSourceBuffer(n,r);t.canChangeType()&&t.changeType(n,r)})},n.appendBuffer=function(e,t){var n=this,r=e.segmentInfo,i=e.type,a=e.bytes;if(this.processedAppend_=!0,"audio"===i&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([e,t]),void this.logger_("delayed audio append of "+a.length+" until video append");if(hl({type:i,sourceUpdater:this,action:rl(a,r||{mediaIndex:-1},t),doneFn:t,name:"appendBuffer"}),"video"===i){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var o=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+o.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,o.forEach(function(e){n.appendBuffer.apply(n,e)})}},n.audioBuffered=function(){return nl(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:qo.createTimeRange()},n.videoBuffered=function(){return nl(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:qo.createTimeRange()},n.buffered=function(){var e=nl(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=nl(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():function(e,t){var n=null,r=null,i=0,a=[],o=[];if(!e||!e.length||!t||!t.length)return qo.createTimeRange();for(var s=e.length;s--;)a.push({time:e.start(s),type:"start"}),a.push({time:e.end(s),type:"end"});for(s=t.length;s--;)a.push({time:t.start(s),type:"start"}),a.push({time:t.end(s),type:"end"});for(a.sort(function(e,t){return e.time-t.time}),s=0;s<a.length;s++)"start"===a[s].type?2===++i&&(n=a[s].time):"end"===a[s].type&&1===--i&&(r=a[s].time),null!==n&&null!==r&&(o.push([n,r]),n=null,r=null);return qo.createTimeRanges(o)}(this.audioBuffered(),this.videoBuffered())},n.setDuration=function(e,t){void 0===t&&(t=Xu),hl({type:"mediaSource",sourceUpdater:this,action:ul(e),name:"duration",doneFn:t})},n.endOfStream=function(e,t){void 0===e&&(e=null),void 0===t&&(t=Xu),"string"!==typeof e&&(e=void 0),hl({type:"mediaSource",sourceUpdater:this,action:sl(e),name:"endOfStream",doneFn:t})},n.removeAudio=function(e,t,n){void 0===n&&(n=Xu),this.audioBuffered().length&&0!==this.audioBuffered().end(0)?hl({type:"audio",sourceUpdater:this,action:il(e,t),doneFn:n,name:"remove"}):n()},n.removeVideo=function(e,t,n){void 0===n&&(n=Xu),this.videoBuffered().length&&0!==this.videoBuffered().end(0)?hl({type:"video",sourceUpdater:this,action:il(e,t),doneFn:n,name:"remove"}):n()},n.updating=function(){return!(!Ju("audio",this)&&!Ju("video",this))},n.audioTimestampOffset=function(e){return"undefined"!==typeof e&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(hl({type:"audio",sourceUpdater:this,action:al(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_},n.videoTimestampOffset=function(e){return"undefined"!==typeof e&&this.videoBuffer&&this.videoTimestampOffset!==e&&(hl({type:"video",sourceUpdater:this,action:al(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_},n.audioQueueCallback=function(e){this.audioBuffer&&hl({type:"audio",sourceUpdater:this,action:ol(e),name:"callback"})},n.videoQueueCallback=function(e){this.videoBuffer&&hl({type:"video",sourceUpdater:this,action:ol(e),name:"callback"})},n.dispose=function(){var e=this;this.trigger("dispose"),Zu.forEach(function(t){e.abort(t),e.canRemoveSourceBuffer()?e.removeSourceBuffer(t):e[t+"QueueCallback"](function(){return tl(t,e)})}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},t}(qo.EventTarget),ml=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},vl=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)})),yl=function(e){function t(t,n){var r;return void 0===n&&(n={}),(r=e.call(this,t,n)||this).mediaSource_=null,r.subtitlesTrack_=null,r.loaderType_="subtitle",r.featuresNativeTextTracks_=t.featuresNativeTextTracks,r.shouldSaveSegmentTimingInfo_=!1,r}h()(t,e);var n=t.prototype;return n.createTransmuxer_=function(){return null},n.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return qo.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return qo.createTimeRanges([[t,n]])},n.initSegmentForMap=function(e,t){if(void 0===t&&(t=!1),!e)return null;var n=Gs(e),r=this.initSegments_[n];if(t&&!r&&e.bytes){var i=vl.byteLength+e.bytes.byteLength,a=new Uint8Array(i);a.set(e.bytes),a.set(vl,e.bytes.byteLength),this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return r||e},n.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},n.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},n.track=function(e){return"undefined"===typeof e?this.subtitlesTrack_:(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)},n.remove=function(e,t){Gu(e,t,this.subtitlesTrack_)},n.fillBuffer_=function(){var e=this,t=this.chooseNextRequest_();if(t){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(t)}},n.timestampOffsetForSegment_=function(){return null},n.chooseNextRequest_=function(){return this.skipEmptySegments_(e.prototype.chooseNextRequest_.call(this))},n.skipEmptySegments_=function(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e},n.stopForError=function(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")},n.segmentRequestFinished_=function(e,t,n){var r=this;if(this.subtitlesTrack_){if(this.saveTransferStats_(t.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(e)return e.code===gu&&this.handleTimeout_(),e.code===mu?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(e);var i=this.pendingSegment_;this.saveBandwidthRelatedStats_(i.duration,t.stats),this.state="APPENDING",this.trigger("appending");var o=i.segment;if(o.map&&(o.map.bytes=t.map.bytes),i.bytes=t.bytes,"function"!==typeof a.a.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var s,u=function(){r.subtitlesTrack_.tech_.off("vttjsloaded",s),r.stopForError({message:"Error loading vtt.js"})};return s=function(){r.subtitlesTrack_.tech_.off("vttjserror",u),r.segmentRequestFinished_(e,t,n)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",s),void this.subtitlesTrack_.tech_.one("vttjserror",u)}o.requested=!0;try{this.parseVTTCues_(i)}catch(l){return void this.stopForError({message:l.message})}if(this.updateTimeMapping_(i,this.syncController_.timelines[i.timeline],this.playlist_),i.cues.length?i.timingInfo={start:i.cues[0].startTime,end:i.cues[i.cues.length-1].endTime}:i.timingInfo={start:i.startOfSegment,end:i.startOfSegment+i.duration},i.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");i.byteLength=i.bytes.byteLength,this.mediaSecondsLoaded+=o.duration,i.cues.forEach(function(e){r.subtitlesTrack_.addCue(r.featuresNativeTextTracks_?new a.a.VTTCue(e.startTime,e.endTime,e.text):e)}),function(e){var t=e.cues;if(t)for(var n=0;n<t.length;n++){for(var r=[],i=0,a=0;a<t.length;a++)t[n].startTime===t[a].startTime&&t[n].endTime===t[a].endTime&&t[n].text===t[a].text&&++i>1&&r.push(t[a]);r.length&&r.forEach(function(t){return e.removeCue(t)})}}(this.subtitlesTrack_),this.handleAppendsDone_()}else this.state="READY"},n.handleData_=function(){},n.updateTimingInfoEnd_=function(){},n.parseVTTCues_=function(e){var t,n=!1;"function"===typeof a.a.TextDecoder?t=new a.a.TextDecoder("utf8"):(t=a.a.WebVTT.StringDecoder(),n=!0);var r=new a.a.WebVTT.Parser(a.a,a.a.vttjs,t);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=e.cues.push.bind(e.cues),r.ontimestampmap=function(t){e.timestampmap=t},r.onparsingerror=function(e){qo.log.warn("Error encountered when parsing cues: "+e.message)},e.segment.map){var i=e.segment.map.bytes;n&&(i=ml(i)),r.parse(i)}var o=e.bytes;n&&(o=ml(o)),r.parse(o),r.flush()},n.updateTimeMapping_=function(e,t,n){var r=e.segment;if(t)if(e.cues.length){var i=e.timestampmap,a=i.MPEGTS/Ct.ONE_SECOND_IN_TS-i.LOCAL+t.mapping;if(e.cues.forEach(function(e){e.startTime+=a,e.endTime+=a}),!n.syncInfo){var o=e.cues[0].startTime,s=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(o,s-r.duration)}}}else r.empty=!0},t}(zu),_l=function(e,t){for(var n=e.cues,r=0;r<n.length;r++){var i=n[r];if(t>=i.adStartTime&&t<=i.adEndTime)return i}return null},Tl=[{name:"VOD",run:function(e,t,n,r,i){if(n!==1/0){return{time:0,segmentIndex:0,partIndex:null}}return null}},{name:"ProgramDateTime",run:function(e,t,n,r,i){if(!Object.keys(e.timelineToDatetimeMappings).length)return null;var a=null,o=null,s=ts(t);i=i||0;for(var u=0;u<s.length;u++){var l=s[t.endList||0===i?u:s.length-(u+1)],d=l.segment,c=e.timelineToDatetimeMappings[d.timeline];if(c&&d.dateTimeObject){var f=d.dateTimeObject.getTime()/1e3+c;if(d.parts&&"number"===typeof l.partIndex)for(var h=0;h<l.partIndex;h++)f+=d.parts[h].duration;var p=Math.abs(i-f);if(null!==o&&(0===p||o<p))break;o=p,a={time:f,segmentIndex:l.segmentIndex,partIndex:l.partIndex}}}return a}},{name:"Segment",run:function(e,t,n,r,i){var a=null,o=null;i=i||0;for(var s=ts(t),u=0;u<s.length;u++){var l=s[t.endList||0===i?u:s.length-(u+1)],d=l.segment,c=l.part&&l.part.start||d&&d.start;if(d.timeline===r&&"undefined"!==typeof c){var f=Math.abs(i-c);if(null!==o&&o<f)break;(!a||null===o||o>=f)&&(o=f,a={time:c,segmentIndex:l.segmentIndex,partIndex:l.partIndex})}}return a}},{name:"Discontinuity",run:function(e,t,n,r,i){var a=null;if(i=i||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var u=t.discontinuityStarts[s],l=t.discontinuitySequence+s+1,d=e.discontinuities[l];if(d){var c=Math.abs(i-d.time);if(null!==o&&o<c)break;(!a||null===o||o>=c)&&(o=c,a={time:d.time,segmentIndex:u,partIndex:null})}}return a}},{name:"Playlist",run:function(e,t,n,r,i){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence,partIndex:null}:null}}],El=function(e){function t(t){var n;return(n=e.call(this)||this).timelines=[],n.discontinuities=[],n.timelineToDatetimeMappings={},n.logger_=Wo("SyncController"),n}h()(t,e);var n=t.prototype;return n.getSyncPoint=function(e,t,n,r){var i=this.runStrategies_(e,t,n,r);return i.length?this.selectSyncPoint_(i,{key:"time",value:r}):null},n.getExpiredTime=function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var r=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return r.segmentIndex>0&&(r.time*=-1),Math.abs(r.time+ss({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:r.segmentIndex,endIndex:0}))},n.runStrategies_=function(e,t,n,r){for(var i=[],a=0;a<Tl.length;a++){var o=Tl[a],s=o.run(this,e,t,n,r);s&&(s.strategy=o.name,i.push({strategy:o.name,syncPoint:s}))}return i},n.selectSyncPoint_=function(e,t){for(var n=e[0].syncPoint,r=Math.abs(e[0].syncPoint[t.key]-t.value),i=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<r&&(r=o,n=e[a].syncPoint,i=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+i+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+("number"===typeof n.partIndex?",partIndex:"+n.partIndex:"")+"]"),n},n.saveExpiredSegmentInfo=function(e,t){for(var n=t.mediaSequence-e.mediaSequence-1;n>=0;n--){var r=e.segments[n];if(r&&"undefined"!==typeof r.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:r.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}},n.setDateTimeMappingForStart=function(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0],n=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-n}},n.saveSegmentTimingInfo=function(e){var t=e.segmentInfo,n=e.shouldSaveTimelineMapping,r=this.calculateSegmentTimeMapping_(t,t.timingInfo,n),i=t.segment;r&&(this.saveDiscontinuitySyncInfo_(t),t.playlist.syncInfo||(t.playlist.syncInfo={mediaSequence:t.playlist.mediaSequence+t.mediaIndex,time:i.start}));var a=i.dateTimeObject;i.discontinuity&&n&&a&&(this.timelineToDatetimeMappings[i.timeline]=-a.getTime()/1e3)},n.timestampOffsetForTimeline=function(e){return"undefined"===typeof this.timelines[e]?null:this.timelines[e].time},n.mappingForTimeline=function(e){return"undefined"===typeof this.timelines[e]?null:this.timelines[e].mapping},n.calculateSegmentTimeMapping_=function(e,t,n){var r,i,a=e.segment,o=e.part,s=this.timelines[e.timeline];if("number"===typeof e.timestampOffset)s={time:e.startOfSegment,mapping:e.startOfSegment-t.start},n&&(this.timelines[e.timeline]=s,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+s.time+"] [mapping: "+s.mapping+"]")),r=e.startOfSegment,i=t.end+s.mapping;else{if(!s)return!1;r=t.start+s.mapping,i=t.end+s.mapping}return o&&(o.start=r,o.end=i),(!a.start||r<a.start)&&(a.start=r),a.end=i,!0},n.saveDiscontinuitySyncInfo_=function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var r=0;r<t.discontinuityStarts.length;r++){var i=t.discontinuityStarts[r],a=t.discontinuitySequence+r+1,o=i-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var u=void 0;u=o<0?n.start-ss({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:i}):n.end+ss({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:i}),this.discontinuities[a]={time:u,accuracy:s}}}},n.dispose=function(){this.trigger("dispose"),this.off()},t}(qo.EventTarget),bl=function(e){function t(){var t;return(t=e.call(this)||this).pendingTimelineChanges_={},t.lastTimelineChanges_={},t}h()(t,e);var n=t.prototype;return n.clearPendingTimelineChange=function(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")},n.pendingTimelineChange=function(e){var t=e.type,n=e.from,r=e.to;return"number"===typeof n&&"number"===typeof r&&(this.pendingTimelineChanges_[t]={type:t,from:n,to:r},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[t]},n.lastTimelineChange=function(e){var t=e.type,n=e.from,r=e.to;return"number"===typeof n&&"number"===typeof r&&(this.lastTimelineChanges_[t]={type:t,from:n,to:r},delete this.pendingTimelineChanges_[t],this.trigger("timelinechange")),this.lastTimelineChanges_[t]},n.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},t}(qo.EventTarget),Sl=nu(ru(iu(function(){function e(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}((void 0===t||null===t)&&n.path)}},n.exports),n.exports}var t=e(function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0}),n=e(function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(n,r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}),r=e(function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0}),i=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,r=0;r<n;++r)t[r].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,i)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",function(t){e.push(t)})},e}();var a=function(){var e,t,n,r,i,a,o,s,u=[[[],[],[],[],[]],[[],[],[],[],[]]],l=u[0],d=u[1],c=l[4],f=d[4],h=[],p=[];for(e=0;e<256;e++)p[(h[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!c[t];t^=r||1,n=p[n]||1)for(a=(a=n^n<<1^n<<2^n<<3^n<<4)>>8^255&a^99,c[t]=a,f[a]=t,s=16843009*h[i=h[r=h[t]]]^65537*i^257*r^16843008*t,o=257*h[a]^16843008*a,e=0;e<4;e++)l[e][t]=o=o<<24^o>>>8,d[e][a]=s=s<<24^s>>>8;for(e=0;e<5;e++)l[e]=l[e].slice(0),d[e]=d[e].slice(0);return u},o=null,s=function(){function e(e){var t,n,r;o||(o=a()),this._tables=[[o[0][0].slice(),o[0][1].slice(),o[0][2].slice(),o[0][3].slice(),o[0][4].slice()],[o[1][0].slice(),o[1][1].slice(),o[1][2].slice(),o[1][3].slice(),o[1][4].slice()]];var i=this._tables[0][4],s=this._tables[1],u=e.length,l=1;if(4!==u&&6!==u&&8!==u)throw new Error("Invalid aes key size");var d=e.slice(0),c=[];for(this._key=[d,c],t=u;t<4*u+28;t++)r=d[t-1],(t%u===0||8===u&&t%u===4)&&(r=i[r>>>24]<<24^i[r>>16&255]<<16^i[r>>8&255]<<8^i[255&r],t%u===0&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7))),d[t]=d[t-u]^r;for(n=0;t;n++,t--)r=d[3&n?t:t-4],c[n]=t<=4||n<4?r:s[0][i[r>>>24]]^s[1][i[r>>16&255]]^s[2][i[r>>8&255]]^s[3][i[255&r]]}return e.prototype.decrypt=function(e,t,n,r,i,a){var o,s,u,l,d=this._key[1],c=e^d[0],f=r^d[1],h=n^d[2],p=t^d[3],g=d.length/4-2,m=4,v=this._tables[1],y=v[0],_=v[1],T=v[2],E=v[3],b=v[4];for(l=0;l<g;l++)o=y[c>>>24]^_[f>>16&255]^T[h>>8&255]^E[255&p]^d[m],s=y[f>>>24]^_[h>>16&255]^T[p>>8&255]^E[255&c]^d[m+1],u=y[h>>>24]^_[p>>16&255]^T[c>>8&255]^E[255&f]^d[m+2],p=y[p>>>24]^_[c>>16&255]^T[f>>8&255]^E[255&h]^d[m+3],m+=4,c=o,f=s,h=u;for(l=0;l<4;l++)i[(3&-l)+a]=b[c>>>24]<<24^b[f>>16&255]<<16^b[h>>8&255]<<8^b[255&p]^d[m++],o=c,c=f,f=h,h=p,p=o},e}(),u=function(e){function t(){var t;return(t=e.call(this,i)||this).jobs=[],t.delay=1,t.timeout_=null,t}r(t,e);var n=t.prototype;return n.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},n.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(i),l=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},d=function(){function e(t,n,r,i){var a=e.STEP,o=new Int32Array(t.buffer),s=new Uint8Array(t.byteLength),d=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(o.subarray(d,d+a),n,r,s)),d=a;d<o.length;d+=a)r=new Uint32Array([l(o[d-4]),l(o[d-3]),l(o[d-2]),l(o[d-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(d,d+a),n,r,s));this.asyncStream_.push(function(){var e;i(null,(e=s).subarray(0,e.byteLength-e[e.byteLength-1]))})}return e.prototype.decryptChunk_=function(e,t,n,r){return function(){var i=function(e,t,n){var r,i,a,o,u,d,c,f,h,p=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),g=new s(Array.prototype.slice.call(t)),m=new Uint8Array(e.byteLength),v=new Int32Array(m.buffer);for(r=n[0],i=n[1],a=n[2],o=n[3],h=0;h<p.length;h+=4)u=l(p[h]),d=l(p[h+1]),c=l(p[h+2]),f=l(p[h+3]),g.decrypt(u,d,c,f,v,h),v[h]=l(v[h]^r),v[h+1]=l(v[h+1]^i),v[h+2]=l(v[h+2]^a),v[h+3]=l(v[h+3]^o),r=u,i=d,a=c,o=f;return m}(e,t,n);r.set(i,e.byteOffset)}},t(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}();self.onmessage=function(e){var t=e.data,n=new Uint8Array(t.encrypted.bytes,t.encrypted.byteOffset,t.encrypted.byteLength),r=new Uint32Array(t.key.bytes,t.key.byteOffset,t.key.byteLength/4),i=new Uint32Array(t.iv.bytes,t.iv.byteOffset,t.iv.byteLength/4);new d(n,r,i,function(e,n){self.postMessage(function(e){var t={};return Object.keys(e).forEach(function(n){var r=e[n];ArrayBuffer.isView(r)?t[n]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:t[n]=r}),t}({source:t.source,decrypted:n}),[n.buffer])})}}))),Al=function(e){var t=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},wl=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},Il=function(e,t){t.activePlaylistLoader=e,e.load()},Cl={AUDIO:function(e,t){return function(){var n=t.segmentLoaders[e],r=t.mediaTypes[e],i=t.blacklistCurrentPlaylist;wl(n,r);var a=r.activeTrack(),o=r.activeGroup(),s=(o.filter(function(e){return e.default})[0]||o[0]).id,u=r.tracks[s];if(a!==u){for(var l in qo.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),r.tracks)r.tracks[l].enabled=r.tracks[l]===u;r.onTrackChanged()}else i({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var n=t.segmentLoaders[e],r=t.mediaTypes[e];qo.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),wl(n,r);var i=r.activeTrack();i&&(i.mode="disabled"),r.onTrackChanged()}}},Rl={AUDIO:function(e,t,n){if(t){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,i),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),i),r.paused()||a.load()}),t.on("error",Cl[e](e,n))}},SUBTITLES:function(e,t,n){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e],o=n.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,i),a.track(o.activeTrack()),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),i),r.paused()||a.load()}),t.on("error",Cl[e](e,n))}},Dl={AUDIO:function(e,t){var n=t.vhs,r=t.sourceType,i=t.segmentLoaders[e],a=t.requestOptions,o=t.master.mediaGroups,s=t.mediaTypes[e],u=s.groups,l=s.tracks,d=s.logger_,c=t.masterPlaylistLoader,f=ms(c.master);for(var h in o[e]&&0!==Object.keys(o[e]).length||(o[e]={main:{default:{default:!0}}}),o[e])for(var p in u[h]||(u[h]=[]),o[e][h]){var g=o[e][h][p],m=void 0;if(f?(d("AUDIO group '"+h+"' label '"+p+"' is a master playlist"),g.isMasterPlaylist=!0,m=null):m="vhs-json"===r&&g.playlists?new Os(g.playlists[0],n,a):g.resolvedUri?new Os(g.resolvedUri,n,a):g.playlists&&"dash"===r?new Js(g.playlists[0],n,a,c):null,g=qo.mergeOptions({id:p,playlistLoader:m},g),Rl[e](e,g.playlistLoader,t),u[h].push(g),"undefined"===typeof l[p]){var v=new qo.AudioTrack({id:p,kind:Al(g),enabled:!1,language:g.language,default:g.default,label:p});l[p]=v}}i.on("error",Cl[e](e,t))},SUBTITLES:function(e,t){var n=t.tech,r=t.vhs,i=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions,s=t.master.mediaGroups,u=t.mediaTypes[e],l=u.groups,d=u.tracks,c=t.masterPlaylistLoader;for(var f in s[e])for(var h in l[f]||(l[f]=[]),s[e][f])if(!s[e][f][h].forced){var p=s[e][f][h],g=void 0;if("hls"===i)g=new Os(p.resolvedUri,r,o);else if("dash"===i){if(!p.playlists.filter(function(e){return e.excludeUntil!==1/0}).length)return;g=new Js(p.playlists[0],r,o,c)}else"vhs-json"===i&&(g=new Os(p.playlists?p.playlists[0]:p.resolvedUri,r,o));if(p=qo.mergeOptions({id:h,playlistLoader:g},p),Rl[e](e,p.playlistLoader,t),l[f].push(p),"undefined"===typeof d[h]){var m=n.addRemoteTextTrack({id:h,kind:"subtitles",default:p.default&&p.autoselect,language:p.language,label:h},!1).track;d[h]=m}}a.on("error",Cl[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var n=t.tech,r=t.master.mediaGroups,i=t.mediaTypes[e],a=i.groups,o=i.tracks;for(var s in r[e])for(var u in a[s]||(a[s]=[]),r[e][s]){var l=r[e][s][u];if(/^(?:CC|SERVICE)/.test(l.instreamId)){var d=n.options_.vhs&&n.options_.vhs.captionServices||{},c={label:u,language:l.language,instreamId:l.instreamId,default:l.default&&l.autoselect};if(d[c.instreamId]&&(c=qo.mergeOptions(c,d[c.instreamId])),void 0===c.default&&delete c.default,a[s].push(qo.mergeOptions({id:u},l)),"undefined"===typeof o[u]){var f=n.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c.default,language:c.language,label:c.label},!1).track;o[u]=f}}}}},Ml=function e(t,n){for(var r=0;r<t.length;r++){if(ps(n,t[r]))return!0;if(t[r].playlists&&e(t[r].playlists,n))return!0}return!1},Ol={AUDIO:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var r in n)if(n[r].enabled)return n[r];return null}},SUBTITLES:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var r in n)if("showing"===n[r].mode||"hidden"===n[r].mode)return n[r];return null}}},Nl=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){Dl[t](t,e)});var t=e.mediaTypes,n=e.masterPlaylistLoader,r=e.tech,i=e.vhs,a=e.segmentLoaders,o=a.AUDIO,s=a.main;["AUDIO","SUBTITLES"].forEach(function(n){t[n].activeGroup=function(e,t){return function(n){var r=t.masterPlaylistLoader,i=t.mediaTypes[e].groups,a=r.media();if(!a)return null;var o=null;a.attributes[e]&&(o=i[a.attributes[e]]);var s=Object.keys(i);if(!o)if("AUDIO"===e&&s.length>1&&ms(t.master))for(var u=0;u<s.length;u++){var l=i[s[u]];if(Ml(l,a)){o=l;break}}else i.main?o=i.main:1===s.length&&(o=i[s[0]]);return"undefined"===typeof n?o:null!==n&&o&&o.filter(function(e){return e.id===n.id})[0]||null}}(n,e),t[n].activeTrack=Ol[n](n,e),t[n].onGroupChanged=function(e,t){return function(){var n=t.segmentLoaders,r=n[e],i=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.getActiveGroup(),u=a.activePlaylistLoader,l=a.lastGroup_;s&&l&&s.id===l.id||(a.lastGroup_=s,a.lastTrack_=o,wl(r,a),s&&!s.isMasterPlaylist&&(s.playlistLoader?(r.resyncLoader(),Il(s.playlistLoader,a)):u&&i.resetEverything()))}}(n,e),t[n].onGroupChanging=function(e,t){return function(){var n=t.segmentLoaders[e];t.mediaTypes[e].lastGroup_=null,n.abort(),n.pause()}}(n,e),t[n].onTrackChanged=function(e,t){return function(){var n=t.masterPlaylistLoader,r=t.segmentLoaders,i=r[e],a=r.main,o=t.mediaTypes[e],s=o.activeTrack(),u=o.getActiveGroup(),l=o.activePlaylistLoader,d=o.lastTrack_;if((!d||!s||d.id!==s.id)&&(o.lastGroup_=u,o.lastTrack_=s,wl(i,o),u)){if(u.isMasterPlaylist){if(!s||!d||s.id===d.id)return;var c=t.vhs.masterPlaylistController_,f=c.selectPlaylist();if(c.media()===f)return;return o.logger_("track change. Switching master audio from "+d.id+" to "+s.id),n.pause(),a.resetEverything(),void c.fastQualityChange_(f)}if("AUDIO"===e){if(!u.playlistLoader)return a.setAudio(!0),void a.resetEverything();i.setAudio(!0),a.setAudio(!1)}l!==u.playlistLoader?(i.track&&i.track(s),i.resetEverything(),Il(u.playlistLoader,o)):Il(u.playlistLoader,o)}}}(n,e),t[n].getActiveGroup=function(e,t){var n=t.mediaTypes;return function(){var t=n[e].activeTrack();return t?n[e].activeGroup(t):null}}(n,e)});var u=t.AUDIO.activeGroup();if(u){var l=(u.filter(function(e){return e.default})[0]||u[0]).id;t.AUDIO.tracks[l].enabled=!0,t.AUDIO.onGroupChanged(),t.AUDIO.onTrackChanged(),t.AUDIO.getActiveGroup().playlistLoader?(s.setAudio(!1),o.setAudio(!0)):s.setAudio(!0)}n.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return t[e].onGroupChanged()})}),n.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(e){return t[e].onGroupChanging()})});var d=function(){t.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"}),r.trigger({type:"usage",name:"hls-audio-change"})};for(var c in r.audioTracks().addEventListener("change",d),r.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),i.on("dispose",function(){r.audioTracks().removeEventListener("change",d),r.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)}),r.clearTracks("audio"),t.AUDIO.tracks)r.audioTracks().addTrack(t.AUDIO.tracks[c])},Pl=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Xu,activeTrack:Xu,getActiveGroup:Xu,onGroupChanged:Xu,onTrackChanged:Xu,lastTrack_:null,logger_:Wo("MediaGroups["+t+"]")}}),e},Ll=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],kl=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},xl=function(e){function t(t){var n;n=e.call(this)||this;var r=t.src,i=t.handleManifestRedirects,o=t.withCredentials,s=t.tech,u=t.bandwidth,l=t.externVhs,d=t.useCueTags,f=t.blacklistDuration,h=t.enableLowInitialPlaylist,p=t.sourceType,g=t.cacheEncryptionKeys,m=t.experimentalBufferBasedABR;if(!r)throw new Error("A non-empty playlist URL or JSON manifest string is required");var v=t.maxPlaylistRetries;null!==v&&"undefined"!==typeof v||(v=1/0),Qu=l,n.experimentalBufferBasedABR=Boolean(m),n.withCredentials=o,n.tech_=s,n.vhs_=s.vhs,n.sourceType_=p,n.useCueTags_=d,n.blacklistDuration=f,n.maxPlaylistRetries=v,n.enableLowInitialPlaylist=h,n.useCueTags_&&(n.cueTagsTrack_=n.tech_.addTextTrack("metadata","ad-cues"),n.cueTagsTrack_.inBandMetadataTrackDispatchType=""),n.requestOptions_={withCredentials:o,handleManifestRedirects:i,maxPlaylistRetries:v,timeout:null},n.on("error",n.pauseLoading),n.mediaTypes_=Pl(),n.mediaSource=new a.a.MediaSource,n.handleDurationChange_=n.handleDurationChange_.bind(c()(n)),n.handleSourceOpen_=n.handleSourceOpen_.bind(c()(n)),n.handleSourceEnded_=n.handleSourceEnded_.bind(c()(n)),n.mediaSource.addEventListener("durationchange",n.handleDurationChange_),n.mediaSource.addEventListener("sourceopen",n.handleSourceOpen_),n.mediaSource.addEventListener("sourceended",n.handleSourceEnded_),n.seekable_=qo.createTimeRanges(),n.hasPlayed_=!1,n.syncController_=new El(t),n.segmentMetadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,n.decrypter_=new Sl,n.sourceUpdater_=new gl(n.mediaSource),n.inbandTextTracks_={},n.timelineChangeController_=new bl;var y={vhs:n.vhs_,parse708captions:t.parse708captions,mediaSource:n.mediaSource,currentTime:n.tech_.currentTime.bind(n.tech_),seekable:function(){return n.seekable()},seeking:function(){return n.tech_.seeking()},duration:function(){return n.duration()},hasPlayed:function(){return n.hasPlayed_},goalBufferLength:function(){return n.goalBufferLength()},bandwidth:u,syncController:n.syncController_,decrypter:n.decrypter_,sourceType:n.sourceType_,inbandTextTracks:n.inbandTextTracks_,cacheEncryptionKeys:g,sourceUpdater:n.sourceUpdater_,timelineChangeController:n.timelineChangeController_};n.masterPlaylistLoader_="dash"===n.sourceType_?new Js(r,n.vhs_,n.requestOptions_):new Os(r,n.vhs_,n.requestOptions_),n.setupMasterPlaylistLoaderListeners_(),n.mainSegmentLoader_=new zu(qo.mergeOptions(y,{segmentMetadataTrack:n.segmentMetadataTrack_,loaderType:"main"}),t),n.audioSegmentLoader_=new zu(qo.mergeOptions(y,{loaderType:"audio"}),t),n.subtitleSegmentLoader_=new yl(qo.mergeOptions(y,{loaderType:"vtt",featuresNativeTextTracks:n.tech_.featuresNativeTextTracks}),t),n.setupSegmentLoaderListeners_(),n.experimentalBufferBasedABR&&(n.masterPlaylistLoader_.one("loadedplaylist",function(){return n.startABRTimer_()}),n.tech_.on("pause",function(){return n.stopABRTimer_()}),n.tech_.on("play",function(){return n.startABRTimer_()})),Ll.forEach(function(e){n[e+"_"]=kl.bind(c()(n),e)}),n.logger_=Wo("MPC"),n.triggeredFmp4Usage=!1,"none"===n.tech_.preload()?(n.loadOnPlay_=function(){n.loadOnPlay_=null,n.masterPlaylistLoader_.load()},n.tech_.one("play",n.loadOnPlay_)):n.masterPlaylistLoader_.load(),n.timeToLoadedData__=-1,n.mainAppendsToLoadedData__=-1,n.audioAppendsToLoadedData__=-1;var _="none"===n.tech_.preload()?"play":"loadstart";return n.tech_.one(_,function(){var e=Date.now();n.tech_.one("loadeddata",function(){n.timeToLoadedData__=Date.now()-e,n.mainAppendsToLoadedData__=n.mainSegmentLoader_.mediaAppends,n.audioAppendsToLoadedData__=n.audioSegmentLoader_.mediaAppends})}),n}h()(t,e);var n=t.prototype;return n.mainAppendsToLoadedData_=function(){return this.mainAppendsToLoadedData__},n.audioAppendsToLoadedData_=function(){return this.audioAppendsToLoadedData__},n.appendsToLoadedData_=function(){var e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return-1===e||-1===t?-1:e+t},n.timeToLoadedData_=function(){return this.timeToLoadedData__},n.checkABR_=function(){var e=this.selectPlaylist();this.shouldSwitchToMedia_(e)&&this.switchMedia_(e,"abr")},n.switchMedia_=function(e,t,n){var r=this.media(),i=r&&(r.id||r.uri),a=e.id||e.uri;i&&i!==a&&(this.logger_("switch media "+i+" -> "+a+" from "+t),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+t})),this.masterPlaylistLoader_.media(e,n)},n.startABRTimer_=function(){var e=this;this.stopABRTimer_(),this.abrTimer_=a.a.setInterval(function(){return e.checkABR_()},250)},n.stopABRTimer_=function(){this.tech_.scrubbing&&this.tech_.scrubbing()||(a.a.clearInterval(this.abrTimer_),this.abrTimer_=null)},n.getAudioTrackPlaylists_=function(){var e=this.master();if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return e&&e.playlists||[];var t,n=e.mediaGroups.AUDIO,r=Object.keys(n);if(Object.keys(this.mediaTypes_.AUDIO.groups).length)t=this.mediaTypes_.AUDIO.activeTrack();else{var i=n.main||r.length&&n[r[0]];for(var a in i)if(i[a].default){t={label:a};break}}if(!t)return[];var o=[];for(var s in n)if(n[s][t.label]){var u=n[s][t.label];u.playlists?o.push.apply(o,u.playlists):o.push(u)}return o},n.setupMasterPlaylistLoaderListeners_=function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;hs(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),Nl({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,vhs:e.vhs_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t),e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){e.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){e.loadOnPlay_&&e.tech_.off("play",e.loadOnPlay_);var t=e.masterPlaylistLoader_.media();if(!t){var n;if(e.excludeUnsupportedVariants_(),e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),!n||!e.shouldSwitchToMedia_(n))return;if(e.initialMedia_=n,e.switchMedia_(e.initialMedia_,"initial"),!("vhs-json"===e.sourceType_&&e.initialMedia_.segments))return;t=e.initialMedia_}e.handleUpdatedMediaPlaylist(t)}),this.masterPlaylistLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;hs(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var t=e.masterPlaylistLoader_.media();"playlist-unchanged"!==t.lastExcludeReason_&&(e.stuckAtPlaylistEnd_(t)&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"}),e.tech_.trigger("playliststuck")))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){e.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){e.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},n.handleUpdatedMediaPlaylist=function(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},n.triggerPresenceUsage_=function(e,t){var n=e.mediaGroups||{},r=!0,i=Object.keys(n.AUDIO);for(var a in n.AUDIO)for(var o in n.AUDIO[a]){n.AUDIO[a][o].uri||(r=!1)}r&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(n.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),Qu.Playlist.isAes(t)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),i.length&&Object.keys(n.AUDIO[i[0]]).length>1&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},n.shouldSwitchToMedia_=function(e){var t=this.masterPlaylistLoader_.media(),n=this.tech_.buffered();return function(e){var t=e.currentPlaylist,n=e.nextPlaylist,r=e.forwardBuffer,i=e.bufferLowWaterLine,a=e.bufferHighWaterLine,o=e.duration,s=e.experimentalBufferBasedABR,u=e.log;if(!n)return qo.log.warn("We received no playlist to switch to. Please check your stream."),!1;var l="allowing switch "+(t&&t.id||"null")+" -> "+n.id;if(!t||!t.endList)return u(l+" as current playlist "+(t?"is live":"is not set")),!0;if(n.id===t.id)return!1;var d=s?eu.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:eu.MAX_BUFFER_LOW_WATER_LINE;if(o<d)return u(l+" as duration < max low water line ("+o+" < "+d+")"),!0;var c=n.attributes.BANDWIDTH,f=t.attributes.BANDWIDTH;if(c<f&&(!s||r<a)){var h=l+" as next bandwidth < current bandwidth ("+c+" < "+f+")";return s&&(h+=" and forwardBuffer < bufferHighWaterLine ("+r+" < "+a+")"),u(h),!0}if((!s||c>f)&&r>=i){var p=l+" as forwardBuffer >= bufferLowWaterLine ("+r+" >= "+i+")";return s&&(p+=" and next bandwidth > current bandwidth ("+c+" > "+f+")"),u(p),!0}return u("not "+l+" as no switching criteria met"),!1}({currentPlaylist:t,nextPlaylist:e,forwardBuffer:n.length?n.end(n.length-1)-this.tech_.currentTime():0,bufferLowWaterLine:this.bufferLowWaterLine(),bufferHighWaterLine:this.bufferHighWaterLine(),duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})},n.setupSegmentLoaderListeners_=function(){var e=this;this.experimentalBufferBasedABR||(this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=e.selectPlaylist();e.shouldSwitchToMedia_(t)&&e.switchMedia_(t,"bandwidthupdate"),e.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){e.trigger("progress")})),this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("appenderror",function(){e.error=e.mainSegmentLoader_.error_,e.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){e.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",function(){e.error=e.audioSegmentLoader_.error_,e.trigger("error")}),this.mainSegmentLoader_.on("ended",function(){e.logger_("main segment loader ended"),e.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(t){e.experimentalBufferBasedABR||(e.delegateLoaders_("all",["abort"]),e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120))});var t=function(){if(!e.sourceUpdater_.hasCreatedSourceBuffers())return e.tryToCreateSourceBuffers_();var t=e.getCodecsOrExclude_();t&&e.sourceUpdater_.addOrChangeSourceBuffers(t)};this.mainSegmentLoader_.on("trackinfo",t),this.audioSegmentLoader_.on("trackinfo",t),this.mainSegmentLoader_.on("fmp4",function(){e.triggeredFmp4Usage||(e.tech_.trigger({type:"usage",name:"vhs-fmp4"}),e.tech_.trigger({type:"usage",name:"hls-fmp4"}),e.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",function(){e.triggeredFmp4Usage||(e.tech_.trigger({type:"usage",name:"vhs-fmp4"}),e.tech_.trigger({type:"usage",name:"hls-fmp4"}),e.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",function(){e.logger_("audioSegmentLoader ended"),e.onEndOfStream()})},n.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},n.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},n.smoothQualityChange_=function(e){void 0===e&&(e=this.selectPlaylist()),this.fastQualityChange_(e)},n.fastQualityChange_=function(e){var t=this;void 0===e&&(e=this.selectPlaylist()),e!==this.masterPlaylistLoader_.media()?(this.switchMedia_(e,"fast-quality"),this.mainSegmentLoader_.resetEverything(function(){qo.browser.IE_VERSION||qo.browser.IS_EDGE?t.tech_.setCurrentTime(t.tech_.currentTime()+.04):t.tech_.setCurrentTime(t.tech_.currentTime())})):this.logger_("skipping fastQualityChange because new media is same as old")},n.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}},n.setupFirstPlay=function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(qo.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.tech_.setCurrentTime(n.end(0)),e.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(n.end(0))}return this.hasPlayed_=!0,this.load(),!0},n.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var e=this.tech_.play();"undefined"!==typeof e&&"function"===typeof e.then&&e.then(null,function(e){})}this.trigger("sourceopen")},n.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var e=this.inbandTextTracks_.metadataTrack_.cues;if(e&&e.length){var t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}}},n.handleDurationChange_=function(){this.tech_.trigger("durationchange")},n.onEndOfStream=function(){var e=this.mainSegmentLoader_.ended_;this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.currentMediaInfo_||this.mainSegmentLoader_.currentMediaInfo_.hasVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},n.stuckAtPlaylistEnd_=function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.duration());if(null===t)return!1;var n=Qu.Playlist.playlistEnd(e,t),r=this.tech_.currentTime(),i=this.tech_.buffered();if(!i.length)return n-r<=.1;var a=i.end(i.length-1);return a-r<=.1&&n-a<=.1},n.blacklistCurrentPlaylist=function(e,t){void 0===e&&(e={});var n=e.playlist||this.masterPlaylistLoader_.media();if(t=t||e.blacklistDuration||this.blacklistDuration,!n)return this.error=e,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));n.playlistErrors_++;var r,i=this.masterPlaylistLoader_.master.playlists,a=i.filter(cs),o=1===a.length&&a[0]===n;if(1===i.length&&t!==1/0)return qo.log.warn("Problem encountered with playlist "+n.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(o);if(o){var s=!1;i.forEach(function(e){if(e!==n){var t=e.excludeUntil;"undefined"!==typeof t&&t!==1/0&&(s=!0,delete e.excludeUntil)}}),s&&(qo.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}r=n.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*t,n.excludeUntil=r,e.reason&&(n.lastExcludeReason_=e.reason),this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var u=this.selectPlaylist();if(!u)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");var l=e.internal?this.logger_:qo.log.warn,d=e.message?" "+e.message:"";l((e.internal?"Internal problem":"Problem")+" encountered with playlist "+n.id+"."+d+" Switching to playlist "+u.id+"."),u.attributes.AUDIO!==n.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),u.attributes.SUBTITLES!==n.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var c=u.targetDuration/2*1e3||5e3,f="number"===typeof u.lastRequest&&Date.now()-u.lastRequest<=c;return this.switchMedia_(u,"exclude",o||f)},n.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()},n.delegateLoaders_=function(e,t){var n=this,r=[],i="all"===e;(i||"main"===e)&&r.push(this.masterPlaylistLoader_);var a=[];(i||"audio"===e)&&a.push("AUDIO"),(i||"subtitle"===e)&&(a.push("CLOSED-CAPTIONS"),a.push("SUBTITLES")),a.forEach(function(e){var t=n.mediaTypes_[e]&&n.mediaTypes_[e].activePlaylistLoader;t&&r.push(t)}),["main","audio","subtitle"].forEach(function(t){var i=n[t+"SegmentLoader_"];!i||e!==t&&"all"!==e||r.push(i)}),r.forEach(function(e){return t.forEach(function(t){"function"===typeof e[t]&&e[t]()})})},n.setCurrentTime=function(e){var t=Xo(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0},n.duration=function(){if(!this.masterPlaylistLoader_)return 0;var e=this.masterPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Qu.Playlist.duration(e):1/0:0},n.seekable=function(){return this.seekable_},n.onSyncInfoUpdate_=function(){var e;if(this.masterPlaylistLoader_){var t=this.masterPlaylistLoader_.media();if(t){var n=this.syncController_.getExpiredTime(t,this.duration());if(null!==n){var r=this.masterPlaylistLoader_.master,i=Qu.Playlist.seekable(t,n,Qu.Playlist.liveEdgeDelay(r,t));if(0!==i.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(n=this.syncController_.getExpiredTime(t,this.duration())))return;if(0===(e=Qu.Playlist.seekable(t,n,Qu.Playlist.liveEdgeDelay(r,t))).length)return}var a,o;this.seekable_&&this.seekable_.length&&(a=this.seekable_.end(0),o=this.seekable_.start(0)),e?e.start(0)>i.end(0)||i.start(0)>e.end(0)?this.seekable_=i:this.seekable_=qo.createTimeRanges([[e.start(0)>i.start(0)?e.start(0):i.start(0),e.end(0)<i.end(0)?e.end(0):i.end(0)]]):this.seekable_=i,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===a&&this.seekable_.start(0)===o||(this.logger_("seekable updated ["+$o(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},n.updateDuration=function(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,e),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(e){var t=this.seekable();if(!t.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<t.end(t.length-1))&&this.sourceUpdater_.setDuration(t.end(t.length-1))}else{var n=this.tech_.buffered(),r=Qu.Playlist.duration(this.masterPlaylistLoader_.media());n.length>0&&(r=Math.max(r,n.end(n.length-1))),this.mediaSource.duration!==r&&this.sourceUpdater_.setDuration(r)}},n.dispose=function(){var e=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(function(t){var n=e.mediaTypes_[t].groups;for(var r in n)n[r].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},n.master=function(){return this.masterPlaylistLoader_.master},n.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},n.areMediaTypesKnown_=function(){var e=!!this.mediaTypes_.AUDIO.activePlaylistLoader;return!(!this.mainSegmentLoader_.currentMediaInfo_||e&&!this.audioSegmentLoader_.currentMediaInfo_)},n.getCodecsOrExclude_=function(){var e=this,t={main:this.mainSegmentLoader_.currentMediaInfo_||{},audio:this.audioSegmentLoader_.currentMediaInfo_||{}};t.video=t.main;var n=Nu(this.master(),this.media()),r={},i=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(t.main.hasVideo&&(r.video=n.video||t.main.videoCodec||"avc1.4d400d"),t.main.isMuxed&&(r.video+=","+(n.audio||t.main.audioCodec||"mp4a.40.2")),(t.main.hasAudio&&!t.main.isMuxed||t.audio.hasAudio||i)&&(r.audio=n.audio||t.main.audioCodec||t.audio.audioCodec||"mp4a.40.2",t.audio.isFmp4=t.main.hasAudio&&!t.main.isMuxed?t.main.isFmp4:t.audio.isFmp4),r.audio||r.video){var a,o={};if(["video","audio"].forEach(function(e){if(r.hasOwnProperty(e)&&(i=t[e].isFmp4,s=r[e],!(i?Z(s):J(s)))){var n=t[e].isFmp4?"browser":"muxer";o[n]=o[n]||[],o[n].push(r[e]),"audio"===e&&(a=n)}var i,s}),i&&a&&this.media().attributes.AUDIO){var s=this.media().attributes.AUDIO;this.master().playlists.forEach(function(t){(t.attributes&&t.attributes.AUDIO)===s&&t!==e.media()&&(t.excludeUntil=1/0)}),this.logger_("excluding audio group "+s+" as "+a+' does not support codec(s): "'+r.audio+'"')}if(!Object.keys(o).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var u=[];if(["video","audio"].forEach(function(t){var n=(X(e.sourceUpdater_.codecs[t]||"")[0]||{}).type,i=(X(r[t]||"")[0]||{}).type;n&&i&&n.toLowerCase()!==i.toLowerCase()&&u.push('"'+e.sourceUpdater_.codecs[t]+'" -> "'+r[t]+'"')}),u.length)return void this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+u.join(", ")+".",blacklistDuration:1/0,internal:!0})}return r}var l=Object.keys(o).reduce(function(e,t){return e&&(e+=", "),e+=t+' does not support codec(s): "'+o[t].join(",")+'"'},"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:!0,message:l,blacklistDuration:1/0})}else this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:1/0})},n.tryToCreateSourceBuffers_=function(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.hasCreatedSourceBuffers()&&this.areMediaTypesKnown_()){var e=this.getCodecsOrExclude_();if(e){this.sourceUpdater_.createSourceBuffers(e);var t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}}},n.excludeUnsupportedVariants_=function(){var e=this,t=this.master().playlists,n=[];Object.keys(t).forEach(function(r){var i=t[r];if(-1===n.indexOf(i.id)){n.push(i.id);var a=Nu(e.master,i),o=[];!a.audio||J(a.audio)||Z(a.audio)||o.push("audio codec "+a.audio),!a.video||J(a.video)||Z(a.video)||o.push("video codec "+a.video),a.text&&"stpp.ttml.im1t"===a.text&&o.push("text codec "+a.text),o.length&&(i.excludeUntil=1/0,e.logger_("excluding "+i.id+" for unsupported: "+o.join(", ")))}})},n.excludeIncompatibleVariants_=function(e){var t=this,n=[],r=this.master().playlists,i=Mu(X(e)),a=Ou(i),o=i.video&&X(i.video)[0]||null,s=i.audio&&X(i.audio)[0]||null;Object.keys(r).forEach(function(e){var i=r[e];if(-1===n.indexOf(i.id)&&i.excludeUntil!==1/0){n.push(i.id);var u=[],l=Nu(t.masterPlaylistLoader_.master,i),d=Ou(l);if(l.audio||l.video){if(d!==a&&u.push('codec count "'+d+'" !== "'+a+'"'),!t.sourceUpdater_.canChangeType()){var c=l.video&&X(l.video)[0]||null,f=l.audio&&X(l.audio)[0]||null;c&&o&&c.type.toLowerCase()!==o.type.toLowerCase()&&u.push('video codec "'+c.type+'" !== "'+o.type+'"'),f&&s&&f.type.toLowerCase()!==s.type.toLowerCase()&&u.push('audio codec "'+f.type+'" !== "'+s.type+'"')}u.length&&(i.excludeUntil=1/0,t.logger_("blacklisting "+i.id+": "+u.join(" && ")))}}})},n.updateAdCues_=function(e){var t=0,n=this.seekable();n.length&&(t=n.start(0)),function(e,t,n){if(void 0===n&&(n=0),e.segments)for(var r,i=n,o=0;o<e.segments.length;o++){var s=e.segments[o];if(r||(r=_l(t,i+s.duration/2)),r){if("cueIn"in s){r.endTime=i,r.adEndTime=i,i+=s.duration,r=null;continue}if(i<r.endTime){i+=s.duration;continue}r.endTime+=s.duration}else if("cueOut"in s&&((r=new a.a.VTTCue(i,i+s.duration,s.cueOut)).adStartTime=i,r.adEndTime=i+parseFloat(s.cueOut),t.addCue(r)),"cueOutCont"in s){var u=s.cueOutCont.split("/").map(parseFloat),l=u[0],d=u[1];(r=new a.a.VTTCue(i,i+s.duration,"")).adStartTime=i-l,r.adEndTime=r.adStartTime+d,t.addCue(r)}i+=s.duration}}(e,this.cueTagsTrack_,t)},n.goalBufferLength=function(){var e=this.tech_.currentTime(),t=eu.GOAL_BUFFER_LENGTH,n=eu.GOAL_BUFFER_LENGTH_RATE,r=Math.max(t,eu.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,r)},n.bufferLowWaterLine=function(){var e=this.tech_.currentTime(),t=eu.BUFFER_LOW_WATER_LINE,n=eu.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(t,eu.MAX_BUFFER_LOW_WATER_LINE),i=Math.max(t,eu.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,this.experimentalBufferBasedABR?i:r)},n.bufferHighWaterLine=function(){return eu.BUFFER_HIGH_WATER_LINE},t}(qo.EventTarget),Fl=function(e,t,n){var r,i,a,o=e.masterPlaylistController_,s=o[(e.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(o);if(t.attributes){var u=t.attributes.RESOLUTION;this.width=u&&u.width,this.height=u&&u.height,this.bandwidth=t.attributes.BANDWIDTH}this.codecs=Nu(o.master(),t),this.playlist=t,this.id=n,this.enabled=(r=e.playlists,i=t.id,a=s,function(e){var t=r.master.playlists[i],n=ds(t),o=cs(t);return"undefined"===typeof e?o:(e?delete t.disabled:t.disabled=!0,e===o||n||(a(),e?r.trigger("renditionenabled"):r.trigger("renditiondisabled")),e)})},Ul=["seeking","seeked","pause","playing","error"],Bl=function(){function e(e){var t=this;this.masterPlaylistController_=e.masterPlaylistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Wo("PlaybackWatcher"),this.logger_("initialize");var n=function(){return t.monitorCurrentTime_()},r=function(){return t.monitorCurrentTime_()},i=function(){return t.techWaiting_()},o=function(){return t.cancelTimer_()},s=function(){return t.fixesBadSeeks_()},u=this.masterPlaylistController_,l=["main","subtitle","audio"],d={};l.forEach(function(e){d[e]={reset:function(){return t.resetSegmentDownloads_(e)},updateend:function(){return t.checkSegmentDownloads_(e)}},u[e+"SegmentLoader_"].on("appendsdone",d[e].updateend),u[e+"SegmentLoader_"].on("playlistupdate",d[e].reset),t.tech_.on(["seeked","seeking"],d[e].reset)}),this.tech_.on("seekablechanged",s),this.tech_.on("waiting",i),this.tech_.on(Ul,o),this.tech_.on("canplay",r),this.tech_.one("play",n),this.dispose=function(){t.logger_("dispose"),t.tech_.off("seekablechanged",s),t.tech_.off("waiting",i),t.tech_.off(Ul,o),t.tech_.off("canplay",r),t.tech_.off("play",n),l.forEach(function(e){u[e+"SegmentLoader_"].off("appendsdone",d[e].updateend),u[e+"SegmentLoader_"].off("playlistupdate",d[e].reset),t.tech_.off(["seeked","seeking"],d[e].reset)}),t.checkCurrentTimeTimeout_&&a.a.clearTimeout(t.checkCurrentTimeTimeout_),t.cancelTimer_()}}var t=e.prototype;return t.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&a.a.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=a.a.setTimeout(this.monitorCurrentTime_.bind(this),250)},t.resetSegmentDownloads_=function(e){var t=this.masterPlaylistController_[e+"SegmentLoader_"];this[e+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+e+" loader"),this[e+"StalledDownloads_"]=0,this[e+"Buffered_"]=t.buffered_()},t.checkSegmentDownloads_=function(e){var t=this.masterPlaylistController_,n=t[e+"SegmentLoader_"],r=n.buffered_(),i=function(e,t){if(e===t)return!1;if(!e&&t||!t&&e)return!0;if(e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e.start(n)!==t.start(n)||e.end(n)!==t.end(n))return!0;return!1}(this[e+"Buffered_"],r);this[e+"Buffered_"]=r,i?this.resetSegmentDownloads_(e):(this[e+"StalledDownloads_"]++,this.logger_("found #"+this[e+"StalledDownloads_"]+" "+e+" appends that did not increase buffer (possible stalled download)",{playlistId:n.playlist_&&n.playlist_.id,buffered:Zo(r)}),this[e+"StalledDownloads_"]<10||(this.logger_(e+" loader stalled download exclusion"),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:"vhs-"+e+"-download-exclusion"}),"subtitle"!==e&&t.blacklistCurrentPlaylist({message:"Excessive "+e+" segment downloading detected."},1/0)))},t.checkCurrentTime_=function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}},t.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},t.fixesBadSeeks_=function(){if(!this.tech_.seeking())return!1;var e,t=this.seekable(),n=this.tech_.currentTime();this.afterSeekableWindow_(t,n,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(e=t.end(t.length-1));if(this.beforeSeekableWindow_(t,n)){var r=t.start(0);e=r+(r===t.end(0)?0:.1)}if("undefined"!==typeof e)return this.logger_("Trying to seek outside of seekable at time "+n+" with seekable range "+$o(t)+". Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0;var i=this.tech_.buffered();return!!function(e){var t=e.buffered,n=e.targetDuration,r=e.currentTime;return!!t.length&&!(t.end(0)-t.start(0)<2*n)&&!(r>t.start(0))&&t.start(0)-r<n}({buffered:i,targetDuration:this.media().targetDuration,currentTime:n})&&(e=i.start(0)+.1,this.logger_("Buffered region starts ("+i.start(0)+")  just beyond seek point ("+n+"). Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0)},t.waiting_=function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),n=Xo(t,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}},t.techWaiting_=function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.tech_.setCurrentTime(n),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var r=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,i=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:t}))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var a=Qo(i,t);if(a.length>0){var o=a.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+o+", seeking to "+a.start(0)),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*o,t),!0}return!1},t.afterSeekableWindow_=function(e,t,n,r){if(void 0===r&&(r=!1),!e.length)return!1;var i=e.end(e.length-1)+.1;return!n.endList&&r&&(i=e.end(e.length-1)+3*n.targetDuration),t>i},t.beforeSeekableWindow_=function(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)},t.videoUnderflow_=function(e){var t=e.videoBuffered,n=e.audioBuffered,r=e.currentTime;if(t){var i;if(t.length&&n.length){var a=Xo(t,r-3),o=Xo(t,r),s=Xo(n,r);s.length&&!o.length&&a.length&&(i={start:a.end(0),end:s.end(0)})}else{Qo(t,r).length||(i=this.gapFromVideoUnderflow_(t,r))}return!!i&&(this.logger_("Encountered a gap in video from "+i.start+" to "+i.end+". Seeking to current time "+r),!0)}},t.skipTheGap_=function(e){var t=this.tech_.buffered(),n=this.tech_.currentTime(),r=Qo(t,n);this.cancelTimer_(),0!==r.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.tech_.setCurrentTime(r.start(0)+1/30),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},t.gapFromVideoUnderflow_=function(e,t){for(var n=function(e){if(e.length<2)return qo.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var r=e.end(n-1),i=e.start(n);t.push([r,i])}return qo.createTimeRanges(t)}(e),r=0;r<n.length;r++){var i=n.start(r),a=n.end(r);if(t-i<4&&t-i>2)return{start:i,end:a}}return null},e}(),jl={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},Gl=function(e){!function e(t,n){var r=0,i=0,a=qo.mergeOptions(jl,n);t.ready(function(){t.trigger({type:"usage",name:"vhs-error-reload-initialized"}),t.trigger({type:"usage",name:"hls-error-reload-initialized"})});var o=function(){i&&t.currentTime(i)},s=function(e){null!==e&&void 0!==e&&(i=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",o),t.src(e),t.trigger({type:"usage",name:"vhs-error-reload"}),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())},u=function(){return Date.now()-r<1e3*a.errorInterval?(t.trigger({type:"usage",name:"vhs-error-reload-canceled"}),void t.trigger({type:"usage",name:"hls-error-reload-canceled"})):a.getSource&&"function"===typeof a.getSource?(r=Date.now(),a.getSource.call(t,s)):void qo.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")},l=function e(){t.off("loadedmetadata",o),t.off("error",u),t.off("dispose",e)};t.on("error",u),t.on("dispose",l),t.reloadSourceOnError=function(n){l(),e(t,n)}}(this,e)},ql={PlaylistLoader:Os,Playlist:vs,utils:Vs,STANDARD_PLAYLIST_SELECTOR:Bu,INITIAL_PLAYLIST_SELECTOR:function(){var e=this,t=this.playlists.master.playlists.filter(vs.isEnabled);return xu(t,function(e,t){return Fu(e,t)}),t.filter(function(t){return!!Nu(e.playlists.master,t).video})[0]||null},lastBandwidthSelector:Bu,movingAverageBandwidthSelector:function(e){var t=-1,n=-1;if(e<0||e>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var r=this.useDevicePixelRatio&&a.a.devicePixelRatio||1;return t<0&&(t=this.systemBandwidth,n=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==n&&(t=e*this.systemBandwidth+(1-e)*t,n=this.systemBandwidth),Uu(this.playlists.master,t,parseInt(ku(this.tech_.el(),"width"),10)*r,parseInt(ku(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}},comparePlaylistBandwidth:Fu,comparePlaylistResolution:function(e,t){var n,r;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||a.a.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(r=t.attributes.RESOLUTION.width),n===(r=r||a.a.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:n-r},xhr:ks()};Object.keys(eu).forEach(function(e){Object.defineProperty(ql,e,{get:function(){return qo.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing"),eu[e]},set:function(t){qo.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing"),"number"!==typeof t||t<0?qo.log.warn("value of Vhs."+e+" must be greater than or equal to 0"):eu[e]=t}})});var Hl=function(e,t){for(var n=t.media(),r=-1,i=0;i<e.length;i++)if(e[i].id===n.id){r=i;break}e.selectedIndex_=r,e.trigger({selectedIndex:r,type:"change"})};ql.canPlaySource=function(){return qo.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Vl=function(e){var t=e.player,n=e.sourceKeySystems,r=e.audioMedia,i=e.mainPlaylists;if(!t.eme.initializeMediaKeys)return Promise.resolve();var a=function(e,t){return e.reduce(function(e,n){if(!n.contentProtection)return e;var r=t.reduce(function(e,t){var r=n.contentProtection[t];return r&&r.pssh&&(e[t]={pssh:r.pssh}),e},{});return Object.keys(r).length&&e.push(r),e},[])}(r?i.concat([r]):i,Object.keys(n)),o=[],s=[];return a.forEach(function(e){s.push(new Promise(function(e,n){t.tech_.one("keysessioncreated",e)})),o.push(new Promise(function(n,r){t.eme.initializeMediaKeys({keySystems:e},function(e){e?r(e):n()})}))}),Promise.race([Promise.all(o),Promise.race(s)])},Kl=function(e){var t=e.player,n=function(e,t,n){if(!e)return e;var r={};t&&t.attributes&&t.attributes.CODECS&&(r=Mu(X(t.attributes.CODECS))),n&&n.attributes&&n.attributes.CODECS&&(r.audio=n.attributes.CODECS);var i=$(r.video),a=$(r.audio),o={};for(var s in e)o[s]={},a&&(o[s].audioContentType=a),i&&(o[s].videoContentType=i),t.contentProtection&&t.contentProtection[s]&&t.contentProtection[s].pssh&&(o[s].pssh=t.contentProtection[s].pssh),"string"===typeof e[s]&&(o[s].url=e[s]);return qo.mergeOptions(e,o)}(e.sourceKeySystems,e.media,e.audioMedia);return!!n&&(t.currentSource().keySystems=n,!(n&&!t.eme)||(qo.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1))},Yl=function(){if(!a.a.localStorage)return null;var e=a.a.localStorage.getItem("videojs-vhs");if(!e)return null;try{return JSON.parse(e)}catch(t){return null}};ql.supportsNativeHls=function(){if(!s.a||!s.a.createElement)return!1;var e=s.a.createElement("video");if(!qo.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(e.canPlayType(t))})}(),ql.supportsNativeDash=!!(s.a&&s.a.createElement&&qo.getTech("Html5").isSupported())&&/maybe|probably/i.test(s.a.createElement("video").canPlayType("application/dash+xml")),ql.supportsTypeNatively=function(e){return"hls"===e?ql.supportsNativeHls:"dash"===e&&ql.supportsNativeDash},ql.isSupported=function(){return qo.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Wl=function(e){function t(t,n,r){var i;if(i=e.call(this,n,qo.mergeOptions(r.hls,r.vhs))||this,r.hls&&Object.keys(r.hls).length&&qo.log.warn("Using hls options is deprecated. Use vhs instead."),"number"===typeof r.initialBandwidth&&(i.options_.bandwidth=r.initialBandwidth),i.logger_=Wo("VhsHandler"),n.options_&&n.options_.playerId){var a=qo(n.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return qo.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),n.trigger({type:"usage",name:"hls-player-access"}),c()(i)},configurable:!0}),a.hasOwnProperty("vhs")||Object.defineProperty(a,"vhs",{get:function(){return qo.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),n.trigger({type:"usage",name:"vhs-player-access"}),c()(i)},configurable:!0}),a.hasOwnProperty("dash")||Object.defineProperty(a,"dash",{get:function(){return qo.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),c()(i)},configurable:!0}),i.player_=a}if(i.tech_=n,i.source_=t,i.stats={},i.ignoreNextSeekingEvent_=!1,i.setOptions_(),i.options_.overrideNative&&n.overrideNativeAudioTracks&&n.overrideNativeVideoTracks)n.overrideNativeAudioTracks(!0),n.overrideNativeVideoTracks(!0);else if(i.options_.overrideNative&&(n.featuresNativeVideoTracks||n.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return i.on(s.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=s.a.fullscreenElement||s.a.webkitFullscreenElement||s.a.mozFullScreenElement||s.a.msFullscreenElement;t&&t.contains(i.tech_.el())?i.masterPlaylistController_.fastQualityChange_():i.masterPlaylistController_.checkABR_()}),i.on(i.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),i.on(i.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),i.on(i.tech_,"play",i.play),i}h()(t,e);var n=t.prototype;return n.setOptions_=function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=!1!==this.options_.handleManifestRedirects,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage="undefined"!==typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!==typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!==typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=Yl();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!==typeof this.options_.bandwidth&&(this.options_.bandwidth=eu.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===eu.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS"].forEach(function(t){"undefined"!==typeof e.source_[t]&&(e.options_[t]=e.source_[t])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},n.src=function(e,t){var n=this;if(e){var r;this.setOptions_(),this.options_.src=0===(r=this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(r.substring(r.indexOf(",")+1)):r,this.options_.tech=this.tech_,this.options_.externVhs=ql,this.options_.sourceType=ne(t),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e)},this.options_.smoothQualityChange&&qo.log.warn("smoothQualityChange is deprecated and will be removed in the next major version"),this.masterPlaylistController_=new xl(this.options_);var i=qo.mergeOptions({liveRangeSafeTimeDelta:.1},this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new Bl(i),this.masterPlaylistController_.on("error",function(){var e=qo.players[n.tech_.options_.playerId],t=n.masterPlaylistController_.error;"object"!==typeof t||t.code?"string"===typeof t&&(t={message:t,code:3}):t.code=3,e.error(t)});var o=this.options_.experimentalBufferBasedABR?ql.movingAverageBandwidthSelector(.55):ql.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):o.bind(this),this.masterPlaylistController_.selectInitialPlaylist=ql.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e,t=1/(this.bandwidth||1);return e=this.throughput>0?1/this.throughput:0,Math.floor(1/(t+e))},set:function(){qo.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},mediaAppends:{get:function(){return n.masterPlaylistController_.mediaAppends_()||0},enumerable:!0},mainAppendsToLoadedData:{get:function(){return n.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:!0},audioAppendsToLoadedData:{get:function(){return n.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:!0},appendsToLoadedData:{get:function(){return n.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:!0},timeToLoadedData:{get:function(){return n.masterPlaylistController_.timeToLoadedData_()||0},enumerable:!0},buffered:{get:function(){return Zo(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Zo(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){n.options_.useBandwidthFromLocalStorage&&function(e){if(!a.a.localStorage)return!1;var t=Yl();t=t?qo.mergeOptions(t,e):e;try{a.a.localStorage.setItem("videojs-vhs",JSON.stringify(t))}catch(n){return!1}}({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){var e;(e=n).representations=function(){var t=e.masterPlaylistController_.master(),n=ms(t)?e.masterPlaylistController_.getAudioTrackPlaylists_():t.playlists;return n?n.filter(function(e){return!ds(e)}).map(function(t,n){return new Fl(e,t,t.id)}):[]}}),this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",function(){n.setupEme_()}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=a.a.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},n.setupEme_=function(){var e=this,t=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,n=Kl({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:t&&t.media()});11!==qo.browser.IE_VERSION&&n?(this.logger_("waiting for EME key session creation"),Vl({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:t&&t.media(),mainPlaylists:this.playlists.master.playlists}).then(function(){e.logger_("created EME key session"),e.masterPlaylistController_.sourceUpdater_.initializedEme()}).catch(function(t){e.logger_("error while creating EME key session",t),e.player_.error({message:"Failed to initialize media keys for EME",code:3})})):this.masterPlaylistController_.sourceUpdater_.initializedEme()},n.setupQualityLevels_=function(){var e=this,t=qo.players[this.tech_.options_.playerId];t&&t.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){var t,n;t=e.qualityLevels_,(n=e).representations().forEach(function(e){t.addQualityLevel(e)}),Hl(t,n.playlists)}),this.playlists.on("mediachange",function(){Hl(e.qualityLevels_,e.playlists)}))},t.version=function(){return{"@videojs/http-streaming":"2.9.1","mux.js":"5.11.1","mpd-parser":"0.17.0","m3u8-parser":"4.7.0","aes-decrypter":"3.1.2"}},n.version=function(){return this.constructor.version()},n.canChangeType=function(){return gl.canChangeType()},n.play=function(){this.masterPlaylistController_.play()},n.setCurrentTime=function(e){this.masterPlaylistController_.setCurrentTime(e)},n.duration=function(){return this.masterPlaylistController_.duration()},n.seekable=function(){return this.masterPlaylistController_.seekable()},n.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&a.a.URL.revokeObjectURL&&(a.a.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),e.prototype.dispose.call(this)},n.convertToProgramTime=function(e,t){return Ks({playlist:this.masterPlaylistController_.media(),time:e,callback:t})},n.seekToProgramTime=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=2),Ys({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:r,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})},t}(qo.getComponent("Component")),zl={name:"videojs-http-streaming",VERSION:"2.9.1",canHandleSource:function(e,t){void 0===t&&(t={});var n=qo.mergeOptions(qo.options,t);return zl.canPlayType(e.type,n)},handleSource:function(e,t,n){void 0===n&&(n={});var r=qo.mergeOptions(qo.options,n);return t.vhs=new Wl(e,t,r),qo.hasOwnProperty("hls")||Object.defineProperty(t,"hls",{get:function(){return qo.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),t.vhs},configurable:!0}),t.vhs.xhr=ks(),t.vhs.src(e.src,e.type),t.vhs},canPlayType:function(e,t){void 0===t&&(t={});var n=qo.mergeOptions(qo.options,t).vhs.overrideNative,r=void 0===n?!qo.browser.IS_ANY_SAFARI:n,i=ne(e);return i&&(!ql.supportsTypeNatively(i)||r)?"maybe":""}};Z("avc1.4d400d,mp4a.40.2")&&qo.getTech("Html5").registerSourceHandler(zl,0),qo.VhsHandler=Wl,Object.defineProperty(qo,"HlsHandler",{get:function(){return qo.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),Wl},configurable:!0}),qo.VhsSourceHandler=zl,Object.defineProperty(qo,"HlsSourceHandler",{get:function(){return qo.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),zl},configurable:!0}),qo.Vhs=ql,Object.defineProperty(qo,"Hls",{get:function(){return qo.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),ql},configurable:!0}),qo.use||(qo.registerComponent("Hls",ql),qo.registerComponent("Vhs",ql)),qo.options.vhs=qo.options.vhs||{},qo.options.hls=qo.options.hls||{},qo.registerPlugin?qo.registerPlugin("reloadSourceOnError",Gl):qo.plugin("reloadSourceOnError",Gl);t.default=qo},1104:function(e,t,n){var r=n(1078);e.exports=function(e){return r(e).getTime()<(new Date).getTime()}},1143:function(e,t,n){"use strict";var r=n(1103),i=n(1239),a=n.n(i),o=n(1311),s=n.n(o),u="6.9.0";var l=function(e,t){t.isImmediatePropagationStopped=function(){return!0},t.cancelBubble=!0,t.isPropagationStopped=function(){return!0}},d=function(e,t,n){l(0,n),e.trigger({type:t+n.type,originalEvent:n})},c=function(e,t){e.ads.isInAdMode()&&(e.ads.isContentResuming()?e.ads._contentEnding&&d(e,"content",t):d(e,"ad",t))},f=function(e,t){e.ads.isInAdMode()?e.ads.isContentResuming()?(l(0,t),e.trigger("resumeended")):d(e,"ad",t):e.ads._contentHasEnded||e.ads.stitchedAds()||(d(e,"content",t),e.trigger("readyforpostroll"))},h=function(e,t){if(!("loadstart"===t.type&&!e.ads._hasThereBeenALoadStartDuringPlayerLife||"loadeddata"===t.type&&!e.ads._hasThereBeenALoadedData||"loadedmetadata"===t.type&&!e.ads._hasThereBeenALoadedMetaData))if(e.ads.inAdBreak())d(e,"ad",t);else{if(e.currentSrc()!==e.ads.contentSrc)return;d(e,"content",t)}},p=function(e,t){e.ads.inAdBreak()?d(e,"ad",t):e.ads.isContentResuming()&&d(e,"content",t)};function g(e){"playing"===e.type?c(this,e):"ended"===e.type?f(this,e):"loadstart"===e.type||"loadeddata"===e.type||"loadedmetadata"===e.type?h(this,e):"play"===e.type?p(this,e):this.ads.isInAdMode()&&(this.ads.isContentResuming()?d(this,"content",e):d(this,"ad",e))}var m={},v=function(){!function(e){if(r.default.dom.isInFrame()&&"function"!==typeof a.a.__tcfapi){for(var t,n=a.a,i={};n;){try{if(n.frames.__tcfapiLocator){t=n;break}}catch(o){}if(n===a.a.top)break;n=n.parent}if(!t)return;a.a.__tcfapi=function(e,n,r,a){var o=Math.random()+"",s={__tcfapiCall:{command:e,parameter:a,version:n,callId:o}};i[o]=r,t.postMessage(s,"*")},a.a.addEventListener("message",function(e){var t={};try{t="string"===typeof e.data?JSON.parse(e.data):e.data}catch(o){}var n=t.__tcfapiReturn;n&&"function"===typeof i[n.callId]&&(i[n.callId](n.returnValue,n.success),i[n.callId]=null)},!1)}}(),"function"===typeof a.a.__tcfapi&&a.a.__tcfapi("addEventListener",2,function(e,t){t&&(m=e)})},y=function(e,t){return t?encodeURIComponent(e):e},_=function(e,t,n){if(e&&e[n])for(var r=e[n],i=Object.keys(r),a=0;a<i.length;a++){t["{mediainfo."+n+"."+i[a]+"}"]=r[i[a]]}};var T={processMetadataTracks:function(e,t){for(var n=e.textTracks(),r=function(n){"metadata"===n.kind&&(e.ads.cueTextTracks.setMetadataTrackMode(n),t(e,n))},i=0;i<n.length;i++)r(n[i]);n.addEventListener("addtrack",function(e){r(e.track)})},setMetadataTrackMode:function(e){},getSupportedAdCue:function(e,t){return t},isSupportedAdCue:function(e,t){return!0},getCueId:function(e,t){return t.id}},E=function(e,t){return void 0!==t&&e.ads.includedCues[t]},b=function(e,t){void 0!==t&&""!==t&&(e.ads.includedCues[t]=!0)};function S(){!1!==this.ads._shouldBlockPlay&&(this.paused()||(this.ads.debug("Playback was canceled by cancelContentPlay"),this.pause()),this.ads._cancelledPlay=!0)}T.processAdTrack=function(e,t,n,i){e.ads.includedCues={};for(var a=0;a<t.length;a++){var o=t[a],s=this.getSupportedAdCue(e,o);if(!this.isSupportedAdCue(e,o))return void r.default.log.warn("Skipping as this is not a supported ad cue.",o);var u=this.getCueId(e,o),l=o.startTime;if(E(e,u))return void r.default.log("Skipping ad already seen with ID "+u);i&&i(e,s,u,l),n(e,s,u,l),b(e,u)}};var A={},w=r.default;A.isMiddlewareMediatorSupported=function(){return!w.browser.IS_IOS&&!w.browser.IS_ANDROID&&!!(w.use&&w.middleware&&w.middleware.TERMINATOR)},A.playMiddleware=function(e){return{setSource:function(e,t){t(null,e)},callPlay:function(){if(e.ads&&!0===e.ads._shouldBlockPlay)return e.ads.debug("Using playMiddleware to block content playback"),e.ads._playBlocked=!0,w.middleware.TERMINATOR},play:function(t,n){e.ads&&e.ads._playBlocked&&t?(e.ads.debug("Play call to Tech was terminated."),e.trigger("play"),e.addClass("vjs-has-started"),e.ads._playBlocked=!1):n&&n.catch&&n.catch(function(t){"NotAllowedError"!==t.name||r.default.browser.IS_SAFARI||e.trigger("pause")})}}},A.testHook=function(e){w=e};var I=A.playMiddleware,C=A.isMiddlewareMediatorSupported,R=function(){if(r.default.getPlugin)return Boolean(r.default.getPlugin("ads"));var e=r.default.getComponent("Player");return Boolean(e&&e.prototype.ads)};var D=function(){function e(){}return e.getState=function(t){if(t)return e.states_&&e.states_[t]?e.states_[t]:void 0},e.registerState=function(t,n){if("string"!==typeof t||!t)throw new Error('Illegal state name, "'+t+'"; must be a non-empty string.');return e.states_||(e.states_={}),e.states_[t]=n,n},e}(),M=function(){function e(e){this.player=e}e._getName=function(){return"Anonymous State"};var t=e.prototype;return t.transitionTo=function(e){var t=this.player;this.cleanup(t);var n=new e(t);t.ads._state=n,t.ads.debug(this.constructor._getName()+" -> "+n.constructor._getName());for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];n.init.apply(n,[t].concat(i))},t.init=function(){},t.cleanup=function(){},t.onPlay=function(){},t.onPlaying=function(){},t.onEnded=function(){},t.onAdEnded=function(){},t.onAdsReady=function(){r.default.log.warn("Unexpected adsready event")},t.onAdsError=function(){},t.onAdsCanceled=function(){},t.onAdTimeout=function(){},t.onAdStarted=function(){},t.onContentChanged=function(){},t.onContentResumed=function(){},t.onReadyForPostroll=function(){r.default.log.warn("Unexpected readyforpostroll event")},t.onNoPreroll=function(){},t.onNoPostroll=function(){},t.startLinearAdMode=function(){r.default.log.warn("Unexpected startLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.endLinearAdMode=function(){r.default.log.warn("Unexpected endLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.skipLinearAdMode=function(){r.default.log.warn("Unexpected skipLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.isAdState=function(){throw new Error("isAdState unimplemented for "+this.constructor._getName())},t.isWaitingForAdBreak=function(){return!1},t.isContentResuming=function(){return!1},t.inAdBreak=function(){return!1},t.handleEvent=function(e){var t=this.player;"play"===e?this.onPlay(t):"adsready"===e?this.onAdsReady(t):"adserror"===e?this.onAdsError(t):"adscanceled"===e?this.onAdsCanceled(t):"adtimeout"===e?this.onAdTimeout(t):"ads-ad-started"===e?this.onAdStarted(t):"contentchanged"===e?this.onContentChanged(t):"contentresumed"===e?this.onContentResumed(t):"readyforpostroll"===e?this.onReadyForPostroll(t):"playing"===e?this.onPlaying(t):"ended"===e?this.onEnded(t):"nopreroll"===e?this.onNoPreroll(t):"nopostroll"===e?this.onNoPostroll(t):"adended"===e&&this.onAdEnded(t)},e}();function O(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}D.registerState("State",M);var N=function(e){function t(t){var n;return(n=e.call(this,t)||this).contentResuming=!1,n.waitingForAdBreak=!1,n}O(t,e);var n=t.prototype;return n.isAdState=function(){return!0},n.onPlaying=function(){var e=D.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},n.onContentResumed=function(){var e=D.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},n.isWaitingForAdBreak=function(){return this.waitingForAdBreak},n.isContentResuming=function(){return this.contentResuming},n.inAdBreak=function(){return!0===this.player.ads._inLinearAdMode},t}(M);D.registerState("AdState",N);var P=function(e){function t(){return e.apply(this,arguments)||this}O(t,e);var n=t.prototype;return n.isAdState=function(){return!1},n.onContentChanged=function(e){var t=D.getState("BeforePreroll"),n=D.getState("Preroll");e.ads.debug("Received contentchanged event (ContentState)"),e.paused()?this.transitionTo(t):(this.transitionTo(n,!1),e.pause(),e.ads._pausedOnContentupdate=!0)},t}(M);D.registerState("ContentState",P);var L,k=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"AdsDone"};var n=t.prototype;return n.init=function(e){e.ads._contentHasEnded=!0,e.trigger("ended")},n.startLinearAdMode=function(){r.default.log.warn("Unexpected startLinearAdMode invocation (AdsDone)")},t}(D.getState("ContentState"));D.registerState("AdsDone",k);var x={start:function(e){e.ads.debug("Starting ad break"),e.ads._inLinearAdMode=!0,e.trigger("adstart"),e.ads.shouldTakeSnapshots()&&(e.ads.snapshot=function(e){var t;t=r.default.browser.IS_IOS&&e.ads.isLive(e)&&e.seekable().length>0?e.currentTime()-e.seekable().end(0):e.currentTime();var n=e.$(".vjs-tech"),i=e.textTracks?e.textTracks():[],a=[],o={ended:e.ended(),currentSrc:e.currentSrc(),sources:e.currentSources(),src:e.tech_.src(),currentTime:t,type:e.currentType()};n&&(o.style=n.getAttribute("style"));for(var s=0;s<i.length;s++){var u=i[s];a.push({track:u,mode:u.mode}),u.mode="disabled"}return o.suppressedTracks=a,o}(e)),e.ads.shouldPlayContentBehindAd(e)&&(e.ads.preAdVolume_=e.volume(),e.volume(0)),e.addClass("vjs-ad-playing"),e.hasClass("vjs-live")&&e.removeClass("vjs-live"),e.ads.removeNativePoster()},end:function(e,t){e.ads.debug("Ending ad break"),void 0===t&&(t=function(){}),e.ads.adType=null,e.ads._inLinearAdMode=!1,e.trigger("adend"),e.removeClass("vjs-ad-playing"),e.ads.isLive(e)&&e.addClass("vjs-live"),e.ads.shouldTakeSnapshots()?function(e,t){var n=e.ads.snapshot;if(void 0===t&&(t=function(){}),!0===e.ads.disableNextSnapshotRestore)return e.ads.disableNextSnapshotRestore=!1,delete e.ads.snapshot,void t();var i,a=e.$(".vjs-tech"),o=20,s=n.suppressedTracks,u=function(){for(var e=0;e<s.length;e++)(i=s[e]).track.mode=i.mode},l=function(){var t;if(r.default.browser.IS_IOS&&e.ads.isLive(e)){if(n.currentTime<0&&(t=e.seekable().length>0?e.seekable().end(0)+n.currentTime:e.currentTime(),e.currentTime(t)),e.paused()){var i=e.play();i&&i.catch&&i.catch(function(e){r.default.log.warn("Play promise rejected in IOS snapshot resume",e)})}}else if(n.ended)e.currentTime(e.duration());else{e.currentTime(n.currentTime);var a=e.play();a&&a.catch&&a.catch(function(e){r.default.log.warn("Play promise rejected in snapshot resume",e)})}e.ads.shouldRemoveAutoplay_&&(e.autoplay(!1),e.ads.shouldRemoveAutoplay_=!1)},d=function t(){if(e.off("contentcanplay",t),L&&e.clearTimeout(L),(a=e.el().querySelector(".vjs-tech")).readyState>1)return l();if(void 0===a.seekable)return l();if(a.seekable.length>0)return l();if(o--)e.setTimeout(t,50);else try{l()}catch(n){r.default.log.warn("Failed to resume the content after an advertisement",n)}};if("style"in n&&a.setAttribute("style",n.style||""),e.ads.videoElementRecycled())e.one("resumeended",function(){delete e.ads.snapshot,t()}),e.one("contentloadedmetadata",u),r.default.browser.IS_IOS&&!e.autoplay()&&(e.autoplay(!0),e.ads.shouldRemoveAutoplay_=!0),e.src(n.sources),e.one("contentcanplay",d),L=e.setTimeout(d,2e3);else{if(u(),!e.ended()){var c=e.play();c&&c.catch&&c.catch(function(e){r.default.log.warn("Play promise rejected in snapshot restore",e)})}delete e.ads.snapshot,t()}}(e,t):(e.volume(e.ads.preAdVolume_),t())}},F=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"Preroll"};var n=t.prototype;return n.init=function(e,t,n){if(this.waitingForAdBreak=!0,e.addClass("vjs-ad-loading"),n||e.ads.nopreroll_)return this.resumeAfterNoPreroll(e);var r=e.ads.settings.timeout;"number"===typeof e.ads.settings.prerollTimeout&&(r=e.ads.settings.prerollTimeout),this._timeout=e.setTimeout(function(){e.trigger("adtimeout")},r),t?this.handleAdsReady():this.adsReady=!1},n.onAdsReady=function(e){e.ads.inAdBreak()?r.default.log.warn("Unexpected adsready event (Preroll)"):(e.ads.debug("Received adsready event (Preroll)"),this.handleAdsReady())},n.handleAdsReady=function(){this.adsReady=!0,this.readyForPreroll()},n.afterLoadStart=function(e){var t=this.player;t.ads._hasThereBeenALoadStartDuringPlayerLife?e():(t.ads.debug("Waiting for loadstart..."),t.one("loadstart",function(){t.ads.debug("Received loadstart event"),e()}))},n.noPreroll=function(){var e=this;this.afterLoadStart(function(){e.player.ads.debug("Skipping prerolls due to nopreroll event (Preroll)"),e.resumeAfterNoPreroll(e.player)})},n.readyForPreroll=function(){var e=this.player;this.afterLoadStart(function(){e.ads.debug("Triggered readyforpreroll event (Preroll)"),e.trigger("readyforpreroll")})},n.onAdsCanceled=function(e){var t=this;e.ads.debug("adscanceled (Preroll)"),this.afterLoadStart(function(){t.resumeAfterNoPreroll(e)})},n.onAdsError=function(e){var t=this;r.default.log("adserror (Preroll)"),this.inAdBreak()?e.ads.endLinearAdMode():this.afterLoadStart(function(){t.resumeAfterNoPreroll(e)})},n.startLinearAdMode=function(){var e=this.player;!this.adsReady||e.ads.inAdBreak()||this.isContentResuming()?r.default.log.warn("Unexpected startLinearAdMode invocation (Preroll)"):(this.clearTimeout(e),e.ads.adType="preroll",this.waitingForAdBreak=!1,x.start(e),e.ads._shouldBlockPlay=!1)},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(e.removeClass("vjs-ad-loading"),e.addClass("vjs-ad-content-resuming"),this.contentResuming=!0,x.end(e))},n.skipLinearAdMode=function(){var e=this,t=this.player;t.ads.inAdBreak()||this.isContentResuming()?r.default.log.warn("Unexpected skipLinearAdMode invocation"):this.afterLoadStart(function(){t.trigger("adskip"),t.ads.debug("skipLinearAdMode (Preroll)"),e.resumeAfterNoPreroll(t)})},n.onAdTimeout=function(e){var t=this;this.afterLoadStart(function(){e.ads.debug("adtimeout (Preroll)"),t.resumeAfterNoPreroll(e)})},n.onNoPreroll=function(e){e.ads.inAdBreak()||this.isContentResuming()?r.default.log.warn("Unexpected nopreroll event (Preroll)"):this.noPreroll()},n.resumeAfterNoPreroll=function(e){if(this.contentResuming=!0,e.ads._shouldBlockPlay=!1,this.cleanupPartial(e),e.ads._playRequested||e.ads._pausedOnContentupdate)if(e.paused()){e.ads.debug("resumeAfterNoPreroll: attempting to resume playback (Preroll)");var t=e.play();t&&t.then&&t.then(null,function(e){})}else e.ads.debug("resumeAfterNoPreroll: already playing (Preroll)"),e.trigger("play"),e.trigger("playing")},n.cleanup=function(e){e.ads._hasThereBeenALoadStartDuringPlayerLife||r.default.log.warn("Leaving Preroll state before loadstart event can cause issues."),this.cleanupPartial(e)},n.cleanupPartial=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming"),this.clearTimeout(e)},n.clearTimeout=function(e){e.clearTimeout(this._timeout),this._timeout=null},t}(D.getState("AdState"));D.registerState("Preroll",F);var U=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"BeforePreroll"};var n=t.prototype;return n.init=function(e){this.adsReady=!1,this.shouldResumeToContent=!1,e.ads._shouldBlockPlay=!e.ads.settings.allowVjsAutoplay||!e.autoplay()},n.onAdsReady=function(e){e.ads.debug("Received adsready event (BeforePreroll)"),this.adsReady=!0},n.onPlay=function(e){var t=D.getState("Preroll");e.ads.debug("Received play event (BeforePreroll)"),this.transitionTo(t,this.adsReady,this.shouldResumeToContent)},n.onAdsCanceled=function(e){e.ads.debug("adscanceled (BeforePreroll)"),this.shouldResumeToContent=!0},n.onAdsError=function(){this.player.ads.debug("adserror (BeforePreroll)"),this.shouldResumeToContent=!0},n.onNoPreroll=function(){this.player.ads.debug("Skipping prerolls due to nopreroll event (BeforePreroll)"),this.shouldResumeToContent=!0},n.skipLinearAdMode=function(){var e=this.player;e.trigger("adskip"),e.ads.debug("skipLinearAdMode (BeforePreroll)"),this.shouldResumeToContent=!0},n.onContentChanged=function(){this.init(this.player)},t}(D.getState("ContentState"));D.registerState("BeforePreroll",U);var B=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"Midroll"};var n=t.prototype;return n.init=function(e){e.ads.adType="midroll",x.start(e),e.addClass("vjs-ad-loading")},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(this.contentResuming=!0,e.addClass("vjs-ad-content-resuming"),e.removeClass("vjs-ad-loading"),x.end(e))},n.onAdsError=function(e){this.inAdBreak()&&e.ads.endLinearAdMode()},n.cleanup=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming")},t}(D.getState("AdState"));D.registerState("Midroll",B);var j=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"Postroll"};var n=t.prototype;return n.init=function(e){if(this.waitingForAdBreak=!0,e.ads._contentEnding=!0,e.ads.nopostroll_){this.resumeContent(e);var t=D.getState("AdsDone");this.transitionTo(t)}else{e.addClass("vjs-ad-loading");var n=e.ads.settings.timeout;"number"===typeof e.ads.settings.postrollTimeout&&(n=e.ads.settings.postrollTimeout),this._postrollTimeout=e.setTimeout(function(){e.trigger("adtimeout")},n)}},n.startLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?r.default.log.warn("Unexpected startLinearAdMode invocation (Postroll)"):(e.ads.adType="postroll",e.clearTimeout(this._postrollTimeout),this.waitingForAdBreak=!1,x.start(e))},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this,t=this.player,n=D.getState("AdsDone");this.inAdBreak()&&(t.removeClass("vjs-ad-loading"),this.resumeContent(t),x.end(t,function(){e.transitionTo(n)}))},n.skipLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?r.default.log.warn("Unexpected skipLinearAdMode invocation"):(e.ads.debug("Postroll abort (skipLinearAdMode)"),e.trigger("adskip"),this.abort(e))},n.onAdTimeout=function(e){e.ads.debug("Postroll abort (adtimeout)"),this.abort(e)},n.onAdsError=function(e){e.ads.debug("Postroll abort (adserror)"),e.ads.inAdBreak()?e.ads.endLinearAdMode():this.abort(e)},n.onContentChanged=function(e){if(this.isContentResuming()){var t=D.getState("BeforePreroll");this.transitionTo(t)}else if(!this.inAdBreak()){var n=D.getState("Preroll");this.transitionTo(n)}},n.onNoPostroll=function(e){this.isContentResuming()||this.inAdBreak()?r.default.log.warn("Unexpected nopostroll event (Postroll)"):this.abort(e)},n.resumeContent=function(e){this.contentResuming=!0,e.addClass("vjs-ad-content-resuming")},n.abort=function(e){var t=D.getState("AdsDone");this.resumeContent(e),e.removeClass("vjs-ad-loading"),this.transitionTo(t)},n.cleanup=function(e){e.removeClass("vjs-ad-content-resuming"),e.clearTimeout(this._postrollTimeout),e.ads._contentEnding=!1},t}(D.getState("AdState"));D.registerState("Postroll",j);var G=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"ContentPlayback"};var n=t.prototype;return n.init=function(e){e.ads._shouldBlockPlay=!1},n.onAdsReady=function(e){e.ads.debug("Received adsready event (ContentPlayback)"),e.ads.nopreroll_||(e.ads.debug("Triggered readyforpreroll event (ContentPlayback)"),e.trigger("readyforpreroll"))},n.onReadyForPostroll=function(e){var t=D.getState("Postroll");e.ads.debug("Received readyforpostroll event"),this.transitionTo(t)},n.startLinearAdMode=function(){var e=D.getState("Midroll");this.transitionTo(e)},t}(D.getState("ContentState"));D.registerState("ContentPlayback",G);var q=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"StitchedContentPlayback"};var n=t.prototype;return n.init=function(){this.player.ads._shouldBlockPlay=!1},n.onContentChanged=function(){this.player.ads.debug("Received contentchanged event ("+this.constructor._getName()+")")},n.startLinearAdMode=function(){var e=D.getState("StitchedAdRoll");this.transitionTo(e)},t}(D.getState("ContentState"));D.registerState("StitchedContentPlayback",q);var H=function(e){function t(){return e.apply(this,arguments)||this}O(t,e),t._getName=function(){return"StitchedAdRoll"};var n=t.prototype;return n.init=function(){this.waitingForAdBreak=!1,this.contentResuming=!1,this.player.ads.adType="stitched",x.start(this.player)},n.onPlaying=function(){},n.onContentResumed=function(){},n.onAdEnded=function(){this.endLinearAdMode(),this.player.trigger("ended")},n.endLinearAdMode=function(){var e=D.getState("StitchedContentPlayback");x.end(this.player),this.transitionTo(e)},t}(D.getState("AdState"));D.registerState("StitchedAdRoll",H);var V=A.isMiddlewareMediatorSupported,K=r.default.getTech("Html5").Events,Y={timeout:5e3,prerollTimeout:void 0,postrollTimeout:void 0,debug:!1,stitchedAds:!1,contentIsLive:void 0,liveCuePoints:!0,allowVjsAutoplay:r.default.options.normalizeAutoplay||!1},W=function(e){var t=this,n=r.default.mergeOptions(Y,e),i=[];K.concat(["firstplay","loadedalldata"]).forEach(function(e){-1===i.indexOf(e)&&i.push(e)}),t.on(i,g),V()||function(e,t){t&&r.default.log("Using cancelContentPlay to block content playback"),e.on("play",S)}(t,n.debug),t.setTimeout(function(){t.ads._hasThereBeenALoadStartDuringPlayerLife||""===t.src()||r.default.log.error("videojs-contrib-ads has not seen a loadstart event 5 seconds after being initialized, but a source is present. This indicates that videojs-contrib-ads was initialized too late. It must be initialized immediately after video.js in the same tick. As a result, some ads will not play and some media events will be incorrect. For more information, see http://videojs.github.io/videojs-contrib-ads/integrator/getting-started.html")},5e3),t.on("ended",function(){t.hasClass("vjs-has-started")||t.addClass("vjs-has-started")}),t.on("contenttimeupdate",function(){t.removeClass("vjs-waiting")}),t.on(["addurationchange","adcanplay"],function(){if(!t.ads.settings.stitchedAds&&!t.hasStarted()&&(!t.ads.snapshot||t.currentSrc()!==t.ads.snapshot.currentSrc)&&t.ads.inAdBreak()){var e=t.play();e&&e.catch&&e.catch(function(e){r.default.log.warn("Play promise rejected when playing ad",e)})}}),t.on("nopreroll",function(){t.ads.debug("Received nopreroll event"),t.ads.nopreroll_=!0}),t.on("nopostroll",function(){t.ads.debug("Received nopostroll event"),t.ads.nopostroll_=!0}),t.on("playing",function(){t.ads._cancelledPlay=!1,t.ads._pausedOnContentupdate=!1}),t.on("play",function(){t.ads._playRequested=!0}),t.one("loadstart",function(){t.ads._hasThereBeenALoadStartDuringPlayerLife=!0}),t.on("loadeddata",function(){t.ads._hasThereBeenALoadedData=!0}),t.on("loadedmetadata",function(){t.ads._hasThereBeenALoadedMetaData=!0}),t.ads=function(e){return{disableNextSnapshotRestore:!1,_contentEnding:!1,_contentHasEnded:!1,_hasThereBeenALoadStartDuringPlayerLife:!1,_hasThereBeenALoadedData:!1,_hasThereBeenALoadedMetaData:!1,_inLinearAdMode:!1,_shouldBlockPlay:!1,_playBlocked:!1,_playRequested:!1,adType:null,VERSION:u,reset:function(){e.ads.disableNextSnapshotRestore=!1,e.ads._contentEnding=!1,e.ads._contentHasEnded=!1,e.ads.snapshot=null,e.ads.adType=null,e.ads._hasThereBeenALoadedData=!1,e.ads._hasThereBeenALoadedMetaData=!1,e.ads._cancelledPlay=!1,e.ads._shouldBlockPlay=!1,e.ads._playBlocked=!1,e.ads.nopreroll_=!1,e.ads.nopostroll_=!1,e.ads._playRequested=!1},startLinearAdMode:function(){e.ads._state.startLinearAdMode()},endLinearAdMode:function(){e.ads._state.endLinearAdMode()},skipLinearAdMode:function(){e.ads._state.skipLinearAdMode()},stitchedAds:function(e){return void 0!==e&&(r.default.log.warn("Using player.ads.stitchedAds() as a setter is deprecated, it should be set as an option upon initialization of contrib-ads."),this.settings.stitchedAds=!!e),this.settings.stitchedAds},videoElementRecycled:function(){if(e.ads.shouldPlayContentBehindAd(e))return!1;if(!this.snapshot)throw new Error("You cannot use videoElementRecycled while there is no snapshot.");var t=e.tech_.src()!==this.snapshot.src,n=e.currentSrc()!==this.snapshot.currentSrc;return t||n},isLive:function(t){return void 0===t&&(t=e),"boolean"===typeof t.ads.settings.contentIsLive?t.ads.settings.contentIsLive:t.duration()===1/0||"8"===r.default.browser.IOS_VERSION&&0===t.duration()},shouldPlayContentBehindAd:function(t){if(void 0===t&&(t=e),t)return!!t.ads.settings.liveCuePoints&&!r.default.browser.IS_IOS&&!r.default.browser.IS_ANDROID&&t.duration()===1/0;throw new Error("shouldPlayContentBehindAd requires a player as a param")},shouldTakeSnapshots:function(t){return void 0===t&&(t=e),!this.shouldPlayContentBehindAd(t)&&!this.stitchedAds()},isInAdMode:function(){return this._state.isAdState()},isWaitingForAdBreak:function(){return this._state.isWaitingForAdBreak()},isContentResuming:function(){return this._state.isContentResuming()},isAdPlaying:function(){return this._state.inAdBreak()},inAdBreak:function(){return this._state.inAdBreak()},removeNativePoster:function(){var t=e.$(".vjs-tech");t&&t.removeAttribute("poster")},debug:function(){if(this.settings.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&"string"===typeof t[0]?r.default.log("ADS: "+t[0]):r.default.log.apply(r.default,["ADS:"].concat(t))}}}}(t),t.ads.settings=n,n.stitchedAds=!!n.stitchedAds,n.stitchedAds?t.ads._state=new(D.getState("StitchedContentPlayback"))(t):t.ads._state=new(D.getState("BeforePreroll"))(t),t.ads._state.init(t),t.ads.cueTextTracks=T,t.ads.adMacroReplacement=function(e,t,n){var i=this,o={};e=e.replace(/{([^}=]+)=([^}]+)}/g,function(e,t,n){return o["{"+t+"}"]=n,"{"+t+"}"}),void 0===t&&(t=!1);var u={};for(var l in void 0!==n&&(u=n),u["{player.id}"]=this.options_["data-player"]||this.id_,u["{player.height}"]=this.currentHeight(),u["{player.width}"]=this.currentWidth(),u["{mediainfo.id}"]=this.mediainfo?this.mediainfo.id:"",u["{mediainfo.name}"]=this.mediainfo?this.mediainfo.name:"",u["{mediainfo.duration}"]=this.mediainfo?this.mediainfo.duration:"",u["{player.duration}"]=this.duration(),u["{player.pageUrl}"]=r.default.dom.isInFrame()?s.a.referrer:a.a.location.href,u["{playlistinfo.id}"]=this.playlistinfo?this.playlistinfo.id:"",u["{playlistinfo.name}"]=this.playlistinfo?this.playlistinfo.name:"",u["{timestamp}"]=(new Date).getTime(),u["{document.referrer}"]=s.a.referrer,u["{window.location.href}"]=a.a.location.href,u["{random}"]=Math.floor(1e12*Math.random()),["description","tags","reference_id","ad_keys"].forEach(function(e){i.mediainfo&&i.mediainfo[e]?u["{mediainfo."+e+"}"]=i.mediainfo[e]:o["{mediainfo."+e+"}"]?u["{mediainfo."+e+"}"]=o["{mediainfo."+e+"}"]:u["{mediainfo."+e+"}"]=""}),_(this.mediainfo,u,"custom_fields"),_(this.mediainfo,u,"customFields"),Object.keys(m).forEach(function(e){u["{tcf."+e+"}"]=m[e]}),u["{tcf.gdprAppliesInt}"]=m.gdprApplies?1:0,u)e=e.split(l).join(y(u[l],t));for(var d in e=e.replace(/{pageVariable\.([^}]+)}/g,function(e,n){for(var i,s=a.a,u=n.split("."),l=0;l<u.length;l++)l===u.length-1?i=s[u[l]]:s=s[u[l]];var d=typeof i;return null===i?"null":void 0===i?o["{pageVariable."+n+"}"]?o["{pageVariable."+n+"}"]:(r.default.log.warn('Page variable "'+n+'" not found'),""):"string"!==d&&"number"!==d&&"boolean"!==d?(r.default.log.warn('Page variable "'+n+'" is not a supported type'),""):y(String(i),t)}),o)e=e.replace(d,o[d]);return e}.bind(t),function(e){e.ads.contentSrc=e.currentSrc(),e.ads._seenInitialLoadstart=!1,e.on("loadstart",function(){if(!e.ads.inAdBreak()){var t=e.currentSrc();t!==e.ads.contentSrc&&(e.ads._seenInitialLoadstart&&e.trigger({type:"contentchanged"}),e.trigger({type:"contentupdate",oldValue:e.ads.contentSrc,newValue:t}),e.ads.contentSrc=t),e.ads._seenInitialLoadstart=!0}})}(t),t.on("contentchanged",t.ads.reset);var o=function(){var e=t.textTracks();if(!t.ads.shouldPlayContentBehindAd(t)&&t.ads.inAdBreak()&&t.tech_.featuresNativeTextTracks&&r.default.browser.IS_IOS&&!Array.isArray(t.textTracks()))for(var n=0;n<e.length;n++){var i=e[n];"showing"===i.mode&&(i.mode="disabled")}};t.ready(function(){t.textTracks().addEventListener("change",o)}),t.on(["play","playing","ended","adsready","adscanceled","adskip","adserror","adtimeout","adended","ads-ad-started","contentchanged","dispose","contentresumed","readyforpostroll","nopreroll","nopostroll"],function(e){t.ads._state.handleEvent(e.type)}),t.on("dispose",function(){t.ads.reset(),t.textTracks().removeEventListener("change",o)}),v(),t.ads.listenToTcf=v};W.VERSION=u,function(e){!R(r.default)&&((r.default.registerPlugin||r.default.plugin)("ads",e),C()&&!r.default.usingContribAdsMiddleware_&&(r.default.use("*",I),r.default.usingContribAdsMiddleware_=!0,r.default.log.debug("Play middleware has been registered with videojs")))}(W)},1144:function(e,t,n){},1145:function(e,t,n){"use strict";n.r(t),function(e){var r=n(1103),i=n(1239),o=n.n(i),u=n(1311),l=n.n(u),d="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{};function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function f(e,t){return e(t={exports:{}},t.exports),t.exports}var h=f(function(e,t){!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},i={17:2,18:4,21:6,22:8,23:10,19:13,20:15},a={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},o={25:2,26:4,29:6,30:8,31:10,27:13,28:15},s=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],u={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},l=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},d=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};d.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var c=function(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new d(t,n,r,i,a)};c.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var f=function(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new c);this.pos=0,this.currPenState=new d};f.prototype={equals:function(e){for(var t=!0,n=0;n<32;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(u.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>32&&(u.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=32?u.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<32;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<32;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var h=function(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new f);this.currRow=14,this.nrRollUpRows=null,this.reset()};h.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){u.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){u.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){u.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){u.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),u.log("INFO","Rolling up")}else u.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+': "'+a+'"'):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var p=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new h,this.nonDisplayedMemory=new h,this.lastOutputScreen=new h,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};p.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,u.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";u.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(u.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){u.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){u.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){u.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){u.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){u.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){u.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){u.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){u.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){u.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){u.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){u.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(u.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,u.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){u.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}u.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=u.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var g=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new p(1,t),new p(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};g.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,u.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],r>=16&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,u.log("DEBUG","Repeated command ("+l([r,i])+") is dropped");else if(0!==r||0!==i){if(u.log("DATA","["+l([t[o],t[o+1]])+"] -> ("+l([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n)if(a=this.parseChars(r,i))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(a);else u.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,u.log("WARNING","Couldn't parse cleaned data "+l([r,i])+" orig: "+l([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return u.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),u.log("DEBUG","MIDROW ("+l([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,s=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,s=64<=t&&t<=95?1===n?r[e]:a[e]:1===n?i[e]:o[e];var u=this.interpretPAC(s,t);return this.channels[n-1].setPAC(u),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1===(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r=null,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,u.log("INFO","Special char '"+n(o)+"' in channel "+r),i=[o],this.lastCmdA=e,this.lastCmdB=t}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(i){var s=l(i);u.log("DEBUG","Char codes =  "+s.join(","))}return i},parseBackgroundAttributes:function(e,t){var n,r,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=s[r],t%2===1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};e.logger=u,e.PenState=d,e.CaptionScreen=h,e.Cea608Parser=g,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,a=[],o=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+n;){if(r=e.getUint32(i),6===(31&e.getUint8(i+4)))for(var s=i+5,u=-1;s<i+4+r-1;){u=0;for(var l=255;255===l;)u+=l=e.getUint8(s),s++;var d=0;for(l=255;255===l;)d+=l=e.getUint8(s),s++;o(u,d,e,s)&&a.push([s,d]),s+=d}i+=r+4}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var d=e.getUint8(n);n++,s&&(127&l)+(127&d)!==0&&(0===u?(r[0].push(l),r[0].push(d)):1===u&&(r[1].push(l),r[1].push(d)))}return r}}(t)}),p=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return n(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability"}}]),e}());t.default=r});c(p);var g=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return n(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate"}}]),e}());t.default=r});c(g);var m=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return n(e,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),e}());t.default=r});c(m);var v=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=void 0,t=[],n={},r={};function i(e,n){for(var r in t){var i=t[r];if(i.context===e&&i.name===n)return i.instance}return null}function a(e,t){return t[e]}function o(e,t,n){e in n&&(n[e]=t)}function s(t,n,r){var i=void 0,a=t.__dashjs_factory_name,o=n[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:n,factory:e},r);for(var u in i=t.apply({context:n},r),s=s.apply({context:n,factory:e,parent:i},r))i.hasOwnProperty(u)&&(i[u]=s[u])}else i=t.apply({context:n},r);return i.getClassName=function(){return a},i}return e={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n})},getSingletonInstance:i,setSingletonInstance:function(e,n,r){for(var i in t){var a=t[i];if(a.context===e&&a.name===n)return void(t[i].instance=r)}t.push({name:n,context:e,instance:r})},deleteSingletonInstances:function(e){t=t.filter(function(t){return t.context!==e})},getSingletonFactory:function(e){var r=a(e.__dashjs_factory_name,n);return r||(r=function(n){var r=void 0;return void 0===n&&(n={}),{getInstance:function(){return r||(r=i(n,e.__dashjs_factory_name)),r||(r=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}},n[e.__dashjs_factory_name]=r),r},getSingletonFactoryByName:function(e){return a(e,n)},updateSingletonFactory:function(e,t){o(e,t,n)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,r);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},r[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,r)},updateClassFactory:function(e,t){o(e,t,r)}}}();t.default=n});c(v);var y=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=r});c(y);var _=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=y)&&n.__esModule?n:{default:n};var i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.SOURCE_INITIALIZED="sourceInitialized",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_SEEK_ASKED="playbackSeekAsked",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.GAP_CAUSED_SEEK_TO_PERIOD_END="gapCausedSeekToPeriodEnd",e.GAP_CAUSED_INTERNAL_SEEK="gapCausedInternalSeek",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}());t.default=i});c(_);var T=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};var i=0;function a(){var e={};function t(t,n,r){var i=-1;return e[t]?(e[t].some(function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0}),i):i}return{on:function(n,r,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n)throw new Error("event type cannot be null or undefined");if(!r||"function"!==typeof r)throw new Error("listener must be a function: "+r);var s=o.priority||i;if(!(t(n,r,a)>=0)){e[n]=e[n]||[];var u={callback:r,scope:a,priority:s};a&&a.getStreamId&&(u.streamId=a.getStreamId()),a&&a.getType&&(u.mediaType=a.getType()),o&&o.mode&&(u.mode=o.mode),e[n].some(function(t,r){if(t&&s>t.priority)return e[n].splice(r,0,u),!0})||e[n].push(u)}},off:function(n,r,i){if(n&&r&&e[n]){var a=t(n,r,i);a<0||(e[n][a]=null)}},trigger:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,r.streamId&&(n.streamId=r.streamId),r.mediaType&&(n.mediaType=r.mediaType),e[t].filter(function(e){return!!e&&(!r.streamId||!e.streamId||e.streamId===r.streamId)&&(!r.mediaType||!e.mediaType||e.mediaType===r.mediaType)&&!(r.mode&&e.mode&&e.mode!==r.mode||!e.mode&&r.mode&&r.mode===_.EVENT_MODE_ON_RECEIVE)}).forEach(function(e){return e&&e.callback.call(e.scope,n)})}},reset:function(){e={}}}}a.__dashjs_factory_name="EventBus";var o=r.default.getSingletonFactory(a);o.EVENT_PRIORITY_LOW=i,o.EVENT_PRIORITY_HIGH=5e3,r.default.updateSingletonFactory(a.__dashjs_factory_name,o),t.default=o});c(T);var E=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=y)&&n.__esModule?n:{default:n};var i=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.BYTES_APPENDED="bytesAppended",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.DATA_UPDATE_STARTED="dataUpdateStarted",e.INBAND_EVENTS="inbandEvents",e.INITIALIZATION_LOADED="initializationLoaded",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.REPRESENTATION_UPDATE_STARTED="representationUpdateStarted",e.REPRESENTATION_UPDATE_COMPLETED="representationUpdateCompleted",e.SEGMENTS_LOADED="segmentsLoaded",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_COMPLETED="streamCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEGMENTBASE_INIT_REQUEST_NEEDED="segmentBaseInitRequestNeeded",e.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED="segmentBaseSegmentsListRequestNeeded",e.SEEK_TARGET="seekTarget",e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=i});c(E);var b=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=E)&&n.__esModule?n:{default:n};var i=new(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}());t.default=i});c(b);var S=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(T),r=a(b),i=a(v);function a(e){return e&&e.__esModule?e:{default:e}}var o=1,s=2,u=3,l=4,d=5;function c(e){e=e||{};var t,i=this.context,a=(0,n.default)(i).getInstance(),c=e.settings,f=[],h=void 0,p=void 0,g=void 0;function m(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function v(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[o,this].concat(t))}function y(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[s,this].concat(t))}function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[u,this].concat(t))}function T(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[l,this].concat(t))}function E(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[d,this].concat(t))}function b(e,t){var n="",i=null;h&&(i=(new Date).getTime(),n+="["+(i-g)+"]"),p&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),n.length>0&&(n+=" ");for(var o=arguments.length,s=Array(o>2?o-2:0),u=2;u<o;u++)s[u-2]=arguments[u];Array.apply(null,s).forEach(function(e){n+=e+" "}),f[e]&&c.get().debug.logLevel>=e&&f[e](n),c&&c.get().debug.dispatchEvent&&a.trigger(r.default.LOG,{message:n,level:e})}return t={getLogger:function(e){return{fatal:v.bind(e),error:y.bind(e),warn:_.bind(e),info:T.bind(e),debug:E.bind(e)}},setLogTimestampVisible:function(e){h=e},setCalleeNameVisible:function(e){p=e}},h=!0,p=!0,g=(new Date).getTime(),"undefined"!==typeof window&&window.console&&(f[o]=m(window.console.error),f[s]=m(window.console.error),f[u]=m(window.console.warn),f[l]=m(window.console.info),f[d]=m(window.console.debug)),t}c.__dashjs_factory_name="Debug";var f=i.default.getSingletonFactory(c);f.LOG_LEVEL_NONE=0,f.LOG_LEVEL_FATAL=o,f.LOG_LEVEL_ERROR=s,f.LOG_LEVEL_WARNING=u,f.LOG_LEVEL_INFO=l,f.LOG_LEVEL_DEBUG=d,i.default.updateSingletonFactory(c.__dashjs_factory_name,f),t.default=f});c(S);var A=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=u(p),r=u(m),i=u(T),a=u(b),o=u(v),s=u(S);function u(e){return e&&e.__esModule?e:{default:e}}var l=500;function d(){var e=this.context,t=(0,i.default)(e).getInstance(),o=void 0,u=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0,S=void 0,A=void 0,w=void 0,I=void 0,C=void 0,R=void 0,D=void 0,M=void 0;function O(e){if(!g||!isNaN(m)){var n=m;if(isNaN(n))if(T){n=e.liveStartTime;var r=c.getCurrentDVRInfo(),i=r?r.range:null;if(i){var o=Y(!0);isNaN(o)||(u.info("Start time from URI parameters: "+o),n=Math.max(Math.min(n,o),i.start))}}else{n=_.start;var s=Y(!1);!isNaN(s)&&s<n+_.duration&&(u.info("Start time from URI parameters: "+s),n=Math.max(n,s))}isNaN(n)||n===h.getTime()||(t.trigger(a.default.PLAYBACK_SEEKING,{seekTime:n}),U(n,!1,!0))}}function N(){return parseFloat((P()-B()).toFixed(5))}function P(){return _.start+_.duration}function L(){_&&h&&h.getElement()?h.play():b=!0}function k(){return _&&h?h.isPaused():null}function x(){_&&h&&h.pause()}function F(){return _&&h?h.isSeeking():null}function U(e,n,r){_&&h&&(e!==(isNaN(w)?h.getTime():w)&&(!0===r?(h.removeEventListener("seeking",ne),u.info("Requesting internal seek to time: "+e),h.setCurrentTime(e,n)):(w=e,t.trigger(a.default.PLAYBACK_SEEK_ASKED),u.info("Requesting seek to time: "+e),h.setCurrentTime(e,n))))}function B(){return _&&h?h.getTime():null}function j(){var e=B();if(T&&!isNaN(A)){var t=A/1e3;e>t&&(e-=t)}return e}function G(){return _&&h?h.getPlaybackRate():null}function q(){return _&&h?h.getEnded():null}function H(){return T}function V(){if(!T||isNaN(A))return NaN;var e=j();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*p.getClientTimeOffset();return Math.max(((t-A-1e3*e)/1e3).toFixed(3),0)}function K(){b=!1,g=!1,m=NaN,y=0,A=0,w=NaN,h&&(t.off(a.default.STREAM_INITIALIZED,O,this),t.off(a.default.DATA_UPDATE_COMPLETED,Q,this),t.off(a.default.BUFFER_LEVEL_STATE_CHANGED,ve,this),t.off(a.default.LOADING_PROGRESS,me,this),t.off(a.default.PLAYBACK_PROGRESS,ce,this),t.off(a.default.PLAYBACK_TIME_UPDATED,ce,this),t.off(a.default.PLAYBACK_ENDED,le,this),t.off(a.default.STREAM_INITIALIZING,_e,this),z(),h.removeEventListener("canplay",$),h.removeEventListener("play",Z),h.removeEventListener("waiting",J),h.removeEventListener("playing",ee),h.removeEventListener("pause",te),h.removeEventListener("error",de),h.removeEventListener("seeking",ne),h.removeEventListener("seeked",re),h.removeEventListener("timeupdate",ie),h.removeEventListener("progress",ae),h.removeEventListener("ratechange",oe),h.removeEventListener("loadedmetadata",se),h.removeEventListener("stalled",ye),h.removeEventListener("ended",ue)),v=null,h=null,_=null,T=null}function Y(e){var t=D.getURIFragmentData();if(!t||!t.t)return NaN;var n=d.getStreams()[0].getStreamInfo().start;t.t=t.t.split(",")[0];var r=-1!==t.t.indexOf("posix:")?"now"===t.t.substring(6)?Date.now()/1e3:parseInt(t.t.substring(6)):NaN;return e&&!isNaN(r)?r-A/1e3:parseInt(t.t)+n}function W(){if(null===v){v=setInterval(function(){t.trigger(a.default.WALLCLOCK_TIME_UPDATED,{isDynamic:T,time:new Date}),H()&&k()&&function(){var e=Date.now();(!S||e>S+l)&&(S=e,ie())}()},M.get().streaming.wallclockTimeUpdateInterval)}}function z(){clearInterval(v),v=null}function X(){if(!k()&&T&&0!==h.getReadyState()){var e=j(),t=function(e){var t=c.getCurrentDVRInfo(),n=t?t.range:null;return n?(u.debug("Checking DVR window for at "+e+" with DVR window range "+n.start+" - "+n.end),e>n.end?Math.max(n.end-y,n.start):e>0&&e+.25<n.start&&Math.abs(e-n.start)<31536e4?n.start:e):NaN}(e);!isNaN(t)&&t!==e&&(u.debug("UpdateCurrentTime: Seek to actual time: "+t+" from currentTime: "+e),U(t))}}function Q(e){if(!e.error){var t=f.convertDataToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&_.id===n.id&&(_=n,X())}}function $(){t.trigger(a.default.CAN_PLAY)}function Z(){u.info("Native video element event: play"),X(),W(),t.trigger(a.default.PLAYBACK_STARTED,{startTime:B()})}function J(){u.info("Native video element event: waiting"),t.trigger(a.default.PLAYBACK_WAITING,{playingTime:B()})}function ee(){u.info("Native video element event: playing"),t.trigger(a.default.PLAYBACK_PLAYING,{playingTime:B()})}function te(){u.info("Native video element event: pause"),t.trigger(a.default.PLAYBACK_PAUSED,{ended:q()})}function ne(){var e=B();isNaN(w)||w===e||(e=w),w=NaN,u.info("Seeking to: "+e),W(),t.trigger(a.default.PLAYBACK_SEEKING,{seekTime:e})}function re(){u.info("Native video element event: seeked"),t.trigger(a.default.PLAYBACK_SEEKED),h.addEventListener("seeking",ne)}function ie(){_&&t.trigger(a.default.PLAYBACK_TIME_UPDATED,{timeToEnd:N(),time:B()})}function ae(){t.trigger(a.default.PLAYBACK_PROGRESS)}function oe(){var e=G();u.info("Native video element event: ratechange: ",e),t.trigger(a.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function se(){u.info("Native video element event: loadedmetadata"),t.trigger(a.default.PLAYBACK_METADATA_LOADED),W()}function ue(){u.info("Native video element event: ended"),x(),z(),t.trigger(a.default.PLAYBACK_ENDED,{isLast:d.getActiveStreamInfo().isLast})}function le(e){if(v&&e.isLast){u.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var t=e.seekTime?e.seekTime:P();h.setCurrentTime(t),x(),z()}}function de(e){var n=e.target||e.srcElement;t.trigger(a.default.PLAYBACK_ERROR,{error:n.error})}function ce(){T&&fe()&&M.get().streaming.liveCatchup.playbackRate>0&&!k()&&!F()&&(function(){try{if(fe()&&M.get().streaming.liveCatchup.playbackRate>0&&B()>0){var e=pe(),t=V(),r=E.getLiveDelay(),i=E.getLiveCatchupLatencyThreshold(),a=M.get().streaming.liveCatchup.minDrift;if(e===n.default.LIVE_CATCHUP_MODE_LOLP){var o=he(),s=M.get().streaming.liveCatchup.playbackBufferMin;return function(e,t,n,r,i,a){try{var o=Math.abs(e-t);return(isNaN(a)||e<=a)&&(o>n||r<i)}catch(s){return!1}}(t,r,a,o,s,i)}return function(e,t,n,r){try{var i=Math.abs(e-t);return i>r&&(isNaN(n)||e<=n)}catch(a){return!1}}(t,r,i,a)}}catch(u){return!1}}()?function(){if(h){var e=void 0,t=h.getPlaybackRate(),r=M.get().streaming.liveCatchup.playbackRate,i=V(),a=E.getLiveDelay(),o=he();if(pe()===n.default.LIVE_CATCHUP_MODE_LOLP){M.get().streaming.liveCatchup.minDrift;var s=M.get().streaming.liveCatchup.playbackBufferMin;e=function(e,t,n,r,i,a,o){var s=e,l=void 0;if(a<i){var d=a-i,c=5*d,f=2*s/(1+Math.pow(Math.E,-c));l=1-s+f,u.debug("[LoL+ playback control_buffer-based] bufferLevel: "+a+", newRate: "+l)}else{if(Math.abs(t-n)<=.02*n)l=1;else{var h=t-n,p=5*h,g=2*s/(1+Math.pow(Math.E,-p));l=1-s+g}u.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+l)}C&&a>n/2&&(C=!1);Math.abs(o-l)<=R&&(l=null);return{newRate:l}}(r,i,a,0,s,o,t)}else e=function(e,t,n,r,i){var a=e,o=t-n,s=5*o,u=2*a/(1+Math.pow(Math.E,-s)),l=1-a+u;C&&(r>n/2?C=!1:o>0&&(l=1));Math.abs(i-l)<=R&&(l=null);return{newRate:l}}(r,i,a,o,t);var l=e.newRate;l&&h.setPlaybackRate(l);var d=i-a;M.get().streaming.liveCatchup.maxDrift>0&&!I&&d>M.get().streaming.liveCatchup.maxDrift?(u.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),I=!0,function(){var e=c.getCurrentDVRInfo();U((e?e.range:null).end-E.getLiveDelay(),!0,!1)}()):I=!1}}():ge())}function fe(){return M.get().streaming.liveCatchup.enabled||M.get().streaming.lowLatencyEnabled}function he(){var e=null;return d.getActiveStreamProcessors().forEach(function(t){var n=t.getBufferLevel();e=null===e?n:Math.min(e,n)}),e}function pe(){var e=M.get().streaming.liveCatchup.playbackBufferMin;return M.get().streaming.liveCatchup.mode!==n.default.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?n.default.LIVE_CATCHUP_MODE_DEFAULT:n.default.LIVE_CATCHUP_MODE_LOLP}function ge(){h&&h.setPlaybackRate(1)}function me(e){if(!1===e.stream&&M.get().streaming.lowLatencyEnabled&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;if(t>E.getLiveDelay()){u.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2));var n={streaming:{liveDelay:t}};M.update(n)}}}function ve(e){e.streamId===_.id&&(fe()?e.state!==r.default.BUFFER_EMPTY||F()||C||(C=!0,ge()):h.setStallState(e.mediaType,e.state===r.default.BUFFER_EMPTY))}function ye(e){t.trigger(a.default.PLAYBACK_STALLED,{e:e})}function _e(e){!function(e,t){if(e&&e.manifestInfo&&e.manifestInfo.serviceDescriptions){for(var r=void 0,i=0;i<e.manifestInfo.serviceDescriptions.length;i++){var a=e.manifestInfo.serviceDescriptions[i];if(a.schemeIdUri===n.default.SERVICE_DESCRIPTION_LL_SCHEME){r=a;break}}r&&t&&t.supplementalProperties&&"true"===t.supplementalProperties[n.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]&&(r.latency&&r.latency.target>0&&(u.debug("Apply LL properties coming from service description. Target Latency (ms):",r.latency.target),M.update({streaming:{lowLatencyEnabled:!0,liveDelay:r.latency.target/1e3,liveCatchup:{minDrift:r.latency.max>r.latency.target?(r.latency.max-r.latency.target)/1e3:void 0}}})),r.playbackRate&&r.playbackRate.max>1&&(u.debug("Apply LL properties coming from service description. Max PlaybackRate:",r.playbackRate.max),M.update({streaming:{lowLatencyEnabled:!0,liveCatchup:{playbackRate:r.playbackRate.max-1}}})))}}(e.streamInfo,e.mediaInfo)}return o={initialize:function(e,n,r){_=e,h.addEventListener("canplay",$),h.addEventListener("play",Z),h.addEventListener("waiting",J),h.addEventListener("playing",ee),h.addEventListener("pause",te),h.addEventListener("error",de),h.addEventListener("seeking",ne),h.addEventListener("seeked",re),h.addEventListener("timeupdate",ie),h.addEventListener("progress",ae),h.addEventListener("ratechange",oe),h.addEventListener("loadedmetadata",se),h.addEventListener("stalled",ye),h.addEventListener("ended",ue),T=_.manifestInfo.isDynamic,I=!1,C=!1,g=!0===n,m=r;var o="undefined"!==typeof navigator?navigator.userAgent.toLowerCase():"",s=/safari/.test(o)&&!/chrome/.test(o);R=s?.25:.02,t.on(a.default.STREAM_INITIALIZED,O,this),t.on(a.default.DATA_UPDATE_COMPLETED,Q,this),t.on(a.default.LOADING_PROGRESS,me,this),t.on(a.default.BUFFER_LEVEL_STATE_CHANGED,ve,this),t.on(a.default.PLAYBACK_PROGRESS,ce,this),t.on(a.default.PLAYBACK_TIME_UPDATED,ce,this),t.on(a.default.PLAYBACK_ENDED,le,this,{priority:i.default.EVENT_PRIORITY_HIGH}),t.on(a.default.STREAM_INITIALIZING,_e,this),b&&(b=!1,L())},setConfig:function(e){e&&(e.streamController&&(d=e.streamController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(E=e.mediaPlayerModel),e.adapter&&(f=e.adapter),e.videoModel&&(h=e.videoModel),e.timelineConverter&&(p=e.timelineConverter),e.uriFragmentModel&&(D=e.uriFragmentModel),e.settings&&(M=e.settings))},getStartTimeFromUriParameters:Y,getTimeToStreamEnd:N,getTime:B,getNormalizedTime:j,getPlaybackRate:G,getPlayedRanges:function(){return _&&h?h.getPlayedRanges():null},getEnded:q,getIsDynamic:H,getStreamController:function(){return d},computeAndSetLiveDelay:function(e,t,n){var r,i=void 0,a=void 0,o=!isNaN(e)&&isFinite(e)?e:NaN,s=f.getSuggestedPresentationDelay();if(i=M.get().streaming.lowLatencyEnabled?0:E.getLiveDelay()?E.getLiveDelay():null===M.get().streaming.liveDelayFragmentCount||isNaN(M.get().streaming.liveDelayFragmentCount)||isNaN(o)?!0===M.get().streaming.useSuggestedPresentationDelay&&null!==s&&!isNaN(s)&&s>0?s:isNaN(o)?isNaN(n)?4*_.manifestInfo.minBufferTime:4*n:4*o:o*M.get().streaming.liveDelayFragmentCount,null!==(r=f.getAvailabilityStartTime())&&(A=r),t>0){var u=Math.max(t-10,t/2);a=Math.min(i,u)}else a=i;return y=a,a},getLiveDelay:function(){return y},setLiveDelay:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&e<y||(y=e)},getCurrentLiveLatency:V,play:L,isPaused:k,pause:x,isSeeking:F,getStreamEndTime:P,seek:U,reset:K},u=(0,s.default)(e).getInstance().getLogger(o),K(),o}d.__dashjs_factory_name="PlaybackController",t.default=o.default.getSingletonFactory(d)});c(A);var w=f(function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null};r.GET="GET",r.HEAD="HEAD",r.MPD_TYPE="MPD",r.XLINK_EXPANSION_TYPE="XLinkExpansion",r.INIT_SEGMENT_TYPE="InitializationSegment",r.INDEX_SEGMENT_TYPE="IndexSegment",r.MEDIA_SEGMENT_TYPE="MediaSegment",r.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",r.OTHER_TYPE="other",t.HTTPRequest=r,t.HTTPRequestTrace=function e(){n(this,e),this.s=null,this.d=null,this.b=[]}});c(w);w.HTTPRequest,w.HTTPRequestTrace;var I=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return n(e,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===w.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?w.HTTPRequest.INIT_SEGMENT_TYPE:w.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}]),e}();r.ACTION_DOWNLOAD="download",r.ACTION_COMPLETE="complete",t.default=r});c(I);var C=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(I);function i(e){return e&&e.__esModule?e:{default:e}}var a="loading",o="executed",s="failed";function u(e){var t=(e=e||{}).eventBus,n=e.events,i=e.dashMetrics,u=e.fragmentLoader,l=e.debug,d=e.streamInfo,c=e.type,f=void 0,h=void 0,p=void 0,g=void 0;function m(e){return!!e&&function(t){var n=!1;return t.some(function(t){if(i=e,a=t,!isNaN(i.index)&&i.startTime===a.startTime&&i.adaptationIndex===a.adaptationIndex&&i.type===a.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,t)||function(e,t){return e.action===r.default.ACTION_COMPLETE&&e.action===t.action}(e,t))return n=!0;var i,a}),n}(p)}function v(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function y(e){p=p.filter(function(t){var n=v(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n})}function _(e,t){t<=e+.5||(p=p.filter(function(n){var r=v(n);return isNaN(n.startTime)||n.startTime>=t-r||isNaN(n.duration)||n.startTime+n.duration<=e+r}))}function T(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r],a=i.startTime,o=a+i.duration;if(n=isNaN(n)?v(i):n,!isNaN(a)&&!isNaN(o)&&t+n>=a&&t-n<o||isNaN(a)&&isNaN(t))return i}return null}function E(e,t){i.addSchedulingInfo(e,t),i.addRequestsQueue(e.mediaType,g,p)}function b(e){e.sender===u&&(g.splice(g.indexOf(e.request),1),e.response&&!e.error&&p.push(e.request),E(e.request,e.error?s:o),t.trigger(n.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:d.id,mediaType:c}))}function S(e){e.sender===u&&t.trigger(n.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:d.id,mediaType:c})}function A(e){e.sender===u&&t.trigger(n.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:d.id,mediaType:c})}function w(){p=[],g=[]}return f={getStreamId:function(){return d.id},getType:function(){return c},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach(function(t){var r=function(e){var t=void 0;switch(e){case a:t=g;break;case o:t=p;break;default:t=[]}return t}(t);n=n.concat(function(e,t){return t.hasOwnProperty("time")?[T(e,t.time,t.threshold)]:e.filter(function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0})}(r,e))}),n},isFragmentLoaded:m,isFragmentLoadedOrPending:function(e){var t=!1,n=0,r=void 0;if(!(t=m(e)))for(n=0;n<g.length;n++)r=g[n],e.url===r.url&&e.startTime===r.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:y,removeExecutedRequestsAfterTime:function(e){p=p.filter(function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e})},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)_(n,e.start(r)),n=e.end(r);t>0&&_(n,t)}else y()},abortRequests:function(){h.debug("abort requests"),u.abort(),g=[]},executeRequest:function(e){switch(e.action){case r.default.ACTION_COMPLETE:p.push(e),E(e,o),h.debug("STREAM_COMPLETED"),t.trigger(n.STREAM_COMPLETED,{request:e},{streamId:e.mediaInfo.streamInfo.id,mediaType:e.mediaType});break;case r.default.ACTION_DOWNLOAD:E(e,a),g.push(e),function(e){t.trigger(n.FRAGMENT_LOADING_STARTED,{request:e},{streamId:d.id,mediaType:c}),u.load(e)}(e);break;default:h.warn("Unknown request action.")}},reset:function(){t.off(n.LOADING_COMPLETED,b,this),t.off(n.LOADING_DATA_PROGRESS,S,this),t.off(n.LOADING_ABANDONED,A,this),u&&u.reset(),w()},addExecutedRequest:function(e){p.push(e)}},h=l.getLogger(f),w(),t.on(n.LOADING_COMPLETED,b,f),t.on(n.LOADING_DATA_PROGRESS,S,f),t.on(n.LOADING_ABANDONED,A,f),f}u.__dashjs_factory_name="FragmentModel";var l=n.default.getClassFactory(u);l.FRAGMENT_MODEL_LOADING=a,l.FRAGMENT_MODEL_EXECUTED=o,l.FRAGMENT_MODEL_CANCELED="canceled",l.FRAGMENT_MODEL_FAILED=s,n.default.updateClassFactory(u.__dashjs_factory_name,l),t.default=l});c(C);var R=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=r||null}});c(R);var D=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1}});c(D);var M=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var r=0;r<t.references.length;r++){var i={reference_type:t.references[r].reference_type,referenced_size:t.references[r].referenced_size,subsegment_duration:t.references[r].subsegment_duration};this.references.push(i)}}break;case"emsg":this.id=t.id,this.version=1===t.version?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}}}return n(e,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),e}();t.default=r});c(M);var O=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(M),r=i(v);function i(e){return e&&e.__esModule?e:{default:e}}function a(){var e=void 0;function t(t){var n=[];if(!t||!e||"function"!==typeof e.fetchAll)return n;for(var i=e.fetchAll(t),a=void 0,o=0,s=i.length;o<s;o++)(a=r(i[o]))&&n.push(a);return n}function r(e){if(!e)return null;var t=new n.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"===typeof e.fetch?r(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null}}}a.__dashjs_factory_name="IsoFile",t.default=r.default.getClassFactory(a)});c(O);var N=f(function(e,t){var n={parseBuffer:function(e){return new r(e).parse()},addBoxProcessor:function(e,t){"string"===typeof e&&"function"===typeof t&&(i.prototype._boxProcessors[e]=t)},createFile:function(){return new r},createBox:function(e,t,n){var r=i.create(e);return t&&t.append(r,n),r},createFullBox:function(e,t,r){var i=n.createBox(e,t,r);return i.version=0,i.flags=0,i},Utils:{}};n.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!==typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),r.push(String.fromCharCode(a))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},n.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!==typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},n.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(void 0!==n&&null!==n){var r,i=-1;if("number"===typeof n)i=n;else{if("string"===typeof n)r=n;else{if("object"!==typeof n||!n.type)return void e.boxes.push(t);r=n.type}for(var a=0;a<e.boxes.length;a++)if(r===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.parseBuffer=n.parseBuffer,t.addBoxProcessor=n.addBoxProcessor,t.createFile=n.createFile,t.createBox=n.createBox,t.createFullBox=n.createFullBox,t.Utils=n.Utils,n.Cursor=function(e){this.offset="undefined"==typeof e?0:e};var r=function(e){this._cursor=new n.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};r.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},r.prototype.fetchAll=function(e,t){var n=[];return r._sweep.call(this,e,n,t),n},r.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=i.parse(this);if("undefined"===typeof e.type)break;this.boxes.push(e)}return this},r._sweep=function(e,t,n){for(var i in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;r._sweep.call(this.boxes[i],e,t,n)}},r.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},r.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)};var i=function(){this._cursor=new n.Cursor};i.parse=function(e){var t=new i;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},i.create=function(e){var t=new i;return t.type=e,t.boxes=[],t},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},i.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r])},i.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i])},i.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t])},i.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(i.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},i.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(n+4);t=r*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},i.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:r=((t=this._raw.getUint16(i))<<8)+(n=this._raw.getUint8(i+2));break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(i+4),r=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,r},i.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},i.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},i.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},i.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},i.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?n.Utils.dataViewToString(t):t},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(n+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(i+2,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:r=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(i+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},i.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},i.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r)},i.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},i.prototype._writeUTF8String=function(e){var t=n.Utils.utf8ToByteArray(e);if(this._rawo)for(var r=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)r.setUint8(i,t[i]);else this.size+=t.length},i.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)})},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!==typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)})},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)})})},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)})})},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))})},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)})},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){}}),P=(N.parseBuffer,N.addBoxProcessor,N.createFile,N.createBox,N.createFullBox,N.Utils,f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r}}));c(P);var L=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(S),r=s(O),i=s(v),a=s(N),o=s(P);function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e=void 0,t=void 0,i=this.context;function s(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=a.default.parseBuffer(e),n=(0,r.default)(i).create();return n.setData(t),n}function u(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function l(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return t={parse:s,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new o.default(0,!1);for(var r=t instanceof ArrayBuffer?new Uint8Array(t):t,i=void 0,a=0;n<r.byteLength;){var s=u(r,n),d=l(r,n+4);if(0===s)break;n+s<=r.byteLength&&(e.indexOf(d)>=0?i=new o.default(n,!0,s):a=n+s),n+=s}return i||new o.default(a,!1)},getMediaTimescaleFromMoov:function(e){var t=s(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,r=s(e),i=r.getBoxes("moof"),a=r.getBoxes("mfhd"),o=void 0,u=void 0,l=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0;n=r.getBoxes("moof").length,t=a[a.length-1].sequence_number,u=0,c=[];var E=-1,b=-1;for(m=0;m<i.length;m++){var S=i[m],A=S.getChildBoxes("traf");for(p=0;p<A.length;p++){var w=A[p],I=w.getChildBox("tfhd"),C=w.getChildBox("tfdt");d=C.baseMediaDecodeTime;var R=w.getChildBoxes("trun"),D=w.getChildBoxes("subs");for(g=0;g<R.length;g++){var M=R[g];for(u=M.sample_count,_=(I.base_data_offset||0)+(M.data_offset||0),h=0;h<u;h++){o=void 0!==(f=M.samples[h]).sample_duration?f.sample_duration:I.default_sample_duration,l=void 0!==f.sample_size?f.sample_size:I.default_sample_size;var O={dts:d,cts:d+(void 0!==f.sample_composition_time_offset?f.sample_composition_time_offset:0),duration:o,offset:S.offset+_,size:l,subSizes:[l]};if(D)for(v=0;v<D.length;v++){var N=D[v];if(E<N.entry_count-1&&h>b&&(E++,b+=N.entries[E].sample_delta),h==b){O.subSizes=[];var P=N.entries[E];for(y=0;y<P.subsample_count;y++)O.subSizes.push(P.subsamples[y].subsample_size)}}c.push(O),_+=l,d+=o}}T=d-C.baseMediaDecodeTime}}return{sampleList:c,lastSequenceNumber:t,totalDuration:T,numSequences:n}},findInitRange:function(t){var n=null,r=s(t);if(!r)return n;var i=r.getBox("ftyp"),a=r.getBox("moov");return e.debug("Searching for initialization."),a&&a.isComplete&&(n=(i?i.offset:a.offset)+"-"+(a.offset+a.size-1),e.debug("Found the initialization.  Range: "+n)),n},parsePayload:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new o.default(0,!1);for(var r=t instanceof ArrayBuffer?new Uint8Array(t):t,i=void 0,a=0;n<r.byteLength;){var s=u(r,n),d=l(r,n+4);if(0===s)break;n+s<=r.byteLength&&(e.indexOf(d)>=0?i=new o.default(n,!0,s,d):a=n+s),n+=s}return i||new o.default(a,!1)}},e=(0,n.default)(i).getInstance().getLogger(t),t}u.__dashjs_factory_name="BoxParser",t.default=i.default.getSingletonFactory(u)});c(L);var k=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.checkParameterType=function(e,t){if(("undefined"===typeof e?"undefined":n(e))!==t)throw i.default.BAD_ARGUMENT_ERROR},t.checkInteger=function(e){if(null===e||isNaN(e)||e%1!==0)throw i.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},t.checkRange=function(e,t,n){if(e<t||e>n)throw i.default.BAD_ARGUMENT_ERROR+" : argument out of range"},t.checkIsVideoOrAudioType=function(e){if("string"!==typeof e||e!==i.default.AUDIO&&e!==i.default.VIDEO)throw i.default.BAD_ARGUMENT_ERROR};var r,i=(r=p)&&r.__esModule?r:{default:r}});c(k);k.checkParameterType,k.checkInteger,k.checkRange,k.checkIsVideoOrAudioType;var x=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,k.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,k.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}i.__dashjs_factory_name="CustomTimeRanges",t.default=r.default.getClassFactory(i)});c(x);var F=f(function(e,t){var n;(n=t).ns_tt="http://www.w3.org/ns/ttml",n.ns_tts="http://www.w3.org/ns/ttml#styling",n.ns_ttp="http://www.w3.org/ns/ttml#parameter",n.ns_xml="http://www.w3.org/XML/1998/namespace",n.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",n.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",n.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",n.ns_ebutts="urn:ebu:tt:style"}),U=f(function(e,t){!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=i[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=n.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=r.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=a.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n},e.parseTextShadow=function(t){var n=t.split(","),r=[];for(var i in n){var a=n[i].split(" ");if(1===a.length&&"none"===a[0])return"none";if(a.length>1&&a.length<5){var o=[null,null,null,null],s=e.parseLength(a.shift());if(null===s)return null;if(o[0]=s,null===(s=e.parseLength(a.shift())))return null;if(o[1]=s,0===a.length){r.push(o);continue}if(null!==(s=e.parseLength(a[0]))&&(o[2]=s,a.shift()),0===a.length){r.push(o);continue}var u=e.parseColor(a[0]);if(null===u)return null;o[3]=u,r.push(o)}}return r},e.parsePosition=function(t){var n=t.split(" "),r=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(n.length>4)return null;for(var i in n)if(!r(n[i])){var a=e.parseLength(n[i]);if(null===a)return null;n[i]=a}for(var o={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<n.length;){var u=n[s++];if(r(u)){var l={value:0,unit:"%"};2!==n.length&&s<n.length&&!r(n[s])&&(l=n[s++]),"right"===u?(o.h.edge=u,o.h.offset=l):"bottom"===u?(o.v.edge=u,o.v.offset=l):"left"===u?o.h.offset=l:"top"===u&&(o.v.offset=l)}else{if(1!==n.length&&2!==n.length)return null;1===s?o.h.offset=u:o.v.offset=u}}return o},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,n,r,i,a,o){return"%"===n&&i?new e.ComputedLength(i.rw*t/100,i.rh*t/100):"em"===n&&r?new e.ComputedLength(r.rw*t,r.rh*t):"c"===n&&a?new e.ComputedLength(t*a.rw,t*a.rh):"px"===n&&o?new e.ComputedLength(t*o.rw,t*o.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null}}(t)}),B=f(function(e,t){!function(e,t,n){function r(e,t,n,r,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=n,this.applies=r,this.parse=o,this.compute=s}for(var i in e.all=[new r(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new r(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new r(t.ns_tts,"direction","ltr",["p","span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(e){return e},null),new r(t.ns_tts,"displayAlign","before",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"extent","auto",["tt","region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null},function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,1);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(1,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}}),new r(t.ns_tts,"fontFamily","default",["span"],!0,!0,function(e){var t=e.split(","),n=[];for(var r in t)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n},null),new r(t.ns_tts,"shear","0%",["p"],!0,!0,n.parseLength,function(e,t,n,r){return"%"!==r.unit?null:Math.abs(r.value)>100?100*Math.sign(r.value):r.value}),new r(t.ns_tts,"fontSize","1c",["span"],!0,!0,n.parseLength,function(t,r,i,a,o){return n.toComputedLength(a.value,a.unit,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)}),new r(t.ns_tts,"fontStyle","normal",["span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"fontWeight","normal",["span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"lineHeight","normal",["p"],!0,!0,function(e){return"normal"===e?e:n.parseLength(e)},function(t,r,i,a,o){var s;if("normal"===a)s=a;else if(null===(s=n.toComputedLength(a.value,a.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s}),new r(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new r(t.ns_tts,"origin","auto",["region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null},function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,0);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(0,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}}),new r(t.ns_tts,"overflow","hidden",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"padding","0px",["region"],!1,!0,function(e){var t=e.split(" ");if(t.length>4)return null;var r=[];for(var i in t){var a=n.parseLength(t[i]);if(!a)return null;r.push(a)}return r},function(t,r,i,a,o){var s;if(1===a.length)s=[a[0],a[0],a[0],a[0]];else if(2===a.length)s=[a[0],a[1],a[0],a[1]];else if(3===a.length)s=[a[0],a[1],a[2],a[1]];else{if(4!==a.length)return null;s=[a[0],a[1],a[2],a[3]]}var u=i.styleAttrs[e.byName.writingMode.qname];if("lrtb"===u||"lr"===u)s=[s[0],s[3],s[2],s[1]];else if("rltb"===u||"rl"===u)s=[s[0],s[1],s[2],s[3]];else if("tblr"===u)s=[s[3],s[0],s[1],s[2]];else{if("tbrl"!==u&&"tb"!==u)return null;s=[s[3],s[2],s[1],s[0]]}var l=[];for(var d in s)if(0===s[d].value)l[d]=new n.ComputedLength(0,0);else if(l[d]=n.toComputedLength(s[d].value,s[d].unit,i.styleAttrs[e.byName.fontSize.qname],"0"===d||"2"===d?i.styleAttrs[e.byName.extent.qname].h:i.styleAttrs[e.byName.extent.qname].w,"0"===d||"2"===d?t.cellLength.h:t.cellLength.w,"0"===d||"2"===d?t.pxLength.h:t.pxLength.w),null===l[d])return null;return l}),new r(t.ns_tts,"position","top left",["region"],!1,!0,function(e){return n.parsePosition(e)},function(t,r,i,a){var o,s;return null===(o=n.toComputedLength(a.v.offset.value,a.v.offset.unit,null,new n.ComputedLength(-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-i.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===a.v.edge&&(o=new n.ComputedLength(-o.rw-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-o.rh-i.styleAttrs[e.byName.extent.qname].h.rh)),s=n.toComputedLength(a.h.offset.value,a.h.offset.unit,null,new n.ComputedLength(t.dimensions.w.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-i.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===o?null:("right"===a.h.edge&&(s=new n.ComputedLength(t.dimensions.w.rw-s.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-i.styleAttrs[e.byName.extent.qname].w.rh)),{h:o,w:s}))}),new r(t.ns_tts,"ruby","none",["span"],!1,!0,function(e){return e},null),new r(t.ns_tts,"rubyAlign","center",["span"],!0,!0,function(e){return"center"!==e&&"spaceAround"!==e?null:e},null),new r(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"rubyReserve","none",["p"],!0,!0,function(e){var t=e.split(" "),r=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(r[0]=t[0],2===t.length&&"none"!==t[0]){var i=n.parseLength(t[1]);if(!i)return null;r[1]=i}return r},function(t,r,i,a,o){if("none"===a[0])return a;var s=null;return null===(s=null===a[1]?new n.ComputedLength(.5*i.styleAttrs[e.byName.fontSize.qname].rw,.5*i.styleAttrs[e.byName.fontSize.qname].rh):n.toComputedLength(a[1].value,a[1].unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[a[0],s]}),new r(t.ns_tts,"showBackground","always",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"textAlign","start",["p"],!0,!0,function(e){return e},function(e,t,n,r,i){return"left"===r?"start":"right"===r?"end":r}),new r(t.ns_tts,"textCombine","none",["span"],!0,!0,function(e){var t=e.split(" ");return 1!==t.length||"none"!==t[0]&&"all"!==t[0]?null:[t[0]]},null),new r(t.ns_tts,"textDecoration","none",["span"],!0,!0,function(e){return e.split(" ")},null),new r(t.ns_tts,"textEmphasis","none",["span"],!0,!0,function(e){var t=e.split(" "),r={style:null,symbol:null,color:null,position:null};for(var i in t)if("none"===t[i]||"auto"===t[i])r.style=t[i];else if("filled"===t[i]||"open"===t[i])r.style=t[i];else if("circle"===t[i]||"dot"===t[i]||"sesame"===t[i])r.symbol=t[i];else if("current"===t[i])r.color=t[i];else if("outside"===t[i]||"before"===t[i]||"after"===t[i])r.position=t[i];else if(r.color=n.parseColor(t[i]),null===r.color)return null;return null==r.style&&null==r.symbol?r.style="auto":(r.symbol=r.symbol||"circle",r.style=r.style||"filled"),r.position=r.position||"outside",r.color=r.color||"current",r},null),new r(t.ns_tts,"textOutline","none",["span"],!0,!0,function(e){if("none"===e)return e;var t={},r=e.split(" ");if(0===r.length||r.length>2)return null;var i=n.parseColor(r[0]);if(t.color=i,null!==i&&r.shift(),1!==r.length)return null;var a=n.parseLength(r[0]);return a?(t.thickness=a,t):null},function(t,r,i,a,o){if("none"===a)return a;var s={};return null===a.color?s.color=i.styleAttrs[e.byName.color.qname]:s.color=a.color,s.thickness=n.toComputedLength(a.thickness.value,a.thickness.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s}),new r(t.ns_tts,"textShadow","none",["span"],!0,!0,n.parseTextShadow,function(t,r,i,a){if("none"===a)return a;var o=[];for(var s in a){var u={};if(u.x_off=n.toComputedLength(a[s][0].value,a[s][0].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===u.x_off)return null;if(u.y_off=n.toComputedLength(a[s][1].value,a[s][1].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.y_off)return null;if(null===a[s][2])u.b_radius=0;else if(u.b_radius=n.toComputedLength(a[s][2].value,a[s][2].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.b_radius)return null;null===a[s][3]?u.color=i.styleAttrs[e.byName.color.qname]:u.color=a[s][3],o.push(u)}return o}),new r(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(e){return e},null),new r(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"zIndex","auto",["region"],!1,!0,function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t},null),new r(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,function(e,t,r,i,a){return n.toComputedLength(i.value,i.unit,null,null,e.cellLength.w,null)}),new r(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(e){return e},null),new r(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(e){return e},null),new r(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(e){return"true"===e},null),new r(t.ns_itts,"fillLineGap","false",["p"],!0,!0,function(e){return"true"===e},null)],e.byQName={},e.all)e.byQName[e.all[i].qname]=e.all[i];for(var a in e.byName={},e.all)e.byName[e.all[a].name]=e.all[a]}(t,"undefined"===typeof imscNames?F:imscNames,"undefined"===typeof imscUtils?U:imscUtils)}),j=f(function(e,t){!function(e,n,r,i){t.generateISD=function(e,t,n){var r=new s(e),i={};for(var a in e.head.layout.regions){var u=o(e,t,e.head.layout.regions[a],e.body,null,"",e.head.layout.regions[a],n,i);null!==u&&r.contents.push(u.element)}return r};var a=[r.byName.color.qname,r.byName.textCombine.qname,r.byName.textDecoration.qname,r.byName.textEmphasis.qname,r.byName.textOutline.qname,r.byName.textShadow.qname];function o(e,t,n,s,d,c,f,h,p){if(t<f.begin||t>=f.end)return null;var g="regionID"in f&&""!==f.regionID?f.regionID:c;if(null!==d&&g!==n.id&&(!("contents"in f)||"contents"in f&&0===f.contents.length||""!==g))return null;var m=new u(f);for(var v in f.sets)t<f.sets[v].begin||t>=f.sets[v].end||(m.styleAttrs[f.sets[v].qname]=f.sets[v].value);var y,_={};for(var T in m.styleAttrs)if(_[T]=!0,T===r.byName.writingMode.qname&&!(r.byName.direction.qname in m.styleAttrs)){var E=m.styleAttrs[T];"lrtb"===E||"lr"===E?m.styleAttrs[r.byName.direction.qname]="ltr":"rltb"!==E&&"rl"!==E||(m.styleAttrs[r.byName.direction.qname]="rtl")}if(null!==d)for(var b in r.all){var S=r.all[b];if(S.qname===r.byName.textDecoration.qname){var A=d.styleAttrs[S.qname],w=m.styleAttrs[S.qname],I=[];void 0===w?I=A:-1===w.indexOf("none")?((-1===w.indexOf("noUnderline")&&-1!==A.indexOf("underline")||-1!==w.indexOf("underline"))&&I.push("underline"),(-1===w.indexOf("noLineThrough")&&-1!==A.indexOf("lineThrough")||-1!==w.indexOf("lineThrough"))&&I.push("lineThrough"),(-1===w.indexOf("noOverline")&&-1!==A.indexOf("overline")||-1!==w.indexOf("overline"))&&I.push("overline")):I.push("none"),m.styleAttrs[S.qname]=I}else if(S.qname!==r.byName.fontSize.qname||S.qname in m.styleAttrs||"span"!==m.kind||"textContainer"!==m.styleAttrs[r.byName.ruby.qname])if(S.qname!==r.byName.fontSize.qname||S.qname in m.styleAttrs||"span"!==m.kind||"text"!==m.styleAttrs[r.byName.ruby.qname])S.inherit&&S.qname in d.styleAttrs&&!(S.qname in m.styleAttrs)&&(m.styleAttrs[S.qname]=d.styleAttrs[S.qname]);else{var C=d.styleAttrs[r.byName.fontSize.qname];"textContainer"===d.styleAttrs[r.byName.ruby.qname]?m.styleAttrs[S.qname]=C:m.styleAttrs[S.qname]=new i.ComputedLength(.5*C.rw,.5*C.rh)}else{var R=d.styleAttrs[r.byName.fontSize.qname];m.styleAttrs[S.qname]=new i.ComputedLength(.5*R.rw,.5*R.rh)}}for(var D in r.all){var M=r.all[D];if(!(M.qname in m.styleAttrs)&&(!(M.qname===r.byName.position.qname&&r.byName.origin.qname in m.styleAttrs)&&!(M.qname===r.byName.origin.qname&&r.byName.position.qname in m.styleAttrs))){var O=e.head.styling.initials[M.qname]||M.initial;("region"===m.kind||!1===M.inherit&&null!==O)&&(m.styleAttrs[M.qname]=M.parse(O),_[M.qname]=!0)}}for(var N in r.all){var P=r.all[N];if(P.qname in _&&null!==P.compute){var L=P.compute(e,d,m,m.styleAttrs[P.qname],p);null!==L?m.styleAttrs[P.qname]=L:(m.styleAttrs[P.qname]=P.compute(e,d,m,P.parse(P.initial),p),l(h,"Style '"+P.qname+"' on element '"+m.kind+"' cannot be computed"))}}if("none"===m.styleAttrs[r.byName.display.qname])return null;for(var k in null===d?y=null===s?[]:[s]:"contents"in f&&(y=f.contents),y){var x=o(e,t,n,s,m,g,y[k],h,p);null!==x&&m.contents.push(x.element)}for(var F in m.styleAttrs){var U=!1;if("span"===m.kind){var B=m.styleAttrs[r.byName.ruby.qname];(U=("container"===B||"textContainer"===B||"baseContainer"===B)&&-1!==a.indexOf(F))||(U="container"!==B&&F===r.byName.rubyAlign.qname),U||(U=!("textContainer"===B||"text"===B)&&F===r.byName.rubyPosition.qname)}if(!U)U=-1===r.byQName[F].applies.indexOf(m.kind);U&&delete m.styleAttrs[F]}if("span"===m.kind&&m.text&&"default"===m.space){var j=m.text.replace(/[\t\r\n ]+/g," ");m.text=j}if("p"===m.kind){var G=[];!function e(t,n){if("contents"in t)for(var r in t.contents)e(t.contents[r],n);else"span"!==t.kind&&"br"!==t.kind||n.push(t)}(m,G);for(var q=0,H="after_br",V=0;;)if("after_br"===H)q>=G.length||"br"===G[q].kind?(H="before_br",V=q,q--):("preserve"!==G[q].space&&(G[q].text=G[q].text.replace(/^[\t\r\n ]+/g,"")),G[q].text.length>0?(H="looking_br",q++):G.splice(q,1));else if("before_br"===H)if(q<0||"br"===G[q].kind){if(H="after_br",(q=V+1)>=G.length)break}else if("preserve"!==G[q].space&&(G[q].text=G[q].text.replace(/[\t\r\n ]+$/g,"")),G[q].text.length>0){if(H="after_br",(q=V+1)>=G.length)break}else G.splice(q,1),q--;else q>=G.length||"br"===G[q].kind?(H="before_br",V=q,q--):q++;!function e(t){if("br"===t.kind)return!1;if("text"in t)return 0===t.text.length;if("contents"in t){for(var n=t.contents.length;n--;)e(t.contents[n])&&t.contents.splice(n,1);return 0===t.contents.length}}(m)}return"div"===m.kind&&r.byName.backgroundImage.qname in m.styleAttrs||"br"===m.kind||"image"===m.kind||"contents"in m&&m.contents.length>0||"span"===m.kind&&null!==m.text||"region"===m.kind&&"always"===m.styleAttrs[r.byName.showBackground.qname]?{region_id:g,element:m}:null}function s(e){this.contents=[],this.aspectRatio=e.aspectRatio}function u(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function l(e,t){if(e&&e.error&&e.error(t))throw t}}(0,"undefined"===typeof imscNames||imscNames,"undefined"===typeof imscStyles?B:imscStyles,"undefined"===typeof imscUtils?U:imscUtils)}),G="undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},q=[],H=[],V="undefined"!==typeof Uint8Array?Uint8Array:Array,K=!1;function Y(){K=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)q[t]=e[t],H[e.charCodeAt(t)]=t;H["-".charCodeAt(0)]=62,H["_".charCodeAt(0)]=63}function W(e,t,n){for(var r,i,a=[],o=t;o<n;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],a.push(q[(i=r)>>18&63]+q[i>>12&63]+q[i>>6&63]+q[63&i]);return a.join("")}function z(e){var t;K||Y();for(var n=e.length,r=n%3,i="",a=[],o=0,s=n-r;o<s;o+=16383)a.push(W(e,o,o+16383>s?s:o+16383));return 1===r?(t=e[n-1],i+=q[t>>2],i+=q[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=q[t>>10],i+=q[t>>4&63],i+=q[t<<2&63],i+="="),a.push(i),a.join("")}function X(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,d=-7,c=n?i-1:0,f=n?-1:1,h=e[t+c];for(c+=f,a=h&(1<<-d)-1,h>>=-d,d+=s;d>0;a=256*a+e[t+c],c+=f,d-=8);for(o=a&(1<<-d)-1,a>>=-d,d+=r;d>0;o=256*o+e[t+c],c+=f,d-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=l}return(h?-1:1)*o*Math.pow(2,a-r)}function Q(e,t,n,r,i,a){var o,s,u,l=8*a-i-1,d=(1<<l)-1,c=d>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+c>=1?f/u:f*Math.pow(2,1-c))*u>=2&&(o++,u/=2),o+c>=d?(s=0,o=d):o+c>=1?(s=(t*u-1)*Math.pow(2,i),o+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=255&s,h+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+h]=255&o,h+=p,o/=256,l-=8);e[n+h-p]|=128*g}var $={}.toString,Z=Array.isArray||function(e){return"[object Array]"==$.call(e)};function J(){return te.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ee(e,t){if(J()<t)throw new RangeError("Invalid typed array length");return te.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=te.prototype:(null===e&&(e=new te(t)),e.length=t),e}function te(e,t,n){if(!te.TYPED_ARRAY_SUPPORT&&!(this instanceof te))return new te(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return ie(this,e)}return ne(this,e,t,n)}function ne(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);te.TYPED_ARRAY_SUPPORT?(e=t).__proto__=te.prototype:e=ae(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!te.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|ue(t,n),i=(e=ee(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(se(t)){var n=0|oe(t.length);return 0===(e=ee(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?ee(e,0):ae(e,t);if("Buffer"===t.type&&Z(t.data))return ae(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function re(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function ie(e,t){if(re(t),e=ee(e,t<0?0:0|oe(t)),!te.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function ae(e,t){var n=t.length<0?0:0|oe(t.length);e=ee(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function oe(e){if(e>=J())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+J().toString(16)+" bytes");return 0|e}function se(e){return!(null==e||!e._isBuffer)}function ue(e,t){if(se(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Le(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ke(e).length;default:if(r)return Le(e).length;t=(""+t).toLowerCase(),r=!0}}function le(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function de(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=te.from(t,r)),se(t))return 0===t.length?-1:ce(e,t,n,r,i);if("number"===typeof t)return t&=255,te.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):ce(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function ce(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var d=-1;for(a=n;a<s;a++)if(l(e,a)===l(t,-1===d?0:a-d)){if(-1===d&&(d=a),a-d+1===u)return d*o}else-1!==d&&(a-=a-d),d=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var c=!0,f=0;f<u;f++)if(l(e,a+f)!==l(t,f)){c=!1;break}if(c)return a}return-1}function fe(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!==0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function he(e,t,n,r){return xe(Le(t,e.length-n),e,n,r)}function pe(e,t,n,r){return xe(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function ge(e,t,n,r){return pe(e,t,n,r)}function me(e,t,n,r){return xe(ke(t),e,n,r)}function ve(e,t,n,r){return xe(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function ye(e,t,n){return 0===t&&n===e.length?z(e):z(e.slice(t,n))}function _e(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,u,l=e[i],d=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=n)switch(c){case 1:l<128&&(d=l);break;case 2:128===(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)>127&&(d=u);break;case 3:a=e[i+1],o=e[i+2],128===(192&a)&&128===(192&o)&&(u=(15&l)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(d=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128===(192&a)&&128===(192&o)&&128===(192&s)&&(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(d=u)}null===d?(d=65533,c=1):d>65535&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),i+=c}return function(e){var t=e.length;if(t<=Te)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Te));return n}(r)}te.TYPED_ARRAY_SUPPORT=void 0===G.TYPED_ARRAY_SUPPORT||G.TYPED_ARRAY_SUPPORT,te.poolSize=8192,te._augment=function(e){return e.__proto__=te.prototype,e},te.from=function(e,t,n){return ne(null,e,t,n)},te.TYPED_ARRAY_SUPPORT&&(te.prototype.__proto__=Uint8Array.prototype,te.__proto__=Uint8Array),te.alloc=function(e,t,n){return function(e,t,n,r){return re(t),t<=0?ee(e,t):void 0!==n?"string"===typeof r?ee(e,t).fill(n,r):ee(e,t).fill(n):ee(e,t)}(null,e,t,n)},te.allocUnsafe=function(e){return ie(null,e)},te.allocUnsafeSlow=function(e){return ie(null,e)},te.isBuffer=Fe,te.compare=function(e,t){if(!se(e)||!se(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},te.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},te.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return te.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=te.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!se(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},te.byteLength=ue,te.prototype._isBuffer=!0,te.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)le(this,t,t+1);return this},te.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)le(this,t,t+3),le(this,t+1,t+2);return this},te.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)le(this,t,t+7),le(this,t+1,t+6),le(this,t+2,t+5),le(this,t+3,t+4);return this},te.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?_e(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Se(this,t,n);case"utf8":case"utf-8":return _e(this,t,n);case"ascii":return Ee(this,t,n);case"latin1":case"binary":return be(this,t,n);case"base64":return ye(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ae(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},te.prototype.equals=function(e){if(!se(e))throw new TypeError("Argument must be a Buffer");return this===e||0===te.compare(this,e)},te.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},te.prototype.compare=function(e,t,n,r,i){if(!se(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),u=this.slice(r,i),l=e.slice(t,n),d=0;d<s;++d)if(u[d]!==l[d]){a=u[d],o=l[d];break}return a<o?-1:o<a?1:0},te.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},te.prototype.indexOf=function(e,t,n){return de(this,e,t,n,!0)},te.prototype.lastIndexOf=function(e,t,n){return de(this,e,t,n,!1)},te.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return fe(this,e,t,n);case"utf8":case"utf-8":return he(this,e,t,n);case"ascii":return pe(this,e,t,n);case"latin1":case"binary":return ge(this,e,t,n);case"base64":return me(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ve(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},te.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Te=4096;function Ee(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function be(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function Se(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=Pe(e[a]);return i}function Ae(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function we(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Ie(e,t,n,r,i,a){if(!se(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function Ce(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function Re(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function De(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Me(e,t,n,r,i){return i||De(e,0,n,4),Q(e,t,n,r,23,4),n+4}function Oe(e,t,n,r,i){return i||De(e,0,n,8),Q(e,t,n,r,52,8),n+8}te.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),te.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=te.prototype;else{var i=t-e;n=new te(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},te.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||we(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},te.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||we(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},te.prototype.readUInt8=function(e,t){return t||we(e,1,this.length),this[e]},te.prototype.readUInt16LE=function(e,t){return t||we(e,2,this.length),this[e]|this[e+1]<<8},te.prototype.readUInt16BE=function(e,t){return t||we(e,2,this.length),this[e]<<8|this[e+1]},te.prototype.readUInt32LE=function(e,t){return t||we(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},te.prototype.readUInt32BE=function(e,t){return t||we(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},te.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||we(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},te.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||we(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},te.prototype.readInt8=function(e,t){return t||we(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},te.prototype.readInt16LE=function(e,t){t||we(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},te.prototype.readInt16BE=function(e,t){t||we(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},te.prototype.readInt32LE=function(e,t){return t||we(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},te.prototype.readInt32BE=function(e,t){return t||we(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},te.prototype.readFloatLE=function(e,t){return t||we(e,4,this.length),X(this,e,!0,23,4)},te.prototype.readFloatBE=function(e,t){return t||we(e,4,this.length),X(this,e,!1,23,4)},te.prototype.readDoubleLE=function(e,t){return t||we(e,8,this.length),X(this,e,!0,52,8)},te.prototype.readDoubleBE=function(e,t){return t||we(e,8,this.length),X(this,e,!1,52,8)},te.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||Ie(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},te.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||Ie(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},te.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,1,255,0),te.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},te.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,2,65535,0),te.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Ce(this,e,t,!0),t+2},te.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,2,65535,0),te.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Ce(this,e,t,!1),t+2},te.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,4,4294967295,0),te.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Re(this,e,t,!0),t+4},te.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,4,4294967295,0),te.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Re(this,e,t,!1),t+4},te.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);Ie(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},te.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);Ie(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},te.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,1,127,-128),te.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},te.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,2,32767,-32768),te.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Ce(this,e,t,!0),t+2},te.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,2,32767,-32768),te.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Ce(this,e,t,!1),t+2},te.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,4,2147483647,-2147483648),te.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Re(this,e,t,!0),t+4},te.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Ie(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),te.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Re(this,e,t,!1),t+4},te.prototype.writeFloatLE=function(e,t,n){return Me(this,e,t,!0,n)},te.prototype.writeFloatBE=function(e,t,n){return Me(this,e,t,!1,n)},te.prototype.writeDoubleLE=function(e,t,n){return Oe(this,e,t,!0,n)},te.prototype.writeDoubleBE=function(e,t,n){return Oe(this,e,t,!1,n)},te.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!te.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},te.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!te.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=se(e)?e:Le(new te(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var Ne=/[^+\/0-9A-Za-z-_]/g;function Pe(e){return e<16?"0"+e.toString(16):e.toString(16)}function Le(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function ke(e){return function(e){var t,n,r,i,a,o;K||Y();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a="="===e[s-2]?2:"="===e[s-1]?1:0,o=new V(3*s/4-a),r=a>0?s-4:s;var u=0;for(t=0,n=0;t<r;t+=4,n+=3)i=H[e.charCodeAt(t)]<<18|H[e.charCodeAt(t+1)]<<12|H[e.charCodeAt(t+2)]<<6|H[e.charCodeAt(t+3)],o[u++]=i>>16&255,o[u++]=i>>8&255,o[u++]=255&i;return 2===a?(i=H[e.charCodeAt(t)]<<2|H[e.charCodeAt(t+1)]>>4,o[u++]=255&i):1===a&&(i=H[e.charCodeAt(t)]<<10|H[e.charCodeAt(t+1)]<<4|H[e.charCodeAt(t+2)]>>2,o[u++]=i>>8&255,o[u++]=255&i),o}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Ne,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function xe(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Fe(e){return null!=e&&(!!e._isBuffer||Ue(e)||function(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&Ue(e.slice(0,0))}(e))}function Ue(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function Be(){}function je(){je.init.call(this)}function Ge(e){return void 0===e._maxListeners?je.defaultMaxListeners:e._maxListeners}function qe(e,t,n,r){var i,a,o,s;if("function"!==typeof n)throw new TypeError('"listener" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]):(a=e._events=new Be,e._eventsCount=0),o){if("function"===typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=Ge(e))&&i>0&&o.length>i){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,s=u,"function"===typeof console.warn?console.warn(s):console.log(s)}}else o=a[t]=n,++e._eventsCount;return e}function He(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function Ve(e){var t=this._events;if(t){var n=t[e];if("function"===typeof n)return 1;if(n)return n.length}return 0}function Ke(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function Ye(){throw new Error("setTimeout has not been defined")}function We(){throw new Error("clearTimeout has not been defined")}Be.prototype=Object.create(null),je.EventEmitter=je,je.usingDomains=!1,je.prototype.domain=void 0,je.prototype._events=void 0,je.prototype._maxListeners=void 0,je.defaultMaxListeners=10,je.init=function(){this.domain=null,je.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Be,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},je.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},je.prototype.getMaxListeners=function(){return Ge(this)},je.prototype.emit=function(e){var t,n,r,i,a,o,s,u="error"===e;if(o=this._events)u=u&&null==o.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=o[e]))return!1;var d="function"===typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=Ke(e,r),a=0;a<r;++a)i[a].call(n)}(n,d,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,a=Ke(e,i),o=0;o<i;++o)a[o].call(n,r)}(n,d,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var a=e.length,o=Ke(e,a),s=0;s<a;++s)o[s].call(n,r,i)}(n,d,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,a){if(t)e.call(n,r,i,a);else for(var o=e.length,s=Ke(e,o),u=0;u<o;++u)s[u].call(n,r,i,a)}(n,d,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,a=Ke(e,i),o=0;o<i;++o)a[o].apply(n,r)}(n,d,this,i)}return!0},je.prototype.addListener=function(e,t){return qe(this,e,t,!1)},je.prototype.on=je.prototype.addListener,je.prototype.prependListener=function(e,t){return qe(this,e,t,!0)},je.prototype.once=function(e,t){if("function"!==typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,He(this,e,t)),this},je.prototype.prependOnceListener=function(e,t){if("function"!==typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,He(this,e,t)),this},je.prototype.removeListener=function(e,t){var n,r,i,a,o;if("function"!==typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0===--this._eventsCount?this._events=new Be:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,a=n.length;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0===--this._eventsCount)return this._events=new Be,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,o||t)}return this},je.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Be,this._eventsCount=0):n[e]&&(0===--this._eventsCount?this._events=new Be:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),a=0;a<i.length;++a)"removeListener"!==(r=i[a])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Be,this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},je.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"===typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},je.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):Ve.call(e,t)},je.prototype.listenerCount=Ve,je.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var ze=Ye,Xe=We;function Qe(e){if(ze===setTimeout)return setTimeout(e,0);if((ze===Ye||!ze)&&setTimeout)return ze=setTimeout,setTimeout(e,0);try{return ze(e,0)}catch(t){try{return ze.call(null,e,0)}catch(t){return ze.call(this,e,0)}}}"function"===typeof G.setTimeout&&(ze=setTimeout),"function"===typeof G.clearTimeout&&(Xe=clearTimeout);var $e,Ze=[],Je=!1,et=-1;function tt(){Je&&$e&&(Je=!1,$e.length?Ze=$e.concat(Ze):et=-1,Ze.length&&nt())}function nt(){if(!Je){var e=Qe(tt);Je=!0;for(var t=Ze.length;t;){for($e=Ze,Ze=[];++et<t;)$e&&$e[et].run();et=-1,t=Ze.length}$e=null,Je=!1,function(e){if(Xe===clearTimeout)return clearTimeout(e);if((Xe===We||!Xe)&&clearTimeout)return Xe=clearTimeout,clearTimeout(e);try{Xe(e)}catch(t){try{return Xe.call(null,e)}catch(t){return Xe.call(this,e)}}}(e)}}function rt(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ze.push(new it(e,t)),1!==Ze.length||Je||Qe(nt)}function it(e,t){this.fun=e,this.array=t}it.prototype.run=function(){this.fun.apply(null,this.array)};function at(){}var ot=at,st=at,ut=at,lt=at,dt=at,ct=at,ft=at;var ht=G.performance||{},pt=ht.now||ht.mozNow||ht.msNow||ht.oNow||ht.webkitNow||function(){return(new Date).getTime()};var gt=new Date;var mt={nextTick:rt,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:ot,addListener:st,once:ut,off:lt,removeListener:dt,removeAllListeners:ct,emit:ft,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*pt.call(ht),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-gt)/1e3}},vt="function"===typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},yt=/%[sdj%]/g;function _t(e,t){if(Ot(G.process))return function(){return _t(e,t).apply(this,arguments)};var n=!1;return function(){return n||(console.error(t),n=!0),e.apply(this,arguments)}}var Tt,Et={};function bt(e,t){var n={seen:[],stylize:At};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),Rt(t)?n.showHidden=t:t&&function(e,t){if(!t||!Pt(t))return e;var n=Object.keys(t),r=n.length;for(;r--;)e[n[r]]=t[n[r]]}(n,t),Ot(n.showHidden)&&(n.showHidden=!1),Ot(n.depth)&&(n.depth=2),Ot(n.colors)&&(n.colors=!1),Ot(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=St),wt(n,e,n.depth)}function St(e,t){var n=bt.styles[t];return n?"\x1b["+bt.colors[n][0]+"m"+e+"\x1b["+bt.colors[n][1]+"m":e}function At(e,t){return e}function wt(e,t,n){if(e.customInspect&&t&&xt(t.inspect)&&t.inspect!==bt&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return Mt(r)||(r=wt(e,r,n)),r}var i=function(e,t){if(Ot(t))return e.stylize("undefined","undefined");if(Mt(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(r=t,"number"===typeof r)return e.stylize(""+t,"number");var r;if(Rt(t))return e.stylize(""+t,"boolean");if(Dt(t))return e.stylize("null","null")}(e,t);if(i)return i;var a=Object.keys(t),o=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),kt(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return It(t);if(0===a.length){if(xt(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(Nt(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Lt(t))return e.stylize(Date.prototype.toString.call(t),"date");if(kt(t))return It(t)}var u,l,d="",c=!1,f=["{","}"];(u=t,Array.isArray(u)&&(c=!0,f=["[","]"]),xt(t))&&(d=" [Function"+(t.name?": "+t.name:"")+"]");return Nt(t)&&(d=" "+RegExp.prototype.toString.call(t)),Lt(t)&&(d=" "+Date.prototype.toUTCString.call(t)),kt(t)&&(d=" "+It(t)),0!==a.length||c&&0!=t.length?n<0?Nt(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),l=c?function(e,t,n,r,i){for(var a=[],o=0,s=t.length;o<s;++o)Ut(t,String(o))?a.push(Ct(e,t,n,r,String(o),!0)):a.push("");return i.forEach(function(i){i.match(/^\d+$/)||a.push(Ct(e,t,n,r,i,!0))}),a}(e,t,n,o,a):a.map(function(r){return Ct(e,t,n,o,r,c)}),e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,d,f)):f[0]+d+f[1]}function It(e){return"["+Error.prototype.toString.call(e)+"]"}function Ct(e,t,n,r,i,a){var o,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),Ut(r,i)||(o="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=Dt(n)?wt(e,u.value,null):wt(e,u.value,n-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),Ot(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function Rt(e){return"boolean"===typeof e}function Dt(e){return null===e}function Mt(e){return"string"===typeof e}function Ot(e){return void 0===e}function Nt(e){return Pt(e)&&"[object RegExp]"===Ft(e)}function Pt(e){return"object"===typeof e&&null!==e}function Lt(e){return Pt(e)&&"[object Date]"===Ft(e)}function kt(e){return Pt(e)&&("[object Error]"===Ft(e)||e instanceof Error)}function xt(e){return"function"===typeof e}function Ft(e){return Object.prototype.toString.call(e)}function Ut(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Bt(){this.head=null,this.tail=null,this.length=0}bt.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},bt.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Bt.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},Bt.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},Bt.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},Bt.prototype.clear=function(){this.head=this.tail=null,this.length=0},Bt.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},Bt.prototype.concat=function(e){if(0===this.length)return te.alloc(0);if(1===this.length)return this.head.data;for(var t=te.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t};var jt=te.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Gt(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!jt(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Ht;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Vt;break;default:return void(this.write=qt)}this.charBuffer=new te(6),this.charReceived=0,this.charLength=0}function qt(e){return e.toString(this.encoding)}function Ht(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function Vt(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}Gt.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var r=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,r),r-=this.charReceived);var i;r=(t+=e.toString(this.encoding,0,r)).length-1;if((i=t.charCodeAt(r))>=55296&&i<=56319){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),e.copy(this.charBuffer,0,0,a),t.substring(0,r)}return t},Gt.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},Gt.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t};var Kt=Object.freeze({StringDecoder:Gt});zt.ReadableState=Wt;var Yt=function(e){Ot(Tt)&&(Tt=mt.env.NODE_DEBUG||""),e=e.toUpperCase(),Et[e]||(new RegExp("\\b"+e+"\\b","i").test(Tt)?Et[e]=function(){var t=function(e){if(!Mt(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(bt(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(yt,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),o=r[n];n<i;o=r[++n])Dt(o)||!Pt(o)?a+=" "+o:a+=" "+bt(o);return a}.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:Et[e]=function(){});return Et[e]}("stream");function Wt(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Sn&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new Bt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new Gt(e.encoding),this.encoding=e.encoding)}function zt(e){if(!(this instanceof zt))return new zt(e);this._readableState=new Wt(e,this),this.readable=!0,e&&"function"===typeof e.read&&(this._read=e.read),je.call(this)}function Xt(e,t,n,r,i){var a=function(e,t){var n=null;Fe(t)||"string"===typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(t,n);if(a)e.emit("error",a);else if(null===n)t.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,Zt(e)}(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var o=new Error("stream.push() after EOF");e.emit("error",o)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||i||r||(n=t.decoder.write(n),u=!t.objectMode&&0===n.length),i||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&Zt(e))),function(e,t){t.readingMore||(t.readingMore=!0,rt(en,e,t))}(e,t)}else i||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}vt(zt,je),zt.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!==typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=te.from(e,t),t=""),Xt(this,n,e,t,!1)},zt.prototype.unshift=function(e){return Xt(this,this._readableState,e,"",!0)},zt.prototype.isPaused=function(){return!1===this._readableState.flowing},zt.prototype.setEncoding=function(e){return this._readableState.decoder=new Gt(e),this._readableState.encoding=e,this};var Qt=8388608;function $t(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=Qt?e=Qt:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function Zt(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Yt("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?rt(Jt,e):Jt(e))}function Jt(e){Yt("emit readable"),e.emit("readable"),rn(e)}function en(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Yt("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function tn(e){Yt("readable nexttick read 0"),e.read(0)}function nn(e,t){t.reading||(Yt("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),rn(e),t.flowing&&!t.reading&&e.read(0)}function rn(e){var t=e._readableState;for(Yt("flow",t.flowing);t.flowing&&null!==e.read(););}function an(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0===(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=te.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0===(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(o));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function on(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,rt(sn,t,e))}function sn(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function un(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function ln(){}function dn(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function cn(e,t){Object.defineProperty(this,"buffer",{get:_t(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Sn&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?rt(i,r):i(r);e._writableState.errorEmitted=!0,e.emit("error",r)}(e,n,r,t,i);else{var a=mn(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||gn(e,n),r?rt(pn,e,n,a,i):pn(e,n,a,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new _n(this)}function fn(e){if(!(this instanceof fn)&&!(this instanceof Sn))return new fn(e);this._writableState=new cn(e,this),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev)),je.call(this)}function hn(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function pn(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),yn(e,t)}function gn(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var o=0;n;)i[o]=n,n=n.next,o+=1;hn(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new _n(t)}else{for(;n;){var s=n.chunk,u=n.encoding,l=n.callback;if(hn(e,t,!1,t.objectMode?1:s.length,s,u,l),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function mn(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function vn(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function yn(e,t){var n=mn(t);return n&&(0===t.pendingcb?(vn(e,t),t.finished=!0,e.emit("finish")):vn(e,t)),n}function _n(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}zt.prototype.read=function(e){Yt("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Yt("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?on(this):Zt(this),null;if(0===(e=$t(e,t))&&t.ended)return 0===t.length&&on(this),null;var r,i=t.needReadable;return Yt("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&Yt("length less than watermark",i=!0),t.ended||t.reading?Yt("reading or ended",i=!1):i&&(Yt("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=$t(n,t))),null===(r=e>0?an(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&on(this)),null!==r&&this.emit("data",r),r},zt.prototype._read=function(e){this.emit("error",new Error("not implemented"))},zt.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,Yt("pipe count=%d opts=%j",r.pipesCount,t);var i=!t||!1!==t.end?o:l;function a(e){Yt("onunpipe"),e===n&&l()}function o(){Yt("onend"),e.end()}r.endEmitted?rt(i):n.once("end",i),e.on("unpipe",a);var s=function(e){return function(){var t=e._readableState;Yt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,rn(e))}}(n);e.on("drain",s);var u=!1;function l(){Yt("cleanup"),e.removeListener("close",h),e.removeListener("finish",p),e.removeListener("drain",s),e.removeListener("error",f),e.removeListener("unpipe",a),n.removeListener("end",o),n.removeListener("end",l),n.removeListener("data",c),u=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var d=!1;function c(t){Yt("ondata"),d=!1,!1!==e.write(t)||d||((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==un(r.pipes,e))&&!u&&(Yt("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function f(t){var n;Yt("onerror",t),g(),e.removeListener("error",f),0===(n="error",e.listeners(n).length)&&e.emit("error",t)}function h(){e.removeListener("finish",p),g()}function p(){Yt("onfinish"),e.removeListener("close",h),g()}function g(){Yt("unpipe"),n.unpipe(e)}return n.on("data",c),function(e,t,n){if("function"===typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",f),e.once("close",h),e.once("finish",p),e.emit("pipe",n),r.flowing||(Yt("pipe resume"),n.resume()),e},zt.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var a=un(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},zt.prototype.on=function(e,t){var n=je.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&Zt(this):rt(tn,this))}return n},zt.prototype.addListener=zt.prototype.on,zt.prototype.resume=function(){var e=this._readableState;return e.flowing||(Yt("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,rt(nn,e,t))}(this,e)),this},zt.prototype.pause=function(){return Yt("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Yt("pause"),this._readableState.flowing=!1,this.emit("pause")),this},zt.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;for(var i in e.on("end",function(){if(Yt("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){(Yt("wrapped data"),t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(r.push(i)||(n=!0,e.pause())))}),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){Yt("wrapped _read",t),n&&(n=!1,e.resume())},r},zt._fromList=an,fn.WritableState=cn,vt(fn,je),cn.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},fn.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},fn.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return"function"===typeof t&&(n=t,t=null),te.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!==typeof n&&(n=ln),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),rt(t,n)}(this,n):function(e,t,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):te.isBuffer(n)||"string"===typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),rt(r,a),i=!1),i}(this,r,e,n)&&(r.pendingcb++,i=function(e,t,n,r,i){n=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=te.from(t,n)),t}(t,n,r),te.isBuffer(n)&&(r="buffer");var a=t.objectMode?1:n.length;t.length+=a;var o=t.length<t.highWaterMark;o||(t.needDrain=!0);if(t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new dn(n,r,i),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else hn(e,t,!1,a,n,r,i);return o}(this,r,e,t,n)),i},fn.prototype.cork=function(){this._writableState.corked++},fn.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||gn(this,e))},fn.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},fn.prototype._write=function(e,t,n){n(new Error("not implemented"))},fn.prototype._writev=null,fn.prototype.end=function(e,t,n){var r=this._writableState;"function"===typeof e?(n=e,e=null,t=null):"function"===typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,yn(e,t),n&&(t.finished?rt(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},vt(Sn,zt);for(var Tn=Object.keys(fn.prototype),En=0;En<Tn.length;En++){var bn=Tn[En];Sn.prototype[bn]||(Sn.prototype[bn]=fn.prototype[bn])}function Sn(e){if(!(this instanceof Sn))return new Sn(e);zt.call(this,e),fn.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",An)}function An(){this.allowHalfOpen||this._writableState.ended||rt(wn,this)}function wn(e){e.end()}function In(e){this.afterTransform=function(t,n){return function(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n);i(t);var a=e._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&e._read(a.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Cn(e){if(!(this instanceof Cn))return new Cn(e);Sn.call(this,e),this._transformState=new In(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"===typeof this._flush?this._flush(function(e){Rn(t,e)}):Rn(t)})}function Rn(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Dn(e){if(!(this instanceof Dn))return new Dn(e);Cn.call(this,e)}function Mn(){je.call(this)}vt(Cn,Sn),Cn.prototype.push=function(e,t){return this._transformState.needTransform=!1,Sn.prototype.push.call(this,e,t)},Cn.prototype._transform=function(e,t,n){throw new Error("Not implemented")},Cn.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Cn.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},vt(Dn,Cn),Dn.prototype._transform=function(e,t,n){n(null,e)},vt(Mn,je),Mn.Readable=zt,Mn.Writable=fn,Mn.Duplex=Sn,Mn.Transform=Cn,Mn.PassThrough=Dn,Mn.Stream=Mn,Mn.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",o),n.on("close",s));var a=!1;function o(){a||(a=!0,e.end())}function s(){a||(a=!0,"function"===typeof e.destroy&&e.destroy())}function u(e){if(l(),0===je.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",o),n.removeListener("close",s),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",u),e.on("error",u),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e};var On=f(function(e,t){!function(e){e.parser=function(e,t){return new r(e,t)},e.SAXParser=r,e.SAXStream=a,e.createStream=function(e,t){return new a(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function r(t,i){if(!(this instanceof r))return new r(t,i);!function(e){for(var t=0,r=n.length;t<r;t++)e[n[t]]=""}(this),this.q=this.c="",this.bufferCheckPosition=e.MAX_BUFFER_LENGTH,this.opt=i||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!t,this.noscript=!(!t&&!this.opt.noscript),this.state=S.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(g)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),w(this,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),r.prototype={end:function(){M(this)},write:function(t){if(this.error)throw this.error;if(this.closed)return D(this,"Cannot write after close. Assign an onready handler.");if(null===t)return M(this);"object"===typeof t&&(t=t.toString());var r=0,i="";for(;i=B(t,r++),this.c=i,i;)switch(this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++),this.state){case S.BEGIN:if(this.state=S.BEGIN_WHITESPACE,"\ufeff"===i)continue;U(this,i);continue;case S.BEGIN_WHITESPACE:U(this,i);continue;case S.TEXT:if(this.sawRoot&&!this.closedRoot){for(var a=r-1;i&&"<"!==i&&"&"!==i;)(i=B(t,r++))&&this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++);this.textNode+=t.substring(a,r-1)}"<"!==i||this.sawRoot&&this.closedRoot&&!this.strict?(!b(o,i)||this.sawRoot&&!this.closedRoot||O(this,"Text data outside of root node."),"&"===i?this.state=S.TEXT_ENTITY:this.textNode+=i):(this.state=S.OPEN_WAKA,this.startTagPosition=this.position);continue;case S.SCRIPT:"<"===i?this.state=S.SCRIPT_ENDING:this.script+=i;continue;case S.SCRIPT_ENDING:"/"===i?this.state=S.CLOSE_TAG:(this.script+="<"+i,this.state=S.SCRIPT);continue;case S.OPEN_WAKA:if("!"===i)this.state=S.SGML_DECL,this.sgmlDecl="";else if(E(o,i));else if(E(m,i))this.state=S.OPEN_TAG,this.tagName=i;else if("/"===i)this.state=S.CLOSE_TAG,this.tagName="";else if("?"===i)this.state=S.PROC_INST,this.procInstName=this.procInstBody="";else{if(O(this,"Unencoded <"),this.startTagPosition+1<this.position){var s=this.position-this.startTagPosition;i=new Array(s).join(" ")+i}this.textNode+="<"+i,this.state=S.TEXT}continue;case S.SGML_DECL:(this.sgmlDecl+i).toUpperCase()===c?(I(this,"onopencdata"),this.state=S.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+i==="--"?(this.state=S.COMMENT,this.comment="",this.sgmlDecl=""):(this.sgmlDecl+i).toUpperCase()===f?(this.state=S.DOCTYPE,(this.doctype||this.sawRoot)&&O(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===i?(I(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=S.TEXT):E(l,i)?(this.state=S.SGML_DECL_QUOTED,this.sgmlDecl+=i):this.sgmlDecl+=i;continue;case S.SGML_DECL_QUOTED:i===this.q&&(this.state=S.SGML_DECL,this.q=""),this.sgmlDecl+=i;continue;case S.DOCTYPE:">"===i?(this.state=S.TEXT,I(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=i,"["===i?this.state=S.DOCTYPE_DTD:E(l,i)&&(this.state=S.DOCTYPE_QUOTED,this.q=i));continue;case S.DOCTYPE_QUOTED:this.doctype+=i,i===this.q&&(this.q="",this.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:this.doctype+=i,"]"===i?this.state=S.DOCTYPE:E(l,i)&&(this.state=S.DOCTYPE_DTD_QUOTED,this.q=i);continue;case S.DOCTYPE_DTD_QUOTED:this.doctype+=i,i===this.q&&(this.state=S.DOCTYPE_DTD,this.q="");continue;case S.COMMENT:"-"===i?this.state=S.COMMENT_ENDING:this.comment+=i;continue;case S.COMMENT_ENDING:"-"===i?(this.state=S.COMMENT_ENDED,this.comment=R(this.opt,this.comment),this.comment&&I(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+i,this.state=S.COMMENT);continue;case S.COMMENT_ENDED:">"!==i?(O(this,"Malformed comment"),this.comment+="--"+i,this.state=S.COMMENT):this.state=S.TEXT;continue;case S.CDATA:"]"===i?this.state=S.CDATA_ENDING:this.cdata+=i;continue;case S.CDATA_ENDING:"]"===i?this.state=S.CDATA_ENDING_2:(this.cdata+="]"+i,this.state=S.CDATA);continue;case S.CDATA_ENDING_2:">"===i?(this.cdata&&I(this,"oncdata",this.cdata),I(this,"onclosecdata"),this.cdata="",this.state=S.TEXT):"]"===i?this.cdata+="]":(this.cdata+="]]"+i,this.state=S.CDATA);continue;case S.PROC_INST:"?"===i?this.state=S.PROC_INST_ENDING:E(o,i)?this.state=S.PROC_INST_BODY:this.procInstName+=i;continue;case S.PROC_INST_BODY:if(!this.procInstBody&&E(o,i))continue;"?"===i?this.state=S.PROC_INST_ENDING:this.procInstBody+=i;continue;case S.PROC_INST_ENDING:">"===i?(I(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=S.TEXT):(this.procInstBody+="?"+i,this.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:E(v,i)?this.tagName+=i:(N(this),">"===i?k(this):"/"===i?this.state=S.OPEN_TAG_SLASH:(b(o,i)&&O(this,"Invalid character in tag name"),this.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:">"===i?(k(this,!0),x(this)):(O(this,"Forward-slash in opening tag not followed by >"),this.state=S.ATTRIB);continue;case S.ATTRIB:if(E(o,i))continue;">"===i?k(this):"/"===i?this.state=S.OPEN_TAG_SLASH:E(m,i)?(this.attribName=i,this.attribValue="",this.state=S.ATTRIB_NAME):O(this,"Invalid attribute name");continue;case S.ATTRIB_NAME:"="===i?this.state=S.ATTRIB_VALUE:">"===i?(O(this,"Attribute without value"),this.attribValue=this.attribName,L(this),k(this)):E(o,i)?this.state=S.ATTRIB_NAME_SAW_WHITE:E(v,i)?this.attribName+=i:O(this,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if("="===i)this.state=S.ATTRIB_VALUE;else{if(E(o,i))continue;O(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",I(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===i?k(this):E(m,i)?(this.attribName=i,this.state=S.ATTRIB_NAME):(O(this,"Invalid attribute name"),this.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(E(o,i))continue;E(l,i)?(this.q=i,this.state=S.ATTRIB_VALUE_QUOTED):(O(this,"Unquoted attribute value"),this.state=S.ATTRIB_VALUE_UNQUOTED,this.attribValue=i);continue;case S.ATTRIB_VALUE_QUOTED:if(i!==this.q){"&"===i?this.state=S.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=i;continue}L(this),this.q="",this.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:E(o,i)?this.state=S.ATTRIB:">"===i?k(this):"/"===i?this.state=S.OPEN_TAG_SLASH:E(m,i)?(O(this,"No whitespace between attributes"),this.attribName=i,this.attribValue="",this.state=S.ATTRIB_NAME):O(this,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(b(d,i)){"&"===i?this.state=S.ATTRIB_VALUE_ENTITY_U:this.attribValue+=i;continue}L(this),">"===i?k(this):this.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(this.tagName)">"===i?x(this):E(v,i)?this.tagName+=i:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=S.SCRIPT):(b(o,i)&&O(this,"Invalid tagname in closing tag"),this.state=S.CLOSE_TAG_SAW_WHITE);else{if(E(o,i))continue;b(m,i)?this.script?(this.script+="</"+i,this.state=S.SCRIPT):O(this,"Invalid tagname in closing tag."):this.tagName=i}continue;case S.CLOSE_TAG_SAW_WHITE:if(E(o,i))continue;">"===i?x(this):O(this,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var u,h;switch(this.state){case S.TEXT_ENTITY:u=S.TEXT,h="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:u=S.ATTRIB_VALUE_QUOTED,h="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:u=S.ATTRIB_VALUE_UNQUOTED,h="attribValue"}";"===i?(this[h]+=F(this),this.entity="",this.state=u):E(this.entity.length?_:y,i)?this.entity+=i:(O(this,"Invalid character in entity name"),this[h]+="&"+this.entity+i,this.entity="",this.state=u);continue;default:throw new Error(this,"Unknown state: "+this.state)}this.position>=this.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,a=0,o=n.length;a<o;a++){var s=t[n[a]].length;if(s>r)switch(n[a]){case"textNode":C(t);break;case"cdata":I(t,"oncdata",t.cdata),t.cdata="";break;case"script":I(t,"onscript",t.script),t.script="";break;default:D(t,"Max buffer length exceeded: "+n[a])}i=Math.max(i,s)}var u=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=u+t.position}(this);return this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;C(e=this),""!==e.cdata&&(I(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(I(e,"onscript",e.script),e.script="")}};try{t=Mn.Stream}catch(j){t=function(){}}var i=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function a(e,n){if(!(this instanceof a))return new a(e,n);t.apply(this),this._parser=new r(e,n),this.writable=!0,this.readable=!0;var o=this;this._parser.onend=function(){o.emit("end")},this._parser.onerror=function(e){o.emit("error",e),o._parser.error=null},this._decoder=null,i.forEach(function(e){Object.defineProperty(o,"on"+e,{get:function(){return o._parser["on"+e]},set:function(t){if(!t)return o.removeAllListeners(e),o._parser["on"+e]=t,t;o.on(e,t)},enumerable:!0,configurable:!1})})}a.prototype=Object.create(t.prototype,{constructor:{value:a}}),a.prototype.write=function(e){if(Fe(e)){if(!this._decoder){var t=Kt.StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},a.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},a.prototype.on=function(e,n){var r=this;return r._parser["on"+e]||-1===i.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),t.prototype.on.call(r,e,n)};var o="\r\n\t ",s="0124356789",u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",l="'\"",d=o+">",c="[CDATA[",f="DOCTYPE",h="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/2000/xmlns/",g={xml:h,xmlns:p};o=T(o),s=T(s),u=T(u);var m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function T(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function E(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function b(e,t){return!E(e,t)}l=T(l),d=T(d);var S=0;for(var A in e.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var n=e.ENTITIES[t],r="number"===typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r}),e.STATE)e.STATE[e.STATE[A]]=A;function w(e,t,n){e[t]&&e[t](n)}function I(e,t,n){e.textNode&&C(e),w(e,t,n)}function C(e){e.textNode=R(e.opt,e.textNode),e.textNode&&w(e,"ontext",e.textNode),e.textNode=""}function R(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function D(e,t){return C(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,w(e,"onerror",t),e}function M(e){return e.sawRoot&&!e.closedRoot&&O(e,"Unclosed root tag"),e.state!==S.BEGIN&&e.state!==S.BEGIN_WHITESPACE&&e.state!==S.TEXT&&D(e,"Unexpected end"),C(e),e.c="",e.closed=!0,w(e,"onend"),r.call(e,e.strict,e.opt),e}function O(e,t){if("object"!==typeof e||!(e instanceof r))throw new Error("bad call to strictFail");e.strict&&D(e,t)}function N(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,I(e,"onopentagstart",n)}function P(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function L(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=P(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==h)O(e,"xml: prefix must be bound to "+h+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==p)O(e,"xmlns: prefix must be bound to "+p+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,I(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function k(e,t){if(e.opt.xmlns){var n=e.tag,r=P(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(O(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){I(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],u=s[0],l=s[1],d=P(u,!0),c=d.prefix,f=d.local,h=""===c?"":n.ns[c]||"",p={name:u,value:l,prefix:c,local:f,uri:h};c&&"xmlns"!==c&&!h&&(O(e,"Unbound namespace prefix: "+JSON.stringify(c)),p.uri=c),e.tag.attributes[u]=p,I(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),I(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=S.TEXT:e.state=S.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function x(e){if(!e.tagName)return O(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=S.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=S.SCRIPT);I(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--;){if(e.tags[t].name===r)break;O(e,"Unexpected close tag")}if(t<0)return O(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=S.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,I(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==u.ns&&Object.keys(a.ns).forEach(function(t){var n=a.ns[t];I(e,"onclosenamespace",{prefix:t,uri:n})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=S.TEXT}function F(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(O(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function U(e,t){"<"===t?(e.state=S.OPEN_WAKA,e.startTagPosition=e.position):b(o,t)&&(O(e,"Non-whitespace before first tag."),e.textNode=t,e.state=S.TEXT)}function B(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}S=e.STATE,String.fromCodePoint||function(){var e=String.fromCharCode,t=Math.floor,n=function(){var n,r,i=[],a=-1,o=arguments.length;if(!o)return"";for(var s="";++a<o;){var u=Number(arguments[a]);if(!isFinite(u)||u<0||u>1114111||t(u)!==u)throw RangeError("Invalid code point: "+u);u<=65535?i.push(u):(n=55296+((u-=65536)>>10),r=u%1024+56320,i.push(n,r)),(a+1===o||i.length>16384)&&(s+=e.apply(null,i),i.length=0)}return s};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:n,configurable:!0,writable:!0}):String.fromCodePoint=n}()}(t)}),Nn=f(function(e,t){!function(e,n,r,i,a){function o(e,t,n,r){var i=r&&"seq"===r.timeContainer,a=0;r&&(a=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+a:a;var s=t.begin,u=null;for(var l in t.sets)o(e,t.sets[l],u,t),s="seq"===t.timeContainer?t.sets[l].end:Math.max(s,t.sets[l].end),u=t.sets[l];if("contents"in t)for(var d in t.contents)o(e,t.contents[d],u,t),s="seq"===t.timeContainer?t.contents[d].end:Math.max(s,t.contents[d].end),u=t.contents[d];else s=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,a+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=a+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function s(e){this.node=e}function u(){this.events=[],this.head=new l,this.body=null}function l(){this.styling=new d,this.layout=new h}function d(){this.styles={},this.initials={}}function c(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function f(){this.styleAttrs=null}function h(){this.regions={}}function p(e,t){g.call(this,"image"),this.src=e,this.type=t}function g(e){this.kind=e}function m(e){this.id=e}function v(e){this.regionID=e}function y(e){this.styleAttrs=e}function _(e){this.sets=e}function T(e){this.contents=e}function E(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function b(){g.call(this,"body")}function S(){g.call(this,"div")}function A(){g.call(this,"p")}function w(){g.call(this,"span")}function I(){g.call(this,"span")}function C(){g.call(this,"br")}function R(){}function D(){}function M(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function O(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function N(e,t){var n={};if(null!==e)for(var r in e.attributes){var a=e.attributes[r].uri+" "+e.attributes[r].local,o=i.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[r].value);null!==s?(n[a]=s,o===i.byName.zIndex&&U(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):B(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[r].value)}}return n}function P(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null}function L(e,t,n){var r,i=null;return null!==(r=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(i=parseFloat(r[1])/t):null!==(r=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(i=parseFloat(r[1])/e):null!==(r=/^(\d+(?:\.\d+)?)ms$/.exec(n))?i=parseFloat(r[1])/1e3:null!==(r=/^(\d+(?:\.\d+)?)s$/.exec(n))?i=parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)h$/.exec(n))?i=3600*parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)m$/.exec(n))?i=60*parseFloat(r[1]):null!==(r=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?i=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(i=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),i}function k(e,t,n){for(;t.styleRefs.length>0;){var r=t.styleRefs.pop();r in e.styles?(k(e,e.styles[r],n),F(e.styles[r].styleAttrs,t.styleAttrs)):B(n,"Non-existant style id referenced")}}function x(e,t,n,r){for(var i=t.length-1;i>=0;i--){var a=t[i];a in e.styles?F(e.styles[a].styleAttrs,n):B(r,"Non-existant style id referenced")}}function F(e,t){for(var n in e)n in t||(t[n]=e[n])}function U(e,t){if(e&&e.warn&&e.warn(t))throw t}function B(e,t){if(e&&e.error&&e.error(t))throw t}function j(e,t){throw e&&e.fatal&&e.fatal(t),t}function G(e,t){for(var n,r=0,i=e.length-1;r<=i;){var a=e[n=Math.floor((r+i)/2)];if(a<t)r=n+1;else{if(!(a>t))return{found:!0,index:n};i=n-1}}return{found:!1,index:r}}t.fromXML=function(e,t,a){var g=n.parser(!0,{xmlns:!0}),m=[],v=[],y=[],_=0,T=null;g.onclosetag=function(e){if(m[0]instanceof d)for(var n in m[0].styles)k(m[0],m[0].styles[n],t);else if(m[0]instanceof A||m[0]instanceof w){if(m[0].contents.length>1){var i,o=[m[0].contents[0]];for(i=1;i<m[0].contents.length;i++)m[0].contents[i]instanceof I&&o[o.length-1]instanceof I?o[o.length-1].text+=m[0].contents[i].text:o.push(m[0].contents[i]);m[0].contents=o}m[0]instanceof w&&1===m[0].contents.length&&m[0].contents[0]instanceof I&&(m[0].text=m[0].contents[0].text,delete m[0].contents)}else m[0]instanceof s&&(m[0].node.uri===r.ns_tt&&"metadata"===m[0].node.local?_--:_>0&&a&&"onCloseTag"in a&&a.onCloseTag());y.shift(),v.shift(),m.shift()},g.ontext=function(e){if(void 0===m[0]);else if(m[0]instanceof w||m[0]instanceof A){if(m[0]instanceof w){var n=m[0].styleAttrs[i.byName.ruby.qname];if("container"===n||"textContainer"===n||"baseContainer"===n)return}var r=new I;r.initFromText(T,m[0],e,y[0],t),m[0].contents.push(r)}else m[0]instanceof s&&_>0&&a&&"onText"in a&&a.onText(e)},g.onopentag=function(e){var n=e.attributes["xml:space"];n?y.unshift(n.value):0===y.length?y.unshift("default"):y.unshift(y[0]);var o=e.attributes["xml:lang"];if(o?v.unshift(o.value):0===v.length?v.unshift(""):v.unshift(v[0]),e.uri===r.ns_tt)if("tt"===e.local)null!==T&&j(t,"Two <tt> elements at ("+this.line+","+this.column+")"),(T=new u).initFromNode(e,t),m.unshift(T);else if("head"===e.local)m[0]instanceof u||j(t,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),m.unshift(T.head);else if("styling"===e.local)m[0]instanceof l||j(t,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),m.unshift(T.head.styling);else if("style"===e.local){var g;m[0]instanceof d?((g=new c).initFromNode(e,t),g.id?T.head.styling.styles[g.id]=g:B(t,"<style> element missing @id attribute"),m.unshift(g)):m[0]instanceof R?((g=new c).initFromNode(e,t),F(g.styleAttrs,m[0].styleAttrs),m.unshift(g)):j(t,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===e.local){var E;if(m[0]instanceof d){for(var I in(E=new f).initFromNode(e,t),E.styleAttrs)T.head.styling.initials[I]=E.styleAttrs[I];m.unshift(E)}else j(t,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===e.local)m[0]instanceof l||j(t,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),m.unshift(T.head.layout);else if("region"===e.local){m[0]instanceof h||j(t,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var M=new R;M.initFromNode(T,e,t),!M.id||M.id in T.head.layout.regions?B(t,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):T.head.layout.regions[M.id]=M,m.unshift(M)}else if("body"===e.local){m[0]instanceof u||j(t,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==T.body&&j(t,"Second <body> element at "+this.line+","+this.column+")");var O=new b;O.initFromNode(T,e,t),T.body=O,m.unshift(O)}else if("div"===e.local){m[0]instanceof S||m[0]instanceof b||j(t,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var N=new S;N.initFromNode(T,m[0],e,t);var P=N.styleAttrs[i.byName.backgroundImage.qname];P&&(N.contents.push(new p(P)),delete N.styleAttrs[i.byName.backgroundImage.qname]),m[0].contents.push(N),m.unshift(N)}else if("image"===e.local){m[0]instanceof S||j(t,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var L=new p;L.initFromNode(T,m[0],e,t),m[0].contents.push(L),m.unshift(L)}else if("p"===e.local){m[0]instanceof S||j(t,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var k=new A;k.initFromNode(T,m[0],e,t),m[0].contents.push(k),m.unshift(k)}else if("span"===e.local){m[0]instanceof w||m[0]instanceof A||j(t,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var x=new w;x.initFromNode(T,m[0],e,y[0],t),m[0].contents.push(x),m.unshift(x)}else if("br"===e.local){m[0]instanceof w||m[0]instanceof A||j(t,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var U=new C;U.initFromNode(T,m[0],e,t),m[0].contents.push(U),m.unshift(U)}else if("set"===e.local){m[0]instanceof w||m[0]instanceof A||m[0]instanceof S||m[0]instanceof b||m[0]instanceof R||m[0]instanceof C||j(t,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var G=new D;G.initFromNode(T,m[0],e,t),m[0].sets.push(G),m.unshift(G)}else m.unshift(new s(e));else m.unshift(new s(e));if(m[0]instanceof s)if(e.uri===r.ns_tt&&"metadata"===e.local)_++;else if(_>0&&a&&"onOpenTag"in a){var q=[];for(var H in e.attributes)q[e.attributes[H].uri+" "+e.attributes[H].local]={uri:e.attributes[H].uri,local:e.attributes[H].local,value:e.attributes[H].value};a.onOpenTag(e.uri,e.local,q)}},g.write(e).close(),delete T.head.styling.styles;var E=!1;for(var M in T.head.layout.regions){E=!0;break}if(!E){var O=R.prototype.createDefaultRegion();T.head.layout.regions[O.id]=O}for(var N in T.head.layout.regions)o(T,T.head.layout.regions[N],null,null);return T.body&&o(T,T.body,null,null),T.body&&function e(t){if(!("contents"in t))return;var n="styleAttrs"in t?t.styleAttrs[i.byName.ruby.qname]:null;var r="span"===t.kind&&("container"===n||"textContainer"===n||"baseContainer"===n);for(var a=t.contents.length-1;a>=0;a--)!r||"styleAttrs"in t.contents[a]&&i.byName.ruby.qname in t.contents[a].styleAttrs?e(t.contents[a]):delete t.contents[a]}(T.body),T},u.prototype.initFromNode=function(e,t){var n=function(e,t){var n=P(e,r.ns_ttp,"cellResolution"),i=15,a=32;if(null!==n){var o=/(\d+) (\d+)/.exec(n);null!==o?(a=parseInt(o[1]),i=parseInt(o[2])):U(t,"Malformed cellResolution value (using initial value instead)")}return{w:a,h:i}}(e,t);this.cellLength={h:new a.ComputedLength(0,1/n.h),w:new a.ComputedLength(1/n.w,0)};var i=function(e,t){var n,i=P(e,r.ns_ttp,"frameRate"),a=30;if(null!==i){null!==(n=/(\d+)/.exec(i))?a=parseInt(n[1]):U(t,"Malformed frame rate attribute (using initial value instead)")}var o=P(e,r.ns_ttp,"frameRateMultiplier"),s=1;if(null!==o){null!==(n=/(\d+) (\d+)/.exec(o))?s=parseInt(n[1])/parseInt(n[2]):U(t,"Malformed frame rate multiplier attribute (using initial value instead)")}var u=s*a,l=1,d=P(e,r.ns_ttp,"tickRate");if(null===d)null!==i&&(l=u);else{null!==(n=/(\d+)/.exec(d))?l=parseInt(n[1]):U(t,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:u,tickRate:l}}(e,t);this.effectiveFrameRate=i.effectiveFrameRate,this.tickRate=i.tickRate,this.aspectRatio=function(e,t){var n=P(e,r.ns_ittp,"aspectRatio");null===n&&(n=P(e,r.ns_ttp,"displayAspectRatio"));var i=null;if(null!==n){var a=/(\d+)\s+(\d+)/.exec(n);if(null!==a){var o=parseInt(a[1]),s=parseInt(a[2]);0!==o&&0!==s?i=o/s:B(t,"Illegal aspectRatio values (ignoring)")}else B(t,"Malformed aspectRatio attribute (ignoring)")}return i}(e,t);var o=P(e,r.ns_ttp,"timeBase");null!==o&&"media"!==o&&j(t,"Unsupported time base");var s=function(e,t){var n=P(e,r.ns_tts,"extent");if(null===n)return null;var i=n.split(" ");if(2!==i.length)return U(t,"Malformed extent (ignoring)"),null;var o=a.parseLength(i[0]),s=a.parseLength(i[1]);if(!s||!o)return U(t,"Malformed extent values (ignoring)"),null;return{h:s,w:o}}(e,t);null===s?this.pxLength={h:null,w:null}:("px"===s.h.unit&&"px"===s.w.unit||j(t,"Extent on TT must be in px or absent"),this.pxLength={h:new a.ComputedLength(0,1/s.h.value),w:new a.ComputedLength(1/s.w.value,0)}),this.dimensions={h:new a.ComputedLength(0,1),w:new a.ComputedLength(1,0)}},u.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=G(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=G(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},u.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},u.prototype.getMediaTimeEvents=function(){return this.events},c.prototype.initFromNode=function(e,t){this.id=M(e),this.styleAttrs=N(e,t),this.styleRefs=O(e)},f.prototype.initFromNode=function(e,t){for(var n in this.styleAttrs={},e.attributes)if(e.attributes[n].uri===r.ns_itts||e.attributes[n].uri===r.ns_ebutts||e.attributes[n].uri===r.ns_tts){var i=e.attributes[n].uri+" "+e.attributes[n].local;this.styleAttrs[i]=e.attributes[n].value}},p.prototype.initFromNode=function(e,t,n,r){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||B(r,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||B(r,"Invalid image@type attribute"),y.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),v.prototype.initFromNode.call(this,e,t,n,r)},m.prototype.initFromNode=function(e,t,n,r){this.id=M(n)},v.prototype.initFromNode=function(e,t,n,r){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(n)},y.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=N(n,r),null!==e.head&&null!==e.head.styling&&x(e.head.styling,O(n),this.styleAttrs,r)},_.prototype.initFromNode=function(e,t,n,r){this.sets=[]},T.prototype.initFromNode=function(e,t,n,r){this.contents=[]},E.prototype.initFromNode=function(e,t,n,r){var i=function(e,t,n,r){var i=null;n&&"begin"in n.attributes&&null===(i=L(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&U(r,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=L(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&U(r,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;n&&"end"in n.attributes&&null===(o=L(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&U(r,"Malformed end value (ignoring)");return{explicit_begin:i,explicit_end:o,explicit_dur:a}}(e,0,n,r);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(B(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,r)},b.prototype.initFromNode=function(e,t,n){y.prototype.initFromNode.call(this,e,null,t,n),E.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n),v.prototype.initFromNode.call(this,e,null,t,n),T.prototype.initFromNode.call(this,e,null,t,n)},S.prototype.initFromNode=function(e,t,n,r){y.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),v.prototype.initFromNode.call(this,e,t,n,r),T.prototype.initFromNode.call(this,e,t,n,r)},A.prototype.initFromNode=function(e,t,n,r){y.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),v.prototype.initFromNode.call(this,e,t,n,r),T.prototype.initFromNode.call(this,e,t,n,r)},w.prototype.initFromNode=function(e,t,n,r,i){y.prototype.initFromNode.call(this,e,t,n,i),E.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i),v.prototype.initFromNode.call(this,e,t,n,i),T.prototype.initFromNode.call(this,e,t,n,i),this.space=r},I.prototype.initFromText=function(e,t,n,r,i){E.prototype.initFromNode.call(this,e,t,null,i),this.text=n,this.space=r},C.prototype.initFromNode=function(e,t,n,r){v.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r)},R.prototype.createDefaultRegion=function(){var e=new R;return m.call(e,""),y.call(e,{}),_.call(e,[]),E.call(e,0,Number.POSITIVE_INFINITY,null),e},R.prototype.initFromNode=function(e,t,n){m.prototype.initFromNode.call(this,e,null,t,n),y.prototype.initFromNode.call(this,e,null,t,n),E.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n),null!==e.head&&null!==e.head.styling&&x(e.head.styling,O(t),this.styleAttrs,n)},D.prototype.initFromNode=function(e,t,n,r){E.prototype.initFromNode.call(this,e,t,n,r);var i=N(n,r);for(var a in this.qname=null,this.value=null,i){if(this.qname){B(r,"More than one style specified on set");break}this.qname=a,this.value=i[a]}}}(0,"undefined"===typeof sax?On:sax,"undefined"===typeof imscNames?F:imscNames,"undefined"===typeof imscStyles?B:imscStyles,"undefined"===typeof imscUtils?U:imscUtils)}),Pn=f(function(e,t){!function(e,n,r){function i(e,t,n){var u;if("region"===n.kind)(u=document.createElement("div")).style.position="absolute";else if("body"===n.kind)u=document.createElement("div");else if("div"===n.kind)u=document.createElement("div");else if("image"===n.kind){if(u=document.createElement("img"),null!==e.imgResolver&&null!==n.src){var d=e.imgResolver(n.src,u);d&&(u.src=d),u.height=e.regionH,u.width=e.regionW}}else if("p"===n.kind)u=document.createElement("p");else if("span"===n.kind){if("container"===n.styleAttrs[r.byName.ruby.qname])u=document.createElement("ruby"),e.ruby=!0;else if("base"===n.styleAttrs[r.byName.ruby.qname])u=document.createElement("rb");else if("text"===n.styleAttrs[r.byName.ruby.qname])u=document.createElement("rt");else if("baseContainer"===n.styleAttrs[r.byName.ruby.qname])u=document.createElement("rbc");else if("textContainer"===n.styleAttrs[r.byName.ruby.qname])u=document.createElement("rtc");else{if("delimiter"===n.styleAttrs[r.byName.ruby.qname])return;u=document.createElement("span")}var c=n.styleAttrs[r.byName.textEmphasis.qname];c&&"none"!==c.style&&(e.textEmphasis=!0)}else"br"===n.kind&&(u=document.createElement("br"));if(u){for(var f in t.appendChild(u),u.style.margin="0",l){var h=l[f],p=n.styleAttrs[h.qname];void 0!==p&&null!==h.map&&h.map(e,u,n,p)}var g=u;if("region"===n.kind){var m=n.styleAttrs[r.byName.writingMode.qname];"lrtb"===m||"lr"===m?(e.ipd="lr",e.bpd="tb"):"rltb"===m||"rl"===m?(e.ipd="rl",e.bpd="tb"):"tblr"===m?(e.ipd="tb",e.bpd="lr"):"tbrl"!==m&&"tb"!==m||(e.ipd="tb",e.bpd="rl")}var v=n.styleAttrs[r.byName.linePadding.qname];if(v&&!v.isZero()){var y=v.toUsedLength(e.w,e.h);if(y>0){var _=Math.ceil(y)+"px";"tb"===e.bpd?(g.style.paddingLeft=_,g.style.paddingRight=_):(g.style.paddingTop=_,g.style.paddingBottom=_),e.lp=v}}var T=n.styleAttrs[r.byName.multiRowAlign.qname];if(T&&"auto"!==T){var E=document.createElement("span");E.style.display="inline-block",E.style.textAlign=T,u.appendChild(E),g=E,e.mra=T}var b=n.styleAttrs[r.byName.rubyReserve.qname];if(b&&"none"!==b[0]&&(e.rubyReserve=b),n.styleAttrs[r.byName.fillLineGap.qname]&&(e.flg=!0),"span"===n.kind&&n.text)if(r.byName.textCombine.qname in n.styleAttrs&&"all"===n.styleAttrs[r.byName.textCombine.qname][0])u.textContent=n.text;else for(var S="",A=0;A<n.text.length;A++){S+=n.text.charAt(A);var w=n.text.charCodeAt(A);if(w<55296||w>56319||A===n.text.length){var I=document.createElement("span");I.textContent=S,u.appendChild(I),S=""}}for(var C in n.contents)i(e,g,n.contents[C]);var R=[];if((e.lp||e.mra||e.flg||e.ruby||e.textEmphasis||e.rubyReserve)&&"p"===n.kind&&(s(e,g,R,null),e.rubyReserve&&(!function(e,t){for(var n=0;n<e.length;n++){var r,i,a=document.createElement("ruby"),o=document.createElement("rb");o.textContent="\u200b",a.appendChild(o);var s=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]?((r=document.createElement("rtc")).style.rubyPosition="under",r.textContent="\u200b",r.style.fontSize=s,(i=document.createElement("rtc")).style.rubyPosition="over",i.textContent="\u200b",i.style.fontSize=s,a.appendChild(r),a.appendChild(i)):((r=document.createElement("rtc")).textContent="\u200b",r.style.fontSize=s,"after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&n>0?r.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"under":"over":r.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"over":"under",a.appendChild(r));e[n].elements[0].node.parentElement.insertBefore(a,e[n].elements[0].node)}}(R,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(!function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].rbc.length;r++){var i;if(!e[n].rbc[r].style.rubyPosition)i="tb"===t.bpd?0===n?"over":"under":"rl"===t.bpd?0===n?"over":"under":0===n?"under":"over",e[n].rbc[r].style.rubyPosition=i}}(R,e),e.ruby=null),e.textEmphasis&&(!function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].te.length;r++){var i;if(!e[n].te[r].style.textEmphasisPosition||"none"===e[n].te[r].style.textEmphasisPosition)i="tb"===t.bpd?0===n?"left over":"left under":"rl"===t.bpd?0===n?"right under":"left under":0===n?"left under":"right under",e[n].te[r].style.textEmphasisPosition=i}}(R,e),e.textEmphasis=null),e.mra&&(!function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var r=document.createElement("br"),i=e[t].elements[n-1].node;i.parentElement.insertBefore(r,i.nextSibling)}}}(R),e.mra=null),e.lp&&(!function(e,t,n){for(var r in e){var i=e[r].elements.length,a=e[r].elements[e[r].start_elem],o=e[r].elements[e[r].end_elem],s=Math.ceil(t)+"px",u="-"+Math.ceil(t)+"px";0!==i&&("lr"===n.ipd?(a.node.style.borderLeftColor=a.bgcolor||"#00000000",a.node.style.borderLeftStyle="solid",a.node.style.borderLeftWidth=s,a.node.style.marginLeft=u):"rl"===n.ipd?(a.node.style.borderRightColor=a.bgcolor||"#00000000",a.node.style.borderRightStyle="solid",a.node.style.borderRightWidth=s,a.node.style.marginRight=u):"tb"===n.ipd&&(a.node.style.borderTopColor=a.bgcolor||"#00000000",a.node.style.borderTopStyle="solid",a.node.style.borderTopWidth=s,a.node.style.marginTop=u),"lr"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=u):"rl"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=u):"tb"===n.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=u))}}(R,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),e.flg)){var D=o(g.getBoundingClientRect(),e);!function(e,t,n,r){for(var i=Math.sign(n-t),a=0;a<=e.length;a++){var o,s,u;if(o=0===a?t:a===e.length?n:(e[a].before+e[a-1].after)/2,a>0)for(var l=0;l<e[a-1].elements.length;l++)null!==e[a-1].elements[l].bgcolor&&(u=e[a-1].elements[l],i*(u.after-o)<0&&(s=Math.ceil(Math.abs(o-u.after))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingRight=s:"rl"===r.bpd?u.node.style.paddingLeft=s:"tb"===r.bpd&&(u.node.style.paddingBottom=s)));if(a<e.length)for(var d=0;d<e[a].elements.length;d++)null!==(u=e[a].elements[d]).bgcolor&&i*(u.before-o)>0&&(s=Math.ceil(Math.abs(u.before-o))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingLeft=s:"rl"===r.bpd?u.node.style.paddingRight=s:"tb"===r.bpd&&(u.node.style.paddingTop=s))}}(R,D.before,D.after,e),e.flg=null}if("region"===n.kind&&(s(e,g,R),"tb"===e.bpd&&e.enableRollUp&&n.contents.length>0&&"after"===n.styleAttrs[r.byName.displayAlign.qname])){var M=new a(""===n.id?"_":n.id,R);if(e.currentISDState[M.id]=M,e.previousISDState&&M.id in e.previousISDState&&e.previousISDState[M.id].plist.length>0&&M.plist.length>1&&M.plist[M.plist.length-2].text===e.previousISDState[M.id].plist[e.previousISDState[M.id].plist.length-1].text){var O=u.firstElementChild,N=M.plist[M.plist.length-1].after-M.plist[M.plist.length-1].before;O.style.bottom="-"+N+"px",O.style.transition="transform 0.4s",O.style.position="relative",O.style.transform="translateY(-"+N+"px)"}}}else!function(e,t){if(e&&e.error&&e.error(t))throw t}(e.errorHandler,"Error processing ISD element kind: "+n.kind)}function a(e,t){this.id=e,this.plist=t}function o(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function s(e,t,n,r){if("rt"!==t.localName&&"rtc"!==t.localName){var i,a,u,l,d=t.style.backgroundColor||r;if(0===t.childElementCount)if("span"===t.localName||"rb"===t.localName){var c=t.getBoundingClientRect();if(0===c.height||0===c.width)return;var f=o(c,e);if(0!==n.length&&(i=f.before,a=f.after,u=n[n.length-1].before,l=n[n.length-1].after,a<l&&i>u||l<=a&&u>=i)){var h=Math.sign(f.after-f.before),p=Math.sign(f.end-f.start);h*(f.before-n[n.length-1].before)<0&&(n[n.length-1].before=f.before),h*(f.after-n[n.length-1].after)>0&&(n[n.length-1].after=f.after),p*(f.start-n[n.length-1].start)<0&&(n[n.length-1].start=f.start,n[n.length-1].start_elem=n[n.length-1].elements.length),p*(f.end-n[n.length-1].end)>0&&(n[n.length-1].end=f.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:f.before,after:f.after,start:f.start,end:f.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:d,before:f.before,after:f.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var g=t.firstChild;g;)g.nodeType===Node.ELEMENT_NODE&&(s(e,g,n,d),"ruby"===g.localName||"rtc"===g.localName?n.length>0&&n[n.length-1].rbc.push(g):"span"===g.localName&&g.style.textEmphasisStyle&&"none"!==g.style.textEmphasisStyle&&n.length>0&&n[n.length-1].te.push(g)),g=g.nextSibling}}function u(e,t){this.qname=e,this.map=t}t.render=function(e,t,n,r,a,o,s,u,l){var d=r||t.clientHeight,c=a||t.clientWidth;if(null!==e.aspectRatio){var f=d*e.aspectRatio;f>c?d=Math.round(c/e.aspectRatio):c=f}var h=document.createElement("div");h.style.position="relative",h.style.width=c+"px",h.style.height=d+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var p={h:d,w:c,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:u,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};for(var g in t.appendChild(h),e.contents)i(p,h,e.contents[g]);return p.currentISDState};var l=[new u("http://www.w3.org/ns/ttml#styling backgroundColor",function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")")}),new u("http://www.w3.org/ns/ttml#styling color",function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")"}),new u("http://www.w3.org/ns/ttml#styling direction",function(e,t,n,r){t.style.direction=r}),new u("http://www.w3.org/ns/ttml#styling display",function(e,t,n,r){}),new u("http://www.w3.org/ns/ttml#styling displayAlign",function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end")}),new u("http://www.w3.org/ns/ttml#styling extent",function(e,t,n,r){e.regionH=r.h.toUsedLength(e.w,e.h),e.regionW=r.w.toUsedLength(e.w,e.h);var i=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=o[0].toUsedLength(e.w,e.h)+o[2].toUsedLength(e.w,e.h),a=o[1].toUsedLength(e.w,e.h)+o[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px"}),new u("http://www.w3.org/ns/ttml#styling fontFamily",function(e,t,n,r){var i=[];for(var a in r)"monospaceSerif"===r[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[a]?i.push("monospace"):"sansSerif"===r[a]?i.push("sans-serif"):"serif"===r[a]?i.push("serif"):"monospaceSansSerif"===r[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[a]?i.push("serif"):i.push(r[a]);t.style.fontFamily=i.join(",")}),new u("http://www.w3.org/ns/ttml#styling shear",function(e,t,n,r){if(0!==r){var i=-.9*r;"tb"===e.bpd?t.style.transform="skewX("+i+"deg)":t.style.transform="skewY("+i+"deg)"}}),new u("http://www.w3.org/ns/ttml#styling fontSize",function(e,t,n,r){t.style.fontSize=r.toUsedLength(e.w,e.h)+"px"}),new u("http://www.w3.org/ns/ttml#styling fontStyle",function(e,t,n,r){t.style.fontStyle=r}),new u("http://www.w3.org/ns/ttml#styling fontWeight",function(e,t,n,r){t.style.fontWeight=r}),new u("http://www.w3.org/ns/ttml#styling lineHeight",function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r.toUsedLength(e.w,e.h)+"px"}),new u("http://www.w3.org/ns/ttml#styling opacity",function(e,t,n,r){t.style.opacity=r}),new u("http://www.w3.org/ns/ttml#styling origin",function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"}),new u("http://www.w3.org/ns/ttml#styling overflow",function(e,t,n,r){t.style.overflow=r}),new u("http://www.w3.org/ns/ttml#styling padding",function(e,t,n,r){var i=[];i[0]=r[0].toUsedLength(e.w,e.h)+"px",i[1]=r[3].toUsedLength(e.w,e.h)+"px",i[2]=r[2].toUsedLength(e.w,e.h)+"px",i[3]=r[1].toUsedLength(e.w,e.h)+"px",t.style.padding=i.join(" ")}),new u("http://www.w3.org/ns/ttml#styling position",function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"}),new u("http://www.w3.org/ns/ttml#styling rubyAlign",function(e,t,n,r){t.style.rubyAlign=r}),new u("http://www.w3.org/ns/ttml#styling rubyPosition",function(e,t,n,r){var i;"before"!==r&&"after"!==r||(i="tb"===e.bpd?"before"===r?"over":"under":"rl"===e.bpd?"before"===r?"over":"under":"before"===r?"under":"over",t.parentElement.style.rubyPosition=i)}),new u("http://www.w3.org/ns/ttml#styling showBackground",null),new u("http://www.w3.org/ns/ttml#styling textAlign",function(e,t,n,i){var a,o=n.styleAttrs[r.byName.direction.qname];a="start"===i?"rtl"===o?"right":"left":"end"===i?"rtl"===o?"left":"right":i,t.style.textAlign=a}),new u("http://www.w3.org/ns/ttml#styling textDecoration",function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through")}),new u("http://www.w3.org/ns/ttml#styling textOutline",function(e,t,n,r){}),new u("http://www.w3.org/ns/ttml#styling textShadow",function(e,t,n,i){var a=n.styleAttrs[r.byName.textOutline.qname];if("none"===i&&"none"===a)t.style.textShadow="";else{var o=[];if("none"!==a&&o.push("rgba("+a.color[0].toString()+","+a.color[1].toString()+","+a.color[2].toString()+","+(a.color[3]/255).toString()+") 0px 0px "+a.thickness.toUsedLength(e.w,e.h)+"px"),"none"!==i)for(var s in i)o.push(i[s].x_off.toUsedLength(e.w,e.h)+"px "+i[s].y_off.toUsedLength(e.w,e.h)+"px "+i[s].b_radius.toUsedLength(e.w,e.h)+"px rgba("+i[s].color[0].toString()+","+i[s].color[1].toString()+","+i[s].color[2].toString()+","+(i[s].color[3]/255).toString()+")");t.style.textShadow=o.join(",")}}),new u("http://www.w3.org/ns/ttml#styling textCombine",function(e,t,n,r){t.style.textCombineUpright=r.join(" ")}),new u("http://www.w3.org/ns/ttml#styling textEmphasis",function(e,t,n,r){var i;"none"!==r.style?("auto"===r.style?t.style.textEmphasisStyle="filled":t.style.textEmphasisStyle=r.style+" "+r.symbol,("before"===r.position||"after"===r.position)&&(i="tb"===e.bpd?"before"===r.position?"left over":"left under":"rl"===e.bpd?"before"===r.position?"right under":"left under":"before"===r.position?"left under":"right under",t.style.textEmphasisPosition=i)):t.style.textEmphasisStyle="none"}),new u("http://www.w3.org/ns/ttml#styling unicodeBidi",function(e,t,n,r){var i;i="bidiOverride"===r?"bidi-override":r,t.style.unicodeBidi=i}),new u("http://www.w3.org/ns/ttml#styling visibility",function(e,t,n,r){t.style.visibility=r}),new u("http://www.w3.org/ns/ttml#styling wrapOption",function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"}),new u("http://www.w3.org/ns/ttml#styling writingMode",function(e,t,n,r){"lrtb"===r||"lr"===r?e.writingMode="horizontal-tb":"rltb"===r||"rl"===r?e.writingMode="horizontal-tb":"tblr"===r?e.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(e.writingMode="vertical-rl"),t.style.writingMode=e.writingMode}),new u("http://www.w3.org/ns/ttml#styling zIndex",function(e,t,n,r){t.style.zIndex=r}),new u("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden")})],d={};for(var c in l)d[l[c].qname]=l[c]}(0,"undefined"===typeof imscNames||imscNames,"undefined"===typeof imscStyles?B:imscStyles,"undefined"===typeof imscUtils||imscUtils)}),Ln={generateISD:j.generateISD,fromXML:Nn.fromXML,renderHTML:Pn.render},kn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(p),r=s(T),i=s(b),a=s(v),o=s(S);function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=(0,r.default)(e).getInstance(),a=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0,S=void 0;function A(e){var t=d[e].kind,n=void 0!==d[e].id?d[e].id:d[e].lang,r=d[e].lang,i=d[e].isTTML,a=d[e].isEmbedded;return l.addTextTrack(t,n,r,i,a)}function w(e,n){var r=l.getClientWidth(),a=l.getClientHeight(),o=l.getVideoWidth(),s=l.getVideoHeight(),u=l.getVideoRelativeOffsetTop(),d=l.getVideoRelativeOffsetLeft();if(0!==o&&0!==s){var c=o/s,f=!1;e.isFromCEA608&&(c=3.5/3,f=!0);var y=function(e,t,n,r,i,a){var o=0,s=0;e/t>n/r?o=(s=t)/r*n:s=(o=e)/n*r;var u,l,d=0,c=0;return o/s>i?(c=s,d=s*i):(d=o,c=o/i),u=(e-d)/2,l=(t-c)/2,a?{x:u+.1*d,y:l+.1*c,w:.8*d,h:.8*c}:{x:u,y:l,w:d,h:c}}.call(this,r,a,o,s,c,f),E=y.w,S=y.h,A=y.x,w=y.y;if(E!=g||S!=m||A!=h||w!=p||n){if(h=A+d,p=w+u,g=E,m=S,v){var I=v.style;I&&(I.left=h+"px",I.top=p+"px",I.width=g+"px",I.height=m+"px",I.zIndex=_&&document[_]||T?b:null,t.trigger(i.default.CAPTION_CONTAINER_RESIZE))}var C=e.activeCues;if(C)for(var R=C.length,D=0;D<R;++D){var M=C[D];M.scaleCue(M)}}}}function I(e){var t=g,n=m,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e.cellResolution){var u=[t/e.cellResolution[0],n/e.cellResolution[1]];if(e.linePadding)for(r in e.linePadding)if(e.linePadding.hasOwnProperty(r)){i=(e.linePadding[r]*u[0]).toString();for(var l=document.getElementsByClassName("spanPadding"),d=0;d<l.length;d++)l[d].style.cssText=l[d].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i),l[d].style.cssText=l[d].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.fontSize){for(r in e.fontSize)if(e.fontSize.hasOwnProperty(r)){"%"===e.fontSize[r][0]?a=e.fontSize[r][1]/100:"c"===e.fontSize[r][0]&&(a=e.fontSize[r][1]),i=(a*u[1]).toString(),s="defaultFontSize"!==r?document.getElementsByClassName(r):document.getElementsByClassName("paragraph");for(var c=0;c<s.length;c++)s[c].style.cssText=s[c].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.lineHeight)for(r in e.lineHeight)if(e.lineHeight.hasOwnProperty(r)){"%"===e.lineHeight[r][0]?o=e.lineHeight[r][1]/100:"c"===e.fontSize[r][0]&&(o=e.lineHeight[r][1]),i=(o*u[1]).toString(),s=document.getElementsByClassName(r);for(var f=0;f<s.length;f++)s[f].style.cssText=s[f].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}}}if(e.isd){var h=document.getElementById(e.cueID);h&&v.removeChild(h),C(e)}}function C(e){if(v){var n=document.createElement("div");v.appendChild(n),E=(0,Ln.renderHTML)(e.isd,n,function(t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(n.test(t)){var i=n.exec(t),a=parseInt(i[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(r.test(t)){var o=r.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[o]}return null},v.clientHeight,v.clientWidth,!1,function(e){s.info("renderCaption :",e)},E,!0),n.id=e.cueID,t.trigger(i.default.CAPTION_RENDERED,{captionDiv:n,currentTrackIdx:f})}}function R(e){return e>=0&&d[e]?l.getTextTrack(d[e].kind,d[e].id,d[e].lang,d[e].isTTML,d[e].isEmbedded):null}function D(e){var t=this;if(e!==f){var n=R(f=e);(function(e){P.call(this),e&&"html"===e.renderingType?function(){var e=document.getElementById("native-cue-style");if(e)return;(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=l.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(r){s.info(""+r.message)}}.call(this):N.call(this)}).call(this,n),y&&(clearInterval(y),y=null),n&&"html"===n.renderingType&&(w.call(this,n,!0),window.ResizeObserver?(S=new window.ResizeObserver(function(){w.call(t,n,!0)})).observe(l.getElement()):y=setInterval(w.bind(this,n),500))}}function M(e,t,n){return(isNaN(t)||e.startTime>=t)&&(isNaN(n)||e.endTime<=n)}function O(e,t,n){if(e.cues)for(var r=e.cues,i=r.length-1;i>=0;i--)M(r[i],t,n)&&e.removeCue(r[i])}function N(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function P(){if(v)for(;v.firstChild;)v.removeChild(v.firstChild)}return a={initialize:function(){"undefined"!==typeof window&&"undefined"!==typeof navigator&&(u=window.VTTCue||window.TextTrackCue,d=[],c=[],f=-1,h=0,p=0,g=0,m=0,v=null,y=null,T=!1,b=2147483647,E=null,void 0!==document.fullscreenElement?_="fullscreenElement":void 0!==document.webkitIsFullScreen?_="webkitIsFullScreen":document.msFullscreenElement?_="msFullscreenElement":document.mozFullScreen&&(_="mozFullScreen"))},setDisplayCConTop:function(e){(0,k.checkParameterType)(e,"boolean"),T=e,v&&!document[_]&&(v.style.zIndex=e?b:null)},addTextTrack:function(e,r){if(d.length!==r){if(d.push(e),d.length===r){d.sort(function(e,t){return e.index-t.index}),v=l.getTTMLRenderingDiv();for(var a=-1,o=0;o<d.length;o++){var u=A.call(this,o);c.push(u),d[o].defaultTrack&&(u.default=!0,a=o);var h=R(o);h&&(h.mode=n.default.TEXT_SHOWING,v&&(d[o].isTTML||d[o].isEmbedded)?h.renderingType="html":h.renderingType="default"),this.addCaptions(o,0,d[o].captionData),t.trigger(i.default.TEXT_TRACK_ADDED)}if(D.call(this,a),a>=0){t.on(i.default.PLAYBACK_METADATA_LOADED,function e(){var n=R(a);n&&w.call(this,n,!0),t.off(i.default.PLAYBACK_METADATA_LOADED,e,this)},this);for(var p=0;p<d.length;p++){var g=R(p);g&&(g.mode=p===a?n.default.TEXT_SHOWING:n.default.TEXT_HIDDEN)}}t.trigger(i.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:f,tracks:d})}}else s.error("Trying to add too many tracks.")},addCaptions:function(e,r,a){var o=R(e),l=this;if(o&&Array.isArray(a)&&0!==a.length)for(var d=0;d<a.length;d++){var c=void 0,y=a[d];o.cellResolution=y.cellResolution,o.isFromCEA608=y.isFromCEA608,"html"===y.type&&v?((c=new u(y.start-r,y.end-r,"")).cueHTMLElement=y.cueHTMLElement,c.isd=y.isd,c.images=y.images,c.embeddedImages=y.embeddedImages,c.cueID=y.cueID,c.scaleCue=I.bind(l),c.cellResolution=y.cellResolution,c.lineHeight=y.lineHeight,c.linePadding=y.linePadding,c.fontSize=y.fontSize,v.style.left=h+"px",v.style.top=p+"px",v.style.width=g+"px",v.style.height=m+"px",c.onenter=function(){o.mode===n.default.TEXT_SHOWING&&(this.isd?(C(this),s.debug("Cue enter id:"+this.cueID)):(v.appendChild(this.cueHTMLElement),I.call(l,this),t.trigger(i.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:f})))},c.onexit=function(){if(v)for(var e=v.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(s.debug("Cue exit id:"+e[t].id),v.removeChild(e[t]),--t)}):y.data&&(c=new u(y.start-r,y.end-r,y.data),y.styles&&(void 0!==y.styles.align&&"align"in c&&(c.align=y.styles.align),void 0!==y.styles.line&&"line"in c&&(c.line=y.styles.line),void 0!==y.styles.position&&"position"in c&&(c.position=y.styles.position),void 0!==y.styles.size&&"size"in c&&(c.size=y.styles.size)),c.onenter=function(){o.mode===n.default.TEXT_SHOWING&&t.trigger(i.default.CAPTION_RENDERED,{currentTrackIdx:f})});try{c?o.addCue(c):s.error("impossible to display subtitles.")}catch(_){throw O(o),o.addCue(c),_}}},getCurrentTrackIdx:function(){return f},setCurrentTrackIdx:D,getTrackIdxForId:function(e){for(var t=-1,n=0;n<d.length;n++)if(d[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return d[f]},setModeForTrackIdx:function(e,t){var n=R(e);n&&n.mode!==t&&(n.mode=t)},deleteCuesFromTrackIdx:function(e,t,n){var r=R(e);r&&O(r,t,n)},deleteAllTextTracks:function(){for(var e=c?c.length:0,t=0;t<e;t++){var n=R(t);n&&(O.call(this,n),n.mode="disabled")}c=[],d=[],y&&(clearInterval(y),y=null),S&&l&&(S.unobserve(l.getElement()),S=null),f=-1,P.call(this)},deleteTextTrack:function(e){l.removeChild(c[e]),c.splice(e,1)},setConfig:function(e){e&&e.videoModel&&(l=e.videoModel)}},s=(0,o.default)(e).getInstance().getLogger(a),a}u.__dashjs_factory_name="TextTracks",t.default=a.default.getSingletonFactory(u)});c(kn);var xn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n){t+=e[n].uchar}return t.length-t.replace(/^\s+/,"").length}function n(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function i(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function a(e){return e.replace(/^\s+/g,"")}function o(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(r,s,u,l){var d=null,c=!1,f=-1,h={start:s,end:u,spans:[]},p="style_cea608_white_black",g={},m={},v=[],y=void 0,_=void 0;for(y=0;y<15;++y){var T=l.rows[y],E="",b=null;if(!1===T.isEmpty()){var S=t(T.chars);null===d&&(d={x:S,y1:y,y2:y+1,p:[]}),S!==f&&c&&(d.p.push(h),h={start:s,end:u,spans:[]},d.y2=y,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===g.hasOwnProperty(d.name)?(v.push(d),g[d.name]=d):g[d.name].p.contat(d.p),d={x:S,y1:y,y2:y+1,p:[]});for(var A=0;A<T.chars.length;++A){var w=T.chars[A],I=w.penState;if(null===b||!I.equals(b)){E.trim().length>0&&(h.spans.push({name:p,line:E,row:y}),E="");var C="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(C+="_underline"),I.italics&&(C+="_italics"),m.hasOwnProperty(C)||(m[C]=JSON.parse(JSON.stringify(I))),b=I,p=C}E+=w.uchar}E.trim().length>0&&h.spans.push({name:p,line:E,row:y}),c=!0,f=S}else c=!1,f=-1,d&&(d.p.push(h),h={start:s,end:u,spans:[]},d.y2=y,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===g.hasOwnProperty(d.name)?(v.push(d),g[d.name]=d):g[d.name].p.contat(d.p),d=null)}d&&(d.p.push(h),d.y2=y+1,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===g.hasOwnProperty(d.name)?(v.push(d),g[d.name]=d):g[d.name].p.contat(d.p),d=null);var R=[];for(y=0;y<v.length;++y){var D=v[y],M="sub_cea608_"+e++,O=document.createElement("div");O.id=M;var N=n(D);O.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+N;var P=document.createElement("div");P.className="paragraph bodyStyle",P.style.cssText=i(r);var L=document.createElement("div");L.className="cueUniWrapper",L.style.cssText="unicode-bidi: normal; direction: ltr;";for(var k=0;k<D.p.length;++k){var x=D.p[k],F=0;for(_=0;_<x.spans.length;++_){var U=x.spans[_];if(U.line.length>0){if(0!==_&&F!=U.row){var B=document.createElement("br");B.className="lineBreak",L.appendChild(B)}var j=!1;F===U.row&&(j=!0),F=U.row;var G=m[U.name],q=document.createElement("span");q.className="spanPadding "+U.name+" customSpanColor",q.style.cssText=i(r,G),0!==_&&j?_===x.spans.length-1?q.textContent=o(U.line):q.textContent=U.line:x.spans.length>1&&_<x.spans.length-1&&U.row===x.spans[_+1].row?q.textContent=a(U.line):q.textContent=U.line.trim(),L.appendChild(q)}}}P.appendChild(L),O.appendChild(P);var H={bodyStyle:["%",90]};for(var V in m)m.hasOwnProperty(V)&&(H[V]=["%",90]);R.push({type:"html",start:s,end:u,cueHTMLElement:O,cueID:M,cellResolution:[32,15],isFromCEA608:!0,fontSize:H,lineHeight:{},linePadding:{}})}return R}}}i.__dashjs_factory_name="EmbeddedTextHtmlRender",t.default=r.default.getSingletonFactory(i)});c(xn);var Fn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=r});c(Fn);var Un=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Fn)&&n.__esModule?n:{default:n};var i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,e.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_CODEC_CODE=30,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="buffer is not defined",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}());t.default=i});c(Un);var Bn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=_(p),r=_(D),i=_(L),a=_(x),o=_(v),s=_(S),u=_(kn),l=_(xn),d=_(N),c=_(h),f=_(T),g=_(b),m=_(R),y=_(Un);function _(e){return e&&e.__esModule?e:{default:e}}function E(){var e=this.context,t=(0,f.default)(e).getInstance(),o=!1,h=void 0,p=void 0,v=void 0,_=void 0,T=void 0,E=void 0,b=void 0,S=void 0,A=void 0,I=void 0,C=void 0,R=void 0,D=void 0,M=void 0,O=void 0,N=void 0,P=void 0,L=void 0,k=void 0,x=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0,q=void 0;function H(){D=null,O=NaN,N=[],k=null,M=!1}function V(){H(),C=[],S=null}function K(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&X(t.bytes,t)}function Y(){F=[],(R=(0,u.default)(e).getInstance()).setConfig({videoModel:P}),R.initialize(),v=(0,i.default)(e).getInstance(),x=null,U=0,j=[],B=null,o=!0,G=(0,l.default)(e).getInstance();var n=L.getActiveStreamProcessors();for(var r in n)if("video"===n[r].getType()){q=n[r].getRepresentationInfo().MSETimeOffset;break}t.on(g.default.VIDEO_CHUNK_RECEIVED,K,this),t.on(g.default.BUFFER_CLEARED,$,this)}function W(e){x=e}function z(e,t){var i=new r.default,a={subtitle:"subtitles",caption:"captions"};i.captionData=e,i.lang=t.lang,i.labels=t.labels,i.id=t.id?t.id:t.index,i.index=t.index,i.isTTML=function(){var e=!1;return t.codec&&t.codec.search(n.default.STPP)>=0&&(e=!0),t.mimeType&&t.mimeType.search(n.default.TTML)>=0&&(e=!0),e}(),i.defaultTrack=function(e){var t=!1;F.length>1&&e.isEmbedded?t=e.id&&e.id===n.default.CC1:1===F.length?e.id&&"string"===typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===F.length&&(t=e.index===C[0].index);return t}(t),i.isFragmented=!T.getIsTextTrack(t.mimeType),i.isEmbedded=!!t.isEmbedded,i.kind=function(){var e=t.roles.length>0?a[t.roles[0]]:a.caption;return e=e===a.caption||e===a.subtitle?e:a.caption}(),i.roles=t.roles,i.accessibility=t.accessibility;var o=(C?C.length:0)+F.length;R.addTextTrack(i,o)}function X(e,t){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,f=t.mediaInfo,h=f.type,g=f.mimeType,T=f.codec||g;if(T){if(h===n.default.FRAGMENTED_TEXT)if(M||"InitializationSegment"!==t.segmentType){if(!M)return;if(i=(u=v.getSamplesInfo(e)).sampleList,null===k&&i.length>0&&(k=i[0].cts-t.start*O),T.search(n.default.STPP)>=0)for(S=null!==S?S:Q(T),a=0;a<i.length;a++){var b=i[a],A=b.cts,I=A-k;this.buffered.add(I/O,(I+b.duration)/O);var C=new DataView(e,b.offset,b.subSizes[0]);l=d.default.Utils.dataViewToString(C,n.default.UTF8);var N=[],L=b.offset+b.subSizes[0];for(o=1;o<b.subSizes.length;o++){var H=new Uint8Array(e,L,b.subSizes[o]),V=String.fromCharCode.apply(null,H);N.push(V),L+=b.subSizes[o]}try{var K=E.getValue().ttmlTimeIsRelative?A/O:0;r=S.parse(l,K,A/O,(A+b.duration)/O,N),R.addCaptions(x,k/O,r)}catch(fe){D.removeExecutedRequestsBeforeTime(),this.remove(),p.error("TTML parser error: "+fe.message)}}else{var Y=[];for(a=0;a<i.length;a++){var W=i[a];W.cts-=k,this.buffered.add(W.cts/O,(W.cts+W.duration)/O);var X=e.slice(W.offset,W.offset+W.size),$=d.default.parseBuffer(X);for(o=0;o<$.boxes.length;o++){var Z=$.boxes[o];if(p.debug("VTT box1: "+Z.type),"vtte"!==Z.type&&"vttc"===Z.type)for(p.debug("VTT vttc boxes.length = "+Z.boxes.length),s=0;s<Z.boxes.length;s++){var J=Z.boxes[s];if(p.debug("VTT box2: "+J.type),"payl"===J.type){var ee=J.cue_text;p.debug("VTT cue_text = "+ee);var te=W.cts/O,ne=(W.cts+W.duration)/O;Y.push({start:te,end:ne,data:ee,styles:{}}),p.debug("VTT "+te+"-"+ne+" : "+ee)}}}}Y.length>0&&R.addCaptions(x,0,Y)}}else M=!0,O=v.getMediaTimescaleFromMoov(e);else if(h===n.default.TEXT){var re=new DataView(e,0,e.byteLength);l=d.default.Utils.dataViewToString(re,n.default.UTF8);try{r=Q(T).parse(l,0),R.addCaptions(R.getCurrentTrackIdx(),0,r)}catch(fe){_.error(new m.default(y.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,y.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+fe.message,l))}}else if(h===n.default.VIDEO)if(t.segmentType===w.HTTPRequest.INIT_SEGMENT_TYPE){if(0===U)for(U=v.getMediaTimescaleFromMoov(e),a=0;a<F.length;a++)z(null,F[a])}else{if(0===U)return void p.warn("CEA-608: No timescale for embeddedTextTrack yet");var ie=function(e,t){return function(e,n,r){var i=null;i=P.getTTMLRenderingDiv()?G.createHTMLCaptionsFromScreen(P.getElement(),e,n,r):[{start:e,end:n,data:r.getDisplayText(),styles:{}}],i&&R.addCaptions(t,0,i)}},ae=(u=v.getSamplesInfo(e)).lastSequenceNumber;if(!j[0]&&!j[1]){var oe=void 0,se=void 0;for(a=0;a<F.length;a++){if(F[a].id===n.default.CC1?se=R.getTrackIdxForId(n.default.CC1):F[a].id===n.default.CC3&&(se=R.getTrackIdxForId(n.default.CC3)),-1===se)return void p.warn("CEA-608: data before track is ready.");oe=ie(0,se),j[a]=new c.default.Cea608Parser(a+1,{newCue:oe},null)}}if(U){if(null!==B&&ae!==B+u.numSequences)for(a=0;a<j.length;a++)j[a]&&j[a].reset();for(var ue=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),i=0;i<t.length;i++)for(var a=t[i],o=c.default.findCea608Nalus(r,a.offset,a.size),s=null,u=0,l=0;l<o.length;l++)for(var d=c.default.extractCea608DataFromRange(r,o[l]),f=0;f<2;f++)d[f].length>0&&(a.cts!==s?u=0:u+=1,n.fields[f].push([a.cts+q*U,d[f],u]),s=a.cts);return n.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]})}),n}(e,u.sampleList),le=0;le<j.length;le++){var de=ue.fields[le],ce=j[le];if(ce)for(a=0;a<de.length;a++)ce.addData(de[a][0]/U,de[a][1])}B=ae}}}else p.error("No text type defined")}function Q(e){var t=void 0;return e.search(n.default.VTT)>=0?t=A:(e.search(n.default.TTML)>=0||e.search(n.default.STPP)>=0)&&(t=I),t}function $(e){F.forEach(function(t){var n=R.getTrackIdxForId(t.id);n>=0&&R.deleteCuesFromTrackIdx(n,e.from,e.to)})}return h={initialize:function(t,r,s,u){o||Y(),R.setConfig({videoModel:P}),R.initialize(),v||(v=(0,i.default)(e).getInstance()),function(t,r,i,o){var s=!T.getIsTextTrack(t);if(C=C.concat(i),s){D=o,h.buffered=(0,a.default)(e).create(),N=b.getTracksFor(n.default.FRAGMENTED_TEXT,r);for(var u=b.getCurrentTrackFor(n.default.FRAGMENTED_TEXT,r),l=0;l<N.length;l++)if(N[l]===u){W(l);break}}for(var d=0;d<C.length;d++)z(null,C[d])}(t,r,s,u)},append:X,abort:function(){R.deleteAllTextTracks(),H(),v=null,C=[]},addEmbeddedTrack:function(e){if(o||Y(),e)if(e.id===n.default.CC1||e.id===n.default.CC3){for(var t=0;t<F.length;t++)if(F[t].id===e.id)return;F.push(e)}else p.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){t.off(g.default.VIDEO_CHUNK_RECEIVED,K,this),t.off(g.default.BUFFER_CLEARED,$,this),R&&R.deleteAllTextTracks(),o=!1,F=[],j=[null,null],B=null},setConfig:function(e){e&&(e.errHandler&&(_=e.errHandler),e.adapter&&(T=e.adapter),e.manifestModel&&(E=e.manifestModel),e.mediaController&&(b=e.mediaController),e.videoModel&&(P=e.videoModel),e.streamController&&(L=e.streamController),e.textTracks&&(R=e.textTracks),e.vttParser&&(A=e.vttParser),e.ttmlParser&&(I=e.ttmlParser))},getConfig:function(){return{fragmentModel:D,fragmentedTracks:N,videoModel:P}},setCurrentFragmentedTrackIdx:W,remove:function(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t)},reset:function(){V(),L=null,P=null,R=null}},p=(0,s.default)(e).getInstance().getLogger(h),V(),h}E.__dashjs_factory_name="TextSourceBuffer",t.default=o.default.getSingletonFactory(E)});c(Bn);var jn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(S);function i(e){return e&&e.__esModule?e:{default:e}}var a="WEBVTT";function o(){var e=this.context,t=void 0,n=void 0,i=void 0,o=void 0,s=void 0,u=void 0;function l(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function d(e){var t=e.split(o),n=t[1].split(u);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:c(n)}}function c(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&-1!=n.search(/%/)&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}}),t}function f(e,t){for(var n,r=t,i="",a="";""!==e[r]&&r<e.length;)r++;if((n=r-t)>1)for(var s=0;s<n;s++){if((a=e[t+s]).match(o)){i="";break}i+=a,s!==n-1&&(i+="\n")}else(a=e[t]).match(o)||(i=a);return i}return t={parse:function(e){var t,r=[],u=void 0;if(!e)return r;t=(e=e.split(i)).length,u=-1;for(var c=0;c<t;c++){var h=e[c];if(h.length>0&&h!==a&&h.match(o)){var p=d(h),g=p.cuePoints,m=p.styles,v=f(e,c+1),y=l(g[0].replace(s,"")),_=l(g[1].replace(s,""));!isNaN(y)&&!isNaN(_)&&y>=u&&_>y?""!==v?(u=y,r.push({start:y,end:_,data:v,styles:m})):n.error("Skipping cue due to empty/malformed cue text"):n.error("Skipping cue due to incorrect cue timing")}}return r}},n=(0,r.default)(e).getInstance().getLogger(t),i=/(?:\r\n|\r|\n)/gm,o=/-->/,s=/(^[\s]+|[\s]+$)/g,u=/\s\b/g,t}o.__dashjs_factory_name="VTTParser",t.default=n.default.getSingletonFactory(o)});c(jn);var Gn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(v),r=o(S),i=o(T),a=o(b);function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,i.default)(e).getInstance(),n=void 0,o=void 0,s=0;function u(){var e="cue_TTML_"+s;return s++,e}return n={parse:function(e,n,r,i,s){var l="",d=[],c=void 0,f=void 0,h=void 0,p={},g={},m="",v="",y={onOpenTag:function(e,t,n){if(n[" imagetype"]&&!n[" imageType"]&&(n[" imageType"]=n[" imagetype"]),"image"===t&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===e)){if(!n[" imageType"]||"PNG"!==n[" imageType"].value)return void o.warn("smpte-tt imageType != PNG. Discarded");m=n["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){m&&(g[m]=v.trim()),v="",m=""},onText:function(e){m&&(v+=e)}};if(!e)throw l="no ttml data to parse",new Error(l);p.data=e,t.trigger(a.default.TTML_TO_PARSE,p);var _=(0,Ln.fromXML)(p.data,function(e){l=e},y);t.trigger(a.default.TTML_PARSED,{ttmlString:p.data,ttmlDoc:_});var T=_.getMediaTimeEvents();for(h=0;h<T.length;h++){var E=(0,Ln.generateISD)(_,T[h],function(e){l=e});E.contents.some(function(e){return e.contents.length})&&(c=T[h]+n<r?r:T[h]+n)<(f=T[h+1]+n>i?i:T[h+1]+n)&&d.push({start:c,end:f,type:"html",cueID:u(),isd:E,images:s,embeddedImages:g})}if(""!==l)throw o.error(l),new Error(l);return d}},o=(0,r.default)(e).getInstance().getLogger(n),n}s.__dashjs_factory_name="TTMLParser",t.default=n.default.getSingletonFactory(s)});c(Gn);var qn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=d(p),r=d(v),i=d(Bn),a=d(kn),o=d(jn),s=d(Gn),u=d(T),l=d(b);function d(e){return e&&e.__esModule?e:{default:e}}function c(){var e=this.context,t=void 0,r=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0,S=void 0,A=void 0,w=void 0,I=void 0,C=void 0,R=void 0;function D(e){void 0===R&&null!==e.fromStreamInfo&&(R=this.getCurrentTrackIdx())}function M(){void 0===R&&(R=this.getCurrentTrackIdx())}function O(){void 0!==R&&(this.setTextTrack(R),R=void 0)}function N(e){var t=this,n=e.tracks,r=e.index;T&&n.some(function(e,n){if(h.matchSettings(T,e))return t.setTextTrack(n),r=n,!0}),(!1===S||void 0===S&&!T||C)&&this.setTextTrack(-1),b=r,_.trigger(l.default.TEXT_TRACKS_ADDED,{enabled:L(),index:r,tracks:n}),I=!0}function P(e){if(!E&&e&&e.newMediaInfo){var t=e.newMediaInfo;t.type===n.default.FRAGMENTED_TEXT&&(T={lang:t.lang,role:t.roles[0],accessibility:t.accessibility[0]})}}function L(){var e=!0;return A&&!w&&(e=!1),e}function x(){A=!0,I=!1,C=!1}return t={setConfig:function(e){e&&(e.errHandler&&(d=e.errHandler),e.adapter&&(c=e.adapter),e.manifestModel&&(f=e.manifestModel),e.mediaController&&(h=e.mediaController),e.videoModel&&(p=e.videoModel),e.streamController&&(g=e.streamController),e.textTracks&&(m=e.textTracks),e.vttParser&&(v=e.vttParser),e.ttmlParser&&(y=e.ttmlParser),r.setConfig({errHandler:d,adapter:c,manifestModel:f,mediaController:h,videoModel:p,streamController:g,textTracks:m,vttParser:v,ttmlParser:y}))},getTextSourceBuffer:function(){return r},getAllTracksAreDisabled:function(){return A},addEmbeddedTrack:function(e){r.addEmbeddedTrack(e)},getTextDefaultLanguage:function(){return T&&T.lang||""},setTextDefaultLanguage:function(e){(0,k.checkParameterType)(e,"string"),T||(T={}),T.lang=e,E=!0},setTextDefaultEnabled:function(e){(0,k.checkParameterType)(e,"boolean"),(S=e)?A=!1:this.setTextTrack(-1)},getTextDefaultEnabled:function(){return void 0!==S&&S},setInitialSettings:function(e){T=e,E=!0},enableText:function(e){(0,k.checkParameterType)(e,"boolean"),!S&&e&&(S=!0),L()!==e&&(e&&this.setTextTrack(b),e||(b=this.getCurrentTrackIdx(),I?this.setTextTrack(-1):C=!0))},isTextEnabled:L,setTextTrack:function(e){var t=r.getConfig(),i=t.fragmentModel,a=t.fragmentedTracks,o=t.videoModel,s=void 0,u=void 0;A=-1===e;var l=m.getCurrentTrackIdx();if(l!==e){A&&h&&h.saveTextSettingsDisabled(),m.setModeForTrackIdx(l,n.default.TEXT_HIDDEN),m.setCurrentTrackIdx(e),m.setModeForTrackIdx(e,n.default.TEXT_SHOWING);var d=m.getCurrentTrackInfo();if(d&&d.isFragmented&&!d.isEmbedded)for(var c=0;c<a.length;c++){var f=a[c];if(d.lang===f.lang&&d.index===f.index&&(f.id?d.id===f.id:d.id===f.index))if(f!==h.getCurrentTrackFor(n.default.FRAGMENTED_TEXT,g.getActiveStreamInfo()))i.abortRequests(),i.removeExecutedRequestsBeforeTime(),r.remove(),m.deleteCuesFromTrackIdx(l),h.setTrack(f),r.setCurrentFragmentedTrackIdx(c);else if(-1===l){for(var p=g.getActiveStreamProcessors(),v=0;v<p.length;v++)if(p[v].getType()===n.default.FRAGMENTED_TEXT){u=p[v];break}u.setBufferingTime(o.getTime()),u.getScheduleController().start()}}else if(d&&!d.isFragmented){for(var y=g.getActiveStreamProcessors(),_=0;_<y.length;_++)if(y[_].getType()===n.default.TEXT){s=(u=y[_]).getMediaInfoArr();break}if(u&&s)for(var T=0;T<s.length;T++)if(s[T].index===d.index&&s[T].lang===d.lang){u.selectMediaInfo(s[T]);break}}}},getCurrentTrackIdx:function(){return m.getCurrentTrackIdx()},enableForcedTextStreaming:function(e){(0,k.checkParameterType)(e,"boolean"),w=e},reset:function(){x(),r.resetEmbedded(),r.reset()}},T=null,b=-1,w=!1,I=!1,E=!1,C=!1,m=(0,a.default)(e).getInstance(),v=(0,o.default)(e).getInstance(),y=(0,s.default)(e).getInstance(),r=(0,i.default)(e).getInstance(),_=(0,u.default)(e).getInstance(),m.initialize(),_.on(l.default.TEXT_TRACKS_QUEUE_INITIALIZED,N,t),_.on(l.default.CURRENT_TRACK_CHANGED,P,t),_.on(l.default.PERIOD_SWITCH_STARTED,D,t),_.on(l.default.STREAM_COMPLETED,M,t),_.on(l.default.PERIOD_SWITCH_COMPLETED,O,t),x(),t}c.__dashjs_factory_name="TextController",t.default=r.default.getSingletonFactory(c)});c(qn);var Hn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(S),r=l(R),i=l(T),a=l(b),o=l(v),s=l(qn),u=l(Un);function l(e){return e&&e.__esModule?e:{default:e}}var d=.1;function c(e,t,o,l){var c=this.context,f=(0,i.default)(c).getInstance(),h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=[],T=[],E=o;function b(){try{return m.buffered}catch(e){return g.error("getAllBufferRanges exception: "+e.message),null}}function S(t){m&&R(function(){try{var n=e.duration,r=0;t&&!isNaN(t.start)&&!isNaN(t.duration)&&isFinite(t.duration)&&(n=t.start+t.duration),t&&!isNaN(t.start)&&(r=t.start),m.appendWindowStart=0,m.appendWindowEnd=n,m.appendWindowStart=r,g.debug("Updated append window. Set start to "+m.appendWindowStart+" and end to "+m.appendWindowEnd)}catch(i){g.warn("Failed to set append window")}})}function A(){if(_.length>0){var e=_.shift();m.updating?R(e):(e(),A())}}function w(){m.updating||A()}function I(){m.updating||A()}function C(){g.error("SourceBufferSink error")}function R(e){_.push(e),m.updating||A()}return h={getType:function(){return p},getAllBufferRanges:b,getBuffer:function(){return m},append:function(e){e?(T.push(e),v||R(function e(){var t=this;if(T.length>0){v=!0;var n=T[0];T.splice(0,1);var i=[],o=function(){var r=b();!function(e,t,n,r){t&&t.length>0&&t.length<n.length&&function(e,t){for(var n=0;n<e.length;n++){var r=Math.round(e.start(n)),i=Math.round(e.end(n));if(i===t.start||r===t.end||t.start>=r&&t.end<=i)return!0}return!1}(t,r)&&f.trigger(a.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:n.end(n.length-2),to:n.start(n.length-1),unintended:!0})}(t,i,r,n),T.length>0?e.call(this):(v=!1,E&&E({chunk:n}))};try{0===n.bytes.length?o.call(this):(i=b(),m.appendBuffer?m.appendBuffer(n.bytes):m.append(n.bytes,n),R(o.bind(this)))}catch(s){g.fatal('SourceBuffer append failed "'+s+'"'),T.length>0?e():v=!1,E&&E({chunk:n,error:new r.default(s.code,s.message)})}}}.bind(this))):E({chunk:e,error:new r.default(u.default.APPEND_ERROR_CODE,u.default.APPEND_ERROR_MESSAGE)})},remove:function(t,n,i){var o=this;R(function(){try{t>=0&&n>t&&(i||"ended"!==e.readyState)&&m.remove(t,n),R(function(){f.trigger(a.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:o,from:t,to:n,unintended:!1})})}catch(s){f.trigger(a.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:o,from:t,to:n,unintended:!1,error:new r.default(s.code,s.message)})}})},abort:function(){try{"open"===e.readyState?m.abort():m.setTextTrack&&"ended"===e.readyState&&m.abort()}catch(t){g.error('SourceBuffer append abort failed: "'+t+'"')}T=[]},reset:function(t){if(m){if("function"===typeof m.removeEventListener&&(m.removeEventListener("updateend",I,!1),m.removeEventListener("error",C,!1),m.removeEventListener("abort",C,!1)),clearInterval(y),_=[],!t){try{m.getClassName&&"TextSourceBuffer"===m.getClassName()||(g.debug("Removing sourcebuffer from media source"),e.removeSourceBuffer(m))}catch(n){g.error("Failed to remove source buffer from media source.")}m=null}v=!1}T=[],E=null},updateTimestampOffset:function(e){m.timestampOffset===e||isNaN(e)||R(function(){e<0&&(e+=.001),m.timestampOffset=e})},hasDiscontinuitiesAfter:function(e){try{var t=b();if(t&&t.length>1)for(var n=0,r=t.length;n<r;n++)if(n>0&&e<t.start(n)&&t.start(n)>t.end(n-1)+d)return!0}catch(i){g.error("hasDiscontinuities exception: "+i.message)}return!1},waitForUpdateEnd:R,updateAppendWindow:S},function(){g=(0,n.default)(c).getInstance().getLogger(h),v=!1,p=t.type;var r=t.codec;try{if(r.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");if((m=l||e.addSourceBuffer(r)).changeType&&l&&(g.debug("Doing period transition with changeType"),m.changeType(r)),S(),"function"===typeof m.addEventListener)try{m.addEventListener("updateend",I,!1),m.addEventListener("error",C,!1),m.addEventListener("abort",C,!1)}catch(a){y=setInterval(w,50)}else y=setInterval(w,50)}catch(o){if(!t.isText&&-1===r.indexOf('codecs="stpp')&&-1===r.indexOf('codecs="wvtt'))throw o;var i=(0,s.default)(c).getInstance();m=i.getTextSourceBuffer()}}(),h}c.__dashjs_factory_name="SourceBufferSink";var f=o.default.getClassFactory(c);t.default=f});c(Hn);var Vn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(S),r=i(v);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=this.context,r=void 0,i=void 0,a=void 0,o=[],s=e;function u(e,t){o=o.filter(function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))})}return r={getAllBufferRanges:function(){for(var e=[],t=0;t<o.length;t++){var n=o[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var r={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(r,"length",{get:function(){return e.length}}),r},append:function(e){"InitializationSegment"!==e.segmentType?(o.push(e),o.sort(function(e,t){return e.start-t.start}),a=null):a=e,i.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),s&&s({chunk:e})},remove:u,abort:function(){},discharge:function(e,t){var n=function(e,t){return o.filter(function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)})}(e,t);return a&&(n.push(a),a=null),u(e,t),n},reset:function(){o=[],a=null,s=null},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return!1},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},i=(0,n.default)(t).getInstance().getLogger(r),r}a.__dashjs_factory_name="PreBufferSink";var o=r.default.getClassFactory(a);t.default=o});c(Vn);var Kn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};var i=-1,a={DEFAULT:.5,STRONG:1,WEAK:0};function o(e,t,n){return{quality:void 0===e?i:e,reason:void 0===t?null:t,priority:function(e){var t=a.DEFAULT;return e!==a.DEFAULT&&e!==a.STRONG&&e!==a.WEAK||(t=e),t}(n)}}o.__dashjs_factory_name="SwitchRequest";var s=r.default.getClassFactory(o);s.NO_CHANGE=i,s.PRIORITY=a,r.default.updateClassFactory(o.__dashjs_factory_name,s),t.default=s});c(Kn);var Yn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(v),r=s(S),i=s(Kn),a=s(p),o=s(m);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t=this.context,n=e.dashMetrics,s=void 0,u=void 0;return s={getMaxIndex:function(e){var r=(0,i.default)(t).create();if(!e||!e.hasOwnProperty("getMediaInfo")||!e.hasOwnProperty("getMediaType")||!e.hasOwnProperty("useBufferOccupancyABR")||!e.hasOwnProperty("getAbrController")||!e.hasOwnProperty("getScheduleController"))return r;!function(){if(!n||!n.hasOwnProperty("getCurrentBufferState"))throw new Error(a.default.MISSING_CONFIG_ERROR)}();var s=e.getMediaInfo(),l=e.getMediaType(),d=n.getCurrentBufferState(l),c=e.getScheduleController(),f=e.getAbrController(),h=e.getStreamInfo(),p=h&&h.manifestInfo?h.manifestInfo.isDynamic:null,g=f.getThroughputHistory(),m=g.getSafeAverageThroughput(l,p),v=g.getAverageLatency(l),y=e.useBufferOccupancyABR();return isNaN(m)||!d||y?r:(f.getAbandonmentStateFor(l)!==o.default.ABANDON_LOAD&&(d.state===o.default.BUFFER_LOADED||p)&&(r.quality=f.getQualityForBitrate(s,m,v),c.setTimeToLoadDelay(0),u.debug("["+l+"] requesting switch to index: ",r.quality,"Average throughput",Math.round(m),"kbps"),r.reason={throughput:m,latency:v}),r)},reset:function(){}},u=(0,r.default)(t).getInstance().getLogger(s),s}u.__dashjs_factory_name="ThroughputRule",t.default=n.default.getClassFactory(u)});c(Yn);var Wn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(T),r=l(b),i=l(v),a=l(S),o=l(Kn),s=l(p),u=l(m);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=.5,i=2,l=this.context,d=(0,n.default)(l).getInstance(),c=e.dashMetrics,f=void 0,h=void 0,p=void 0;function g(){(p={})[s.default.VIDEO]={ignoreCount:i},p[s.default.AUDIO]={ignoreCount:i}}function m(){g()}function v(e){isNaN(e.startTime)||e.mediaType!==s.default.AUDIO&&e.mediaType!==s.default.VIDEO||p[e.mediaType].ignoreCount>0&&p[e.mediaType].ignoreCount--}return f={getMaxIndex:function(e){var n=(0,o.default)(l).create();if(!e||!e.hasOwnProperty("getMediaType"))return n;!function(){if(!c||!c.hasOwnProperty("getCurrentBufferLevel")||!c.hasOwnProperty("getCurrentBufferState"))throw new Error(s.default.MISSING_CONFIG_ERROR)}();var r=e.getMediaType(),i=c.getCurrentBufferState(r),a=e.getRepresentationInfo().fragmentDuration;if(function(e){return p[e].ignoreCount>0}(r)||!a)return n;if(i&&i.state===u.default.BUFFER_EMPTY)h.debug("["+r+"] Switch to index 0; buffer is empty."),n.quality=0,n.reason="InsufficientBufferRule: Buffer is empty";else{var d=e.getMediaInfo(),f=e.getAbrController(),g=f.getThroughputHistory(),m=c.getCurrentBufferLevel(r),v=g.getAverageThroughput(r),y=g.getAverageLatency(r),_=v*(m/a)*t;n.quality=f.getQualityForBitrate(d,_,y),n.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return n},reset:function(){g(),d.off(r.default.PLAYBACK_SEEKING,m,f),d.off(r.default.BYTES_APPENDED_END_FRAGMENT,v,f)}},h=(0,a.default)(l).getInstance().getLogger(f),g(),d.on(r.default.PLAYBACK_SEEKING,m,f),d.on(r.default.BYTES_APPENDED_END_FRAGMENT,v,f),f}d.__dashjs_factory_name="InsufficientBufferRule",t.default=i.default.getClassFactory(d)});c(Wn);var zn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(Kn),r=a(v),i=a(S);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=1.8,r=500,a=5,s=this.context,u=e.mediaPlayerModel,l=e.dashMetrics,d=e.settings,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0;function m(){h={},p={},g=[]}return c={shouldAbandon:function(e){var i=(0,n.default)(s).create(n.default.NO_CHANGE,{name:o.__dashjs_factory_name});if(!e||!e.hasOwnProperty("getMediaInfo")||!e.hasOwnProperty("getMediaType")||!e.hasOwnProperty("getCurrentRequest")||!e.hasOwnProperty("getRepresentationInfo")||!e.hasOwnProperty("getAbrController"))return i;var c,m,v=e.getMediaInfo(),y=e.getMediaType(),_=e.getCurrentRequest();if(!isNaN(_.index)){c=y,m=_.index,h[c]=h[c]||{},h[c][m]=h[c][m]||{};var T=u.getStableBufferTime();if(l.getCurrentBufferLevel(y)>T)return i;var E=h[y][_.index];if(null===E||null===_.firstByteDate||p.hasOwnProperty(E.id))return i;if(void 0===E.firstByteTime&&(g[y]=[],E.firstByteTime=_.firstByteDate.getTime(),E.segmentDuration=_.duration,E.bytesTotal=_.bytesTotal,E.id=_.index),E.bytesLoaded=_.bytesLoaded,E.elapsedTime=(new Date).getTime()-E.firstByteTime,E.bytesLoaded>0&&E.elapsedTime>0&&function(e,t){g[e]=g[e]||[],g[e].push(t)}(y,Math.round(8*E.bytesLoaded/E.elapsedTime)),g[y].length>=a&&E.elapsedTime>r&&E.bytesLoaded<E.bytesTotal){var b=g[y].reduce(function(e,t){return e+t},0);if(E.measuredBandwidthInKbps=Math.round(b/g[y].length),E.estimatedTimeOfDownload=+(8*E.bytesTotal/E.measuredBandwidthInKbps/1e3).toFixed(2),E.estimatedTimeOfDownload<E.segmentDuration*t||0===e.getRepresentationInfo().quality)return i;if(!p.hasOwnProperty(E.id)){var S=e.getAbrController(),A=E.bytesTotal-E.bytesLoaded,w=S.getBitrateList(v),I=S.getQualityForBitrate(v,E.measuredBandwidthInKbps*d.get().streaming.abr.bandwidthSafetyFactor),C=S.getMinAllowedIndexFor(y),R=void 0!==C?Math.max(C,I):I;A>E.bytesTotal*w[R].bitrate/w[S.getQualityFor(y)].bitrate&&(i.quality=R,i.reason.throughput=E.measuredBandwidthInKbps,i.reason.fragmentID=E.id,p[E.id]=E,f.debug("["+y+"] frag id",E.id," is asking to abandon and switch to quality to ",R," measured bandwidth was",E.measuredBandwidthInKbps),delete h[y][E.id])}}else E.bytesLoaded===E.bytesTotal&&delete h[y][E.id]}return i},reset:m},f=(0,i.default)(s).getInstance().getLogger(c),m(),c}o.__dashjs_factory_name="AbandonRequestsRule",t.default=r.default.getClassFactory(o)});c(zn);var Xn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(v),r=a(Kn),i=a(S);function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.context,t=void 0,n=void 0,a=.15,o=375;return t={getMaxIndex:function(t){var i=(0,r.default)(e).create();if(!t||!t.hasOwnProperty("getDroppedFramesHistory"))return i;var s=t.getDroppedFramesHistory();if(s){for(var u=s.getFrameHistory(),l=0,d=0,c=r.default.NO_CHANGE,f=1;f<u.length;f++)if(u[f]&&(l=u[f].droppedVideoFrames,(d=u[f].totalVideoFrames)>o&&l/d>a)){c=f-1,n.debug("index: "+c+" Dropped Frames: "+l+" Total Frames: "+d);break}return(0,r.default)(e).create(c,{droppedFrames:l})}return i}},n=(0,i.default)(e).getInstance().getLogger(t),t}o.__dashjs_factory_name="DroppedFramesRule",t.default=n.default.getClassFactory(o)});c(Xn);var Qn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(v),r=a(S),i=a(Kn);function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.context,t=void 0,n=void 0,a=.075,o=6;return t={getMaxIndex:function(t){for(var r=t?t.getSwitchHistory():null,s=r?r.getSwitchRequests():[],u=0,l=0,d=0,c=(0,i.default)(e).create(),f=0;f<s.length;f++)if(void 0!==s[f]&&(u+=s[f].drops,l+=s[f].noDrops,d+=s[f].dropSize,u+l>=o&&u/l>a)){c.quality=f>0&&s[f].drops>0?f-1:f,c.reason={index:c.quality,drops:u,noDrops:l,dropSize:d},n.debug("Switch history rule index: "+c.quality+" samples: "+(u+l)+" drops: "+u);break}return c}},n=(0,r.default)(e).getInstance().getLogger(t),t}o.__dashjs_factory_name="SwitchHistoryRule",t.default=n.default.getClassFactory(o)});c(Qn);var $n=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=u(m),r=u(Kn),i=u(v),a=u(T),o=u(b),s=u(S);function u(e){return e&&e.__esModule?e:{default:e}}var l=0,d=1,c=2,f=10,h=2,p=.99;function g(e){e=e||{};var t=this.context,i=e.dashMetrics,u=e.mediaPlayerModel,g=(0,a.default)(t).getInstance(),m=void 0,v=void 0,y=void 0;function _(e,t,n){var r=n.reduce(function(e,t,r){return t>n[e]?r:e},0);if(0===r)return null;var i=Math.max(e,f+h*t.length),a=(n[r]-1)/(i/f-1);return{gp:a,Vp:f/a}}function T(e){var t={},n=e.getMediaInfo().bitrateList.map(function(e){return e.bandwidth}),r=function(e){return e.map(function(e){return Math.log(e)})}(n);r=r.map(function(e){return e-r[0]+1});var i=u.getStableBufferTime(),a=_(i,n,r);return a?(t.state=d,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,E(t)):t.state=l,t}function E(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function b(e,t){var n=u.getStableBufferTime();if(e.stableBufferTime!==n){var r=_(n,e.bitrates,e.utilities);if(r.Vp!==e.Vp||r.gp!==e.gp){var a=i.getCurrentBufferLevel(t),o=a+e.placeholderBuffer;o-=f,o*=r.Vp/e.Vp,o+=f,e.stableBufferTime=n,e.Vp=r.Vp,e.gp=r.gp,e.placeholderBuffer=Math.max(0,o-a)}}}function S(e,t){return e.Vp*(e.utilities[t]+e.gp)}function A(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],u=e.Vp*(e.gp+(n*s-o*r)/(n-o));i=Math.max(i,u)}return i}function I(){for(var e in y)y.hasOwnProperty(e)&&y[e].state===c&&(y[e].placeholderBuffer=0)}function C(){for(var e in y)if(y.hasOwnProperty(e)){var t=y[e];t.state!==l&&(t.state=d,E(t))}}function R(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=y[e.chunk.mediaInfo.type];if(t&&t.state!==l){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,M(t,e.chunk.mediaInfo.type)}}}function D(e){if(e&&e.metric===n.default.HTTP_REQUEST&&e.value&&e.value.type===w.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=y[e.mediaType];t&&t.state!==l&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),M(t,e.mediaType))}}function M(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=p,!isNaN(e.lastSegmentFinishTimeMs)){var n=i.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),r=S(e,e.lastQuality),a=Math.max(0,r-n);e.placeholderBuffer=Math.min(a,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function O(e){if(e){var t=y[e.mediaType];t&&t.state!==l&&(t.abrQuality=e.newQuality)}}function N(e){if(e){var t=y[e.mediaType];if(t&&t.state!==l){var n=i.getCurrentBufferLevel(e.mediaType),r=void 0;r=t.abrQuality>0?A(t,t.abrQuality):f;var a=Math.max(0,r-n);t.placeholderBuffer=Math.min(t.placeholderBuffer,a)}}}function P(){y={}}return m={getMaxIndex:function(e){var n=(0,r.default)(t).create();if(!e||!e.hasOwnProperty("getMediaInfo")||!e.hasOwnProperty("getMediaType")||!e.hasOwnProperty("getScheduleController")||!e.hasOwnProperty("getStreamInfo")||!e.hasOwnProperty("getAbrController")||!e.hasOwnProperty("useBufferOccupancyABR"))return n;var a=e.getMediaInfo(),o=e.getMediaType(),s=e.getScheduleController(),u=e.getStreamInfo(),f=e.getAbrController(),h=f.getThroughputHistory(),p=u?u.id:null,g=u&&u.manifestInfo&&u.manifestInfo.isDynamic,m=e.useBufferOccupancyABR();if(n.reason=n.reason||{},!m)return n;s.setTimeToLoadDelay(0);var _=function(e){var t=e.getMediaType(),n=y[t];return n?n.state!==l&&b(n,t):(n=T(e),y[t]=n),n}(e);if(_.state===l)return n;var w=i.getCurrentBufferLevel(o),I=h.getAverageThroughput(o,g),C=h.getSafeAverageThroughput(o,g),R=h.getAverageLatency(o),D=void 0;if(n.reason.state=_.state,n.reason.throughput=I,n.reason.latency=R,isNaN(I))return n;switch(_.state){case d:D=f.getQualityForBitrate(a,C,R),n.quality=D,n.reason.throughput=C,_.placeholderBuffer=Math.max(0,A(_,D)-w),_.lastQuality=D,!isNaN(_.lastSegmentDurationS)&&w>=_.lastSegmentDurationS&&(_.state=c);break;case c:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r)}}else{var i=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,b(e,t)}(_,o),D=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,r=a)}return r}(_,w+_.placeholderBuffer);var M=f.getQualityForBitrate(a,C,R);D>_.lastQuality&&D>M&&(D=Math.max(M,_.lastQuality));var O=Math.max(0,w+_.placeholderBuffer-S(_,D));O<=_.placeholderBuffer?(_.placeholderBuffer-=O,O=0):(O-=_.placeholderBuffer,_.placeholderBuffer=0,D<f.getTopQualityIndexFor(o,p)?s.setTimeToLoadDelay(1e3*O):O=0),n.quality=D,n.reason.throughput=I,n.reason.latency=R,n.reason.bufferLevel=w,n.reason.placeholderBuffer=_.placeholderBuffer,n.reason.delay=O,_.lastQuality=D;break;default:v.debug("BOLA ABR rule invoked in bad state."),n.quality=f.getQualityForBitrate(a,C,R),n.reason.state=_.state,n.reason.throughput=C,n.reason.latency=R,_.state=d,E(_)}return n},reset:function(){P(),g.off(o.default.BUFFER_EMPTY,I,m),g.off(o.default.PLAYBACK_SEEKING,C,m),g.off(o.default.MEDIA_FRAGMENT_LOADED,R,m),g.off(o.default.METRIC_ADDED,D,m),g.off(o.default.QUALITY_CHANGE_REQUESTED,O,m),g.off(o.default.FRAGMENT_LOADING_ABANDONED,N,m)}},v=(0,s.default)(t).getInstance().getLogger(m),P(),g.on(o.default.BUFFER_EMPTY,I,m),g.on(o.default.PLAYBACK_SEEKING,C,m),g.on(o.default.MEDIA_FRAGMENT_LOADED,R,m),g.on(o.default.METRIC_ADDED,D,m),g.on(o.default.QUALITY_CHANGE_REQUESTED,O,m),g.on(o.default.FRAGMENT_LOADING_ABANDONED,N,m),m}g.__dashjs_factory_name="BolaRule",t.default=i.default.getClassFactory(g)});c($n);var Zn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(m),r=l(Kn),i=l(v),a=l(T),o=l(b),s=l(S),u=l(p);function l(e){return e&&e.__esModule?e:{default:e}}var d=0,c=1,f=2;function h(e){e=e||{};var t=this.context,i=e.dashMetrics,l=(0,a.default)(t).getInstance(),h=void 0,p=void 0,g=void 0,m=void 0;function v(e){var t={},n=e.getMediaInfo(),r=n.bitrateList.map(function(e){return e.bandwidth/1e3});return t.state=c,t.bitrates=r,t.lastQuality=0,function(e){if(!e||!e.type)return;g[e.type]={},g[e.type].w=[],g[e.type].prev_w=[],g[e.type].Q=0,g[e.type].segment_request_start_s=0,g[e.type].segment_download_finish_s=0,g[e.type].B_target=1.5}(n),y(t),t}function y(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function _(){for(var e in p)if(p.hasOwnProperty(e)){var t=p[e];t.state!==d&&(t.state=c,y(t))}}function T(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=p[e.chunk.mediaInfo.type],n=g[e.chunk.mediaInfo.type];if(t&&t.state!==d){var r=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||r>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=r,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=r,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,b(t,n)}}}function E(e){if(e&&e.metric===n.default.HTTP_REQUEST&&e.value&&e.value.type===w.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=p[e.mediaType],r=g[e.mediaType];t&&t.state!==d&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),b(t,r))}}function b(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function S(e){if(e&&e.mediaType){var t=p[e.mediaType];t&&t.state!==d&&(t.abrQuality=e.newQuality)}}function A(e,t){if(e.length!==t.length)return-1;for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function I(){p={},g={}}return h={getMaxIndex:function(e){var n=(0,r.default)(t).create(),a=Math.pow(4,.99),o=Math.max(Math.pow(4,1),a*Math.sqrt(4)),s=e.getMediaInfo(),l=e.getMediaType(),h=s.bitrateList.map(function(e){return e.bandwidth}),_=h.length,T=e.getScheduleController(),E=e.getStreamInfo(),b=e.getAbrController(),S=b.getThroughputHistory(),w=E&&E.manifestInfo&&E.manifestInfo.isDynamic,I=e.useL2AABR(),C=i.getCurrentBufferLevel(l,!0),R=S.getSafeAverageThroughput(l,w),D=S.getAverageThroughput(l,w),M=S.getAverageLatency(l),O=void 0,N=e.getVideoModel().getPlaybackRate();if(!e||!e.hasOwnProperty("getMediaInfo")||!e.hasOwnProperty("getMediaType")||!e.hasOwnProperty("getScheduleController")||!e.hasOwnProperty("getStreamInfo")||!e.hasOwnProperty("getAbrController")||!e.hasOwnProperty("useL2AABR"))return n;if(n.reason=n.reason||{},!I||l===u.default.AUDIO)return n;T.setTimeToLoadDelay(0);var P=function(e){var t=e.getMediaType(),n=p[t];return n||(n=v(e),p[t]=n),n}(e);if(P.state===d)return n;var L=g[l];if(!L)return n;if(n.reason.state=P.state,n.reason.throughput=D,n.reason.latency=M,isNaN(D))return n;switch(P.state){case c:if(O=b.getQualityForBitrate(s,R,M),n.quality=O,n.reason.throughput=R,P.lastQuality=O,!isNaN(P.lastSegmentDurationS)&&C>=L.B_target){P.state=f,L.Q=a;for(var k=0;k<_;++k)k===P.lastQuality?L.prev_w[k]=1:L.prev_w[k]=0}break;case f:var x=[],F=i.getCurrentHttpRequest(l).trace.reduce(function(e,t){return e+t.d},0),U=i.getCurrentHttpRequest(l).trace.reduce(function(e,t){return e+t.b[0]},0),B=Math.round(8*U/F);B<1&&(B=1);for(var j=P.lastSegmentDurationS,G=1,q=0;q<_;++q)h[q]=h[q]/1e3,N*h[q]>B&&(G=-1),L.w[q]=L.prev_w[q]+G*(j/(2*o))*((L.Q+a)*(N*h[q]/B));L.w=function(e){for(var t=e.length,n=!1,r=[],i=0;i<t;++i)r[i]=e[i];for(var a=e.sort(function(e,t){return t-e}),o=0,s=0,u=[],l=0;l<t-1;++l)if((s=((o+=a[l])-1)/(l+1))>=a[l+1]){n=!0;break}n||(s=(o+a[t-1]-1)/t);for(var d=0;d<t;++d)u[d]=Math.max(r[d]-s,0);return u}(L.w);for(var H=0;H<_;++H)x[H]=L.w[H]-L.prev_w[H],L.prev_w[H]=L.w[H];L.Q=Math.max(0,L.Q-j+j*N*((A(h,L.prev_w)+A(h,x))/B));for(var V=[],K=0;K<_;++K)V[K]=Math.abs(h[K]-A(L.w,h));(O=V.indexOf(Math.min.apply(Math,V)))>P.lastQuality&&h[P.lastQuality+1]<=B&&(O=P.lastQuality+1),h[O]>=B&&(L.Q=2*Math.max(a,L.Q)),n.quality=O,n.reason.throughput=D,n.reason.latency=M,n.reason.bufferLevel=C,P.lastQuality=n.quality;break;default:m.debug("L2A ABR rule invoked in bad state."),n.quality=b.getQualityForBitrate(s,R,M),n.reason.state=P.state,n.reason.throughput=R,n.reason.latency=M,P.state=c,y(P)}return n},reset:function(){I(),l.off(o.default.PLAYBACK_SEEKING,_,h),l.off(o.default.MEDIA_FRAGMENT_LOADED,T,h),l.off(o.default.METRIC_ADDED,E,h),l.off(o.default.QUALITY_CHANGE_REQUESTED,S,h)}},m=(0,s.default)(t).getInstance().getLogger(h),I(),l.on(o.default.PLAYBACK_SEEKING,_,h),l.on(o.default.MEDIA_FRAGMENT_LOADED,T,h),l.on(o.default.METRIC_ADDED,E,h),l.on(o.default.QUALITY_CHANGE_REQUESTED,S,h),h}h.__dashjs_factory_name="L2ARule",t.default=i.default.getClassFactory(h)});c(Zn);var Jn=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(S);function i(e){return e&&e.__esModule?e:{default:e}}var a={MANUAL:"manual_weight_selection",RANDOM:"random_weight_selection",DYNAMIC:"dynamic_weight_selection"};function o(){var e=this.context,t=void 0,n=void 0,i=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=void 0;function f(){i=null,o=1,s=100,u=0,l=null,d=null,c=a.DYNAMIC}function h(){var e=0;if(i)for(var t=0;t<i.length;t++){var n=i[t];n.state.throughput>e&&(e=n.state.throughput)}return e}function p(e,t,n){var r=e.map(function(e,r){return n[r]*Math.pow(e-t[r],2)}).reduce(function(e,t){return e+t});return(r<0?-1:1)*Math.sqrt(Math.abs(r))}function g(e,t,n){for(var r=0;r<t.length;r++){var i=t[r],a=(s=e,p([(o=i).state.throughput,o.state.latency,o.state.rebuffer,o.state.switch],[s.state.throughput,s.state.latency,s.state.rebuffer,s.state.switch],[1,1,1,1]));m(i,n,Math.exp(-1*Math.pow(a,2)/(2*Math.pow(.1,2))))}var o,s}function m(e,t,n){var r=e.state,i=[.01,.01,.01,.01];r.throughput=r.throughput+(t[0]-r.throughput)*i[0]*n,r.latency=r.latency+(t[1]-r.latency)*i[1]*n,r.rebuffer=r.rebuffer+(t[2]-r.rebuffer)*i[2]*n,r.switch=r.switch+(t[3]-r.switch)*i[3]*n}function v(e,t,n,r,i,a,o){l||(l=d[d.length-1]);var s=e.findWeightVector(t,n,r,i,a,o);null!==s&&-1!==s&&(l=s)}return t={getNextQuality:function(e,t,r,f,m,y,_){var T=r,E=f,b=t,S=function(e){if(!i){i=[];var t=e.bitrateList,n=[];u=t[0].bandwidth,t.forEach(function(e){n.push(e.bandwidth),e.bandwidth<u&&(u=e.bandwidth)}),o=function(e){var t=e.map(function(e){return Math.pow(e,2)}).reduce(function(e,t){return e+t});return Math.sqrt(t)}(n);for(var r=0;r<t.length;r++){var a={qualityIndex:r,bitrate:t[r].bandwidth,state:{throughput:t[r].bandwidth/o,latency:0,rebuffer:0,switch:0}};i.push(a)}d=function(e){var t=[],n=function(e){for(var t=[],n=0;n<e;n++){var r=[Math.random()*h(),Math.random(),Math.random(),Math.random()];t.push(r)}return t}(Math.pow(e.length,2));t.push(n[0]);for(var r=[1,1,1,1],i=1;i<e.length;i++){for(var a=null,o=null,s=0;s<n.length;s++){for(var u=n[s],l=null,d=0;d<t.length;d++){var c=p(u,t[d],r);(null===l||c<l)&&(l=c)}(null===o||l>o)&&(a=u,o=l)}t.push(a)}for(var f=null,g=null,m=0;m<t.length;m++){for(var v=0,y=0;y<t.length;y++)m!==y&&(v+=p(t[m],t[y],r));(null===f||v>f)&&(f=v,g=m)}var _=[];for(_.push(t[g]),t.splice(g,1);t.length>0;){for(var T=null,E=null,b=0;b<t.length;b++){var S=p(_[0],t[b],r);(null===T||S<T)&&(T=S,E=b)}_.push(t[E]),t.splice(E,1)}return _}(i)}return i}(e),A=t/o;A>1&&(A=h()),r/=s,n.debug("getNextQuality called throughput:"+A+" latency:"+r+" bufferSize:"+f+" currentQualityIndex:"+y+" playbackRate:"+m);var w=S[y],I=w.bitrate*_.getSegmentDuration()/b,C=Math.max(0,I-E);if(E-I<_.getMinBuffer())return n.debug("Buffer is low for bitrate= "+w.bitrate+" downloadTime="+I+" currentBuffer="+E+" rebuffer="+C),function(e,t){var n=0,r=e;if(i)for(var a=0;a<i.length;a++){var o=i[a];o.bitrate<e.bitrate&&o.bitrate>n&&t>o.bitrate&&(n=o.bitrate,r=o)}return r}(w,b).qualityIndex;switch(c){case a.MANUAL:l=[.4,.4,.4,.4];break;case a.RANDOM:!function(e){l=function(e,t){for(var n=[],r=Math.sqrt(2/e),i=0;i<t;i++)n.push(Math.random()*r);return l=n}(e.length,4)}(S);break;case a.DYNAMIC:v(_,S,T,E,C,b,m);break;default:v(_,S,T,E,C,b,m)}for(var R=null,D=null,M=null,O=0;O<S.length;O++){var N=S[O],P=N.state,L=[P.throughput,P.latency,P.rebuffer,P.switch],k=l.slice(),x=_.getNextBufferWithBitrate(N.bitrate,E,b),F=x<_.getMinBuffer();F&&n.debug("Buffer is low for bitrate="+N.bitrate+" downloadTime="+I+" currentBuffer="+E+" nextBuffer="+x),(N.bitrate>t-1e4||F)&&N.bitrate!==u&&(k[0]=100);var U=p(L,[A,0,0,0],k);(null===R||U<R)&&(R=U,D=N.qualityIndex,M=N)}var B=Math.abs(w.bitrate-M.bitrate)/o;return g(w,S,[A,r,C,B]),g(M,S,[A,0,0,B]),D},reset:function(){f()}},n=(0,r.default)(e).getInstance().getLogger(t),f(),t}o.__dashjs_factory_name="LearningAbrController",t.default=n.default.getClassFactory(o)});c(Jn);var er=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}});c(er);var tr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(er);function i(e){return e&&e.__esModule?e:{default:e}}function a(){var e,t=void 0,n=void 0,i=void 0,a=void 0;function o(){t=null,n=null,i=null,a=null}function s(e,t,n,i){var a=new r.default;return a.type=e,a.weights.bitrateReward=t||1,a.weights.bitrateSwitchPenalty=1,a.weights.rebufferPenalty=n||1e3,a.weights.latencyPenalty=[],a.weights.latencyPenalty.push({threshold:1.1,penalty:.05*i}),a.weights.latencyPenalty.push({threshold:1e8,penalty:.1*n}),a.weights.playbackSpeedPenalty=i||200,a}function u(e,t,n,r,i){i.bitrateWSum+=i.weights.bitrateReward*e,i.lastBitrate&&(i.bitrateSwitchWSum+=i.weights.bitrateSwitchPenalty*Math.abs(e-i.lastBitrate)),i.lastBitrate=e,i.rebufferWSum+=i.weights.rebufferPenalty*t;for(var a=0;a<i.weights.latencyPenalty.length;a++){var o=i.weights.latencyPenalty[a];if(n<=o.threshold){i.latencyWSum+=o.penalty*n;break}}i.playbackSpeedWSum+=i.weights.playbackSpeedPenalty*Math.abs(1-r),i.totalQoe=i.bitrateWSum-i.bitrateSwitchWSum-i.rebufferWSum-i.latencyWSum-i.playbackSpeedWSum}return e={setupPerSegmentQoe:function(e,r,o){t=s("segment",e,r,o),n=e,i=r,a=o},logSegmentMetrics:function(e,n,r,i){t&&u(e,n,r,i,t)},getPerSegmentQoe:function(){return t},calculateSingleUseQoe:function(e,t,r,o){var l=null;return n&&i&&a&&(l=s("segment",n,i,a)),l?(u(e,t,r,o,l),l.totalQoe):0},reset:function(){o()}},o(),e}a.__dashjs_factory_name="LoLpQoeEvaluator",t.default=n.default.getClassFactory(a)});c(tr);var nr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(e){var t,n=e.targetLatency,r=e.bufferMin,i=e.segmentDuration,a=e.qoeEvaluator,o=void 0,s=void 0;function u(){return i}function l(e,t){var n=u();return t>n?e-n:e+n-t}return t={getMinBuffer:function(){return r},getSegmentDuration:u,getNextBufferWithBitrate:function(e,t,n){return l(t,e*i/n)},getNextBuffer:l,findWeightVector:function(e,t,u,d,c,f){var h=null,p=null,g=null,m=Math.abs(t-s);return e.forEach(function(e){o.forEach(function(o){o[0];var s=o[1],d=o[2],v=(o[3],e.bitrate*i/c),y=l(u,v),_=(0===d?10:1/d)*Math.max(1e-5,v-y),T=(0===s?10:1/s)*e.state.latency,E=a.calculateSingleUseQoe(e.bitrate,_,T,f);(null===h||E>h)&&function(e,t,i){return!(e>n+i)&&t>=r}(t,y,m)&&(h=E,p=o,g=e.bitrate)})}),null===p&&null===g&&(p=-1),s=t,p}},function(){var e,t;e=[.2,.4,.6,.8,1],t=4,o=function t(n,r,i){if(i===r)return n;for(var a=n.length,o=0;o<a;o++)for(var s=n.shift(),u=0;u<e.length;u++)n.push(s.concat(e[u]));return t(n,r,i+1)}(e.map(function(e){return[e]}),t,1),s=0}(),t}i.__dashjs_factory_name="LoLpWeightSelector",t.default=r.default.getClassFactory(i)});c(nr);var rr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=d(S),r=d(v),i=d(Jn),a=d(tr),o=d(Kn),s=d(m),u=d(nr),l=d(p);function d(e){return e&&e.__esModule?e:{default:e}}var c=1.5,f=.3;function h(e){var t=(e=e||{}).dashMetrics,r=this.context,d=void 0,h=void 0,p=void 0,g=void 0;return h={getMaxIndex:function(e){try{var n=(0,o.default)(r).create(),i=e.getMediaInfo().type,a=e.getAbrController(),h=e.getStreamInfo(),m=a.getQualityFor(i,h),v=e.getMediaInfo(),y=t.getCurrentBufferState(i),_=e.getScheduleController(),T=t.getCurrentBufferLevel(i,!0),E=h&&h.manifestInfo?h.manifestInfo.isDynamic:null,b=_.getPlaybackController(),S=b.getCurrentLiveLatency();if(!e.useLoLPABR()||i===l.default.AUDIO)return n;S||(S=0);var A=b.getPlaybackRate(),w=a.getThroughputHistory().getSafeAverageThroughput(i,E);if(d.debug("Throughput "+Math.round(w)+" kbps"),isNaN(w)||!y)return n;if(a.getAbandonmentStateFor(i)===s.default.ABANDON_LOAD)return n;for(var I=v.bitrateList,C=e.getRepresentationInfo().fragmentDuration,R=I[0].bandwidth/1e3,D=I[I.length-1].bandwidth/1e3,M=0;M<I.length;M++){var O=I[M].bandwidth/1e3;O>D?D=O:O<R&&(R=O)}var N=I[m].bandwidth/1e3,P=t.getCurrentHttpRequest(i,!0),L=(P.tresponse.getTime()-P.trequest.getTime())/1e3,k=L>C?L-C:0;g.setupPerSegmentQoe(C,D,R),g.logSegmentMetrics(N,k,S,A);var x=(0,u.default)(r).create({targetLatency:c,bufferMin:f,segmentDuration:C,qoeEvaluator:g});return n.quality=p.getNextQuality(v,1e3*w,S,T,A,m,x),n.reason={throughput:w,latency:S},n.priority=o.default.PRIORITY.STRONG,_.setTimeToLoadDelay(0),n.quality!==m&&console.log("[TgcLearningRule]["+i+"] requesting switch to index: ",n.quality,"Average throughput",Math.round(w),"kbps"),n}catch(F){throw F}},reset:function(){p.reset(),g.reset()}},d=(0,n.default)(r).getInstance().getLogger(h),p=(0,i.default)(r).create(),g=(0,a.default)(r).create(),h}h.__dashjs_factory_name="LoLPRule",t.default=r.default.getClassFactory(h)});c(rr);var ir=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=h(Yn),r=h(Wn),i=h(zn),a=h(Xn),o=h(Qn),s=h($n),u=h(Zn),l=h(rr),d=h(v),c=h(Kn),f=h(p);function h(e){return e&&e.__esModule?e:{default:e}}var g="qualitySwitchRules",m="abandonFragmentRules";function y(e){e=e||{};var t=this.context,d=e.mediaPlayerModel,h=e.dashMetrics,p=e.settings,v=void 0,y=void 0;function _(e){return e.filter(function(e){return e.quality>c.default.NO_CHANGE})}function T(e){var n,r={},i=void 0,a=void 0,o=void 0,s=void 0;if(0!==e.length){for(r[c.default.PRIORITY.STRONG]=c.default.NO_CHANGE,r[c.default.PRIORITY.WEAK]=c.default.NO_CHANGE,r[c.default.PRIORITY.DEFAULT]=c.default.NO_CHANGE,i=0,n=e.length;i<n;i+=1)(a=e[i]).quality!==c.default.NO_CHANGE&&(r[a.priority]=r[a.priority]>c.default.NO_CHANGE?Math.min(r[a.priority],a.quality):a.quality);return r[c.default.PRIORITY.WEAK]!==c.default.NO_CHANGE&&(o=r[c.default.PRIORITY.WEAK]),r[c.default.PRIORITY.DEFAULT]!==c.default.NO_CHANGE&&(o=r[c.default.PRIORITY.DEFAULT]),r[c.default.PRIORITY.STRONG]!==c.default.NO_CHANGE&&(o=r[c.default.PRIORITY.STRONG]),o!==c.default.NO_CHANGE&&(s=o),(0,c.default)(t).create(s)}}return{initialize:function(){v=[],y=[],p.get().streaming.abr.useDefaultABRRules&&(p.get().streaming.abr.ABRStrategy===f.default.ABR_STRATEGY_L2A?v.push((0,u.default)(t).create({dashMetrics:h,mediaPlayerModel:d,settings:p})):p.get().streaming.abr.ABRStrategy===f.default.ABR_STRATEGY_LoLP?v.push((0,l.default)(t).create({dashMetrics:h})):(v.push((0,s.default)(t).create({dashMetrics:h,mediaPlayerModel:d,settings:p})),v.push((0,n.default)(t).create({dashMetrics:h})),v.push((0,r.default)(t).create({dashMetrics:h})),v.push((0,o.default)(t).create()),v.push((0,a.default)(t).create()),y.push((0,i.default)(t).create({dashMetrics:h,mediaPlayerModel:d,settings:p})))),d.getABRCustomRules().forEach(function(e){e.type===g&&v.push(e.rule(t).create()),e.type===m&&y.push(e.rule(t).create())})},reset:function(){[v,y].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset()})}),v=[],y=[]},getMaxQuality:function(e){return T(_(v.map(function(t){return t.getMaxIndex(e)})))||(0,c.default)(t).create()},shouldAbandonFragment:function(e){return T(_(y.map(function(t){return t.shouldAbandon(e)})))||(0,c.default)(t).create()},getQualitySwitchRules:function(){return v}}}y.__dashjs_factory_name="ABRRulesCollection";var _=d.default.getClassFactory(y);_.QUALITY_SWITCH_RULES=g,_.ABANDON_FRAGMENT_RULES=m,d.default.updateSingletonFactory(y.__dashjs_factory_name,_),t.default=_});c(ir);var ar=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN}});c(ar);var or=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.useL2AABR,s=e.useLoLPABR,u=e.streamProcessor?e.streamProcessor.getScheduleController():null,l=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,d=e.videoModel?e.videoModel:null;function c(){return l?l.mediaInfo:null}return{getMediaType:function(){var e=c();return e?e.type:null},getMediaInfo:c,getDroppedFramesHistory:function(){return r},getCurrentRequest:function(){return i},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=c();return e?e.streamInfo:null},getScheduleController:function(){return u},getAbrController:function(){return t},getRepresentationInfo:function(){return l},useBufferOccupancyABR:function(){return a},useL2AABR:function(){return o},useLoLPABR:function(){return s},getVideoModel:function(){return d}}}i.__dashjs_factory_name="RulesContext",t.default=r.default.getClassFactory(i)});c(or);var sr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(Kn);function i(e){return e&&e.__esModule?e:{default:e}}var a=8;function o(){var e=[],t=[];return{push:function(n){n.newValue===r.default.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var i=n.newValue-n.oldValue,o=i<0?1:0,s=o?-i:0,u=o?0:1;if(e[n.oldValue].drops+=o,e[n.oldValue].dropSize+=s,e[n.oldValue].noDrops+=u,t.push({idx:n.oldValue,noDrop:u,drop:o,dropSize:s}),t.length>a){var l=t.shift();e[l.idx].drops-=l.drop,e[l.idx].dropSize-=l.dropSize,e[l.idx].noDrops-=l.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}o.__dashjs_factory_name="SwitchRequestHistory";var s=n.default.getClassFactory(o);t.default=s});c(sr);var ur=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(){var e=[],t=0,n=0;return{push:function(r,i){var a=i&&i.droppedVideoFrames?i.droppedVideoFrames:0,o=i&&i.totalVideoFrames?i.totalVideoFrames:0,s=a-t;t=a;var u=o-n;n=o,isNaN(r)||(e[r]?(e[r].droppedVideoFrames+=s,e[r].totalVideoFrames+=u):e[r]={droppedVideoFrames:s,totalVideoFrames:u})},getFrameHistory:function(){return e},reset:function(r){e=[],t=r.droppedVideoFrames,n=r.totalVideoFrames}}}i.__dashjs_factory_name="DroppedFramesHistory";var a=r.default.getClassFactory(i);t.default=a});c(ur);var lr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(p),r=i(v);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=20,r=3,i=4,a=4,o=1.3,s=1.3,u=8,l=3,d=2,c=1,f=(e=e||{}).settings,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0;function y(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function _(e,t,u){return f.get().streaming.abr.movingAverageMethod!==n.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?v.throughputHalfLife:v.latencyHalfLife,r=e?g[t]:m[t];if(!r||r.totalWeight<=0)return NaN;var i=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/n.fast)),a=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/n.slow));return e?Math.min(i,a):Math.max(i,a)}(e,t):function(e,t,n){var u=function(e,t,n){var u=void 0,l=void 0;if(e?(u=h[t],l=n?r:i):(u=p[t],l=a),u){if(l>=u.length)l=u.length;else if(e)for(var d=1;d<l;++d){var c=u[u.length-d]/u[u.length-d-1];if((c>=s||c<=1/o)&&(l+=1)===u.length)break}}else l=0;return l}(e,t,n),l=(e?h:p)[t];if(0===u||!l||0===l.length)return NaN;return(l=l.slice(-u)).reduce(function(e,t){return e+t})/l.length}(e,t,u)}function T(e,t){return _(!0,e,t)}function E(e){h[e]=h[e]||[],p[e]=p[e]||[],g[e]=g[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},m[e]=m[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function b(){h={},p={},g={},m={}}var S={push:function(e,r,i){if(r.trace&&r.trace.length){var a=r.tresponse.getTime()-r.trequest.getTime()||1,o=r._tfinish.getTime()-r.tresponse.getTime()||1,s=r.trace.reduce(function(e,t){return e+t.b[0]},0),u=void 0;u=f.get().streaming.lowLatencyEnabled?r.trace.reduce(function(e,t){return e+t.d},0):i?o:a+o;var l=Math.round(8*s/u);if(E(e),function(e,t,r){return e===n.default.VIDEO?r<f.get().streaming.cacheLoadThresholds[n.default.VIDEO]:e===n.default.AUDIO?r<f.get().streaming.cacheLoadThresholds[n.default.AUDIO]:void 0}(e,0,o)){if(h[e].length>0&&!h[e].hasCachedEntries)return;h[e].hasCachedEntries=!0}else h[e]&&h[e].hasCachedEntries&&function(e){delete h[e],delete p[e],delete g[e],delete m[e],E(e)}(e);h[e].push(l),h[e].length>t&&h[e].shift(),p[e].push(a),p[e].length>t&&p[e].shift(),y(g[e],l,.001*o,v.throughputHalfLife),y(m[e],a,1,v.latencyHalfLife)}},getAverageThroughput:T,getSafeAverageThroughput:function(e,t){var n=T(e,t);return isNaN(n)||(n*=f.get().streaming.abr.bandwidthSafetyFactor),n},getAverageLatency:function(e){return _(!1,e)},reset:b};return v={throughputHalfLife:{fast:l,slow:u},latencyHalfLife:{fast:c,slow:d}},b(),S}a.__dashjs_factory_name="ThroughputHistory",t.default=r.default.getClassFactory(a)});c(lr);var dr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=_(ir),r=_(p),i=_(m),a=_(ar),o=_(C),s=_(T),u=_(b),l=_(v),d=_(or),c=_(Kn),f=_(sr),h=_(ur),g=_(lr),y=_(S);function _(e){return e&&e.__esModule?e:{default:e}}var E=1e3,A=100,I=0;function R(){var e=this.context,t=(0,y.default)(e).getInstance(),l=(0,s.default)(e).getInstance(),p=void 0,m=void 0,v=void 0,_=void 0,T=void 0,b=void 0,S=void 0,C=void 0,R=void 0,D=void 0,M=void 0,O=void 0,N=void 0,P=void 0,L=void 0,x=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0,q=void 0,H=void 0,V=void 0,K=void 0;function Y(){(v=(0,n.default)(e).create({dashMetrics:V,mediaPlayerModel:L,settings:K})).initialize()}function W(){T={},b={},C={},S={},U={},G={},q={},H={},void 0===D&&(D=!1),F=void 0,B=void 0,j=void 0,clearTimeout(R),R=null}function z(e){e.mediaType===r.default.VIDEO&&(F=e.oldQuality,B.push(F,P.getPlaybackQuality()))}function X(e){e.metric!==i.default.HTTP_REQUEST||!e.value||e.value.type!==w.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==r.default.AUDIO&&e.mediaType!==r.default.VIDEO||j.push(e.mediaType,e.value,K.get().streaming.abr.useDeadTimeLatency),e.metric!==i.default.BUFFER_LEVEL||e.mediaType!==r.default.AUDIO&&e.mediaType!==r.default.VIDEO||function(e,t){var n=K.get().streaming.abr.ABRStrategy;if(n===r.default.ABR_STRATEGY_L2A)return G[e]=!1,H[e]=!1,void(q[e]=!0);if(n===r.default.ABR_STRATEGY_LoLP)return G[e]=!1,H[e]=!0,void(q[e]=!1);if(n===r.default.ABR_STRATEGY_BOLA)return G[e]=!0,H[e]=!1,void(q[e]=!1);if(n===r.default.ABR_STRATEGY_THROUGHPUT)return G[e]=!1,H[e]=!1,void(q[e]=!1);!function(e,t){var n=L.getStableBufferTime(),r=n,i=.5*n,a=G[e],o=t>(a?i:r);G[e]=o,o!==a&&(o?m.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):m.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}(e,t)}(e.mediaType,.001*e.value.level)}function Q(e,t){return T[t]=T[t]||{},T[t].hasOwnProperty(e)||(T[t][e]=0),function(e,t){if(t!==r.default.VIDEO||!K.get().streaming.abr.limitBitrateByPortal||!S[t])return e;D||ue();var n=N.getAdaptationForType(0,t).Representation,i=e;if(M>0&&O>0){for(;i>0&&n[i]&&M<n[i].width&&M-n[i-1].width<n[i].width-M;)i-=1;for(;i<n.length-1&&n[i].width===n[i+1].width;)i+=1}return i}(function(e,t,n){var r=K.get().streaming.abr.maxRepresentationRatio[t];if(isNaN(r)||r>=1||r<0)return e;return Math.min(e,Math.round(n*r))}(function(e,t){var n=e;if(!S[t])return n;var r=Z(t);void 0!==r&&(n=Math.max(e,r));var i=$(t);void 0!==i&&(n=Math.min(n,i));return n}(T[t][e],e),e,T[t][e]),e)}function $(e){var t=function(e){return K.get().streaming.abr.maxBitrate[e]}(e);return t>-1?ne(S[e].getMediaInfo(),t):void 0}function Z(e){var t=function(e){return K.get().streaming.abr.minBitrate[e]}(e);if(t>-1){var n=S[e].getMediaInfo(),r=re(n),i=ne(n,t);return r[i]&&i<r.length-1&&r[i].bitrate<1e3*t&&i++,i}}function J(e,t,n,r){var i=t.id,a=se(e);(0,k.checkInteger)(n);var o=Q(e,i);n!==a&&n>=0&&n<=o&&ee(e,a,n,o,r)}function ee(e,t,n,r,i){if(e&&S[e]){var a=S[e].getStreamInfo(),o=a?a.id:null;if(K.get().debug.logLevel===y.default.LOG_LEVEL_DEBUG){var s=V.getCurrentBufferLevel(e);m.info("["+e+"] switch from "+t+" to "+n+"/"+r+" (buffer: "+s+") "+(i?JSON.stringify(i):"."))}!function(e,t,n){b[t]=b[t]||{},b[t][e]=n}(e,o,n),l.trigger(u.default.QUALITY_CHANGE_REQUESTED,{oldQuality:t,newQuality:n,reason:i},{streamId:a.id,mediaType:e});var d=j.getAverageThroughput(e);isNaN(d)||x.setSavedBitrateSettings(e,d)}}function te(e,t){C[e].state=t}function ne(e,t,n){var r=e&&e.type?S[e.type].getRepresentationInfo():null;if(K.get().streaming.abr.useDeadTimeLatency&&n&&r&&r.fragmentDuration){n/=1e3;var i=r.fragmentDuration;if(n>i)return 0;t*=1-n/i}for(var a=re(e),o=a.length-1;o>=0;o--){if(1e3*t>=a[o].bitrate)return o}return I}function re(e){var t=[];if(!e||!e.bitrateList)return t;for(var n=e.bitrateList,r=e.type,i=void 0,o=0,s=n.length;o<s;o++)(i=new a.default).mediaType=r,i.qualityIndex=o,i.bitrate=n[o].bandwidth,i.width=n[o].width,i.height=n[o].height,i.scanType=n[o].scanType,t.push(i);return t}function ie(e){return G[e]}function ae(e){return q[e]}function oe(e){return H[e]}function se(e){if(e&&S[e]){var t=S[e].getStreamInfo(),n=t?t.id:null;if(n)return b[n]=b[n]||{},b[n].hasOwnProperty(e)||(b[n][e]=I),b[n][e]}return I}function ue(){if(P){var e=K.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;M=P.getClientWidth()*e,O=P.getClientHeight()*e}}function le(t){var n=t.request.mediaType;if(K.get().streaming.abr.autoSwitchBitrate[n]){var r=S[n];if(!r)return;var a=(0,d.default)(e).create({abrController:p,streamProcessor:r,currentRequest:t.request,useBufferOccupancyABR:ie(n),useL2AABR:ae(n),useLoLPABR:oe(n),videoModel:P}),s=v.shouldAbandonFragment(a);if(s.quality>c.default.NO_CHANGE){var u=r.getFragmentModel();u.getRequests({state:o.default.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(u.abortRequests(),te(n,i.default.ABANDON_LOAD),U[n].reset(),U[n].push({oldValue:se(n),newValue:s.quality,confidence:1,reason:s.reason}),J(n,_.getActiveStreamInfo(),s.quality,s.reason),clearTimeout(R),R=setTimeout(function(){te(n,i.default.ALLOW_LOAD),R=null},K.get().streaming.abandonLoadTimeout))}}}return p={isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=se(r.default.AUDIO),i=se(r.default.VIDEO);return n===Q(r.default.AUDIO,t)&&i===Q(r.default.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return function(e,t,n){T[t]=T[t]||{},T[t][e]=n}(t,n,r),r},getThroughputHistory:function(){return j},getBitrateList:re,getQualityForBitrate:ne,getTopBitrateInfoFor:function(e){if(e&&S&&S[e]){var t=S[e].getStreamInfo();if(t&&t.id){var n=Q(e,t.id),r=re(S[e].getMediaInfo());return r[n]?r[n]:null}}return null},getMaxAllowedIndexFor:$,getMinAllowedIndexFor:Z,getInitialBitrateFor:function(e){if(function(){if(!x||!x.hasOwnProperty("getSavedBitrateSettings"))throw new Error(r.default.MISSING_CONFIG_ERROR)}(),e===r.default.TEXT||e===r.default.FRAGMENTED_TEXT)return NaN;var t=x.getSavedBitrateSettings(e),n=K.get().streaming.abr.initialBitrate[e],i=K.get().streaming.abr.initialRepresentationRatio[e];if(-1===n)if(i>-1){var a=N.getAdaptationForType(0,e).Representation;n=Array.isArray(a)?a[Math.max(Math.round(a.length*i)-1,0)].bandwidth:0}else n=isNaN(t)?e===r.default.VIDEO?E:A:t;return n},getQualityFor:se,getAbandonmentStateFor:function(e){return C[e]?C[e].state:null},setPlaybackQuality:J,checkPlaybackQuality:function(t){if(t&&S&&S[t]){var n=S[t].getStreamInfo(),r=n?n.id:null,a=se(t),o=(0,d.default)(e).create({abrController:p,streamProcessor:S[t],currentValue:a,switchHistory:U[t],droppedFramesHistory:B,useBufferOccupancyABR:ie(t),useL2AABR:ae(t),useLoLPABR:oe(t),videoModel:P});if(B){var s=P.getPlaybackQuality();s&&B.push(F,s)}if(K.get().streaming.abr.autoSwitchBitrate[t]){var u=Z(t),l=Q(t,r),f=v.getMaxQuality(o),h=f.quality;if(void 0!==u&&(h>c.default.NO_CHANGE?h:a)<u&&(h=u),h>l&&(h=l),U[t].push({oldValue:a,newValue:h}),h>c.default.NO_CHANGE&&h!=a)(C[t].state===i.default.ALLOW_LOAD||h>a)&&ee(t,a,h,l,f.reason);else if(K.get().debug.logLevel===y.default.LOG_LEVEL_DEBUG){var g=V.getCurrentBufferLevel(t,!0);m.debug("["+t+"] stay on "+a+"/"+l+" (buffer: "+g+")")}}}},getTopQualityIndexFor:Q,setElementSize:ue,setWindowResizeEventCalled:function(e){D=e},createAbrRulesCollection:Y,registerStreamType:function(t,n){U[t]=U[t]||(0,f.default)(e).create(),S[t]=n,C[t]=C[t]||{},C[t].state=i.default.ALLOW_LOAD,G[t]=!1,q[t]=!1,H[t]=!1,l.on(u.default.LOADING_PROGRESS,le,p),t===r.default.VIDEO&&(l.on(u.default.QUALITY_CHANGE_RENDERED,z,p),B=B||(0,h.default)(e).create(),ue()),l.on(u.default.METRIC_ADDED,X,p),l.on(u.default.PERIOD_SWITCH_COMPLETED,Y,p),j=j||(0,g.default)(e).create({settings:K})},unRegisterStreamType:function(e){delete S[e]},setConfig:function(e){e&&(e.streamController&&(_=e.streamController),e.domStorage&&(x=e.domStorage),e.mediaPlayerModel&&(L=e.mediaPlayerModel),e.dashMetrics&&(V=e.dashMetrics),e.adapter&&(N=e.adapter),e.videoModel&&(P=e.videoModel),e.settings&&(K=e.settings))},reset:function(){W(),l.off(u.default.LOADING_PROGRESS,le,p),l.off(u.default.QUALITY_CHANGE_RENDERED,z,p),l.off(u.default.METRIC_ADDED,X,p),l.off(u.default.PERIOD_SWITCH_COMPLETED,Y,p),v&&v.reset()}},m=t.getLogger(p),W(),p}R.__dashjs_factory_name="AbrController";var D=l.default.getSingletonFactory(R);D.QUALITY_DEFAULT=I,l.default.updateSingletonFactory(R.__dashjs_factory_name,D),t.default=D});c(dr);var cr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(){var e={};return{save:function(t){var n=t.streamId,r=t.representationId;e[n]=e[n]||{},e[n][r]=t},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},reset:function(){e={}}}}i.__dashjs_factory_name="InitCache",t.default=r.default.getSingletonFactory(i)});c(cr);var fr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=y(p),r=y(m),i=y(C),a=y(Hn),o=y(Vn),s=y(dr),u=y(T),l=y(b),d=y(v),c=y(S),f=y(cr),h=y(R),g=y(Un);function y(e){return e&&e.__esModule?e:{default:e}}var _=.1,E=.5,A=.01,I=22,D="BufferController";function M(e){e=e||{};var t=this.context,d=(0,u.default)(t).getInstance(),p=e.errHandler,m=e.fragmentModel,v=e.representationController,y=e.mediaController,T=e.adapter,b=e.textController,S=e.abrController,C=e.playbackController,R=e.streamInfo,M=e.type,O=e.settings,N=void 0,P=void 0,L=void 0,k=void 0,x=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0,q=void 0,H=void 0,V=void 0,K=void 0,Y=void 0,W=void 0,z=void 0,X=void 0,Q=void 0,$=void 0,Z=void 0,J=void 0;function ee(e){return T.convertDataToRepresentationInfo(v.getRepresentationForQuality(e))}function te(e,n){if(!z||!e)return null;var r=e[0];if(U)try{G=n&&n[M]?(0,a.default)(t).create(U,r,oe.bind(this),n[M]):(0,a.default)(t).create(U,r,oe.bind(this),null),O.get().streaming.useAppendWindow&&G.updateAppendWindow(R),"function"===typeof G.getBuffer().initialize&&G.getBuffer().initialize(M,R,e,m)}catch(i){P.fatal("Caught error on create SourceBuffer: "+i),p.error(new h.default(g.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,g.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+M))}else G=(0,o.default)(t).create(oe.bind(this));return be(ee(L)),G}function ne(e){P.info("Init fragment finished loading saving to",M+"'s init cache"),z.save(e.chunk),P.debug("Append Init fragment",M," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),ie(e.chunk)}function re(e){var t=e.chunk;if(Z){J=t;var n=G&&G.getAllBufferRanges();n&&n.length>0&&C.getTimeToStreamEnd()>O.get().streaming.stallThreshold&&(P.debug("Clearing buffer because track changed - "+(n.end(n.length-1)+E)),_e([{start:0,end:n.end(n.length-1)+E,force:!0}]))}else ie(t)}function ie(e){G.append(e),e.mediaInfo.type===n.default.VIDEO&&Oe(l.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function ae(e){if(e&&e.length>0)for(var t=0,n=e.length;t<n;t++)P.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",C.getTime())}function oe(e){if(e.error){if(e.error.code===I&&(W=!0,F=.8*De(),P.warn("Quota exceeded, Critical Buffer: "+F),F>0)){var t=Math.max(.2*F,1),r=F-t,i=Math.min(O.get().streaming.bufferTimeAtTopQuality,.9*r),a=Math.min(O.get().streaming.bufferTimeAtTopQualityLongForm,.9*r),o={streaming:{bufferToKeep:parseFloat(t.toFixed(5)),bufferTimeAtTopQuality:parseFloat(i.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(a.toFixed(5))}};O.update(o)}e.error.code!==I&&Me()||(P.warn("Clearing playback buffer to overcome quota exceed situation"),Oe(l.default.QUOTA_EXCEEDED,{criticalBufferLevel:F}),_e(ye()))}else{W=!1,(V=e.chunk)&&!isNaN(V.index)&&(B=Math.max(V.index,B),ge());var s=G.getAllBufferRanges();if(V.segmentType===w.HTTPRequest.MEDIA_SEGMENT_TYPE)ae(s),de(),function(){if(M!==n.default.AUDIO&&M!==n.default.VIDEO)return;if(isNaN(X))return;var e=C.getTime(),t=he(X,0);if(e===X&&t)return;var r=v.getCurrentRepresentation().segmentDuration;if(!(t=he(X,r)))return;Math.abs(e-X)>r?X<=t.end&&(C.seek(Math.max(X,t.start),!1,!0),X=NaN):e<t.start&&(C.seek(t.start,!1,!0),X=NaN)}();else if(Z){var u=C.getTime();P.debug("AppendToBuffer seek target should be "+u),Oe(l.default.SEEK_TARGET,{time:u})}V&&Oe(V.endFragment?l.default.BYTES_APPENDED_END_FRAGMENT:l.default.BYTES_APPENDED,{quality:V.quality,startTime:V.start,index:V.index,bufferedRanges:s,mediaType:M})}}function se(e){L!==e.newQuality&&(be(this.getRepresentationInfo(e.newQuality)),L=e.newQuality)}function ue(e){X=e.seekTime,k&&(Q=!0,k=!1,j=Number.POSITIVE_INFINITY),M!==n.default.FRAGMENTED_TEXT?G.waitForUpdateEnd(function(){var e=function(){var e=[],t=G.getAllBufferRanges();if(!t||0===t.length)return e;var n=C.getTime(),r=t.end(t.length-1)+E,a=m.getRequests({state:i.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:A})[0];if(a){var o={start:0,end:a.startTime-O.get().streaming.stallThreshold},s=m.getRequests({state:i.default.FRAGMENT_MODEL_EXECUTED,time:a.startTime-a.duration/2,threshold:A})[0];s&&s.startTime!=a.startTime&&(o.end=s.startTime),o.start<o.end&&o.end>t.start(0)&&e.push(o);var u={start:a.startTime+a.duration+O.get().streaming.stallThreshold,end:r},l=m.getRequests({state:i.default.FRAGMENT_MODEL_EXECUTED,time:a.startTime+a.duration+O.get().streaming.stallThreshold,threshold:A})[0];l&&l.startTime!==a.startTime&&(u.start=l.startTime+l.duration+O.get().streaming.stallThreshold),u.start<u.end&&u.start<r&&e.push(u)}else P.debug("getAllRangesWithSafetyFactor - No request found in current time position, removing full buffer 0 -",r),e.push({start:0,end:r});return e}();e&&0!==e.length||de(),_e(e)}):de()}function le(){X=NaN}function de(){(!Z||M===n.default.FRAGMENTED_TEXT&&b.isTextEnabled())&&pe()}function ce(){me()}function fe(){X=NaN,me()}function he(e,t){var n=G.getAllBufferRanges(),r=0,i=0,a=null,o=null,s=0,u=void 0,l=void 0,d=isNaN(t)?.15:t;if(null!==n&&void 0!==n){for(l=0,u=n.length;l<u;l++)if(r=n.start(l),i=n.end(l),null===a)s=Math.abs(r-e),e>=r&&e<i?(a=r,o=i):s<=d&&(a=r,o=i);else{if(!((s=r-o)<=d))break;o=i}if(null!==a)return{start:a,end:o}}return null}function pe(){C&&(x=function(e,t){var n;return O.get().streaming.jumpGaps&&(t=O.get().streaming.smallGapLimit),null===(n=he(e,t))?0:n.end-e}((isNaN(X)?C.getTime():X)||0),Oe(l.default.BUFFER_LEVEL_UPDATED,{bufferLevel:x}),me())}function ge(){B>=j-1&&!k&&void 0===G.discharge&&(k=!0,P.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for "+M),Oe(l.default.BUFFERING_COMPLETED))}function me(){M!==n.default.AUDIO&&M!==n.default.VIDEO||(Q&&!k&&x>0&&C&&C.getTimeToStreamEnd()-x<_&&(Q=!1,k=!0,P.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED for type "+M),Oe(l.default.BUFFERING_COMPLETED)),(!O.get().streaming.lowLatencyEnabled&&x<O.get().streaming.stallThreshold||0===x)&&!k?ve(r.default.BUFFER_EMPTY):(k||x>=R.manifestInfo.minBufferTime)&&ve(r.default.BUFFER_LOADED))}function ve(e){H===e||e===r.default.BUFFER_EMPTY&&0===C.getTime()||M===n.default.FRAGMENTED_TEXT&&!b.isTextEnabled()||(H=e,Oe(l.default.BUFFER_LEVEL_STATE_CHANGED,{state:e}),Oe(e===r.default.BUFFER_LOADED?l.default.BUFFER_LOADED:l.default.BUFFER_EMPTY),P.debug(e===r.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function ye(){var e=[],t=G.getAllBufferRanges();if(!t||0===t.length)return e;var n=C.getTime(),r=Math.max(0,n-O.get().streaming.bufferToKeep),a=m.getRequests({state:i.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:A})[0];if(a)r=Math.min(a.startTime,r);else if(0===n&&C.getIsDynamic())return[];if(t.start(0)<=r){for(var o={start:0,end:r},s=0;s<t.length&&t.end(s)<=r;s++)o.end=t.end(s);o.start<o.end&&e.push(o)}return e}function _e(e){e&&G&&0!==e.length&&($.push.apply($,e),Y||Te())}function Te(){if(0===$.length||!G)return P.debug("Nothing to prune, halt pruning"),$=[],void(Y=!1);var e=G.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return P.debug("SourceBuffer is empty (or does not exist), halt pruning"),$=[],void(Y=!1);var t=$.shift();P.debug("Removing buffer from:",t.start,"to",t.end),Y=!0,C.getTime()<t.end&&(k=!1,B=0),G.remove(t.start,t.end,t.force)}function Ee(e){G===e.buffer&&(P.debug("onRemoved buffer from:",e.from,"to",e.to),ae(G.getAllBufferRanges()),0===$.length&&(Y=!1),e.unintended&&(P.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),Oe(l.default.SEEK_TARGET,{time:e.from,mediaType:M,streamId:R.id})),Y?Te():(Z?(Z=!1,J&&ie(J)):pe(),Oe(l.default.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Me(),quotaExceeded:W})))}function be(e){e&&void 0!==e.MSETimeOffset&&G&&G.updateTimestampOffset&&G.updateTimestampOffset(e.MSETimeOffset)}function Se(e){e.error||k||be(e.currentRepresentation)}function Ae(e){j=e.request.index,ge()}function we(e){if(e.newMediaInfo.streamInfo.id===R.id&&e.newMediaInfo.type===M){var t=G&&G.getAllBufferRanges();t&&(P.info("Track change asked"),y.getSwitchMode(M)===n.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&C.getTimeToStreamEnd()>O.get().streaming.stallThreshold&&(k=!1,j=Number.POSITIVE_INFINITY))}}function Ie(){++K*(O.get().streaming.wallclockTimeUpdateInterval/1e3)>=O.get().streaming.bufferPruningInterval&&(K=0,G&&M!==n.default.FRAGMENTED_TEXT&&(k||_e(ye())))}function Ce(){me()}function Re(e,t){U=e,G&&t&&"function"===typeof G.discharge&&(q=G,te(t))}function De(){var e,t=G.getAllBufferRanges(),n=0,r=void 0;if(!t)return n;for(r=0,e=t.length;r<e;r++)n+=t.end(r)-t.start(r);return n}function Me(){return De()<F}function Oe(e,t){var n=t||{};d.trigger(e,n,{streamId:R.id,mediaType:M})}function Ne(e,t){F=Number.POSITIVE_INFINITY,H=void 0,L=s.default.QUALITY_DEFAULT,j=Number.POSITIVE_INFINITY,B=0,V=null,k=!1,Y=!1,W=!1,Q=!1,x=0,K=0,$=[],X=NaN,G&&(e||G.abort(),G.reset(t),G=null),Z=!1}return N={initialize:function(e){Re(e),L=S.getQualityFor(M),d.on(l.default.DATA_UPDATE_COMPLETED,Se,this),d.on(l.default.INIT_FRAGMENT_LOADED,ne,this),d.on(l.default.MEDIA_FRAGMENT_LOADED,re,this),d.on(l.default.QUALITY_CHANGE_REQUESTED,se,this),d.on(l.default.STREAM_COMPLETED,Ae,this),d.on(l.default.PLAYBACK_PLAYING,fe,this),d.on(l.default.PLAYBACK_PROGRESS,de,this),d.on(l.default.PLAYBACK_TIME_UPDATED,de,this),d.on(l.default.PLAYBACK_RATE_CHANGED,Ce,this),d.on(l.default.PLAYBACK_SEEKING,ue,this),d.on(l.default.PLAYBACK_SEEKED,le,this),d.on(l.default.PLAYBACK_STALLED,ce,this),d.on(l.default.WALLCLOCK_TIME_UPDATED,Ie,this),d.on(l.default.CURRENT_TRACK_CHANGED,we,this,{priority:u.default.EVENT_PRIORITY_HIGH}),d.on(l.default.SOURCEBUFFER_REMOVE_COMPLETED,Ee,this)},getStreamId:function(){return R.id},getType:function(){return M},getBufferControllerType:function(){return D},getRepresentationInfo:ee,createBuffer:te,dischargePreBuffer:function(){if(G&&q&&"function"===typeof q.discharge){var e=q.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+M+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";P.debug(t)}else P.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var r=q.discharge(),i=null,a=0;a<r.length;a++){var o=r[a],s=z.extract(o.streamId,o.representationId);s&&(i!==s&&(G.append(s),i=s),G.append(o))}q.reset(),q=null}},getBuffer:function(){return G},setBuffer:function(e){G=e},getBufferLevel:function(){return x},getRangeAt:he,setMediaSource:Re,getMediaSource:function(){return U},appendInitSegment:function(e){var t=z.extract(R.id,e);return!!t&&(P.info("Append Init fragment",M," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),ie(t),!0)},replaceBuffer:function(){Z=!0},getIsBufferingCompleted:function(){return k},getIsPruningInProgress:function(){return Y},reset:function(e,t){d.off(l.default.DATA_UPDATE_COMPLETED,Se,this),d.off(l.default.INIT_FRAGMENT_LOADED,ne,this),d.off(l.default.MEDIA_FRAGMENT_LOADED,re,this),d.off(l.default.QUALITY_CHANGE_REQUESTED,se,this),d.off(l.default.STREAM_COMPLETED,Ae,this),d.off(l.default.PLAYBACK_PLAYING,fe,this),d.off(l.default.PLAYBACK_PROGRESS,de,this),d.off(l.default.PLAYBACK_TIME_UPDATED,de,this),d.off(l.default.PLAYBACK_RATE_CHANGED,Ce,this),d.off(l.default.PLAYBACK_SEEKING,ue,this),d.off(l.default.PLAYBACK_SEEKED,le,this),d.off(l.default.PLAYBACK_STALLED,ce,this),d.off(l.default.WALLCLOCK_TIME_UPDATED,Ie,this),d.off(l.default.CURRENT_TRACK_CHANGED,we,this),d.off(l.default.SOURCEBUFFER_REMOVE_COMPLETED,Ee,this),Ne(e,t)},updateAppendWindow:function(){G&&!k&&G.updateAppendWindow(R)}},P=(0,c.default)(t).getInstance().getLogger(N),z=(0,f.default)(t).getInstance(),Ne(),N}M.__dashjs_factory_name=D,t.default=d.default.getClassFactory(M)});c(fr);var hr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=c(p),r=c(T),i=c(b),a=c(v),o=c(cr),s=c(Hn),u=c(qn),l=c(R),d=c(Un);function c(e){return e&&e.__esModule?e:{default:e}}var f="NotFragmentedTextBufferController";function h(e){e=e||{};var t=this.context,a=(0,r.default)(t).getInstance(),c=(0,u.default)(t).getInstance(),h=e.errHandler,p=e.streamInfo,g=e.type,m=e.mimeType,v=e.fragmentModel,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0,S=void 0;function A(e){E=e}function w(e){null===S.extract(p.id,e.currentRepresentation.id)&&(_=!1,a.trigger(i.default.INIT_FRAGMENT_NEEDED,{representationId:e.currentRepresentation.id,sender:y},{streamId:p.id,mediaType:g}))}function I(e){e.chunk.bytes&&(S.save(e.chunk),b.append(e.chunk),_=!0,a.trigger(i.default.STREAM_COMPLETED,{request:e.request},{streamId:p.id,mediaType:g}))}return y={getBufferControllerType:function(){return f},initialize:function(e){A(e),S=(0,o.default)(t).getInstance()},createBuffer:function(e){var r=e[0];try{if(b=(0,s.default)(t).create(E,r),!T){var i=b.getBuffer();i.hasOwnProperty(n.default.INITIALIZE)&&i.initialize(m,p,e,v),T=!0}return b}catch(a){if(r&&(r.isText||-1!==r.codec.indexOf('codecs="stpp')||-1!==r.codec.indexOf('codecs="wvtt')))try{b=c.getTextSourceBuffer()}catch(a){h.error(new l.default(d.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,d.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+g+" : "+a.message))}else h.error(new l.default(d.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,d.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+g))}},getStreamId:function(){return p.id},getType:function(){return g},getBuffer:function(){return b},getBufferLevel:function(){return 0},setMediaSource:A,getMediaSource:function(){return E},getIsBufferingCompleted:function(){return _},getIsPruningInProgress:function(){return!1},dischargePreBuffer:function(){},appendInitSegment:function(e){return null!==S.extract(p.id,e)},getRangeAt:function(){return null},reset:function(e){a.off(i.default.DATA_UPDATE_COMPLETED,w,y),a.off(i.default.INIT_FRAGMENT_LOADED,I,y),!e&&b&&(b.abort(),b.reset(),b=null)},updateTimestampOffset:function(e){b.timestampOffset===e||isNaN(e)||(b.timestampOffset=e)}},T=!1,E=null,_=!1,a.on(i.default.DATA_UPDATE_COMPLETED,w,y),a.on(i.default.INIT_FRAGMENT_LOADED,I,y),y}h.__dashjs_factory_name=f,t.default=a.default.getClassFactory(h)});c(hr);var pr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(p),r=o(v),i=o(fr),a=o(hr);function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t,r=this.context,o=void 0;function s(){return o.getBuffer()}return t={getBufferControllerType:function(){return o.getBufferControllerType()},initialize:function(e,t){return o.initialize(e,t)},createBuffer:function(e,t){return o.createBuffer(e,t)},getType:function(){return o.getType()},getBuffer:s,setBuffer:function(e){o.setBuffer(e)},getBufferLevel:function(){return o.getBufferLevel()},setMediaSource:function(e){o.setMediaSource(e)},getMediaSource:function(){return o.getMediaSource()},getIsBufferingCompleted:function(){return o.getIsBufferingCompleted()},getIsPruningInProgress:function(){return o.getIsPruningInProgress()},dischargePreBuffer:function(){return o.dischargePreBuffer()},appendInitSegment:function(e){o.appendInitSegment(e)},getRangeAt:function(e){return o.getRangeAt(e)},reset:function(e){o.reset(e)},updateTimestampOffset:function(e){var t=s();t.timestampOffset===e||isNaN(e)||(t.timestampOffset=e)},updateAppendWindow:function(){o.updateAppendWindow()}},o=e.type===n.default.FRAGMENTED_TEXT?(0,i.default)(r).create({streamInfo:e.streamInfo,type:e.type,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,fragmentModel:e.fragmentModel,errHandler:e.errHandler,mediaController:e.mediaController,representationController:e.representationController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,settings:e.settings}):(0,a.default)(r).create({streamInfo:e.streamInfo,type:e.type,mimeType:e.mimeType,fragmentModel:e.fragmentModel,errHandler:e.errHandler}),t}s.__dashjs_factory_name="TextBufferController",t.default=r.default.getClassFactory(s)});c(pr);var gr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(p),r=a(v),i=a(m);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).dashMetrics,r=e.mediaPlayerModel,a=e.textController,o=e.abrController,s=e.settings;function u(e,u,l){var d=NaN;if(!e||!u)return d;if(e===n.default.FRAGMENTED_TEXT)if(a.isTextEnabled())if(isNaN(u.fragmentDuration)){var c=t.getCurrentSchedulingInfo(i.default.SCHEDULING_INFO);d=c?c.duration:0}else d=u.fragmentDuration;else d=0;else if(e===n.default.AUDIO&&l){var f=t.getCurrentBufferLevel(n.default.VIDEO);d=isNaN(u.fragmentDuration)?f:Math.max(f,u.fragmentDuration)}else{var h=u.mediaInfo.streamInfo;if(o.isPlayingAtTopQuality(h))d=h.manifestInfo.duration>=s.get().streaming.longFormContentDurationThreshold?s.get().streaming.bufferTimeAtTopQualityLongForm:s.get().streaming.bufferTimeAtTopQuality;else d=r.getStableBufferTime()}return d}return{execute:function(e,n,r){return!e||!n||t.getCurrentBufferLevel(e)<u(e,n,r)},getBufferTarget:u}}o.__dashjs_factory_name="BufferLevelRule",t.default=r.default.getClassFactory(o)});c(gr);var mr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=d(p),r=d(m),i=d(gr),a=d(C),o=d(T),s=d(b),u=d(v),l=d(S);function d(e){return e&&e.__esModule?e:{default:e}}function c(e){e=e||{};var t=this.context,u=(0,o.default)(t).getInstance(),d=e.adapter,c=e.dashMetrics,f=e.mediaPlayerModel,h=e.fragmentModel,p=e.abrController,g=e.playbackController,m=e.textController,v=e.streamInfo,y=e.type,_=e.mimeType,T=e.mediaController,E=e.bufferController,b=e.settings,S=void 0,A=void 0,w=void 0,I=void 0,C=void 0,R=void 0,D=void 0,M=void 0,O=void 0,N=void 0,P=void 0,L=void 0,k=void 0,x=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0;function q(){return!1===I}function H(){q()||w&&!E.getIsBufferingCompleted()&&(A.debug("Schedule Controller starts"),I=!1,c.createPlaylistTraceMetrics(w.id,1e3*g.getTime(),g.getPlaybackRate()),Y(0))}function V(){I||(A.debug("Schedule Controller stops"),A.debug(y+" Schedule Controller stops"),I=!0,clearTimeout(D))}function K(){if(I||C||g.isPaused()&&!b.get().streaming.scheduleWhilePaused||(y===n.default.FRAGMENTED_TEXT||y===n.default.TEXT)&&!m.isTextEnabled()||E.getIsBufferingCompleted())V();else{!function(){var e=g.getTime(),t=1.5;if(isNaN(w.fragmentDuration)){var i=c.getCurrentSchedulingInfo(w.mediaInfo.type);t=i?1.5*i.duration:1.5}var o=h.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];if(o&&-1===x.indexOf(o)&&!d.getIsTextTrack(_)){var s=b.get().streaming.fastSwitchEnabled,u=E.getBufferLevel(),l=p.getAbandonmentStateFor(y),f=!T.isCurrentTrack(o.mediaInfo)&&T.getSwitchMode(o.mediaInfo.type)===n.default.TRACK_SWITCH_MODE_NEVER_REPLACE,m=o.quality<w.quality;s&&(f||m)&&u>=t&&l!==r.default.ABANDON_LOAD?(z(o),G=!0,A.debug("Reloading outdated fragment at index: ",o.index)):o.quality>w.quality&&!U&&le(g.getTime()+u)}}();var e=x.length>0;if(U||isNaN(k)||F||e||function(e,t){L[t]=L[t]||{};var n=p.getTopQualityIndexFor(e,t);return L[t][e]!=n&&(A.info("Top quality "+e+" index has changed from "+L[t][e]+" to "+n),L[t][e]=n,!0)}(y,v.id)||N.execute(y,w,O)){W(!0),!e&&j&&p.checkPlaybackQuality(y),function(){if(w.quality===k&&!F||U){var e=x.shift();e&&e.isInitializationRequest()?(u.trigger(s.default.INIT_FRAGMENT_NEEDED,{representationId:e.representationId,sender:S},{streamId:v.id,mediaType:y}),j=!1):(u.trigger(s.default.MEDIA_FRAGMENT_NEEDED,{seekTarget:M,replacement:e},{streamId:v.id,mediaType:y}),j=!0)}else F?(A.debug("Switch track for "+y+", representation id = "+w.id),(U=T.getSwitchMode(y)===n.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE)&&E.replaceBuffer&&E.replaceBuffer(),F=!1):A.debug("Quality has changed, get init request for representationid = "+w.id),u.trigger(s.default.INIT_FRAGMENT_NEEDED,{representationId:w.id,sender:S},{streamId:v.id,mediaType:y}),k=w.quality,j=!1}()}else Y(500)}}function Y(e){clearTimeout(D),D=setTimeout(K,e)}function W(e){C!==e?C=e:A.debug("isFragmentProcessingInProgress is already equal to",e)}function z(e){x.push(e)}function X(e){if(g&&h){var t=h.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:g.getTime(),threshold:0})[0];t&&g.getTime()>=t.startTime&&((!P.mediaInfo||t.mediaInfo.type===P.mediaInfo.type&&t.mediaInfo.id!==P.mediaInfo.id)&&e&&u.trigger(s.default.TRACK_CHANGE_RENDERED,{mediaType:y,oldMediaInfo:P.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===P.quality&&t.adaptationIndex===P.adaptationIndex||!e||u.trigger(s.default.QUALITY_CHANGE_RENDERED,{mediaType:y,oldQuality:P.quality,newQuality:t.quality}),P={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function Q(){V(),W(!1),A.info("Stream "+v.id+" is complete")}function $(e){e.request.mediaInfo.streamInfo.id===v.id&&e.request.mediaType===y&&(A.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),d.getIsTextTrack(_)&&W(!1),e.error&&e.request.serviceLocation&&!I&&(z(e.request),W(!1),Y(0)),U&&(B=e.request))}function Z(){X(!0)}function J(e){if(U&&!isNaN(e.startTime)&&(U=!1,h.addExecutedRequest(B)),W(!1),G&&!isNaN(e.startTime)){var t=g.getTime(),n=e.startTime+w.fragmentDuration,r=1.5*w.fragmentDuration;Y(t+r>=n?0:1e3*(n-(t+r))),G=!1}else Y(0)}function ee(e){A.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),g.isSeeking()||F||(A.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),z(e.request)),W(!1),Y(0)}function te(){}function ne(){V()}function re(e){U&&b.get().streaming.flushBufferAtTrackSwitch&&g.seek(g.getTime()+.001,!1,!0),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&H()}function ie(){V(),W(!1)}function ae(){h.abortRequests(),V()}function oe(){!I&&b.get().streaming.scheduleWhilePaused||H()}function se(e){le(e.seekTime),de(0),I&&H();var t=w.DVRWindow&&g?w.DVRWindow.end-g.getTime():NaN;c.updateManifestUpdateInfo({latency:t}),C?h.abortRequests():Y(0)}function ue(e){c.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function le(e){M=e}function de(e){R=e}function ce(){j=!0,C=!1,R=0,M=NaN,k=NaN,P={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},L={},x=[],I=!0,F=!1,U=!1,B=null,G=!1}return S={initialize:function(e){O=e,N=(0,i.default)(t).create({abrController:p,dashMetrics:c,mediaPlayerModel:f,textController:m,settings:b}),u.on(s.default.DATA_UPDATE_STARTED,te,this),u.on(s.default.FRAGMENT_LOADING_COMPLETED,$,this),u.on(s.default.STREAM_COMPLETED,Q,this),u.on(s.default.BUFFER_CLEARED,re,this),u.on(s.default.BYTES_APPENDED_END_FRAGMENT,J,this),u.on(s.default.QUOTA_EXCEEDED,ie,this),u.on(s.default.PLAYBACK_SEEKING,se,this),u.on(s.default.PLAYBACK_STARTED,oe,this),u.on(s.default.PLAYBACK_RATE_CHANGED,ue,this),u.on(s.default.PLAYBACK_TIME_UPDATED,Z,this),u.on(s.default.URL_RESOLUTION_FAILED,ae,this),u.on(s.default.FRAGMENT_LOADING_ABANDONED,ee,this),u.on(s.default.BUFFERING_COMPLETED,ne,this)},getType:function(){return y},getStreamId:function(){return v.id},setCurrentRepresentation:function(e){w=e},setSeekTarget:le,setTimeToLoadDelay:de,getTimeToLoadDelay:function(){return R},switchTrackAsked:function(){F=!0},isStarted:q,start:H,stop:V,reset:function(){u.off(s.default.DATA_UPDATE_STARTED,te,this),u.off(s.default.FRAGMENT_LOADING_COMPLETED,$,this),u.off(s.default.STREAM_COMPLETED,Q,this),u.off(s.default.BUFFER_CLEARED,re,this),u.off(s.default.BYTES_APPENDED_END_FRAGMENT,J,this),u.off(s.default.QUOTA_EXCEEDED,ie,this),u.off(s.default.PLAYBACK_SEEKING,se,this),u.off(s.default.PLAYBACK_STARTED,oe,this),u.off(s.default.PLAYBACK_RATE_CHANGED,ue,this),u.off(s.default.PLAYBACK_TIME_UPDATED,Z,this),u.off(s.default.URL_RESOLUTION_FAILED,ae,this),u.off(s.default.FRAGMENT_LOADING_ABANDONED,ee,this),u.off(s.default.BUFFERING_COMPLETED,ne,this),V(),X(!1),ce()},getBufferTarget:function(){return N.getBufferTarget(y,w,O)},processInitRequest:function(e){e&&(W(!0),h.executeRequest(e))},processMediaRequest:function(e){e?(A.debug("Next fragment request url is "+e.url),h.executeRequest(e)):(g.getIsDynamic()&&A.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling."),W(!1),Y(b.get().streaming.lowLatencyEnabled?100:500))},getPlaybackController:function(){return g}},A=(0,l.default)(t).getInstance().getLogger(S),ce(),S}c.__dashjs_factory_name="ScheduleController",t.default=u.default.getClassFactory(c)});c(mr);var vr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(p),r=a(R),i=a(v);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).eventBus,i=e.events,a=e.errors,o=e.abrController,s=e.dashMetrics,u=e.playbackController,l=e.timelineConverter,d=e.type,c=e.streamInfo,f=e.dashConstants,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0;function y(){return d}function _(){if(!o||!s||!u||!l)throw new Error(n.default.MISSING_CONFIG_ERROR)}function T(){return g}function E(){return v}function b(){p=null,g=!0,m=[]}function S(){_();var e=new Date,t=E(),n=1e3*u.getTime();t&&s.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function A(e){return null===e||void 0===e||e>=m.length?null:m[e]}function w(e,t){var n;(e.segmentAvailabilityRange=l.calcSegmentAvailabilityRange(e,t),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start)?R(new r.default(a.SEGMENTS_UNAVAILABLE_ERROR_CODE,a.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end})):t&&(n=e.segmentAvailabilityRange.end,l.setExpectedLiveEdge(n),s.updateManifestUpdateInfo({presentationStartTime:n}))}function I(e,n){_();for(var r=0,a=m.length;r<a;r++)w(m[r],e),n&&t.trigger(i.REPRESENTATION_UPDATE_STARTED,{representation:m[r]},{streamId:c.id,mediaType:d})}function C(){g=!0,t.trigger(i.DATA_UPDATE_STARTED,{},{streamId:c.id,mediaType:d})}function R(e){g=!1,t.trigger(i.DATA_UPDATE_COMPLETED,{data:p,currentRepresentation:v,error:e},{streamId:c.id,mediaType:d})}function D(e){var n=e;t.trigger(i.AST_IN_FUTURE,{delay:n}),setTimeout(function(){T()||(C(),m.forEach(function(e){e.segmentAvailabilityRange=null}),I(u.getIsDynamic(),!0))},n)}function M(e){if(T())if(e.error)R(e.error);else{var t,n=e.representation,i=s.getCurrentManifestUpdate(),l=!1,d=0,h=void 0;if(n.adaptation.period.mpd.manifest.type===f.DYNAMIC&&!n.adaptation.period.mpd.manifest.ignorePostponeTimePeriod&&u.getStreamController().getStreams().length<=1&&(d=function(t){try{var n=u.getStreamController(),r=n.getActiveStreamInfo(),i=t.segmentAvailabilityRange.start;r&&r.id&&r.id!==c.id&&(i=Math.min(u.getTime(),i));var a=t.segmentAvailabilityRange.end-i,o=u.getLiveDelay();return 1e3*(o-a)}catch(e){return 0}}(n)),d>0)return D(d),void R(new r.default(a.SEGMENTS_UPDATE_FAILED_ERROR_CODE,a.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE));if(i){for(var p=0;p<i.representationInfo.length;p++)if((h=i.representationInfo[p]).index===n.index&&h.mediaType===y()){l=!0;break}l||s.addManifestUpdateRepresentationInfo(n,y())}(function(){for(var e=0,t=m.length;e<t;e++){var n=m[e].segmentInfoType;if(null===m[e].segmentAvailabilityRange||!m[e].hasInitialization()||(n===f.SEGMENT_BASE||n===f.BASE_URL)&&!m[e].segments)return!1}return!0})()&&(o.setPlaybackQuality(y(),c,(t=v,m.indexOf(t))),s.updateManifestUpdateInfo({latency:v.segmentAvailabilityRange.end-u.getTime()}),s.getCurrentRepresentationSwitch(E().adaptation.type)||S(),R())}}function O(e){e.isDynamic&&I(e.isDynamic)}function N(e){v=A(e.newQuality),S()}function P(e){if(e.newDuration){var t=E();if(t&&t.adaptation.period)t.adaptation.period.duration=e.newDuration}}return h={getStreamId:function(){return c.id},getType:y,getData:function(){return p},isUpdating:T,updateData:function(e,t,r,i){_(),C(),m=t,v=A(i),p=e,r===n.default.VIDEO||r===n.default.AUDIO||r===n.default.FRAGMENTED_TEXT?I(u.getIsDynamic(),!0):R()},updateRepresentation:w,getCurrentRepresentation:E,getRepresentationForQuality:A,reset:function(){t.off(i.QUALITY_CHANGE_REQUESTED,N,h),t.off(i.REPRESENTATION_UPDATE_COMPLETED,M,h),t.off(i.WALLCLOCK_TIME_UPDATED,O,h),t.off(i.MANIFEST_VALIDITY_CHANGED,P,h),b()}},b(),t.on(i.QUALITY_CHANGE_REQUESTED,N,h),t.on(i.REPRESENTATION_UPDATE_COMPLETED,M,h),t.on(i.WALLCLOCK_TIME_UPDATED,O,h),t.on(i.MANIFEST_VALIDITY_CHANGED,P,h),h}o.__dashjs_factory_name="RepresentationController",t.default=i.default.getClassFactory(o)});c(vr);var yr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(p);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=(e=e||{}).timelineConverter;return{getLiveEdge:function(e){return function(){if(!t||!t.hasOwnProperty("getExpectedLiveEdge"))throw new Error(r.default.MISSING_CONFIG_ERROR)}(),e.DVRWindow?e.DVRWindow.end:0},reset:function(){t=null}}}a.__dashjs_factory_name="LiveEdgeFinder",t.default=n.default.getClassFactory(a)});c(yr);var _r=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null}});c(_r);var Tr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeDollarsInTemplate=function(e){return e?e.split("$$").join("$"):e},t.replaceIDForTemplate=function(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},t.replaceTokenForTemplate=a,t.getIndexBasedSegment=function(e,t,n,r){var i=void 0,a=void 0,u=void 0;i=n.segmentDuration,isNaN(i)&&(i=n.adaptation.period.duration);a=parseFloat((n.adaptation.period.start+r*i).toFixed(5)),u=parseFloat((a+i).toFixed(5));var l=o(n,i,a,e.calcMediaTimeFromPresentationTime(a,n),e.calcAvailabilityStartTimeFromPresentationTime(a,n.adaptation.period.mpd,t),e,u,t,r);if(!s(e,n,l,t))return null;return l},t.getTimeBasedSegment=function(e,t,n,r,i,u,l,d,c,f){var h=r/u,p=Math.min(i/u,n.adaptation.period.mpd.maxSegmentDuration),g=void 0,m=void 0,v=void 0;if(g=e.calcPresentationTimeFromMediaTime(h,n),m=g+p,v=o(n,p,g,h,n.adaptation.period.mpd.manifest.loadedTime,e,m,t,c),!s(e,n,v,t))return null;return v.replacementTime=f||r,l=a(l,"Number",v.replacementNumber),l=a(l,"Time",v.replacementTime),v.media=l,v.mediaRange=d,v};var n,r=(n=_r)&&n.__esModule?n:{default:n};function i(e,t){for(;e.length<t;)e="0"+e;return e}function a(e,t,n){var r=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=t.length,c="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((a=e.indexOf("$",r+d))<0)return e;if((o=e.indexOf("%0",r+d))>r&&o<a)switch(s=e.charAt(a-1),u=parseInt(e.substring(o+c,a-1),10),s){case"d":case"i":case"u":l=i(n.toString(),u);break;case"x":l=i(n.toString(16),u);break;case"X":l=i(n.toString(16),u).toUpperCase();break;case"o":l=i(n.toString(8),u);break;default:return e}else l=n;e=e.substring(0,r)+l+e.substring(a+1)}}function o(e,t,n,i,a,o,s,u,l){var d,c=new r.default;return c.representation=e,c.duration=t,c.presentationStartTime=n,c.mediaStartTime=i,c.availabilityStartTime=a,c.availabilityEndTime=o.calcAvailabilityEndTimeFromPresentationTime(s,e.adaptation.period.mpd,u),c.wallStartTime=o.calcWallTimeForSegment(c,u),c.replacementNumber=(d=l,c.representation.startNumber+d),c.availabilityIdx=l,c}function s(e,t,n,r){var i=e.getPeriodEnd(t,r),a=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,i);if(e.calcPeriodRelativeTimeFromMpdRelativeTime(t,n.presentationStartTime)>=a){if(!r)return!1;if(t.segmentAvailabilityRange&&n.presentationStartTime>=t.segmentAvailabilityRange.end)return!1}return!0}});c(Tr);Tr.unescapeDollarsInTemplate,Tr.replaceIDForTemplate,Tr.replaceTokenForTemplate,Tr.getIndexBasedSegment,Tr.getTimeBasedSegment;var Er=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(p);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcMediaTimeFromPresentationTime")||!n.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function a(e,r){var i,a,o,s=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,u=s.SegmentTimeline,l=s.SegmentURL_asArray,d=0,c=0,f=-1,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0;o=e.timescale;var _=!1;for(p=0,a=(i=u.S_asArray).length;p<a&&!_;p++){if(m=0,(h=i[p]).hasOwnProperty("r")&&(m=h.r),h.hasOwnProperty("t")&&(c=(d=h.t)/o),m<0){if((y=i[p+1])&&y.hasOwnProperty("t"))v=y.t/o;else{var T=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:n.calcSegmentAvailabilityRange(e,t).end;v=n.calcMediaTimeFromPresentationTime(T,e),e.segmentDuration=h.d/o}m=Math.ceil((v-c)/(h.d/o))-1}for(g=0;g<=m&&!_;g++)(_=r(d,c,s,l,h,o,++f,p))&&(e.segmentDuration=h.d/o,(g<m-1||p<a-1)&&f++),c=(d+=h.d)/o}e.availableSegmentsNumber=f}return{getSegmentByIndex:function(e,r,o){if(i(),!e)return null;var s=null,u=!1;return a(e,function(r,i,a,l,d,c,f,h){if(u||o<0){var p=a.media,g=d.mediaRange;return l&&(p=l[h].media||"",g=l[h].mediaRange),s=(0,Tr.getTimeBasedSegment)(n,t,e,r,d.d,c,p,g,f,d.tManifest),!0}return i>=o-.5*d.d/c&&(u=!0),!1}),s},getSegmentByTime:function(e,r){if(i(),!e)return null;void 0===r&&(r=null);var o=null,s=n.calcMediaTimeFromPresentationTime(r,e);return a(e,function(r,i,a,u,l,d,c,f){if(s<i+l.d/d){var h=a.media,p=l.mediaRange;return u&&(h=u[f].media||"",p=u[f].mediaRange),o=(0,Tr.getTimeBasedSegment)(n,t,e,r,l.d,d,h,p,c,l.tManifest),!0}return!1}),o}}}a.__dashjs_factory_name="TimelineSegmentsGetter";var o=n.default.getClassFactory(a);t.default=o});c(Er);var br=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(p);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function a(e,r){if(i(),!e)return null;var a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;r=Math.max(r,0);var o=(0,Tr.getIndexBasedSegment)(n,t,e,r);if(o){o.replacementTime=Math.round((r-1)*e.segmentDuration*e.timescale,10);var s=a.media;s=(0,Tr.replaceTokenForTemplate)(s,"Number",o.replacementNumber),s=(0,Tr.replaceTokenForTemplate)(s,"Time",o.replacementTime),o.media=s}var u=e.segmentDuration,l=e.segmentAvailabilityRange;return isNaN(u)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((l.end-l.start)/u),o}return{getSegmentByIndex:a,getSegmentByTime:function(e,t){if(i(),!e)return null;var r=e.segmentDuration;if(isNaN(r))return null;var o=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return a(e,Math.floor(o/r))}}}a.__dashjs_factory_name="TemplateSegmentsGetter";var o=n.default.getClassFactory(a);t.default=o});c(br);var Sr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(p);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function a(e,r){if(i(),!e)return null;var a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,o=a.SegmentURL_asArray.length,s=e&&!isNaN(e.startNumber)?e.startNumber:1,u=Math.max(s-1,0),l=e.startNumber,d=null;if(r-u<o){var c=a.SegmentURL_asArray[r-u];(d=(0,Tr.getIndexBasedSegment)(n,t,e,r))&&(d.replacementTime=(l+r-1)*e.segmentDuration,d.media=c.media?c.media:"",d.mediaRange=c.mediaRange,d.index=r,d.indexRange=c.indexRange)}return e.availableSegmentsNumber=o,d}return{getSegmentByIndex:a,getSegmentByTime:function(e,t){if(i(),!e)return null;var r=e.segmentDuration;if(isNaN(r))return null;var o=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return a(e,Math.floor(o/r))}}}a.__dashjs_factory_name="ListSegmentsGetter";var o=n.default.getClassFactory(a);t.default=o});c(Sr);var Ar=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(p);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=(e=e||{}).timelineConverter;function n(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function i(e,t){if(n(),!e)return null;var r=e.segments?e.segments.length:-1,i=void 0;if(t<r&&(i=e.segments[t])&&i.availabilityIdx===t)return i;for(var a=0;a<r;a++)if((i=e.segments[a])&&i.availabilityIdx===t)return i;return null}return{getSegmentByIndex:i,getSegmentByTime:function(e,t){return n(),i(e,function(e,t){if(!e)return-1;var n=e.segments,r=n?n.length:null,i=-1,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0;if(n&&r>0)for(l=0;l<r;l++)if(o=n[l],s=o.presentationStartTime,u=o.duration,t+(a=u/2)>=s&&t-a<s+u){i=o.availabilityIdx;break}return i}(e,t))}}}a.__dashjs_factory_name="SegmentBaseGetter";var o=n.default.getClassFactory(a);t.default=o});c(Ar);var wr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(v),r=s(Er),i=s(br),a=s(Sr),o=s(Ar);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t,n=this.context,s=e.events,u=e.eventBus,l=e.dashConstants,d=e.streamInfo,c=e.type,f=void 0;function h(e){return e?e.segments?f[l.SEGMENT_BASE]:f[e.segmentInfoType]:null}return t={initialize:function(t){f[l.SEGMENT_TIMELINE]=(0,r.default)(n).create(e,t),f[l.SEGMENT_TEMPLATE]=(0,i.default)(n).create(e,t),f[l.SEGMENT_LIST]=(0,a.default)(n).create(e,t),f[l.SEGMENT_BASE]=(0,o.default)(n).create(e,t)},update:function(e,t,n,r){n||u.trigger(s.SEGMENTBASE_INIT_REQUEST_NEEDED,{streamId:d.id,mediaType:c,mimeType:t,representation:e}),r||u.trigger(s.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{streamId:d.id,mediaType:c,mimeType:t,representation:e})},getSegmentByIndex:function(e,t,n){var r=h(e);return r?r.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=h(e);return n?n.getSegmentByTime(e,t):null}},f={},t}u.__dashjs_factory_name="SegmentsController";var l=n.default.getClassFactory(u);t.default=l});c(wr);var Ir=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(I),r=a(v),i=a(wr);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=this.context,r=e.eventBus,a=e.events,o=e.debug,s=e.dashConstants,u=e.urlUtils,l=e.type,d=e.streamInfo,c=e.timelineConverter,f=e.dashMetrics,h=e.baseURLController,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0;function S(){return l}function A(){m=-1,v=null}function I(){A(),y=null,b=null,E=null}function C(e,t,n){var r=h.resolve(n.path),i=void 0,a=void 0;return r&&t!==r.url&&u.isRelative(t)?(i=r.url,a=r.serviceLocation,t&&(i=u.resolve(t,i))):i=t,!u.isRelative(i)&&(e.url=i,e.serviceLocation=a,!0)}function R(e){!function(e){var t=e.hasInitialization(),n=e.hasSegments();t&&n?r.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{representation:e},{streamId:d.id,mediaType:l}):b.update(e,E,t,n)}(e.representation)}function D(e,t){if(null===t||void 0===t)return null;var r=new n.default,i=t.representation,a=i.adaptation.period.mpd.manifest.Period_asArray[i.adaptation.period.index].AdaptationSet_asArray[i.adaptation.index].Representation_asArray[i.index].bandwidth,o=t.media;return o=(0,Tr.replaceTokenForTemplate)(o,"Number",t.replacementNumber),o=(0,Tr.replaceTokenForTemplate)(o,"Time",t.replacementTime),o=(0,Tr.replaceTokenForTemplate)(o,"Bandwidth",a),o=(0,Tr.replaceIDForTemplate)(o,i.id),o=(0,Tr.unescapeDollarsInTemplate)(o),r.mediaType=S(),r.type=w.HTTPRequest.MEDIA_SEGMENT_TYPE,r.range=t.mediaRange,r.startTime=t.presentationStartTime,r.mediaStartTime=t.mediaStartTime,r.duration=t.duration,r.timescale=i.timescale,r.availabilityStartTime=t.availabilityStartTime,r.availabilityEndTime=t.availabilityEndTime,r.wallStartTime=t.wallStartTime,r.quality=i.index,r.index=t.availabilityIdx,r.mediaInfo=e,r.adaptationIndex=i.adaptation.index,r.representationId=i.id,C(r,o,i)?r:void 0}function M(e){var t=!1;if(!e)return t;if(_){if(T)t=!0;else if(v){var n=parseFloat((v.presentationStartTime-e.adaptation.period.start).toFixed(5));t=(v.duration>0?n+1.5*v.duration:n)>=e.adaptation.period.duration}}else m>=e.availableSegmentsNumber&&(t=!0);return t}function O(e){var t=e.representation;t.segments&&r.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{representation:t},{streamId:d.id,mediaType:l})}function N(e){if(!e.error){var t,n=e.segments,i=e.representation,o=[],s=0,u=void 0,h=void 0,p=void 0;for(u=0,t=n?n.length:0;u<t;u++)h=n[u],(p=(0,Tr.getTimeBasedSegment)(c,_,i,h.startTime,h.duration,h.timescale,h.media,h.mediaRange,s))&&(o.push(p),p=null,s++);if(o.length>0)if(i.segmentAvailabilityRange={start:o[0].presentationStartTime,end:o[o.length-1].presentationStartTime},i.availableSegmentsNumber=o.length,i.segments=o,_)!function(e){c.setExpectedLiveEdge(e),f.updateManifestUpdateInfo({presentationStartTime:e})}(o[o.length-1].presentationStartTime-8);i.hasInitialization()&&r.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{representation:i},{streamId:d.id,mediaType:l})}}function P(){g.debug("Dynamic stream complete"),T=!0}return p={initialize:function(e){_=e,T=!1,b.initialize(e)},getStreamId:function(){return d.id},getType:S,getStreamInfo:function(){return d},getInitRequest:function(e,t){return t?function(e,t,r){var i=new n.default,a=t.adaptation.period,o=a.start;if(i.mediaType=r,i.type=w.HTTPRequest.INIT_SEGMENT_TYPE,i.range=t.range,i.availabilityStartTime=c.calcAvailabilityStartTimeFromPresentationTime(o,a.mpd,_),i.availabilityEndTime=c.calcAvailabilityEndTimeFromPresentationTime(o+a.duration,a.mpd,_),i.quality=t.index,i.mediaInfo=e,i.representationId=t.id,C(i,t.initialization,t))return i.url=(0,Tr.replaceTokenForTemplate)(i.url,"Bandwidth",t.bandwidth),i}(e,t,S()):null},getRequestForSegment:D,getSegmentRequestForTime:function(e,t,r,i){var a=null;if(!t||!t.segmentInfoType)return a;var o=m,u=!!i&&i.keepIdx,d=!(!i||!i.ignoreIsFinished);y!==r&&(y=r,g.debug("Getting the request for time : "+r));var c=b.getSegmentByTime(t,r);return c?(m=c.availabilityIdx,v=c,g.debug("Index for time "+r+" is "+m),a=D(e,c)):!d&&M(t)&&((a=new n.default).action=n.default.ACTION_COMPLETE,a.index=m-1,a.mediaType=l,a.mediaInfo=e,g.debug("Signal complete in getSegmentRequestForTime")),u&&o>=0&&(m=t.segmentInfoType===s.SEGMENT_TIMELINE&&_?m:o),a},getNextSegmentRequest:function(e,t){var r=null;if(!t||!t.segmentInfoType)return null;y=null;var i=m+1;g.debug("Getting the next request at index: "+i);var a=b.getSegmentByIndex(t,i,v?v.mediaStartTime:-1);return a||!function(e){return!isFinite(e.adaptation.period.duration)}(t)||T?(a?(r=D(e,a),m=a.availabilityIdx):m=_?i-1:i,a?v=a:M(t)&&((r=new n.default).action=n.default.ACTION_COMPLETE,r.index=m-1,r.mediaType=S(),r.mediaInfo=e,g.debug("Signal complete")),r):(g.debug(S()+" No segment found at index: "+i+". Wait for next loop"),null)},setCurrentIndex:function(e){m=e},getCurrentIndex:function(){return m},isMediaFinished:M,reset:function(){I(),r.off(a.INITIALIZATION_LOADED,O,p),r.off(a.SEGMENTS_LOADED,N,p),r.off(a.REPRESENTATION_UPDATE_STARTED,R,p),r.off(a.DYNAMIC_TO_STATIC,P,p)},resetIndex:A,setMimeType:function(e){E=e}},g=o.getLogger(p),I(),b=(0,i.default)(t).create(e),r.on(a.INITIALIZATION_LOADED,O,p),r.on(a.SEGMENTS_LOADED,N,p),r.on(a.REPRESENTATION_UPDATE_STARTED,R,p),r.on(a.DYNAMIC_TO_STATIC,P,p),p}o.__dashjs_factory_name="DashHandler",t.default=r.default.getClassFactory(o)});c(Ir);var Cr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}i.__dashjs_factory_name="RequestModifier",t.default=r.default.getSingletonFactory(i)});c(Cr);var Rr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(){var e=void 0,t=/^[a-z][a-z0-9+\-_.]*:/i,n=/^https?:\/\//i,r=/^https:\/\//i,i=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(n){return e}},o=function(e,t){var n=s;if(!t)return e;if(!d(e))return e;c(e)&&(n=u),f(e)&&(n=l);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return[r,e].join(i)};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function u(e){var t=e.match(i);return t?t[1]:""}function l(e){var n=e.match(t);return n?n[0]:""}function d(e){return!t.test(e)}function c(e){return d(e)&&"/"===e.charAt(0)}function f(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y"),e=a}catch(t){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:u,parseScheme:l,isRelative:d,isPathAbsolute:c,isSchemeRelative:f,isHTTPURL:function(e){return n.test(e)},isHTTPS:function(e){return r.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(t,n){return e(t,n)}}}i.__dashjs_factory_name="DefaultURLUtils",t.default=r.default.getSingletonFactory(i)});c(Rr);var Dr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(Rr);function i(e){return e&&e.__esModule?e:{default:e}}function a(){var e=void 0,t=[],n=this.context;function i(n,r,i){var a=function(n){var r=void 0;for(r=0;r<t.length;r++)if(t[r].regex.test(n))return t[r].utils;return e}(i||r);return a&&"function"===typeof a[n]?a[n](r,i):e[n](r,i)}return e=(0,r.default)(n).getInstance(),{registerUrlRegex:function(e,n){t.push({regex:e,utils:n})},parseBaseUrl:function(e){return i("parseBaseUrl",e)},parseOrigin:function(e){return i("parseOrigin",e)},parseScheme:function(e){return i("parseScheme",e)},isRelative:function(e){return i("isRelative",e)},isPathAbsolute:function(e){return i("isPathAbsolute",e)},isSchemeRelative:function(e){return i("isSchemeRelative",e)},isHTTPURL:function(e){return i("isHTTPURL",e)},isHTTPS:function(e){return i("isHTTPS",e)},removeHostname:function(e){return i("removeHostname",e)},resolve:function(e,t){return i("resolve",e,t)}}}a.__dashjs_factory_name="URLUtils";var o=n.default.getSingletonFactory(a);t.default=o});c(Dr);var Mr=f(function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};r.INITIAL_PLAYOUT_START_REASON="initial_playout",r.SEEK_START_REASON="seek",r.RESUME_FROM_PAUSE_START_REASON="resume",r.METRICS_COLLECTION_START_REASON="metrics_collection_start";var i=function e(){n(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};i.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",i.REBUFFERING_REASON="rebuffering",i.USER_REQUEST_STOP_REASON="user_request",i.END_OF_PERIOD_STOP_REASON="end_of_period",i.END_OF_CONTENT_STOP_REASON="end_of_content",i.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",i.FAILURE_STOP_REASON="failure",t.PlayList=r,t.PlayListTrace=i});c(Mr);Mr.PlayList,Mr.PlayListTrace;var Or=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=N(p),r=N(g),i=N(m),a=N(C),o=N(fr),s=N(pr),u=N(mr),l=N(vr),d=N(yr),c=N(v),f=N(T),h=N(b),y=N(Ir),_=N(Un),E=N(R),A=N(S),w=N(Cr),D=N(Dr),M=N(L),O=N(I);function N(e){return e&&e.__esModule?e:{default:e}}function P(e){e=e||{};var t=this.context,c=(0,f.default)(t).getInstance(),p=e.streamInfo,g=e.type,m=e.errHandler,v=e.mimeType,T=e.timelineConverter,b=e.adapter,S=e.manifestModel,I=e.mediaPlayerModel,C=e.fragmentModel,R=e.abrController,N=e.playbackController,P=e.mediaController,L=e.textController,x=e.dashMetrics,F=e.settings,U=e.boxParser,B=void 0,j=void 0,G=void 0,q=void 0,H=void 0,V=void 0,K=void 0,Y=void 0,W=void 0,z=void 0,X=void 0,Q=void 0;function $(){return g}function Z(){H=[],q=null,X=0}function J(e){(e.error||K.setCurrentRepresentation(b.convertDataToRepresentationInfo(e.currentRepresentation)),e.error&&e.error.code!==_.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE)||N.getStreamController().getActiveStreamInfo().id===p.id&&ie()}function ee(e){var t=ue(e.newQuality);K.setCurrentRepresentation(t),x.pushPlayListTraceMetrics(new Date,Mr.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),x.createPlaylistTraceMetrics(t.id,1e3*N.getTime(),N.getPlaybackRate())}function te(e){x.addBufferLevel(g,new Date,1e3*e.bufferLevel);var t=N.getStreamController().getActiveStreamInfo().id;S.getValue().doNotUpdateDVRWindowOnBufferUpdated||p.id!==t||ie()}function ne(e){x.addBufferState(g,e.state,K.getBufferTarget()),e.state!==i.default.BUFFER_EMPTY||N.isSeeking()||x.pushPlayListTraceMetrics(new Date,Mr.PlayListTrace.REBUFFERING_REASON)}function re(e){C.syncExecutedRequestsWithBufferedRange(V.getBuffer().getAllBufferRanges(),p.duration),e.from>N.getTime()&&(X=e.from,Q=!0)}function ie(){var e=p.manifestInfo,t=e.isDynamic,n=T.calcSegmentAvailabilityRange(Y.getCurrentRepresentation(),t);x.addDVRInfo($(),N.getTime(),e,n)}function ae(){return V?V.getBuffer():null}function oe(){return H}function se(){return q}function ue(e){var t=void 0;return void 0!==e?((0,k.checkInteger)(e),t=Y?Y.getRepresentationForQuality(e):null):t=Y?Y.getCurrentRepresentation():null,b.convertDataToRepresentationInfo(t)}function le(e){if(e.sender&&(!b.getIsTextTrack(v)||L.isTextEnabled())&&V&&e.representationId&&!V.appendInitSegment(e.representationId)){var t=z?z.getInitRequest(se(),Y.getCurrentRepresentation()):null;K.processInitRequest(t)}}function de(e){var t=void 0;V.getIsPruningInProgress()||(t=function(e,t){var r=ue(),i=!isNaN(e),a=N.getNormalizedTime(),o=i?e:X,s=!1,u=void 0;if(isNaN(o)||$()===n.default.FRAGMENTED_TEXT&&!L.isTextEnabled())return null;if(V){var l=V.getRangeAt(o),d=V.getRangeAt(a);if((null!==l||null!==d)&&!i&&(!l||d&&d.start!=l.start&&d.end!=l.end)){var c=V.getBuffer().hasDiscontinuitiesAfter(a);c&&$()!==n.default.FRAGMENTED_TEXT&&(C.removeExecutedRequestsAfterTime(d.end),s=!0)}}if(t)o=t.startTime+t.duration/2,u=he(r,o,{timeThreshold:0,ignoreIsFinished:!0});else{var f=i||Q||s;for(u=he(r,f?o:void 0,{keepIdx:!f}),Q=!1;u&&u.action!==O.default.ACTION_COMPLETE&&C.isFragmentLoaded(u);)u=he(r)}return u}(e.seekTarget,e.replacement))&&(K.setSeekTarget(NaN),e.replacement||(isNaN(t.startTime+t.duration)||(X=t.startTime+t.duration),t.delayLoadingTime=(new Date).getTime()+K.getTimeToLoadDelay(),K.setTimeToLoadDelay(0))),K.processMediaRequest(t)}function ce(e){var n=e.chunk,r=n.bytes,i=n.quality,o=ue(i),s=Y&&o?Y.getRepresentationForQuality(o.quality):null,u=b.getEventsFor(o.mediaInfo),l=b.getEventsFor(o,s);if(u&&u.length>0||l&&l.length>0){var d=function(n,r,i,a){try{for(var o={},s=[],u=i.concat(a),l=0,d=u.length;l<d;l++)o[u[l].schemeIdUri+"/"+u[l].value]=u[l];var c=(0,M.default)(t).getInstance().parse(n),f=c.getBoxes("emsg");if(!f||0===f.length)return s;for(var h=c.getBox("sidx"),p=!h||isNaN(h.earliest_presentation_time)||isNaN(h.timescale)?r&&!isNaN(r.mediaStartTime)?r.mediaStartTime:0:h.earliest_presentation_time/h.timescale,g=Math.max(p,0),m=Y.getCurrentRepresentation(),v=0,y=f.length;v<y;v++){var _=b.getEvent(f[v],o,g,m);_&&s.push(_)}return s}catch(e){return[]}}(r,C.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,quality:i,index:n.index})[0],u,l);c.trigger(h.default.INBAND_EVENTS,{events:d},{streamId:p.id})}}function fe(e){X=e.time,K.setSeekTarget(e.time)}function he(e,t,n){var r=null;if(z){var i=Y&&e?Y.getRepresentationForQuality(e.quality):null;r=void 0!==t&&void 0!==n?z.getSegmentRequestForTime(se(),i,t,n):z.getNextSegmentRequest(se(),i)}return r}return B={initialize:function(i,a){z=(0,y.default)(t).create({streamInfo:p,type:g,timelineConverter:T,dashMetrics:x,mediaPlayerModel:I,baseURLController:e.baseURLController,errHandler:m,settings:F,boxParser:U,events:h.default,eventBus:c,errors:_.default,debug:(0,A.default)(t).getInstance(),requestModifier:(0,w.default)(t).getInstance(),dashConstants:r.default,constants:n.default,urlUtils:(0,D.default)(t).getInstance()}),(G=p.manifestInfo.isDynamic)&&(W=(0,d.default)(t).create({timelineConverter:T})),z.initialize(G),R.registerStreamType(g,B),Y=(0,l.default)(t).create({streamInfo:p,type:g,abrController:R,dashMetrics:x,playbackController:N,timelineConverter:T,dashConstants:r.default,events:h.default,eventBus:c,errors:_.default}),(V=function(e){return e?e===n.default.VIDEO||e===n.default.AUDIO?(0,o.default)(t).create({streamInfo:p,type:e,mediaPlayerModel:I,manifestModel:S,fragmentModel:C,errHandler:m,mediaController:P,representationController:Y,adapter:b,textController:L,abrController:R,playbackController:N,settings:F}):(0,s.default)(t).create({streamInfo:p,type:e,mimeType:v,mediaPlayerModel:I,manifestModel:S,fragmentModel:C,errHandler:m,mediaController:P,representationController:Y,adapter:b,textController:L,abrController:R,playbackController:N,settings:F}):(m.error(new E.default(_.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,_.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}(g))&&V.initialize(i),(K=(0,u.default)(t).create({streamInfo:p,type:g,mimeType:v,adapter:b,dashMetrics:x,mediaPlayerModel:I,fragmentModel:C,abrController:R,playbackController:N,textController:L,mediaController:P,bufferController:V,settings:F})).initialize(a),X=0,Q=!1},getStreamId:function(){return p.id},getType:$,isUpdating:function(){return!!Y&&Y.isUpdating()},getBufferController:function(){return V},getFragmentModel:function(){return C},getScheduleController:function(){return K},getRepresentationController:function(){return Y},getRepresentationInfo:ue,getBufferLevel:function(){return V?V.getBufferLevel():0},isBufferingCompleted:function(){return!!V&&V.getIsBufferingCompleted()},createBuffer:function(e){return ae()||V?V.createBuffer(H,e):null},updateStreamInfo:function(e){p=e,F.get().streaming.useAppendWindow&&V.updateAppendWindow()},getStreamInfo:function(){return p},selectMediaInfo:function(e){e===q||e&&q&&e.type!==q.type||(q=e);var t=b.getRealAdaptation(p,q),r=b.getVoRepresentations(q);if(Y){var i=Y.getData(),a=R.getTopQualityIndexFor(g,p.id),o=R.getMinAllowedIndexFor(g),s=void 0,u=null;null!==i&&i.id==t.id||g===n.default.FRAGMENTED_TEXT?s=R.getQualityFor(g):(u=R.getThroughputHistory().getAverageThroughput(g)||R.getInitialBitrateFor(g),s=R.getQualityForBitrate(q,u)),void 0!==o&&s<o&&(s=o),s>a&&(s=a),z.setMimeType(q?q.mimeType:null),Y.updateData(t,r,g,s)}},addMediaInfo:function(e,t){-1===H.indexOf(e)&&H.push(e),t&&this.selectMediaInfo(e)},getLiveStartTime:function(){if(!G)return NaN;if(!W)return NaN;var e=NaN,t=ue(),n=W.getLiveEdge(t);if(isNaN(n))return NaN;var r=function(e,t){try{var n=null,r=N.getLiveDelay(),i=isNaN(p.manifestInfo.DVRWindowSize)?r:p.manifestInfo.DVRWindowSize,a=.1*i,o=void 0;if(!isFinite(i)||he(t,e-i+a,{ignoreIsFinished:!0}))for(;!n&&r<=i;)(n=he(t,o=e-r,{ignoreIsFinished:!0}))||(r+=1);return n&&N.setLiveDelay(r,!0),j.debug("live edge: "+e+", live delay: "+r+", live target: "+o),n}catch(s){return null}}(n,t);return r&&(e=F.get().streaming.lowLatencyEnabled?r.duration<I.getLiveDelay()?r.startTime:r.startTime+r.duration-I.getLiveDelay():r.startTime),e},switchTrackAsked:function(){K.switchTrackAsked()},getMediaInfoArr:oe,getMediaInfo:se,getMediaSource:function(){return V.getMediaSource()},setMediaSource:function(e){V.setMediaSource(e,oe())},dischargePreBuffer:function(){V.dischargePreBuffer()},getBuffer:ae,setBuffer:function(e){V.setBuffer(e)},setBufferingTime:function(e){X=e},resetIndexHandler:function(){z&&z.resetIndex()},getInitRequest:function(e){(0,k.checkInteger)(e);var t=Y?Y.getRepresentationForQuality(e):null;return z?z.getInitRequest(se(),t):null},getFragmentRequest:he,finalisePlayList:function(e,t){x.pushPlayListTraceMetrics(e,t)},reset:function(e,t){z&&z.reset(),V&&(V.reset(e,t),V=null),K&&(K.reset(),K=null),Y&&(Y.reset(),Y=null),W&&(W.reset(),W=null),R&&R.unRegisterStreamType(g),c.off(h.default.DATA_UPDATE_COMPLETED,J,B),c.off(h.default.QUALITY_CHANGE_REQUESTED,ee,B),c.off(h.default.INIT_FRAGMENT_NEEDED,le,B),c.off(h.default.MEDIA_FRAGMENT_NEEDED,de,B),c.off(h.default.MEDIA_FRAGMENT_LOADED,ce,B),c.off(h.default.BUFFER_LEVEL_UPDATED,te,B),c.off(h.default.BUFFER_LEVEL_STATE_CHANGED,ne,B),c.off(h.default.BUFFER_CLEARED,re,B),c.off(h.default.SEEK_TARGET,fe,B),Z(),g=null,p=null}},j=(0,A.default)(t).getInstance().getLogger(B),Z(),c.on(h.default.DATA_UPDATE_COMPLETED,J,B,{priority:f.default.EVENT_PRIORITY_HIGH}),c.on(h.default.QUALITY_CHANGE_REQUESTED,ee,B),c.on(h.default.INIT_FRAGMENT_NEEDED,le,B),c.on(h.default.MEDIA_FRAGMENT_NEEDED,de,B),c.on(h.default.MEDIA_FRAGMENT_LOADED,ce,B),c.on(h.default.BUFFER_LEVEL_UPDATED,te,B),c.on(h.default.BUFFER_LEVEL_STATE_CHANGED,ne,B),c.on(h.default.BUFFER_CLEARED,re,B),c.on(h.default.SEEK_TARGET,fe,B),B}P.__dashjs_factory_name="StreamProcessor",t.default=c.default.getClassFactory(P)});c(Or);var Nr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null}});c(Nr);var Pr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(e){var t=(e=e||{}).requestModifier;return{load:function(e){var n=new Date,r=e.request,i=new XMLHttpRequest;i.open(e.method,e.url,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=n),t&&(i=t.modifyRequestHeader(i)),i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.ontimeout=e.ontimeout,i.timeout=e.timeout,i.send(),e.response=i},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}i.__dashjs_factory_name="XHRLoader";var a=r.default.getClassFactory(i);t.default=a});c(Pr);var Lr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"mixin",value:function(t,r,i){var a=void 0,o={};if(t)for(var s in r)r.hasOwnProperty(s)&&(a=r[s],s in t&&(t[s]===a||s in o&&o[s]===a)||("object"===n(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],a,i):t[s]=i(a)));return t}},{key:"clone",value:function(t){if(!t||"object"!==("undefined"===typeof t?"undefined":n(t)))return t;var r=void 0;if(t instanceof Array){r=[];for(var i=0,a=t.length;i<a;++i)i in t&&r.push(e.clone(t[i]))}else r={};return e.mixin(r,t,e.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var n=new URL(e);return t.forEach(function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value)}),n.href}catch(r){return e}}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}}]),e}();t.default=i});c(Lr);var kr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=s(v),i=s(Lr),a=s(S),o=s(p);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(){var e,t,r={debug:{logLevel:a.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{metricsMaxListDepth:1e3,abandonLoadTimeout:1e4,liveDelayFragmentCount:NaN,liveDelay:null,scheduleWhilePaused:!0,fastSwitchEnabled:!1,flushBufferAtTrackSwitch:!1,calcSegmentAvailabilityRangeFromTimeline:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,stableBufferTime:12,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,longFormContentDurationThreshold:600,wallclockTimeUpdateInterval:50,lowLatencyEnabled:!1,keepProtectionMediaKeys:!1,useManifestDateHeaderTimeSource:!0,useSuggestedPresentationDelay:!0,useAppendWindow:!0,manifestUpdateRetryInterval:100,stallThreshold:.5,liveCatchup:{minDrift:.02,maxDrift:0,playbackRate:.5,latencyThreshold:60,playbackBufferMin:.5,enabled:!1,mode:o.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:o.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:o.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:o.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE,fragmentRequestTimeout:0,retryIntervals:(e={},u(e,w.HTTPRequest.MPD_TYPE,500),u(e,w.HTTPRequest.XLINK_EXPANSION_TYPE,500),u(e,w.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),u(e,w.HTTPRequest.INIT_SEGMENT_TYPE,1e3),u(e,w.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),u(e,w.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),u(e,w.HTTPRequest.OTHER_TYPE,1e3),u(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},u(t,w.HTTPRequest.MPD_TYPE,3),u(t,w.HTTPRequest.XLINK_EXPANSION_TYPE,1),u(t,w.HTTPRequest.MEDIA_SEGMENT_TYPE,3),u(t,w.HTTPRequest.INIT_SEGMENT_TYPE,3),u(t,w.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),u(t,w.HTTPRequest.INDEX_SEGMENT_TYPE,3),u(t,w.HTTPRequest.OTHER_TYPE,3),u(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:o.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:o.default.ABR_STRATEGY_DYNAMIC,bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:o.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA},cmcd:{enabled:!1,sid:null,cid:null}}},s=i.default.clone(r);return{get:function(){return s},update:function(e){"object"===("undefined"===typeof e?"undefined":n(e))&&function e(t,r,a){for(var o in t)t.hasOwnProperty(o)&&r.hasOwnProperty(o)&&("object"===n(t[o])&&null!==t[o]?e(t[o],r[o],a.slice()+o+"."):r[o]=i.default.clone(t[o]))}(e,s,"")},reset:function(){s=i.default.clone(r)}}}l.__dashjs_factory_name="Settings";var d=r.default.getSingletonFactory(l);t.default=d});c(kr);var xr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(v),r=a(kr),i=a(p);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=this.context,n=e.requestModifier,a=e.boxParser,o=(0,r.default)(t).getInstance();function s(e,t){e.reader.read().then(t).catch(function(t){e.onerror&&200===e.response.status&&e.onerror(t)})}function u(e,t,n,r,a){switch(e){case i.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING:return function(e,t){try{var n=void 0,r=void 0;n=e.filter(function(t,n){return n>0&&n<e.length-1}),r=t.filter(function(e,n){return n>0&&n<t.length-1});var i=0;if(n.length>1){for(var a=0;a<n.length;a++)if(n[a]&&r[a]){var o=r[a].ts-n[a].ts;i+=o}return i}return null}catch(s){return null}}(t,n);case i.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA:default:return l(r,a)}}function l(e,t){try{if((e=e.filter(function(n){return n.bytes>t/4/e.length})).length>1){var n=0,r=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach(function(t,i){var a=e[i+1];if(a){var o=a.ts-t.ts;n+=o<r?o:0}}),n}return null}catch(i){return null}}return{load:function(e){var t=new Date,r=e.request,l=new Headers;r.range&&l.append("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=t),n&&n.modifyRequestHeader({setRequestHeader:function(e,t){l.append(e,t)}});var d=void 0;"function"===typeof window.AbortController&&(d=new AbortController,e.abortController=d,d.signal.onabort=e.onabort);var c={method:e.method,headers:l,credentials:e.withCredentials?"include":void 0,signal:d?d.signal:void 0};fetch(e.url,c).then(function(t){e.response||(e.response={}),e.response.status=t.status,e.response.statusText=t.statusText,e.response.responseURL=t.url,t.ok||e.onerror();var n="",r=!0,l=!1,d=void 0;try{for(var c,f=t.headers.keys()[Symbol.iterator]();!(r=(c=f.next()).done);r=!0){var h=c.value;n+=h+": "+t.headers.get(h)+"\r\n"}}catch(A){l=!0,d=A}finally{try{!r&&f.return&&f.return()}finally{if(l)throw d}}if(e.response.responseHeaders=n,!t.body)return t.arrayBuffer().then(function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()});var p=parseInt(t.headers.get("Content-Length"),10),g=0,m=!1,v=new Uint8Array,y=0;e.reader=t.body.getReader();var _=[],T=[],E=[],b=!0,S=o.get().streaming.abr.fetchThroughputCalculationMode;s(e,function t(n){var r=n.value;if(n.done)return v&&(e.progress({loaded:g,total:isNaN(p)?g:p,lengthComputable:!0,time:u(S,T,E,_,g),stream:!0}),e.response.response=v.buffer),e.onload(),void e.onend();if(r&&r.length>0){v=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(v,r),g+=r.length,_.push({ts:Date.now(),bytes:r.length}),S===i.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&b&&a.findLastTopIsoBoxCompleted(["moof"],v,y).found&&(b=!1,T.push({ts:performance.now(),bytes:r.length}));var o=a.findLastTopIsoBoxCompleted(["moov","mdat"],v,y);if(o.found){var l=o.lastCompletedOffset+o.size;S===i.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&(b=!0,E.push({ts:performance.now(),bytes:v.length}));var d=void 0;l===v.length?(d=v,v=new Uint8Array):(d=new Uint8Array(v.subarray(0,l)),v=v.subarray(l)),e.progress({data:d.buffer,lengthComputable:!1,noTrace:!0}),y=0}else y=o.lastCompletedOffset,m||(e.progress({lengthComputable:!1,noTrace:!0}),m=!0)}s(e,t)})}).catch(function(t){e.onerror&&e.onerror(t)})},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(t){}},calculateDownloadedTime:u}}o.__dashjs_factory_name="FetchLoader";var s=n.default.getClassFactory(o);t.default=s});c(xr);var Fr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=y)&&n.__esModule?n:{default:n};var i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}());t.default=i});c(Fr);var Ur=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(n=g)&&n.__esModule?n:{default:n};var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return r(e,[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==i.default.BASE_URL&&this.segmentInfoType!==i.default.SEGMENT_BASE&&!this.indexRange}}]),e}();t.default=a});c(Ur);var Br=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null}});c(Br);var jr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};n.DEFAULT_ID="defaultId",t.default=n});c(jr);var Gr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN}});c(Gr);var qr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}});c(qr);var Hr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN}});c(Hr);var Vr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};n.DEFAULT_DVB_PRIORITY=1,n.DEFAULT_DVB_WEIGHT=1,t.default=n});c(Vr);var Kr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0}});c(Kr);var Yr=Array.isArray,Wr=Object.keys,zr=Object.prototype.hasOwnProperty,Xr=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var r,i,a,o=Yr(t),s=Yr(n);if(o&&s){if((i=t.length)!=n.length)return!1;for(r=i;0!==r--;)if(!e(t[r],n[r]))return!1;return!0}if(o!=s)return!1;var u=t instanceof Date,l=n instanceof Date;if(u!=l)return!1;if(u&&l)return t.getTime()==n.getTime();var d=t instanceof RegExp,c=n instanceof RegExp;if(d!=c)return!1;if(d&&c)return t.toString()==n.toString();var f=Wr(t);if((i=f.length)!==Wr(n).length)return!1;for(r=i;0!==r--;)if(!zr.call(n,f[r]))return!1;for(r=i;0!==r--;)if(!e(t[a=f[r]],n[a]))return!1;return!0}return t!==t&&n!==n},Qr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(Xr);function i(e){return e&&e.__esModule?e:{default:e}}function a(){return{areEqual:function(e,t){return(0,r.default)(e,t)}}}a.__dashjs_factory_name="ObjectUtils",t.default=n.default.getSingletonFactory(a)});c(Qr);var $r=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}});c($r);var Zr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.THUMBNAILS_SCHEME_ID_URIS=void 0;var n=c(p),r=c(g),i=c(v),a=c($r),o=c(Dr),s=c(b),u=c(L),l=c(Pr),d=c(Ir);function c(e){return e&&e.__esModule?e:{default:e}}var f=t.THUMBNAILS_SCHEME_ID_URIS=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function h(e){var t,i=this.context,c=e.adapter,h=e.baseURLController,p=e.streamInfo,g=e.timelineConverter,m=e.debug,v=e.eventBus,y=e.events,_=e.dashConstants,T=(0,o.default)(i).getInstance(),E=void 0,b=void 0,S=void 0,A=void 0,w=void 0,I=void 0;function C(){D(),w=(0,l.default)(i).create({}),I=(0,u.default)(i).getInstance(),(b=(0,d.default)(i).create({streamInfo:p,timelineConverter:g,baseURLController:h,debug:m,eventBus:v,events:y,dashConstants:_,urlUtils:T})).initialize(!!c&&c.getIsDynamic()),function(){if(!p||!c)return;if(!(A=c.getMediaInfoForType(p,n.default.IMAGE)))return;var e=c.getVoRepresentations(A);e&&e.length>0&&e.forEach(function(e){(e.segmentInfoType===r.default.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===r.default.SEGMENT_TIMELINE)&&R(e),e.segmentInfoType===r.default.SEGMENT_BASE&&R(e,!0)});E.length>0&&(E.sort(function(e,t){return e.bitrate-t.bitrate}),S=E.length-1)}()}function R(e,t){var r=new a.default;r.id=e.id,r.bitrate=e.bandwidth,r.width=e.width,r.height=e.height,r.tilesHor=1,r.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach(function(e){if(f.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(r.tilesHor=parseInt(t[0],10),r.tilesVert=parseInt(t[1],10))}}),t?v.trigger(s.default.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{streamId:p.id,mediaType:n.default.IMAGE,mimeType:A.mimeType,representation:e,callback:function(e,t,n,i){var a=[];n=function(e,t){var n,r=[],i=0,a=void 0,o=void 0,s=void 0;for(a=0,n=e.length;a<n;a++)o=e[a],(s=(0,Tr.getTimeBasedSegment)(g,c.getIsDynamic(),t,o.startTime,o.duration,o.timescale,o.media,o.mediaRange,i))&&(r.push(s),s=null,i++);return r}(n,i),r.segmentDuration=n[0].duration,r.readThumbnail=function(e,t){var r=null;a.some(function(t){if(t.start<=e&&t.end>e)return r=t.url,!0}),r?t(r):n.some(function(n){if(n.mediaStartTime<=e&&n.mediaStartTime+n.duration>e){var r=h.resolve(i.path);return w.load({method:"get",url:r.url,request:{range:n.mediaRange,responseType:"arraybuffer"},onload:function(e){var r=I.getSamplesInfo(e.target.response),i=new Blob([e.target.response.slice(r.sampleList[0].offset,r.sampleList[0].offset+r.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(i);a.push({start:n.mediaStartTime,end:n.mediaStartTime+n.duration,url:o}),t&&t(o)}}),!0}})}}}):(r.startNumber=e.startNumber,r.segmentDuration=e.segmentDuration,r.timescale=e.timescale,r.templateUrl=function(e){var t=T.isRelative(e.media)?T.resolve(e.media,h.resolve(e.path).url):e.media;if(!t)return"";return(0,Tr.replaceIDForTemplate)(t,e.id)}(e)),r.tilesHor>0&&r.tilesVert>0&&(r.widthPerTile=r.width/r.tilesHor,r.heightPerTile=r.height/r.tilesVert,E.push(r))}function D(){E=[],S=-1,A=null}return t={initialize:C,getTracks:function(){return E},reset:D,setTrackByIndex:function(e){E&&0!==E.length&&(e>=E.length&&(e=E.length-1),S=e)},getCurrentTrack:function(){return S<0?null:E[S]},getCurrentTrackIndex:function(){return S},getThumbnailRequestForTime:function(e){for(var t=void 0,n=c.getVoRepresentations(A),r=0;r<n.length;r++)if(E[S].id===n[r].id){t=n[r];break}return b.getSegmentRequestForTime(A,t,e)}},C(),t}h.__dashjs_factory_name="ThumbnailTracks",t.default=i.default.getClassFactory(h)});c(Zr);Zr.THUMBNAILS_SCHEME_ID_URIS;var Jr=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=E(p),r=E(g),i=E(Ur),a=E(Br),o=E(jr),s=E(Gr),u=E(qr),l=E(Hr),d=E(Vr),c=E(Kr),f=E(Qr),h=E(Dr),m=E(v),y=E(S),_=E(R),T=E(Un);function E(e){return e&&e.__esModule?e:{default:e}}function b(){var e=void 0,t=void 0,p=void 0,g=void 0,m=this.context,v=(0,h.default)(m).getInstance(),E=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e};function b(e,t){var i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=!1,c=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(s=e.ContentComponent_asArray),u=t!==n.default.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0){var f=N(e.Representation_asArray[0]);if(f&&f.length>0&&Zr.THUMBNAILS_SCHEME_ID_URIS.indexOf(f[0].schemeIdUri)>=0)return t===n.default.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(r.default.CODECS)&&(0===(l=e.Representation_asArray[0].codecs).search(n.default.STPP)||0===l.search(n.default.WVTT)))return t===n.default.FRAGMENTED_TEXT}if(s){if(s.length>1)return t===n.default.MUXED;s[0]&&s[0].contentType===t&&(d=!0,c=!0)}if(e.hasOwnProperty(r.default.MIME_TYPE)&&(d=u.test(e.mimeType),c=!0),!c)for(i=0,a=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!c&&i<a;)(o=e.Representation_asArray[i]).hasOwnProperty(r.default.MIME_TYPE)&&(d=u.test(o.mimeType),c=!0),i++;return d}function S(e){return b(e,n.default.AUDIO)}function A(e){return b(e,n.default.VIDEO)}function w(e){return b(e,n.default.FRAGMENTED_TEXT)}function I(e){return b(e,n.default.IMAGE)}function C(e){return"text/vtt"===e||"application/ttml+xml"===e}function R(){return function(e,t){return e.bandwidth-t.bandwidth}}function D(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e}function M(e,t){return e&&e.Period_asArray&&E(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function O(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===r.default.DYNAMIC),t}function N(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}}):null}function P(e){var t=e.S_asArray[0],n=e.S_asArray[1];return t.hasOwnProperty("d")?t.d:n.t-t.t}function L(e){var t=e.presentationTimeOffset;return e.adaptation.period.start-t}function k(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=o.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(r.default.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function x(e,t){var i=[],a=void 0;if(!e)return i;for(a=0;a<e.length;a++){var o=new c.default;if(o.timescale=1,o.representation=t,!e[a].hasOwnProperty(n.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=e[a].schemeIdUri,e[a].hasOwnProperty(r.default.TIMESCALE)&&(o.timescale=e[a].timescale),e[a].hasOwnProperty(r.default.VALUE)&&(o.value=e[a].value),i.push(o)}return i}function F(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],i=!1;return n.some(function(n){if(n){var a=new d.default,o=n.__text||n;return v.isRelative(o)&&(i=!0,e.baseUri&&(o=v.resolve(o,e.baseUri))),a.url=o,n.hasOwnProperty(r.default.SERVICE_LOCATION)&&n.serviceLocation.length?a.serviceLocation=n.serviceLocation:a.serviceLocation=o,n.hasOwnProperty(r.default.DVB_PRIORITY)&&(a.dvb_priority=n[r.default.DVB_PRIORITY]),n.hasOwnProperty(r.default.DVB_WEIGHT)&&(a.dvb_weight=n[r.default.DVB_WEIGHT]),n.hasOwnProperty(r.default.AVAILABILITY_TIME_OFFSET)&&(a.availabilityTimeOffset=n[r.default.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(r.default.AVAILABILITY_TIME_COMPLETE)&&(a.availabilityTimeComplete="false"!==n[r.default.AVAILABILITY_TIME_COMPLETE]),t.push(a),i}}),t}return e={getIsTypeOf:b,getIsTextTrack:C,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(r.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(r.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var r=M(t,n);return r.length>0&&E(e)?r[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return-1;for(var r=M(t,n),i=0;i<r.length;i++)if((0,f.default)(m).getInstance().areEqual(r[i],e))return i;return-1},getAdaptationForId:function(e,t,n){var i,a=M(t,n),o=void 0;for(o=0,i=a.length;o<i;o++)if(a[o].hasOwnProperty(r.default.ID)&&a[o].id===e)return a[o];return null},getAdaptationsForType:function(e,t,n){var r,i=M(e,t),a=void 0,o=[];for(a=0,r=i.length;a<r;a++)b(i[a],n)&&o.push(D(i[a]));return o},getCodec:function(e,t,n){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=E(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'))}return r&&(r=r.replace(/\sprofiles=[^;]*/g,"")),r},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(r.default.CENC_DEFAULT_KID)?e[r.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(r.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:O,hasProfile:function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(r.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(r.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=D(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map(function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}})},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&E(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t=[],n=function(e){if(e&&e.period&&E(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&E(e.index))return D(t.AdaptationSet_asArray[e.index])}}(e),a=void 0,o=void 0;if(n&&n.Representation_asArray){if(e&&e.period&&E(e.period.index)){var s=F(e.period.mpd.manifest);s&&(o=s[0])}for(var u=0,l=n.Representation_asArray.length;u<l;++u){var d=n.Representation_asArray[u],c=new i.default;if(c.index=u,c.adaptation=e,d.hasOwnProperty(r.default.ID)&&(c.id=d.id),d.hasOwnProperty(r.default.CODECS)&&(c.codecs=d.codecs),d.hasOwnProperty(r.default.CODEC_PRIVATE_DATA)&&(c.codecPrivateData=d.codecPrivateData),d.hasOwnProperty(r.default.BANDWITH)&&(c.bandwidth=d.bandwidth),d.hasOwnProperty(r.default.WIDTH)&&(c.width=d.width),d.hasOwnProperty(r.default.HEIGHT)&&(c.height=d.height),d.hasOwnProperty(r.default.SCAN_TYPE)&&(c.scanType=d.scanType),d.hasOwnProperty(r.default.MAX_PLAYOUT_RATE)&&(c.maxPlayoutRate=d.maxPlayoutRate),d.hasOwnProperty(r.default.SEGMENT_BASE)?(a=d.SegmentBase,c.segmentInfoType=r.default.SEGMENT_BASE):d.hasOwnProperty(r.default.SEGMENT_LIST)?(a=d.SegmentList).hasOwnProperty(r.default.SEGMENT_TIMELINE)?c.segmentInfoType=r.default.SEGMENT_TIMELINE:c.segmentInfoType=r.default.SEGMENT_LIST:d.hasOwnProperty(r.default.SEGMENT_TEMPLATE)?((a=d.SegmentTemplate).hasOwnProperty(r.default.SEGMENT_TIMELINE)?c.segmentInfoType=r.default.SEGMENT_TIMELINE:c.segmentInfoType=r.default.SEGMENT_TEMPLATE,a.hasOwnProperty(r.default.INITIALIZATION_MINUS)&&(c.initialization=a.initialization.split("$Bandwidth$").join(d.bandwidth).split("$RepresentationID$").join(d.id))):c.segmentInfoType=r.default.BASE_URL,c.essentialProperties=N(d),a){if(a.hasOwnProperty(r.default.INITIALIZATION)){var f=a.Initialization;f.hasOwnProperty(r.default.SOURCE_URL)&&(c.initialization=f.sourceURL),f.hasOwnProperty(r.default.RANGE)&&(c.range=f.range)}else d.hasOwnProperty(r.default.MIME_TYPE)&&C(d.mimeType)&&(c.range=0);a.hasOwnProperty(r.default.TIMESCALE)&&(c.timescale=a.timescale),a.hasOwnProperty(r.default.DURATION)?c.segmentDuration=a.duration/c.timescale:d.hasOwnProperty(r.default.SEGMENT_TEMPLATE)&&(a=d.SegmentTemplate).hasOwnProperty(r.default.SEGMENT_TIMELINE)&&(c.segmentDuration=P(a.SegmentTimeline)/c.timescale),a.hasOwnProperty(r.default.MEDIA)&&(c.media=a.media),a.hasOwnProperty(r.default.START_NUMBER)&&(c.startNumber=a.startNumber),a.hasOwnProperty(r.default.INDEX_RANGE)&&(c.indexRange=a.indexRange),a.hasOwnProperty(r.default.PRESENTATION_TIME_OFFSET)&&(c.presentationTimeOffset=a.presentationTimeOffset/c.timescale),a.hasOwnProperty(r.default.AVAILABILITY_TIME_OFFSET)?c.availabilityTimeOffset=a.availabilityTimeOffset:o&&void 0!==o.availabilityTimeOffset&&(c.availabilityTimeOffset=o.availabilityTimeOffset),a.hasOwnProperty(r.default.AVAILABILITY_TIME_COMPLETE)?c.availabilityTimeComplete="false"!==a.availabilityTimeComplete:o&&void 0!==o.availabilityTimeComplete&&(c.availabilityTimeComplete=o.availabilityTimeComplete)}c.MSETimeOffset=L(c),c.path=[e.period.index,e.index,u],t.push(c)}}return t},getAdaptationsForPeriod:function(e){var t=e&&E(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,i=[],o=void 0,s=void 0,u=void 0;if(t&&t.AdaptationSet_asArray)for(u=0;u<t.AdaptationSet_asArray.length;u++)s=t.AdaptationSet_asArray[u],o=new a.default,s.hasOwnProperty(r.default.ID)&&(o.id=s.id),o.index=u,o.period=e,b(s,n.default.MUXED)?o.type=n.default.MUXED:S(s)?o.type=n.default.AUDIO:A(s)?o.type=n.default.VIDEO:w(s)?o.type=n.default.FRAGMENTED_TEXT:I(s)?o.type=n.default.IMAGE:o.type=n.default.TEXT,i.push(o);return i},getRegularPeriods:function(e){var i,a=!!e&&O(e.manifest),s=[],u=null,l=null,d=null,c=null,f=void 0;for(f=0,i=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;f<i;f++)(l=e.manifest.Period_asArray[f]).hasOwnProperty(r.default.START)?(c=new o.default).start=l.start:null!==u&&u.hasOwnProperty(r.default.DURATION)&&null!==d?(c=new o.default).start=parseFloat((d.start+d.duration).toFixed(5)):0!==f||a||((c=new o.default).start=0),null!==d&&isNaN(d.duration)&&(null!==c?d.duration=parseFloat((c.start-d.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==c&&(c.id=k(l,f),c.index=f,c.mpd=e,l.hasOwnProperty(r.default.DURATION)&&(c.duration=l.duration),s.push(c),u=l,d=c),l=null,c=null;return 0===s.length?s:(null!==d&&isNaN(d.duration)&&(d.duration=parseFloat((function(e){!function(){if(!p||!p.hasOwnProperty("error"))throw new Error(n.default.MISSING_CONFIG_ERROR)}();var t=O(e.mpd.manifest),r=void 0;return e.mpd.manifest.mediaPresentationDuration?r=e.mpd.manifest.mediaPresentationDuration:e.duration?r=e.duration:t?r=Number.POSITIVE_INFINITY:p.error(new _.default(T.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),r}(d)-d.start).toFixed(5))),s)},getMpd:function(e){var t=new s.default;return e&&(t.manifest=e,e.hasOwnProperty(r.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(r.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(r.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(r.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(r.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(r.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(r.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration)),t},getEventsForPeriod:function(e){var t=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,i=t?t.Period_asArray:null,a=i&&e&&E(e.index)?i[e.index].EventStream_asArray:null,o=[],s=void 0,u=void 0;if(a)for(s=0;s<a.length;s++){var d=new c.default;if(d.period=e,d.timescale=1,!a[s].hasOwnProperty(n.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(d.schemeIdUri=a[s][n.default.SCHEME_ID_URI],a[s].hasOwnProperty(r.default.TIMESCALE)&&(d.timescale=a[s][r.default.TIMESCALE]),a[s].hasOwnProperty(r.default.VALUE)&&(d.value=a[s][r.default.VALUE]),a[s].hasOwnProperty(r.default.PRESENTATION_TIME_OFFSET)&&(d.presentationTimeOffset=a[s][r.default.PRESENTATION_TIME_OFFSET]),u=0;a[s].Event_asArray&&u<a[s].Event_asArray.length;u++){var f=a[s].Event_asArray[u],h=new l.default;if(h.presentationTime=0,h.eventStream=d,f.hasOwnProperty(r.default.PRESENTATION_TIME)){h.presentationTime=f.presentationTime;var p=d.presentationTimeOffset?d.presentationTimeOffset/d.timescale:0;h.calculatedPresentationTime=h.presentationTime/d.timescale+e.start-p}f.hasOwnProperty(r.default.DURATION)&&(h.duration=f.duration/d.timescale),f.hasOwnProperty(r.default.ID)&&(h.id=f.id),f.Signal&&f.Signal.Binary?h.messageData=g.decodeArray(f.Signal.Binary.toString()):h.messageData=f.messageData||f.__text,o.push(h)}}return o},getEventStreamForAdaptationSet:function(e,t){var n=void 0,r=void 0,i=void 0;return e&&e.Period_asArray&&t&&t.period&&E(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&E(t.index)&&(i=r.AdaptationSet_asArray[t.index])&&(n=i.InbandEventStream_asArray),x(n,null)},getEventStreamForRepresentation:function(e,t){var n=void 0,r=void 0,i=void 0,a=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&E(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&E(t.adaptation.index)&&(i=r.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&E(t.index)&&(a=i.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),x(n,t)},getUTCTimingSources:function(e){var t=O(e),i=!!e&&e.hasOwnProperty(r.default.AVAILABILITY_START_TIME),a=e?e.UTCTiming_asArray:null,o=[];return(t||i)&&a&&a.forEach(function(e){var t=new u.default;e.hasOwnProperty(n.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(r.default.VALUE)&&(t.value=e.value.toString(),o.push(t)))}),o},getBaseURLsFromElement:F,getRepresentationSortFunction:R,getLocation:function(e){if(e&&e.hasOwnProperty(n.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(r.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(r.default.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(r.default.SERVICE_DESCRIPTION)){var i=!0,a=!1,o=void 0;try{for(var s,u=e.ServiceDescription_asArray[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,d=void 0,c=void 0,f=void 0,h=void 0;for(var p in l)l.hasOwnProperty(p)&&(p===r.default.ID?d=l[p]:p===r.default.SERVICE_DESCRIPTION_SCOPE?c=l[p].schemeIdUri:p===r.default.SERVICE_DESCRIPTION_LATENCY?f={target:l[p].target,max:l[p].max,min:l[p].min}:p===r.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(h={max:l[p].max,min:l[p].min}));c===n.default.SERVICE_DESCRIPTION_LL_SCHEME&&(f||h)&&t.push({id:d,schemeIdUri:c,latency:f,playbackRate:h})}}catch(g){a=!0,o=g}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}}return t},getSupplementalPropperties:function(e){var t={};if(e&&e.hasOwnProperty(r.default.SUPPLEMENTAL_PROPERTY)){var i=!0,a=!1,o=void 0;try{for(var s,u=e.SupplementalProperty_asArray[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.hasOwnProperty(n.default.SCHEME_ID_URI)&&l.hasOwnProperty(r.default.VALUE)&&(t[l[n.default.SCHEME_ID_URI]]=l[r.default.VALUE])}}catch(d){a=!0,o=d}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}}return t},setConfig:function(e){e&&(e.errHandler&&(p=e.errHandler),e.BASE64&&(g=e.BASE64))}},t=(0,y.default)(m).getInstance().getLogger(e),e}b.__dashjs_factory_name="DashManifestModel",t.default=m.default.getSingletonFactory(b)});c(Jr);var ei=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=d(T),r=d(_),i=d(Fr),a=d(v),o=d(S),s=d(kr),u=d(Jr),l=d(Lr);function d(e){return e&&e.__esModule?e:{default:e}}var c="CMCD",f=1,h={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o"},p={DASH:"d",MSS:"s"},g={VOD:"v",LIVE:"l"};function m(){var e=void 0,t=void 0,a=void 0,d=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=this.context,E=(0,n.default)(T).getInstance(),b=(0,s.default)(T).getInstance();function S(){a={pr:1,nor:null,st:null,sf:null,sid:""+l.default.generateUuid(),cid:null},y={},v={},_={}}function A(){var e={},t=b.get().streaming.cmcd.cid?b.get().streaming.cmcd.cid:a.cid;return e.v=f,e.sid=b.get().streaming.cmcd.sid?b.get().streaming.cmcd.sid:a.sid,e.sid=""+e.sid,t&&(e.cid=""+t),isNaN(a.pr)||1===a.pr||null===a.pr||(e.pr=a.pr),a.st&&(e.st=a.st),a.sf&&(e.sf=a.sf),e}function I(e){try{a.pr=e.playbackRate}catch(t){}}function C(t){try{var n=e.getIsDynamic(t.data)?""+g.LIVE:""+g.VOD,r=t.protocol&&"MSS"===t.protocol?""+p.MSS:""+p.DASH;a.st=""+n,a.sf=""+r}catch(i){}}function R(e){try{e.state&&e.mediaType&&e.state===r.default.BUFFER_EMPTY&&(y[e.mediaType]||(y[e.mediaType]=!0),v[e.mediaType]||(v[e.mediaType]=!0))}catch(t){}}function D(){for(var e in y)y.hasOwnProperty(e)&&(y[e]=!0);for(var t in v)v.hasOwnProperty(t)&&(v[t]=!0)}return t={getQueryParameter:function(e){try{if(b.get().streaming.cmcd&&b.get().streaming.cmcd.enabled){var t=function(e){try{return e.type===w.HTTPRequest.MPD_TYPE?function(){var e=A();return e.ot=""+h.MANIFEST,e}():e.type===w.HTTPRequest.MEDIA_SEGMENT_TYPE?(t=e.mediaType,_.hasOwnProperty(t)||(_[t]=!1),v.hasOwnProperty(t)||(v[t]=!1),y.hasOwnProperty(t)||(y[t]=!1),function(e){var t=A(),n=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(r){return null}}(e),r=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration)}catch(t){return null}}(e),i="video"===e.mediaType?""+h.VIDEO:"audio"===e.mediaType?""+h.AUDIO:"fragmentedText"===e.mediaType?""+h.CAPTION:null,o=function(e){try{return 100*parseInt(d.getThroughputHistory().getSafeAverageThroughput(e)/100)}catch(t){return null}}(e.mediaType),s=function(e){try{var t=a.pr,n=m.getCurrentBufferLevel(e);return isNaN(t)||isNaN(n)?null:100*parseInt(n/t*10)}catch(r){return null}}(e.mediaType),u=function(e){try{var t=m.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t)}catch(n){return null}}(e.mediaType),l=function(e){try{var t=d.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3)}catch(n){return null}}(e.mediaType),c=a.pr;return n&&(t.br=n),i&&(t.ot=i),isNaN(r)||(t.d=r),isNaN(o)||(t.mtp=o),isNaN(s)||(t.dl=s),isNaN(u)||(t.bl=u),isNaN(l)||(t.tb=l),isNaN(c)||1===c||(t.pr=c),y[e.mediaType]&&(t.bs=!0,y[e.mediaType]=!1),!v[e.mediaType]&&_[e.mediaType]||(t.su=!0,v[e.mediaType]=!1,_[e.mediaType]=!0),t}(e)):e.type===w.HTTPRequest.INIT_SEGMENT_TYPE?function(){var e=A();return e.ot=""+h.INIT,e.su=!0,e}():e.type===w.HTTPRequest.OTHER_TYPE||e.type===w.HTTPRequest.XLINK_EXPANSION_TYPE?function(){var e=A();return e.ot=""+h.OTHER,e}():null}catch(n){return null}var t}(e),n=function(e){try{if(!e)return null;var t=Object.keys(e).sort(function(e,t){return e.localeCompare(t)}),n=t.length,r=t.reduce(function(t,r,i){if("v"===r&&1===e[r])return t;if("string"!==typeof e[r]||"ot"===r&&"sf"===r&&"st"===r)t+=r+"="+e[r];else{var a=e[r].replace(/"/g,'"');t+=r+'="'+a+'"'}return i<n-1&&(t+=","),t},"");return r=r.replace(/=true/g,"")}catch(i){return null}}(t);return E.trigger(i.default.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:n}),{key:c,value:n}}return null}catch(r){return null}},setConfig:function(e){e&&(e.abrController&&(d=e.abrController),e.dashMetrics&&(m=e.dashMetrics),e.playbackController&&e.playbackController)},reset:function(){E.off(r.default.PLAYBACK_RATE_CHANGED,I,this),E.off(r.default.MANIFEST_LOADED,C,this),E.off(r.default.BUFFER_LEVEL_STATE_CHANGED,R,t),E.off(r.default.PLAYBACK_SEEKED,D,t),S()},initialize:function(){E.on(r.default.PLAYBACK_RATE_CHANGED,I,t),E.on(r.default.MANIFEST_LOADED,C,t),E.on(r.default.BUFFER_LEVEL_STATE_CHANGED,R,t),E.on(r.default.PLAYBACK_SEEKED,D,t)}},(0,o.default)(T).getInstance().getLogger(t),e=(0,u.default)(T).getInstance(),S(),t}m.__dashjs_factory_name="CmcdModel",t.default=a.default.getSingletonFactory(m)});c(ei);var ti=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(Pr),r=l(xr),i=l(v),a=l(R),o=l(ei),s=l(Lr),u=l(S);function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){e=e||{};var t=this.context,i=e.errHandler,l=e.dashMetrics,c=e.mediaPlayerModel,f=e.requestModifier,h=e.boxParser,p=e.useFetch||!1,g=e.errors,m=e.requestTimeout||0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0,S=void 0;function A(e,o){var u=e.request,d=[],g=!0,v=!0,I=new Date,C=I,R=0,D=void 0;if(!f||!l||!i)throw new Error("config object is not correct or missing");var M=function(e){v=!1,u.requestStartDate=I,u.requestEndDate=new Date,u.firstByteDate=u.firstByteDate||I,u.checkExistenceOnly||(l.addHttpRequest(u,D.response?D.response.responseURL:null,D.response?D.response.status:null,D.response&&D.response.getAllResponseHeaders?D.response.getAllResponseHeaders():D.response?D.response.responseHeaders:[],e?d:null),u.type===w.HTTPRequest.MPD_TYPE&&l.addManifestUpdate(u.type,u.requestStartDate,u.requestEndDate))},O=function(){if(-1!==y.indexOf(D)&&(y.splice(y.indexOf(D),1),v))if(M(!1),o>0){o--;var t={config:e};T.push(t),t.timeout=setTimeout(function(){-1!==T.indexOf(t)&&(T.splice(T.indexOf(t),1),A(e,o))},c.getRetryIntervalsForType(u.type))}else i.error(new a.default(E[u.type],u.url+" is not available",{request:u,response:D.response})),e.error&&e.error(u,"error",D.response.statusText),e.complete&&e.complete(u,D.response.statusText)},N=void 0;N=p&&window.fetch&&"arraybuffer"===u.responseType&&u.type===w.HTTPRequest.MEDIA_SEGMENT_TYPE?(0,r.default)(t).create({requestModifier:f,boxParser:h}):(0,n.default)(t).create({requestModifier:f});var P=f.modifyRequestURL(u.url),L=function(e){try{var t=[],n=b.getQueryParameter(e);return n&&t.push(n),t}catch(r){return[]}}(u);P=s.default.addAditionalQueryParameterToUrl(P,L);var k=u.checkExistenceOnly?w.HTTPRequest.HEAD:w.HTTPRequest.GET,x=c.getXHRWithCredentialsForType(u.type);D={url:P,method:k,withCredentials:x,request:u,onload:function(){D.response.status>=200&&D.response.status<=299&&(M(!0),e.success&&e.success(D.response.response,D.response.statusText,D.response.responseURL),e.complete&&e.complete(u,D.response.statusText))},onend:O,onerror:O,progress:function(t){var n=new Date;g&&(g=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(u.firstByteDate=n)),t.lengthComputable&&(u.bytesLoaded=t.loaded,u.bytesTotal=t.total),t.noTrace||(d.push({s:C,d:t.time?t.time:n.getTime()-C.getTime(),b:[t.loaded?t.loaded-R:0]}),C=n,R=t.loaded),e.progress&&t&&e.progress(t)},onabort:function(){e.abort&&e.abort(u)},ontimeout:function(e){var t=void 0;if(e.lengthComputable){var n=e.loaded/e.total*100;t="Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+n.toFixed(3)+"% Completed"}else t="Request timeout: non-computable download size";S.warn(t)},loader:N,timeout:m};var F=(new Date).getTime();if(isNaN(u.delayLoadingTime)||F>=u.delayLoadingTime)y.push(D),N.load(D);else{var U={httpRequest:D};_.push(U),U.delayTimeout=setTimeout(function(){if(-1!==_.indexOf(U)){_.splice(_.indexOf(U),1);try{I=new Date,C=I,y.push(U.httpRequest),N.load(U.httpRequest)}catch(e){U.httpRequest.onerror()}}},u.delayLoadingTime-F)}}return v={load:function(e){e.request?A(e,c.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){T.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)}),T=[],_.forEach(function(e){return clearTimeout(e.delayTimeout)}),_=[],y.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e)}),y=[]}},function(){var e;S=(0,u.default)(t).getInstance().getLogger(v),y=[],_=[],T=[],b=(0,o.default)(t).getInstance(),d(e={},w.HTTPRequest.MPD_TYPE,g.DOWNLOAD_ERROR_ID_MANIFEST_CODE),d(e,w.HTTPRequest.XLINK_EXPANSION_TYPE,g.DOWNLOAD_ERROR_ID_XLINK_CODE),d(e,w.HTTPRequest.INIT_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),d(e,w.HTTPRequest.MEDIA_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(e,w.HTTPRequest.INDEX_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(e,w.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(e,w.HTTPRequest.OTHER_TYPE,g.DOWNLOAD_ERROR_ID_CONTENT_CODE),E=e}(),v}c.__dashjs_factory_name="HTTPLoader";var f=i.default.getClassFactory(c);t.default=f});c(ti);var ni=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(ti);function i(e){return e&&e.__esModule?e:{default:e}}function a(){var e=void 0;function t(){e={}}function n(){t()}return n(),{getLoader:function(t){for(var n in e)if(e.hasOwnProperty(n)&&t.startsWith(n))return e[n];return r.default},registerLoader:function(t,n){e[t]=n},unregisterLoader:function(t){e[t]&&delete e[t]},unregisterAllLoader:t,reset:n}}a.__dashjs_factory_name="SchemeLoaderFactory";var o=n.default.getSingletonFactory(a);t.default=o});c(ni);var ri=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(ni);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){e=e||{};var t=this.context,n=void 0,i=void 0;return n=(0,r.default)(t).getInstance(),{load:function(r){var a=n.getLoader(r&&r.request?r.request.url:null);(i=a(t).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.useFetch||null,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,requestTimeout:isNaN(e.requestTimeout)?0:e.requestTimeout,errors:e.errors})).load(r)},abort:function(){i&&i.abort()}}}a.__dashjs_factory_name="URLLoader";var o=n.default.getClassFactory(a);t.default=o});c(ri);var ii=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=I)&&n.__esModule?n:{default:n};var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkForExistenceOnly=!0,n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=i});c(ii);var ai=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(p),r=s(ri),i=s(ii),a=s(R),o=s(v);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t=this.context,o=e.eventBus,s=e.events,u=e.urlUtils,l=e.errors,d=void 0,c=void 0;return d={checkForExistence:function(e){var t=function(t){o.trigger(s.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var n=new i.default(e.url);c.load({request:n,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var t=function(t,n){o.trigger(s.LOADING_COMPLETED,{request:e,response:t||null,error:n||null,sender:d})};e?c.load({request:e,progress:function(t){o.trigger(s.LOADING_PROGRESS,{request:e,stream:t.stream}),t.data&&o.trigger(s.LOADING_DATA_PROGRESS,{request:e,response:t.data||null,error:null,sender:d})},success:function(e){t(e)},error:function(e,n,r){t(void 0,new a.default(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,r,n))},abort:function(e){e&&o.trigger(s.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:d})}}):t(void 0,new a.default(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){c&&c.abort()},reset:function(){c&&(c.abort(),c=null)}},c=(0,r.default)(t).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:u,constants:n.default,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),d}u.__dashjs_factory_name="FragmentLoader",t.default=o.default.getClassFactory(u)});c(ai);var oi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=f(p),r=f(Nr),i=f(C),a=f(ai),o=f(Cr),s=f(T),u=f(b),l=f(Un),d=f(v),c=f(S);function f(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,d=(0,s.default)(t).getInstance(),f=e.errHandler,h=e.mediaPlayerModel,p=e.dashMetrics,g=(0,c.default)(t).getInstance(),m=e.streamInfo,v=void 0,y=void 0,_=void 0;function T(){for(var e in _)_[e].reset();_={}}function E(e){if(e.sender){var t=e.request,i=e.response,a=t.isInitializationRequest(),o=t.mediaInfo.streamInfo;if(e.error&&(t.mediaType!==n.default.AUDIO&&t.mediaType!==n.default.VIDEO&&t.mediaType!==n.default.FRAGMENTED_TEXT||d.trigger(u.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),i&&o){var s=function(e,t,n,i){var a=new r.default;return a.streamId=n,a.mediaInfo=t.mediaInfo,a.segmentType=t.type,a.start=t.startTime,a.duration=t.duration,a.end=a.start+a.duration,a.bytes=e,a.index=t.index,a.quality=t.quality,a.representationId=t.representationId,a.endFragment=i,a}(i,t,m.id,e.type!==u.default.FRAGMENT_LOADING_PROGRESS);d.trigger(a?u.default.INIT_FRAGMENT_LOADED:u.default.MEDIA_FRAGMENT_LOADED,{chunk:s,request:t},{streamId:o.id,mediaType:t.mediaType})}else y.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return v={getStreamId:function(){return m.id},getModel:function(n){var r=_[n];return r||(r=(0,i.default)(t).create({streamInfo:m,type:n,dashMetrics:p,fragmentLoader:(0,a.default)(t).create({dashMetrics:p,mediaPlayerModel:h,errHandler:f,requestModifier:(0,o.default)(t).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:d,events:u.default,errors:l.default,dashConstants:e.dashConstants,urlUtils:e.urlUtils}),debug:g,eventBus:d,events:u.default}),_[n]=r),r},reset:function(){d.off(u.default.FRAGMENT_LOADING_COMPLETED,E,this),d.off(u.default.FRAGMENT_LOADING_PROGRESS,E,this),T()}},y=g.getLogger(v),T(),d.on(u.default.FRAGMENT_LOADING_COMPLETED,E,v),d.on(u.default.FRAGMENT_LOADING_PROGRESS,E,v),v}h.__dashjs_factory_name="FragmentController",t.default=d.default.getClassFactory(h)});c(oi);var si=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null}});c(si);var ui=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(v),r=s(p),i=s(si),a=s(Zr),o=s(ar);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){var t,n=this.context,s=e.streamInfo,u=void 0;function l(){u&&u.reset()}return t={getStreamId:function(){return s.id},provide:function(e,t){if("function"===typeof t){var n,r=u.getCurrentTrack(),a=void 0;if(!r||r.segmentDuration<=0||void 0===e||null===e)t(null);else{isNaN(r.segmentDuration)&&(a=u.getThumbnailRequestForTime(e))&&(r.segmentDuration=a.duration),n=e%r.segmentDuration;var o=Math.floor(n*r.tilesHor*r.tilesVert/r.segmentDuration),s=new i.default;if(s.width=Math.floor(r.widthPerTile),s.height=Math.floor(r.heightPerTile),s.x=Math.floor(o%r.tilesHor)*r.widthPerTile,s.y=Math.floor(o/r.tilesHor)*r.heightPerTile,"readThumbnail"in r)return r.readThumbnail(e,function(e){s.url=e,t(s)});if(a)s.url=a.url,r.segmentDuration=NaN;else{var l=Math.floor(e/r.segmentDuration);s.url=function(e,t){var n=t+e.startNumber,r=(0,Tr.replaceTokenForTemplate)(e.templateUrl,"Number",n);return r=(0,Tr.replaceTokenForTemplate)(r,"Time",(n-1)*e.segmentDuration),r=(0,Tr.replaceTokenForTemplate)(r,"Bandwidth",e.bandwidth),(0,Tr.unescapeDollarsInTemplate)(r)}(r,l)}t(s)}}},setTrackByIndex:function(e){u.setTrackByIndex(e)},getCurrentTrackIndex:function(){return u.getCurrentTrackIndex()},getBitrateList:function(){var e=u.getTracks(),t=0;return e.map(function(e){var n=new o.default;return n.mediaType=r.default.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n})},reset:l},l(),u=(0,a.default)(n).create({streamInfo:s,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants}),t}u.__dashjs_factory_name="ThumbnailController",t.default=n.default.getClassFactory(u)});c(ui);var li=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=y(p),r=y(g),i=y(Or),a=y(oi),o=y(ui),s=y(T),u=y(b),l=y(S),d=y(Un),c=y(v),f=y(R),h=y(L),m=y(Dr);function y(e){return e&&e.__esModule?e:{default:e}}function _(e){e=e||{};var t=this.context,c=(0,s.default)(t).getInstance(),p=(0,m.default)(t).getInstance(),g=e.manifestModel,v=e.mediaPlayerModel,y=e.manifestUpdater,_=e.adapter,T=e.capabilities,E=e.errHandler,b=e.timelineConverter,S=e.dashMetrics,A=e.abrController,w=e.playbackController,I=e.eventController,C=e.mediaController,R=e.textController,D=e.protectionController,M=e.videoModel,O=e.settings,N=e.streamInfo,P=void 0,L=void 0,k=void 0,x=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0,q=void 0,H=void 0,V=void 0,K=void 0,Y=void 0,W=void 0,z=void 0,X=void 0,Q=void 0,$=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function Z(e){for(var t=k?k.length:0,n=0;n<t;n++){k[n].getFragmentModel().removeExecutedRequestsBeforeTime(ne()+te()),k[n].reset(!1,e)}k=[],F=!1,U=!1,be(!1),c.off(u.default.CURRENT_TRACK_CHANGED,ue,P)}function J(){Z(),x=!1,B=!1,j=!1,G={},q=!1,W=!1,X=!1}function ee(){w&&w.pause(),H&&(H.reset(),H=null),N=null,J(),c.off(u.default.DATA_UPDATE_COMPLETED,ge,P),c.off(u.default.BUFFERING_COMPLETED,pe,P),c.off(u.default.INBAND_EVENTS,me,P),D&&(c.off(u.default.KEY_ERROR,oe,P),c.off(u.default.SERVER_CERTIFICATE_UPDATED,oe,P),c.off(u.default.LICENSE_REQUEST_COMPLETE,oe,P),c.off(u.default.KEY_SYSTEM_SELECTED,oe,P),c.off(u.default.KEY_SESSION_CREATED,oe,P),c.off(u.default.KEY_STATUSES_CHANGED,oe,P)),be(!1)}function te(){return N?N.duration:NaN}function ne(){return N?N.start:NaN}function re(){if(!N.manifestInfo.isDynamic)return NaN;for(var e=0;e<k.length;e++)if(k[e].getType()===n.default.AUDIO||k[e].getType()===n.default.VIDEO)return k[e].getLiveStartTime();return NaN}function ie(){return N}function ae(){if(!M||!A||!A.hasOwnProperty("getBitrateList")||!_||!_.hasOwnProperty("getAllMediaInfoForType")||!_.hasOwnProperty("getEventsFor"))throw new Error(n.default.MISSING_CONFIG_ERROR)}function oe(e){e.error&&(E.error(e.error),L.fatal(e.error.message),ee())}function se(e){var t,r=e?e.type:null,i=void 0;if(r===n.default.MUXED)return i="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",L.fatal(i),E.error(new f.default(d.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,i,g.getValue())),!1;if(r===n.default.TEXT||r===n.default.FRAGMENTED_TEXT||r===n.default.EMBEDDED_TEXT||r===n.default.IMAGE)return!0;if(t=e.codec,L.debug(r+" codec: "+t),e.contentProtection&&!T.supportsEncryptedMedia())E.error(new f.default(d.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,d.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!T.supportsCodec(t))return i=r+"Codec ("+t+") is not supported.",L.error(i),!1;return!0}function ue(e){if(N&&e.newMediaInfo.streamInfo.id===N.id){var t=e.newMediaInfo,r=g.getValue();_.setCurrentMediaInfo(N.id,t.type,t);var i=ve(t);if(i){var a=w.getTime();L.info("Stream -  Process track changed at current time "+a),L.debug("Stream -  Update stream controller"),r.refreshManifestOnSwitchTrack?(L.debug("Stream -  Refreshing manifest for switch track"),Q=e,y.refreshManifest()):(i.selectMediaInfo(t),t.type!==n.default.FRAGMENTED_TEXT?(A.updateTopQualityIndex(t),i.switchTrackAsked(),i.getFragmentModel().abortRequests()):(i.getScheduleController().setSeekTarget(a),i.setBufferingTime(a),i.resetIndexHandler()))}}}function le(a,s){var l,d=_.getAllMediaInfoForType(N,a),f=null;if(d&&0!==d.length){a===n.default.VIDEO&&(B=!0),a===n.default.AUDIO&&(j=!0);for(var h=0,p=d.length;h<p;h++)if(f=d[h],a===n.default.EMBEDDED_TEXT)R.addEmbeddedTrack(f);else{if(!se(f))continue;C.addTrack(f)}a!==n.default.EMBEDDED_TEXT&&0!==C.getTracksFor(a,N).length&&(a!==n.default.IMAGE?(C.checkInitialMediaSettingsForType(a,N),l=C.getCurrentTrackFor(a,N),c.trigger(u.default.STREAM_INITIALIZING,{streamInfo:N,mediaInfo:f}),function(r,a,o,s){var u=H.getModel(r?r.type:null),l=(0,i.default)(t).create({streamInfo:N,type:r?r.type:null,mimeType:r?r.mimeType:null,timelineConverter:b,adapter:_,manifestModel:g,mediaPlayerModel:v,fragmentModel:u,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,abrController:A,playbackController:w,mediaController:C,textController:R,errHandler:E,settings:O,boxParser:Y});if(l.initialize(o,B),A.updateTopQualityIndex(r),s?(l.setBuffer(s.buffer),l.setBufferingTime(s.currentTime),k[s.replaceIdx]=l):k.push(l),!s||!s.ignoreMediaInfo)if(!r||r.type!==n.default.TEXT&&r.type!==n.default.FRAGMENTED_TEXT)l.addMediaInfo(r,!0);else{for(var d=void 0,c=0;c<a.length;c++)a[c].index===r.index&&(d=c),l.addMediaInfo(a[c]);l.selectMediaInfo(a[d])}}(l,d,s)):V=(0,o.default)(t).create({streamInfo:N,adapter:_,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:z,eventBus:c,events:u.default,dashConstants:r.default}))}else L.info("No "+a+" data.")}function de(){if(I){var e=_.getEventsFor(N);I.addInlineEvents(e)}}function ce(e){var t=_.getAdaptationForType(N?N.index:null,e,N);t&&Array.isArray(t.Representation_asArray)&&(t.Representation_asArray=t.Representation_asArray.filter(function(e,n){if(0===n)return!0;var r=_.getCodec(t,n,!0);return!!T.supportsCodec(r)||(L.error("[Stream] codec not supported: "+r),!1)}))}function fe(){for(var e=k.length,t=!!G.audio||!!G.video?new f.default(d.default.DATA_UPDATE_FAILED_ERROR_CODE,d.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,r=0;r<e;r++)if(k[r].isUpdating()||q)return;if(U){if(D)for(var i=0;i<e&&k[i];i++)if(k[i].getType()===n.default.AUDIO||k[i].getType()===n.default.VIDEO||k[i].getType()===n.default.FRAGMENTED_TEXT){var a=k[i].getMediaInfo();a&&D.initializeForMedia(a)}t?E.error(t):x||(x=!0,b.setTimeSyncCompleted(!0),c.trigger(u.default.STREAM_INITIALIZED,{streamInfo:N,liveStartTime:K?NaN:re()}));for(var o=0;o<e&&k[o];o++)k[o].getScheduleController().start()}}function he(e){for(var t={},n=0,r=k.length;n<r;n++){var i=k[n].createBuffer(e);i&&(t[k[n].getType()]=i.getBuffer())}return t}function pe(){var e=ye(),t=e.length;if(0!==t){for(var r=0;r<t;r++)if(!e[r].isBufferingCompleted()&&(e[r].getType()===n.default.AUDIO||e[r].getType()===n.default.VIDEO))return void L.warn("onBufferingCompleted - One streamProcessor has finished but",e[r].getType(),"one is not buffering completed");L.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),c.trigger(u.default.STREAM_BUFFERING_COMPLETED,{streamInfo:N})}else L.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function ge(e){G[e.mediaType]=e.error,fe()}function me(e){var t;t=e.events,I&&I.addInbandEvents(t)}function ve(e){return e?ye().filter(function(t){return t.getType()===e.type})[0]:null}function ye(){for(var e=[],t=void 0,r=void 0,i=0;i<k.length;i++)(t=(r=k[i]).getType())!==n.default.AUDIO&&t!==n.default.VIDEO&&t!==n.default.FRAGMENTED_TEXT&&t!==n.default.TEXT||e.push(r);return e}function _e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return!1;var r=e.getStreamInfo(),i=n?n.getStreamInfo():ie();if(!r||!i)return!1;var a=_.getAdaptationForType(r.index,t,r),o=_.getAdaptationForType(i.index,t,i);return a&&o?!(!Te(o)&&Te(a)):!a&&!o}function Te(e){return!!e&&!!(e.ContentProtection||e.Representation&&e.Representation.length>0&&e.Representation[0].ContentProtection)}function Ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var r=e.getStreamInfo(),i=n?n.getStreamInfo():ie();if(!r||!i)return!1;var a=_.getAdaptationForType(r.index,t,r),o=_.getAdaptationForType(i.index,t,i);if(!a||!o)return!a&&!o;var s=a&&o&&a.mimeType===o.mimeType,u=o.Representation_asArray.map(function(e){return e.codecs}),l=a.Representation_asArray.map(function(e){return e.codecs}),d=l.some(function(e){return u.indexOf(e)>-1}),c=l.some(function(e){return u.some(function(t){return function(e,t){for(var n=e.split(".")[0],r=0===t.indexOf(n),i=void 0,a=0;a<$.length;a++)if($[a].codec===n){i=$[a];break}if(i)return r||i.compatibleCodecs.some(function(e){return 0===t.indexOf(e)});return r}(t,e)})});return d||c&&s}function be(e){K=e}function Se(){return K}return P={initialize:function(){c.on(u.default.BUFFERING_COMPLETED,pe,P),c.on(u.default.DATA_UPDATE_COMPLETED,ge,P),c.on(u.default.INBAND_EVENTS,me,P),D&&(c.on(u.default.KEY_ERROR,oe,P),c.on(u.default.SERVER_CERTIFICATE_UPDATED,oe,P),c.on(u.default.LICENSE_REQUEST_COMPLETE,oe,P),c.on(u.default.KEY_SYSTEM_SELECTED,oe,P),c.on(u.default.KEY_SESSION_CREATED,oe,P),c.on(u.default.KEY_STATUSES_CHANGED,oe,P)),c.trigger(u.default.STREAM_UPDATED,{streamInfo:N})},getStreamId:function(){return N?N.id:null},activate:function(e,t){if(!F){var r=void 0;return c.on(u.default.CURRENT_TRACK_CHANGED,ue,P),Se()?(function(){if(q=!0,ae(),ce(n.default.VIDEO),ce(n.default.AUDIO),U=!0,q=!1,0===k.length){var e="No streams to play.";E.error(new f.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e,g.getValue())),L.debug(e)}else fe()}(),r=t):r=function(e,t){ae();var r=M.getElement();de(),q=!0,ce(n.default.VIDEO),ce(n.default.AUDIO),(!r||r&&/^VIDEO$/i.test(r.nodeName))&&le(n.default.VIDEO,e),le(n.default.AUDIO,e),le(n.default.TEXT,e),le(n.default.FRAGMENTED_TEXT,e),le(n.default.EMBEDDED_TEXT,e),le(n.default.MUXED,e),le(n.default.IMAGE,e);var i=he(t);if(U=!0,q=!1,0===k.length){var a="No streams to play.";E.error(new f.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,a,g.getValue())),L.fatal(a)}else fe();return i}(e,t),F=!0,r}return t},deactivate:Z,isActive:function(){return F},getDuration:te,getStartTime:ne,getId:function(){return N?N.id:null},getStreamInfo:ie,getHasAudioTrack:function(){return j},getHasVideoTrack:function(){return B},preload:function(e,t){if(!Se()){de(),le(n.default.VIDEO,e),le(n.default.AUDIO,e),le(n.default.TEXT,e),le(n.default.FRAGMENTED_TEXT,e),le(n.default.EMBEDDED_TEXT,e),le(n.default.MUXED,e),le(n.default.IMAGE,e),he(t),c.on(u.default.CURRENT_TRACK_CHANGED,ue,P);for(var r=0;r<k.length&&k[r];r++)k[r].getScheduleController().start();be(!0)}},getThumbnailController:function(){return V},getBitrateListFor:function(e){if(ae(),e===n.default.IMAGE)return V?V.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<k.length;n++)if((t=k[n]).getType()===e)return t.getMediaInfo();return null}(e);return A.getBitrateList(t)},updateData:function(e){L.info("Manifest updated... updating data system wide."),F=!1,q=!0,N=e,c.trigger(u.default.STREAM_UPDATED,{streamInfo:N}),I&&de(),ce(n.default.VIDEO),ce(n.default.AUDIO);for(var t=0,r=k.length;t<r;t++){var i=k[t];i.updateStreamInfo(N);var a=_.getMediaInfoForType(N,i.getType());a&&(A.updateTopQualityIndex(a),i.addMediaInfo(a,!0))}if(Q&&Q.newMediaInfo.type!==n.default.FRAGMENTED_TEXT){var o=ve(Q.oldMediaInfo);if(!o)return;o.switchTrackAsked(),Q=void 0}q=!1,fe()},reset:ee,getProcessors:ye,setMediaSource:function(e){for(var t=0;t<k.length;)se(k[t].getMediaInfo())?(k[t].setMediaSource(e),t++):(k[t].reset(),k.splice(t,1));for(var n=0;n<k.length;n++)k[n].dischargePreBuffer();if(0===k.length){var r="No streams to play.";E.error(new f.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,r+"nostreams",g.getValue())),L.fatal(r)}},isMediaCodecCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ee(e,n.default.VIDEO,t)&&Ee(e,n.default.AUDIO,t)},isProtectionCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _e(e,n.default.VIDEO,t)&&_e(e,n.default.AUDIO,t)},getPreloaded:Se,getPreloadingScheduled:function(){return W},setPreloadingScheduled:function(e){W=e},getIsEndedEventSignaled:function(){return X},setIsEndedEventSignaled:function(e){X=e}},z=(0,l.default)(t).getInstance(),L=z.getLogger(P),J(),Y=(0,h.default)(t).getInstance(),H=(0,a.default)(t).create({streamInfo:N,mediaPlayerModel:v,dashMetrics:S,errHandler:E,settings:O,boxParser:Y,dashConstants:r.default,urlUtils:p}),P}_.__dashjs_factory_name="Stream",t.default=c.default.getClassFactory(_)});c(li);var di=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=u(T),r=u(b),i=u(v),a=u(S),o=u(Un),s=u(g);function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=this.context,t=(0,n.default)(e).getInstance(),i=void 0,u=void 0,l=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0;function _(){l=NaN,h=!1,c=!0,f=!1,T()}function T(){null!==d&&(clearTimeout(d),d=null)}function E(e){T(),f||(isNaN(e)&&!isNaN(l)&&(e=1e3*l),isNaN(e)||(u.debug("Refresh manifest in "+e+" milliseconds."),d=setTimeout(A,e)))}function b(){h=!0;var e=g.getValue(),t=e.url,n=m.getLocation(e);n&&(t=n),p.load(t)}function S(e){if(g.getValue()&&g.getValue().type===s.default.DYNAMIC&&e.type===s.default.STATIC)return t.trigger(r.default.DYNAMIC_TO_STATIC),h=!1,void(f=!0);g.setValue(e);var n=new Date,i=(n.getTime()-e.loadedTime.getTime())/1e3;1e3*(l=m.getManifestUpdatePeriod(e,i))>2147483647&&(l=2147483.647),t.trigger(r.default.MANIFEST_UPDATED,{manifest:e}),u.info("Manifest has been refreshed at "+n+"["+n.getTime()/1e3+"] "),c||E()}function A(){c||(h?E(y.get().streaming.manifestUpdateRetryInterval):b())}function w(e){e.error?e.error.code===o.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&v.error(e.error):S(e.manifest)}function I(){c=!1,E()}function C(){(c=!y.get().streaming.scheduleWhilePaused)&&T()}function R(){h=!1}return i={initialize:function(){_(),t.on(r.default.STREAMS_COMPOSED,R,this),t.on(r.default.PLAYBACK_STARTED,I,this),t.on(r.default.PLAYBACK_PAUSED,C,this),t.on(r.default.INTERNAL_MANIFEST_LOADED,w,this)},setManifest:function(e){S(e)},refreshManifest:b,setConfig:function(e){e&&(e.manifestModel&&(g=e.manifestModel),e.adapter&&(m=e.adapter),e.manifestLoader&&(p=e.manifestLoader),e.errHandler&&(v=e.errHandler),e.settings&&(y=e.settings))},reset:function(){t.off(r.default.PLAYBACK_STARTED,I,this),t.off(r.default.PLAYBACK_PAUSED,C,this),t.off(r.default.STREAMS_COMPOSED,R,this),t.off(r.default.INTERNAL_MANIFEST_LOADED,w,this),_()}},u=(0,a.default)(e).getInstance().getLogger(i),i}l.__dashjs_factory_name="ManifestUpdater",t.default=i.default.getClassFactory(l)});c(di);var ci=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(R),r=l(T),i=l(b),a=l(Un),o=l(v),s=l(S),u=l(Dr);function l(e){return e&&e.__esModule?e:{default:e}}var d=5e3;function c(){var e=this.context,t=(0,r.default)(e).getInstance(),o=(0,u.default)(e).getInstance(),l=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0;function y(e){h=e}function _(e){f=e}function T(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t=void 0,n=void 0,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function E(e){return Date.parse(e)}function b(e){return Date.parse(e)}function S(e,t,n){n()}function A(e,t,n){var r=T(e);isNaN(r)?n():t(r)}function I(e,t,n,r,i){var a,s,u=!1,l=new XMLHttpRequest,c=i?w.HTTPRequest.HEAD:w.HTTPRequest.GET,f=t.match(/\S+/g);if(t=f.shift(),a=function(){u||(u=!0,f.length?I(e,f.join(" "),n,r,i):r())},s=function(){var t=void 0,r=void 0;200===l.status&&(t=i?l.getResponseHeader("Date"):l.response,r=e(t),isNaN(r)||(n(r),u=!0))},o.isRelative(t)){var h=v.resolve();h&&(t=o.resolve(t,h.url))}l.open(c,t),l.timeout=d,l.onload=s,l.onloadend=a,l.send()}function C(e,t,n){I(b,e,t,n,!0)}function R(e,r,o){y(!1),t.trigger(i.default.TIME_SYNCHRONIZATION_COMPLETED,{time:r,offset:o,error:e?new n.default(a.default.TIME_SYNC_FAILED_ERROR_CODE,a.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null})}return l={initialize:function(e,t){p=t,f=0,h=!1,g={"urn:mpeg:dash:utc:http-head:2014":C,"urn:mpeg:dash:utc:http-xsdate:2014":I.bind(null,T),"urn:mpeg:dash:utc:http-iso:2014":I.bind(null,E),"urn:mpeg:dash:utc:direct:2014":A,"urn:mpeg:dash:utc:http-head:2012":C,"urn:mpeg:dash:utc:http-xsdate:2012":I.bind(null,T),"urn:mpeg:dash:utc:http-iso:2012":I.bind(null,E),"urn:mpeg:dash:utc:direct:2012":A,"urn:mpeg:dash:utc:http-ntp:2014":S,"urn:mpeg:dash:utc:ntp:2014":S,"urn:mpeg:dash:utc:sntp:2014":S},h||function e(t,n){var r=n||0,i=t[r],a=function(e,t){var n=!e||!t;n&&p?function(){var e=m.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;isNaN(t)?R(!0):(_(t-(new Date).getTime()),R(!1,t/1e3,f))}():R(n,e,t)};y(!0),i?g.hasOwnProperty(i.schemeIdUri)?g[i.schemeIdUri](i.value,function(e){var t=(new Date).getTime(),n=function(e,t){return e-t}(e,t);_(n),c.info("Local time: "+new Date(t)),c.info("Server time: "+new Date(e)),c.info("Server Time - Local Time (ms): "+n),a(e,n)},function(){e(t,r+1)}):e(t,r+1):(_(0),a())}(e)},getOffsetToDeviceTimeMs:function(){return f},setConfig:function(e){e&&(e.dashMetrics&&(m=e.dashMetrics),e.baseURLController&&(v=e.baseURLController))},reset:function(){y(!1)}},c=(0,s.default)(e).getInstance().getLogger(l),l}c.__dashjs_factory_name="TimeSyncController";var f=o.default.getSingletonFactory(c);f.HTTP_TIMEOUT_MS=d,o.default.updateSingletonFactory(c.__dashjs_factory_name,f),t.default=f});c(ci);var fi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(S);function i(e){return e&&e.__esModule?e:{default:e}}function a(){var e=void 0,t=void 0,n=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n},detachMediaSource:function(e){e.setSource(null)},setDuration:function(e,t){return e.duration!=t&&(e.duration=t),e.duration},setSeekable:function(e,t,n){e&&"function"===typeof e.setLiveSeekableRange&&"function"===typeof e.clearLiveSeekableRange&&"open"===e.readyState&&t>=0&&t<n&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,n))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var n=e.sourceBuffers,r=0;r<n.length;r++){if(n[r].updating)return;if(0===n[r].buffered.length)return}t.info("call to mediaSource endOfStream"),e.endOfStream()}}},t=(0,r.default)(n).getInstance().getLogger(e),e}a.__dashjs_factory_name="MediaSourceController",t.default=n.default.getSingletonFactory(a)});c(fi);var hi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(v),r=s(S),i=s(T),a=s(_),o=s(Pr);function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e="urn:mpeg:dash:event:2012",t=1,n="urn:mpeg:dash:event:callback:2015",s=1,u=100,l=300,d=this.context,c=(0,i.default)(d).getInstance(),f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0;function S(){if(!_||!T)throw new Error("setConfig function has to be called previously")}function A(){b=!1,p={},g={},m={},v=null,E=!1,y=Date.now()/1e3}function w(){try{null!==v&&b&&(clearInterval(v),v=null,b=!1,function(){try{O(g),O(p)}catch(e){}}())}catch(e){throw e}}function I(e){try{if(e.eventStream.value==t){var n=e.calculatedPresentationTime,r=void 0;r=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,c.trigger(a.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:n,newDuration:r,newManifestValidAfter:NaN},{mode:a.default.EVENT_MODE_ON_START})}}catch(i){}}function C(){try{if(!E){E=!0;var e=T.getTime(),t=e-y;t=y>0?Math.max(0,t):0,R(g,t,e),R(p,t,e),function(){try{if(m)for(var e=T.getTime(),t=Object.keys(m),n=0;n<t.length;n++){var r=t[n],i=m[r];null!==i&&i.duration+i.calculatedPresentationTime<e&&(h.debug("Remove Event "+r+" at time "+e),i=null,delete m[r])}}catch(a){}}(),y=e,E=!1}}catch(n){E=!1}}function R(e,t,n){try{if(e)for(var r=Object.keys(e),i=0;i<r.length;i++){var o=r[i],s=e[o];if(void 0!==s){var u=isNaN(s.duration)?0:s.duration;s.calculatedPresentationTime<=n&&s.calculatedPresentationTime+t+u>=n?N(o,s,e,a.default.EVENT_MODE_ON_START):(D(n,u+t,s.calculatedPresentationTime)||M(s))&&(h.debug("Deleting event "+o+" as it is expired or invalid"),delete e[o])}}}catch(l){}}function D(e,t,n){try{return e-t>n}catch(r){return!1}}function M(e){try{var t=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>t}catch(n){return!1}}function O(e){try{var t=Object.keys(e),n=T.getTime();if(!t||0===t.length)return;var r=e[t[0]].eventStream&&e[t[0]].eventStream.period&&!isNaN(e[t[0]].eventStream.period.duration)?e[t[0]].eventStream.period.duration:NaN,i=e[t[0]].eventStream&&e[t[0]].eventStream.period&&!isNaN(e[t[0]].eventStream.period.start)?e[t[0]].eventStream.period.start:NaN;if(isNaN(r)||isNaN(i))return;t.forEach(function(t){var r=e[t],i=r.calculatedPresentationTime;Math.abs(i-n)<l&&N(t,r,e,a.default.EVENT_MODE_ON_START)})}catch(o){}}function N(r,i,u,l){try{var f=T.getTime();if(l===a.default.EVENT_MODE_ON_RECEIVE)return h.debug("Received event "+r),void c.trigger(i.eventStream.schemeIdUri,{event:i},{mode:l});i.duration>0&&(m[r]=i),i.eventStream.schemeIdUri===e&&i.eventStream.value===t?0===i.duration&&0===i.presentationTimeDelta||(h.debug("Starting manifest refresh event "+r+" at "+f),function(){try{S(),_.refreshManifest()}catch(e){}}()):i.eventStream.schemeIdUri===n&&i.eventStream.value===s?(h.debug("Starting callback event "+r+" at "+f),function(e){try{var t=(0,o.default)(d).create({});t.load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(n){throw n}}(i.messageData)):(h.debug("Starting event "+r+" at "+f),c.trigger(i.eventStream.schemeIdUri,{event:i},{mode:l})),delete u[r]}catch(p){}}return f={addInlineEvents:function(e){try{if(S(),e)for(var t=0;t<e.length;t++){var n=e[t];h.debug("Add inline event with id "+n.id),p[n.id]||N(n.id,n,e,a.default.EVENT_MODE_ON_RECEIVE),p[n.id]=n}h.debug("Added "+e.length+" inline events")}catch(r){throw r}},addInbandEvents:function(t){try{S();for(var n=0;n<t.length;n++){var r=t[n];r.id in g?h.debug("Repeated event with id "+r.id):(r.eventStream.schemeIdUri===e&&void 0===g[r.id]&&I(r),g[r.id]=r,h.debug("Add inband event with id "+r.id),N(r.id,r,t,a.default.EVENT_MODE_ON_RECEIVE))}C()}catch(i){throw i}},start:function(){try{S(),h.debug("Start Event Controller"),b||isNaN(u)||(b=!0,v=setInterval(C,u))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(_=e.manifestUpdater),e.playbackController&&(T=e.playbackController)}catch(t){throw t}},reset:function(){w(),A()}},h=(0,r.default)(d).getInstance().getLogger(f),A(),f}u.__dashjs_factory_name="EventController",t.default=n.default.getSingletonFactory(u)});c(hi);var pi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=w(p),r=w(m),i=w(li),a=w(di),o=w(T),s=w(b),u=w(v),l=w(S),d=w(cr),c=w(Dr),f=w(_),h=w(ci),g=w(fi),y=w(R),E=w(Un),A=w(hi);function w(e){return e&&e.__esModule?e:{default:e}}var I=200,C=500;function D(){var e=this.context,t=(0,o.default)(e).getInstance(),u=void 0,p=void 0,m=void 0,v=void 0,_=void 0,T=void 0,b=void 0,S=void 0,w=void 0,R=void 0,D=void 0,M=void 0,O=void 0,N=void 0,P=void 0,L=void 0,k=void 0,x=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0,q=void 0,H=void 0,V=void 0,K=void 0,Y=void 0,W=void 0,z=void 0,X=void 0,Q=void 0,$=void 0,Z=void 0,J=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0;function ie(){if(Ie()){var e=W.getPlaybackQuality();e&&S.addDroppedFrames(e)}}function ae(e){var t=pe(e.seekTime);t===B&&te&&te.length>0&&te.forEach(function(e){e.deactivate(!0)}),t&&t!==B?(Re(Mr.PlayListTrace.END_OF_PERIOD_STOP_REASON),ye(t,B,e.seekTime)):Re(Mr.PlayListTrace.USER_REQUEST_STOP_REASON),De(Mr.PlayList.SEEK_START_REASON)}function oe(e){var t=ve();Re(Mr.PlayListTrace.END_OF_PERIOD_STOP_REASON),ye(t,B,e.seekTime),De(Mr.PlayList.SEEK_START_REASON)}function se(){p.debug("[onPlaybackStarted]"),$?($=!1,De(Mr.PlayList.INITIAL_PLAYOUT_START_REASON)):Q&&(Q=!1,De(Mr.PlayList.RESUME_FROM_PAUSE_START_REASON))}function ue(e){p.debug("[onPlaybackPaused]"),e.ended||(Q=!0,Re(Mr.PlayListTrace.USER_REQUEST_STOP_REASON))}function le(){Z&&(clearInterval(Z),Z=null)}function de(){J||(J=setInterval(function(){!function(){if(!B||!ce(B))return;var e=function(e){try{var t=e||(B||null);if(t){var n=t.getStreamInfo().start;return U.filter(function(e){return e.getStreamInfo().start>n})}}catch(r){return[]}}(B),t=0,r=function(){var r=e[t],i=0===t?B:e[t-1];if(!r.getPreloadingScheduled()&&ce(i)&&Y){var a=[n.default.VIDEO,n.default.AUDIO],o=!0;a.forEach(function(e){var t=b.getMediaInfoForType(r.getStreamInfo(),e),n=b.getVoRepresentations(t);n.forEach(function(e){var t=b.getIsDynamic(),n=F.calcSegmentAvailabilityRange(e,t);n.end<n.start&&(o=!1)})}),o&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(Y&&!e.getPreloaded()){var n=he(e,t);n&&(e.setPreloadingScheduled(!0),p.info("[onStreamCanLoadNext] Preloading next stream with id "+e.getId()),e.preload(Y,ee),te.push(e),e.getProcessors().forEach(function(t){t.setBufferingTime(e.getStartTime())}))}}(r,i)}t+=1};for(;t<e.length;)r()}()},C))}function ce(e){try{if(!e)return!1;var t=e.getProcessors().filter(function(e){return e.getType()===n.default.AUDIO||e.getType()===n.default.VIDEO});if(!t||0===t.length)return!1;var r=t.filter(function(e){return!e.isBufferingCompleted()});return r&&0===r.length}catch(i){return!1}}function fe(){var e=Oe().isLast;Y&&e&&(p.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),w.signalEndOfStream(Y))}function he(e,t){try{return re.get().streaming.reuseExistingSourceBuffers&&t.isProtectionCompatible(e,t)&&(ne||t.isMediaCodecCompatible(e,t))&&!function(e){try{var t=e.getStreamInfo(),r=b.getAdaptationForType(t.index,n.default.FRAGMENTED_TEXT,t);return!!r&&(-1!==r.codecs.indexOf("stpp")||-1!==r.codecs.indexOf("wvtt"))}catch(i){return!1}}(e)}catch(r){return!1}}function pe(e){if(isNaN(e))return null;var t=0,n=null,r=U.length;r>0&&(t+=U[0].getStartTime());for(var i=0;i<r;i++)if(n=U[i],e<(t=parseFloat((t+n.getDuration()).toFixed(5))))return n;return null}function ge(){return B?B.getProcessors():[]}function me(e){if(!B.getIsEndedEventSignaled()){B.setIsEndedEventSignaled(!0);var t=ve();t?(p.debug("StreamController onEnded, found next stream with id "+t.getStreamInfo().id),ye(t,B,NaN)):(p.debug("StreamController no next stream found"),B.setIsEndedEventSignaled(!1)),Re(t?Mr.PlayListTrace.END_OF_PERIOD_STOP_REASON:Mr.PlayListTrace.END_OF_CONTENT_STOP_REASON)}e&&e.isLast&&le()}function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||(B||null);if(t){for(var n=t.getStreamInfo().start,r=t.getStreamInfo().duration,i=parseFloat((n+r).toFixed(5)),a=0,o=-1,s=NaN;a<U.length;){var u=U[a].getStreamInfo().start-i;u>=0&&(isNaN(s)||u<s)&&(s=u,o=a),a+=1}return o>=0?U[o]:null}return null}function ye(e,n,r){if(!(H||!e||n===e&&e.isActive())){H=!0,t.trigger(s.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var i=!1;n&&(i=he(e,n),n.deactivate(i)),r=isNaN(r)?!i&&n?e.getStreamInfo().start:NaN:r,p.info("Switch to stream "+e.getId()+". Seektime is "+r+", current playback time is "+z.getTime()),p.info("Seamless period switch is set to "+i),B=e,te=te.filter(function(e){return e.getId()!==B.getId()}),z.initialize(Oe(),!!n,r),W.getElement()?_e(r,null===n,!1,i):Te(r,i)}}function _e(e,n,r,i){var a=void 0;function o(){Y&&"open"===Y.readyState&&(p.debug("MediaSource is open!"),window.URL.revokeObjectURL(a),Y.removeEventListener("sourceopen",o),Y.removeEventListener("webkitsourceopen",o),Ee(),n||t.trigger(s.default.SOURCE_INITIALIZED),r?B.setMediaSource(Y):Te(e,i))}Y?i?(Te(e,i),n||t.trigger(s.default.SOURCE_INITIALIZED)):(w.detachMediaSource(W),Y.addEventListener("sourceopen",o,!1),Y.addEventListener("webkitsourceopen",o,!1),a=w.attachMediaSource(Y,W),p.debug("MediaSource attached to element.  Waiting on open...")):((Y=w.createMediaSource()).addEventListener("sourceopen",o,!1),Y.addEventListener("webkitsourceopen",o,!1),a=w.attachMediaSource(Y,W),p.debug("MediaSource attached to element.  Waiting on open..."))}function Te(e,n){if(ee=B.activate(Y,n?ee:void 0)){var r=Object.keys(ee);r.length>0&&ee[r[0]].changeType&&(ne=!0)}$||isNaN(e)||(e===z.getTime()?t.trigger(s.default.SEEK_TARGET,{time:e},{streamId:B.getId()}):z.seek(e)),!q&&$||z.play(),H=!1,t.trigger(s.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Oe()})}function Ee(e){var t=e||Oe().manifestInfo.duration;if(t&&!isNaN(t)){var n=w.setDuration(Y,t);p.debug("Duration successfully set to: "+n)}}function be(e){for(var t=0,n=U.length;t<n;t++)if(U[t].getId()===e.id)return U[t];return null}function Se(){try{var r=b.getStreamsInfo();if(0===r.length)throw new Error("There are no streams");S.updateManifestUpdateInfo({currentTime:z.getTime(),buffered:W.getBufferRange(),presentationStartTime:r[0].start,clientTimeOffset:F.getClientTimeOffset()}),U.length>0&&(U=U.filter(function(e){var t=r.filter(function(t){return t.id===e.getId()}).length>0||e.getId()===B.getId();return t||p.debug("Removing stream "+e.getId()),t}));for(var a=0,o=r.length;a<o;a++){var u=r[a],l=be(u);l?l.updateData(u):(l=(0,i.default)(e).create({manifestModel:T,mediaPlayerModel:X,dashMetrics:S,manifestUpdater:v,adapter:b,timelineConverter:F,capabilities:m,errHandler:x,baseURLController:D,abrController:M,playbackController:z,eventController:N,mediaController:O,textController:P,protectionController:j,videoModel:W,streamInfo:u,settings:re}),U.push(l),l.initialize()),S.addManifestUpdateStreamInfo(u)}if(!B){if(b.getIsDynamic()&&U.length){var d=r[0].manifestInfo,c=function(e,t){try{var r=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var i=e[0],a=[n.default.VIDEO,n.default.AUDIO,n.default.FRAGMENTED_TEXT],o=a.reduce(function(e,t){var n=b.getMediaInfoForType(i,t);return n&&e.push(n),e},[]).reduce(function(e,t){var n=b.getVoRepresentations(t);return n&&n.length>0&&n.forEach(function(t){t&&e.push(t)}),e},[]).reduce(function(e,t){var n=b.convertDataToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e},[]);r=Math.max.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(o))}return isFinite(r)?r:NaN}catch(s){return NaN}}(r,d);z.computeAndSetLiveDelay(c,d.DVRWindowSize,d.minBufferTime)}var f=null;!(f=pe(z.getStartTimeFromUriParameters(b.getIsDynamic())))&&b.getIsDynamic()&&U.length&&(p.debug("Dynamic stream: Trying to find the correct starting period"),f=function(){try{var e=F.calcPresentationTimeFromWallTime(new Date,b.getRegularPeriods()[0]),t=z.getLiveDelay(),n=e-t;return pe(n)}catch(r){return null}}()),ye(null!==f?f:U[0],null,NaN),Z||(Z=setInterval(function(){!H&&z.getTimeToStreamEnd()<=0&&t.trigger(s.default.PLAYBACK_ENDED,{isLast:Oe().isLast})},I)),de()}t.trigger(s.default.STREAMS_COMPOSED)}catch(h){x.error(new y.default(E.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,h.message+"nostreamscomposed",T.getValue())),K=!0,ke()}}function Ae(){var e=T.getValue();j&&(t.trigger(s.default.PROTECTION_CREATED,{controller:j,manifest:e}),j.setMediaElement(W.getElement()),G&&j.setProtectionData(G)),Se()}function we(e){if(e.error)K=!0,ke();else{var t=e.manifest;b.updatePeriods(t);var n=b.getUTCTimingSources(),r=b.getIsDynamic()?n.concat(X.getUTCTimingSources()):n,i=k.isHTTPS(e.manifest.url);r.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===X.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(i?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),i?"https://":"http://"),p.debug("Matching default timing source protocol to manifest protocol: ",e.value))}),D.initialize(t),R.setConfig({dashMetrics:S,baseURLController:D}),R.initialize(r,re.get().streaming.useManifestDateHeaderTimeSource)}}function Ie(){return!!B&&B.getHasVideoTrack()}function Ce(){return!!B&&B.getHasAudioTrack()}function Re(e,t){t=t||new Date,ge().forEach(function(n){n.finalisePlayList(t,e)}),S.addPlayList()}function De(e){S.createPlaylistMetrics(1e3*z.getTime(),e)}function Me(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}V=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),p.fatal("Video Element Error: "+t),e.error&&p.fatal(e.error),x.error(new y.default(e.error.code,t)),ke()}}function Oe(){return B?B.getStreamInfo():null}function Ne(){if(!_||!_.hasOwnProperty("load")||!F||!F.hasOwnProperty("initialize")||!F.hasOwnProperty("reset")||!F.hasOwnProperty("getClientTimeOffset")||!T||!x||!S||!z)throw new Error(n.default.MISSING_CONFIG_ERROR)}function Pe(e){isNaN(e.newDuration)||Ee(e.newDuration)}function Le(){U=[],j=null,H=!1,B=null,V=!1,K=!1,$=!0,Q=!1,q=!0,Z=null,J=null,te=[]}function ke(){Ne(),R.reset(),Re(V||K?Mr.PlayListTrace.FAILURE_STOP_REASON:Mr.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,n=U?U.length:0;e<n;e++){U[e].reset(V)}t.off(s.default.PLAYBACK_TIME_UPDATED,ie,u),t.off(s.default.PLAYBACK_SEEKING,ae,u),t.off(s.default.GAP_CAUSED_SEEK_TO_PERIOD_END,oe,u),t.off(s.default.PLAYBACK_ERROR,Me,u),t.off(s.default.PLAYBACK_STARTED,se,u),t.off(s.default.PLAYBACK_PAUSED,ue,u),t.off(s.default.PLAYBACK_ENDED,me,u),t.off(s.default.MANIFEST_UPDATED,we,u),t.off(s.default.STREAM_BUFFERING_COMPLETED,fe,u),t.off(s.default.MANIFEST_VALIDITY_CHANGED,Pe,u),t.off(s.default.TIME_SYNCHRONIZATION_COMPLETED,Ae,u),t.off(f.default.METRIC_ADDED,xe,u),D.reset(),v.reset(),N.reset(),S.clearAllCurrentMetrics(),T.setValue(null),_.reset(),F.reset(),L.reset(),Y&&(w.detachMediaSource(W),Y=null),W=null,j&&(j.setMediaElement(null),j=null,G=null,T.getValue()&&t.trigger(s.default.PROTECTION_DESTROYED,{data:T.getValue().url})),le(),clearInterval(J),J=null,t.trigger(s.default.STREAM_TEARDOWN_COMPLETE),Le()}function xe(e){if(e.metric===r.default.DVR_INFO){var t=Ce()?n.default.AUDIO:n.default.VIDEO;e.mediaType===t&&w.setSeekable(Y,e.value.range.start,e.value.range.end)}}return u={initialize:function(n,r){Ne(),q=n,G=r,F.initialize(),(v=(0,a.default)(e).create()).setConfig({manifestModel:T,adapter:b,manifestLoader:_,errHandler:x,settings:re}),v.initialize(),(N=(0,A.default)(e).getInstance()).setConfig({manifestUpdater:v,playbackController:z}),N.start(),t.on(s.default.PLAYBACK_TIME_UPDATED,ie,u),t.on(s.default.PLAYBACK_SEEKING,ae,u),t.on(s.default.GAP_CAUSED_SEEK_TO_PERIOD_END,oe,u),t.on(s.default.PLAYBACK_ERROR,Me,u),t.on(s.default.PLAYBACK_STARTED,se,u),t.on(s.default.PLAYBACK_PAUSED,ue,u),t.on(s.default.PLAYBACK_ENDED,me,u,{priority:o.default.EVENT_PRIORITY_HIGH}),t.on(s.default.MANIFEST_UPDATED,we,u),t.on(s.default.STREAM_BUFFERING_COMPLETED,fe,u),t.on(s.default.MANIFEST_VALIDITY_CHANGED,Pe,u),t.on(s.default.TIME_SYNCHRONIZATION_COMPLETED,Ae,u),t.on(f.default.METRIC_ADDED,xe,u)},getActiveStreamInfo:Oe,hasVideoTrack:Ie,hasAudioTrack:Ce,switchToVideoElement:function(e){B&&(z.initialize(Oe()),_e(e,!1,!0,!1))},getStreamById:function(e){return U.filter(function(t){return t.getId()===e})[0]},getStreamForTime:pe,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,a=null,o=0;o<U.length;o++){if(i=(n=U[o]).getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a)}return null},load:function(e){Ne(),_.load(e)},loadWithManifest:function(e){!function(){if(!v||!v.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),v.setManifest(e)},getActiveStreamProcessors:ge,setConfig:function(e){e&&(e.capabilities&&(m=e.capabilities),e.manifestLoader&&(_=e.manifestLoader),e.manifestModel&&(T=e.manifestModel),e.mediaPlayerModel&&(X=e.mediaPlayerModel),e.protectionController&&(j=e.protectionController),e.adapter&&(b=e.adapter),e.dashMetrics&&(S=e.dashMetrics),e.errHandler&&(x=e.errHandler),e.timelineConverter&&(F=e.timelineConverter),e.videoModel&&(W=e.videoModel),e.playbackController&&(z=e.playbackController),e.abrController&&(M=e.abrController),e.mediaController&&(O=e.mediaController),e.textController&&(P=e.textController),e.settings&&(re=e.settings),e.baseURLController&&(D=e.baseURLController))},setProtectionData:function(e){G=e},getIsStreamSwitchInProgress:function(){return H},getHasMediaOrIntialisationError:function(){return V||K},hasStreamFinishedBuffering:ce,getStreams:function(){return U},getActiveStream:function(){return B},reset:ke},p=(0,l.default)(e).getInstance().getLogger(u),R=(0,h.default)(e).getInstance(),w=(0,g.default)(e).getInstance(),L=(0,d.default)(e).getInstance(),k=(0,c.default)(e).getInstance(),Le(),u}D.__dashjs_factory_name="StreamController",t.default=u.default.getSingletonFactory(D)});c(pi);var gi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(v),r=o(S),i=o(b),a=o(T);function o(e){return e&&e.__esModule?e:{default:e}}var s=100,u=30,l=.1;function d(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,o=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0;function _(){y.debug("Stopping the gap controller"),f&&(clearInterval(f),f=null),function(){t.off(i.default.WALLCLOCK_TIME_UPDATED,b,this),t.off(i.default.PLAYBACK_SEEKING,E,this),t.off(i.default.BYTES_APPENDED_END_FRAGMENT,T,n)}(),f=null,h=NaN,c=0,v=null}function T(){f||function(){try{f||(y.debug("Starting the gap controller"),f=setInterval(function(){if(S()){var e=p.getTime();A(e)}},s))}catch(e){}}()}function E(){v&&(clearTimeout(v),v=null)}function b(){if(S()&&++c>=u){var e=p.getTime();o===e?A(e,!0):(o=e,h=NaN),c=0}}function S(){return d.get().streaming.jumpGaps&&g.getActiveStreamProcessors().length>0&&(!p.isSeeking()||g.hasStreamFinishedBuffering(g.getActiveStream()))&&!p.isPaused()&&!g.getIsStreamSwitchInProgress()&&!g.getHasMediaOrIntialisationError()}function A(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=d.get().streaming.smallGapLimit,o=d.get().streaming.jumpLargeGaps,s=m.getBufferRange(),u=NaN,c=!1;if(n=function(e,t){try{if(!e||e.length<=1&&t>0)return NaN;for(var n=NaN,r=0;isNaN(n)&&r<e.length;){var i=r>0?e.end(r-1):0;t<e.start(r)&&i-t<l&&(n=r),r+=1}return n}catch(a){return null}}(s,e),!isNaN(n)){var f=s.start(n),g=f-e;g>0&&(g<=a||o)&&(u=f)}var _=p.getTimeToStreamEnd();if(isNaN(u)&&r&&isFinite(_)&&!isNaN(_)&&_<a&&(u=parseFloat(p.getStreamEndTime().toFixed(5)),c=!0),u>0&&h!==u&&u>e&&!v){var T=u-e;if(c)y.warn("Jumping to end of stream because of gap from "+e+" to "+u+". Gap duration: "+T),t.trigger(i.default.GAP_CAUSED_SEEK_TO_PERIOD_END,{seekTime:u,duration:T});else{var E=p.getIsDynamic(),b=n>0?s.end(n-1):e,S=E?1e3*T:0;v=window.setTimeout(function(){p.seek(u,!0,!0),y.warn("Jumping gap starting at "+b+" and ending at "+u+". Jumping by: "+T),t.trigger(i.default.GAP_CAUSED_INTERNAL_SEEK,{seekTime:u,duration:T}),v=null},S)}h=u}}return n={reset:_,setConfig:function(e){e&&(e.settings&&(d=e.settings),e.playbackController&&(p=e.playbackController),e.streamController&&(g=e.streamController),e.videoModel&&(m=e.videoModel),e.timelineConverter&&e.timelineConverter,e.adapter&&e.adapter)},initialize:function(){!function(){t.on(i.default.WALLCLOCK_TIME_UPDATED,b,this),t.on(i.default.PLAYBACK_SEEKING,E,this),t.on(i.default.BYTES_APPENDED_END_FRAGMENT,T,n)}()}},y=(0,r.default)(e).getInstance().getLogger(n),_(),n}d.__dashjs_factory_name="GapController",t.default=n.default.getSingletonFactory(d)});c(gi);var mi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(p),r=s(b),i=s(T),a=s(v),o=s(S);function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=(0,i.default)(e).getInstance(),a=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=void 0,f=[n.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,n.default.TRACK_SWITCH_MODE_NEVER_REPLACE],h=[n.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE,n.default.TRACK_SELECTION_MODE_WIDEST_RANGE];function p(e,t){if(!e||!t)return[];var n=t.id;return u[n]&&u[n][e]?u[n][e].list:[]}function g(e,t){return!e||!t||t&&!u[t.id]?null:u[t.id][e].current}function m(e,i){if(e&&e.streamInfo){var a=e.type,o=e.streamInfo,s=o.id,l=g(a,o);if(u[s]&&u[s][a]&&!b(e,l)&&(u[s][a].current=e,!u[s][a].current||i&&a===n.default.FRAGMENTED_TEXT||t.trigger(r.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:l,newMediaInfo:e,switchMode:_(a)}),!i)){var d=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);if(!d||!u[s][a].storeLastSettings)return;d.roles&&(d.role=d.roles[0],delete d.roles),d.accessibility&&(d.accessibility=d.accessibility[0]),d.audioChannelConfiguration&&(d.audioChannelConfiguration=d.audioChannelConfiguration[0]),c.setSavedMediaSettings(a,d)}}}function v(e,t){e&&t&&(d[e]=t)}function y(e){return e?d[e]:null}function _(e){return l.get().streaming.trackSwitchMode[e]}function T(){return l.get().streaming.selectionModeForInitialTrack}function E(e){return e===n.default.AUDIO||e===n.default.VIDEO||e===n.default.TEXT||e===n.default.FRAGMENTED_TEXT||e===n.default.IMAGE}function b(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function S(){u={},d={audio:null,video:null,fragmentedText:null}}function A(e,t){var n=!e.lang||t.lang.match(e.lang),r=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter(function(t){return t===e.role})[0],a=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility})[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0];return n&&r&&i&&a&&o}function w(e,t){if(e===n.default.FRAGMENTED_TEXT)return t[0];var r=T(),i=[],a=function(e){var t=0,n=[],r=void 0;return e.forEach(function(e){(r=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})))>t?(t=r,n=[e]):r===t&&n.push(e)}),n},o=function(e){var t=0,n=[],r=void 0;return e.forEach(function(e){(r=e.representationCount)>t?(t=r,n=[e]):r===t&&n.push(e)}),n};switch(r){case n.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:(i=a(t)).length>1&&(i=o(i));break;case n.default.TRACK_SELECTION_MODE_WIDEST_RANGE:(i=o(t)).length>1&&(i=a(t));break;default:s.warn("Track selection mode is not supported: "+r)}return i[0]}return a={checkInitialMediaSettingsForType:function(e,t){var n=y(e),r=p(e,t),i=[];n||v(e,n=c.getSavedMediaSettings(e)),r&&0!==r.length&&(n&&r.forEach(function(e){A(n,e)&&i.push(e)}),0===i.length?m(w(e,r),!0):i.length>1?m(w(e,i)):m(i[0]))},addTrack:function(e){if(e){var t=e.type;if(E(t)){var n=e.streamInfo.id;u[n]||(u[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var r=u[n][t].list,i=0,a=r.length;i<a;++i)if(b(r[i],e))return;r.push(e);var o=y(t);o&&A(o,e)&&!g(t,e.streamInfo)&&m(e)}}},getTracksFor:p,getCurrentTrackFor:g,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return u[n]&&u[n][t]&&b(u[n][t].current,e)},setTrack:m,setInitialSettings:v,getInitialSettings:y,setSwitchMode:function(e,t){if(s.warn("deprecated: Please use updateSettings({streaming: { trackSwitchMode: mode } }) instead"),-1!==f.indexOf(t)){var n={};n[e]=t,l.update({streaming:{trackSwitchMode:n}})}else s.warn("Track switch mode is not supported: "+t)},getSwitchMode:_,setSelectionModeForInitialTrack:function(e){s.warn("deprecated: Please use updateSettings({streaming: { selectionModeForInitialTrack: mode } }) instead"),-1!==h.indexOf(e)?l.update({streaming:{selectionModeForInitialTrack:e}}):s.warn("Track selection mode is not supported: "+e)},getSelectionModeForInitialTrack:T,isMultiTrackSupportedByType:E,isTracksEqual:b,matchSettings:A,saveTextSettingsDisabled:function(){c.setSavedMediaSettings(n.default.FRAGMENTED_TEXT,null)},setConfig:function(e){e&&(e.domStorage&&(c=e.domStorage),e.settings&&(l=e.settings))},reset:S},s=(0,o.default)(e).getInstance().getLogger(a),S(),a}u.__dashjs_factory_name="MediaController";var l=a.default.getSingletonFactory(u);a.default.updateSingletonFactory(u.__dashjs_factory_name,l),t.default=l});c(mi);var vi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Qr),r=i(v);function i(e){return e&&e.__esModule?e:{default:e}}var a=NaN,o=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:n||a},this.children=[]};function s(){var e,t=void 0,r=void 0,i=this.context,s=(0,n.default)(i).getInstance();function u(e,t,n){var i=r.getBaseURLsFromElement(n);e[t]?s.areEqual(i,e[t].data.baseUrls)||(e[t].data.baseUrls=i,e[t].data.selectedIdx=a):e[t]=new o(i)}function l(e){!function(){if(!r||!r.hasOwnProperty("getBaseURLsFromElement")||!r.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var n=r.getBaseURLsFromElement(e);s.areEqual(n,t.data.baseUrls)||(t.data.baseUrls=n,t.data.selectedIdx=a),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,n){u(t.children,n,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,i){u(t.children[n].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(r.getRepresentationSortFunction()).forEach(function(e,r){u(t.children[n].children[i].children,r,e)})})})}function d(){t=new o}return e={reset:d,update:function(e){l(e)},getForPath:function(e){var n=t,r=[n.data];return e&&e.forEach(function(e){(n=n.children[e])&&r.push(n.data)}),r.filter(function(e){return e.baseUrls.length})},invalidateSelectedIndexes:function(e){!function e(n,r){var i=r||t;n(i.data),i.children&&i.children.forEach(function(t){return e(n,t)})}(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=a)})},setConfig:function(e){e.adapter&&(r=e.adapter)}},d(),e}s.__dashjs_factory_name="BaseURLTreeModel",t.default=r.default.getClassFactory(s)});c(vi);var yi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(v),r=i(T);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){e=e||{};var t=void 0,n=[],i=(0,r.default)(this.context).getInstance(),a=e.updateEventName,o=e.addBlacklistEventName;function s(e){-1===n.indexOf(e)&&(n.push(e),i.trigger(a,{entry:e}))}function u(e){s(e.entry)}return t={add:s,contains:function(e){return!!(n.length&&e&&e.length)&&-1!==n.indexOf(e)},reset:function(){n=[]}},o&&i.on(o,u,t),t}a.__dashjs_factory_name="BlackListController",t.default=n.default.getClassFactory(a)});c(yi);var _i=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t=0,n=[],r=0,i=void 0,a=void 0;if((a=e.sort(function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n}).filter(function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority})).length)return a.length>1&&(a.forEach(function(e){t+=e.dvb_weight,n.push(t)}),i=Math.floor(Math.random()*(t-1)),n.every(function(e,t){return r=t,!(i<e)})),a[r]}(function(e){var n=[];return e.filter(function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1)}).filter(function(e){return!n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority)})}(e))}}}i.__dashjs_factory_name="DVBSelector",t.default=r.default.getClassFactory(i)});c(_i);var Ti=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(e){var t=(e=e||{}).blacklistController;return{select:function(e){var n=0,r=void 0;return e&&e.some(function(e,r){return n=r,!t.contains(e.serviceLocation)})&&(r=e[n]),r}}}i.__dashjs_factory_name="BasicSelector",t.default=r.default.getClassFactory(i)});c(Ti);var Ei=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=d(Un),r=d(T),i=d(b),a=d(yi),o=d(_i),s=d(Ti),u=d(v),l=d(R);function d(e){return e&&e.__esModule?e:{default:e}}function c(){var e,t=this.context,u=(0,r.default)(t).getInstance(),d=void 0,c=void 0,f=void 0,h=void 0;function p(){d.reset()}return e={chooseSelector:function(e){(0,k.checkParameterType)(e,"boolean"),h=e?f:c},select:function(e){if(e){var t=e.baseUrls,r=e.selectedIdx;if(!isNaN(r))return t[r];var a=h.select(t);return a?(e.selectedIdx=t.indexOf(a),a):(u.trigger(i.default.URL_RESOLUTION_FAILED,{error:new l.default(n.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,n.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(h===c&&p()))}},reset:p,setConfig:function(e){e.selector&&(h=e.selector)}},d=(0,a.default)(t).create({updateEventName:i.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:i.default.SERVICE_LOCATION_BLACKLIST_ADD}),c=(0,s.default)(t).create({blacklistController:d}),f=(0,o.default)(t).create({blacklistController:d}),h=c,e}c.__dashjs_factory_name="BaseURLSelector",t.default=u.default.getClassFactory(c)});c(Ei);var bi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(vi),r=l(Ei),i=l(Dr),a=l(Vr),o=l(v),s=l(T),u=l(b);function l(e){return e&&e.__esModule?e:{default:e}}function d(){var e=void 0,t=void 0,o=this.context,l=(0,s.default)(o).getInstance(),d=(0,i.default)(o).getInstance(),c=void 0,f=void 0;function h(e){c.invalidateSelectedIndexes(e.entry)}return e={reset:function(){c.reset(),f.reset()},initialize:function(e){var n;c.setConfig({adapter:t}),n=e,c.update(n),f.chooseSelector(t.getIsDVB(n))},resolve:function(e){var t=c.getForPath(e).reduce(function(e,t){var n=f.select(t);return n?(d.isRelative(n.url)?e.url=d.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new a.default},new a.default);if(!d.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(c=e.baseURLTreeModel),e.baseURLSelector&&(f=e.baseURLSelector),e.adapter&&(t=e.adapter)}},c=(0,n.default)(o).create(),f=(0,r.default)(o).create(),l.on(u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,h,e),e}d.__dashjs_factory_name="BaseURLController",t.default=o.default.getClassFactory(d)});c(bi);var Si=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(p),r=i(I);function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.url=e||null,i.type=r||null,i.mediaType=n.default.STREAM,i.responseType="",i}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a});c(Si);var Ai=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(R),r=l(ri),i=l(Si),a=l(T),o=l(b),s=l(v),u=l(Un);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t="urn:mpeg:dash:resolve-to-zero:2013",s=this.context,l=(0,a.default)(s).getInstance(),d=(0,r.default)(s).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings?e.settings.get().streaming.lowLatencyEnabled:null,errors:u.default});return{load:function(e,r,a){var s=function(t,i){r.resolved=!0,r.resolvedContent=t||null,l.trigger(o.default.XLINK_ELEMENT_LOADED,{element:r,resolveObject:a,error:t||i?null:new n.default(u.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,u.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if(e===t)s(null,!0);else{var c=new i.default(e,w.HTTPRequest.XLINK_EXPANSION_TYPE);d.load({request:c,success:function(e){s(e)},error:function(){s(null)}})}},reset:function(){d&&(d.abort(),d=null)}}}d.__dashjs_factory_name="XlinkLoader",t.default=s.default.getClassFactory(d)});c(Ai);var wi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=e||{},void 0===e.escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1);var t={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function n(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function r(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function i(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"===typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"===typeof a&&a(t,n,r))break}return i!=e.length}function a(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&i(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function o(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function s(n,r,a,o){return!(r==t.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||i(e.xmlElementsFilter,n,a,o)}function u(r,l){if(r.nodeType==t.DOCUMENT_NODE){for(var d=new Object,c=r.childNodes,f=0;f<c.length;f++)(p=c[f]).nodeType==t.ELEMENT_NODE&&(e.ignoreRoot?d=u(p):(d={})[g=n(p)]=u(p));return d}if(r.nodeType==t.ELEMENT_NODE){(d=new Object).__cnt=0;var h=[];for(c=r.childNodes,f=0;f<c.length;f++){var p,g=n(p=c[f]);if(p.nodeType!=t.COMMENT_NODE){var m=l+"."+g;if(s(d,p.nodeType,g,m))if(d.__cnt++,null==d[g]){var v=u(p,m);("#text"!=g||/[^\s]/.test(v))&&((y={})[g]=v,h.push(y)),d[g]=v,a(d,g,m)}else{var y;null!=d[g]&&(d[g]instanceof Array||(d[g]=[d[g]],a(d,g,m))),v=u(p,m),("#text"!=g||/[^\s]/.test(v))&&((y={})[g]=v,h.push(y)),d[g][d[g].length]=v}}}d.__children=h;for(var _=n(r),T=0;T<r.attributes.length;T++){var E=r.attributes[T];d.__cnt++;for(var b=E.value,S=0,A=e.matchers.length;S<A;S++){var w=e.matchers[S];w.test(E,_)&&(b=w.converter(E.value))}d[e.attributePrefix+E.name]=b}var I=function(e){return e.prefix}(r);return null!=I&&""!=I&&(d.__cnt++,d.__prefix=I),null!=d["#text"]&&(d.__text=d["#text"],d.__text instanceof Array&&(d.__text=d.__text.join("\n")),e.stripWhitespaces&&(d.__text=d.__text.trim()),delete d["#text"],"property"==e.arrayAccessForm&&delete d["#text_asArray"],d.__text=function(t,n,r){if(e.datetimeAccessFormPaths.length>0){var a=r.split(".#")[0];return i(e.datetimeAccessFormPaths,t,n,a)?o(t):t}return t}(d.__text,g,l+"."+g)),null!=d["#cdata-section"]&&(d.__cdata=d["#cdata-section"],delete d["#cdata-section"],"property"==e.arrayAccessForm&&delete d["#cdata-section_asArray"]),0==d.__cnt&&"text"==e.emptyNodeForm?d="":1==d.__cnt&&null!=d.__text?d=d.__text:1!=d.__cnt||null==d.__cdata||e.keepCData?d.__cnt>1&&null!=d.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==d.__text||""==d.__text.trim())&&delete d.__text:d=d.__cdata,delete d.__cnt,!e.enableToStringFunc||null==d.__text&&null==d.__cdata||(d.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),d}if(r.nodeType==t.TEXT_NODE||r.nodeType==t.CDATA_SECTION_NODE)return r.nodeValue}function l(t,n,i,a){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=i)for(var s=0;s<i.length;s++){var u=i[s],l=t[u];e.escapeMode&&(l=r(l)),o+=" "+u.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?o+='"'+l+'"':o+="'"+l+"'"}return o+=a?"/>":">"}function d(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function c(t,n){return"property"==e.arrayAccessForm&&(r=n.toString(),i="_asArray",-1!==r.indexOf(i,r.length-i.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var r,i}function f(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t}function h(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||i(e.jsonPropertiesFilter,t,n,r)}function p(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function g(t){var n="";return t instanceof Object?n+=function(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=r(t.__text):n+=t.__text),n}(t):null!=t&&(e.escapeMode?n+=r(t):n+=t),n}function m(e,t){return""===e?t:e+"."+t}function v(e,t,n,r){var i="";if(0==e.length)i+=l(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=l(e[a],t,p(e[a]),!1),i+=y(e[a],m(r,t)),i+=d(e[a],t);return i}function y(e,t){var n="";if(f(e)>0)for(var r in e)if(!c(e,r)&&(""==t||h(e,r,m(t,r)))){var i=e[r],a=p(i);null==i||void 0==i?n+=l(i,r,a,!0):i instanceof Object?i instanceof Array?n+=v(i,r,a,t):i instanceof Date?(n+=l(i,r,a,!1),n+=i.toISOString(),n+=d(i,r)):f(i)>0||null!=i.__text||null!=i.__cdata?(n+=l(i,r,a,!1),n+=y(i,m(t,r)),n+=d(i,r)):n+=l(i,r,a,!0):(n+=l(i,r,a,!1),n+=g(i),n+=d(i,r))}return n+=g(e)}this.parseXmlString=function(e){var t;if(window.ActiveXObject||window,void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(r){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"===typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?o(e):e},this.xml2json=function(e){return u(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return y(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}});c(wi);var Ii=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(Ai),r=l(T),i=l(b),a=l(v),o=l(wi),s=l(Dr),u=l(g);function l(e){return e&&e.__esModule?e:{default:e}}var d="onLoad",c="onActuate",f="urn:mpeg:dash:resolve-to-zero:2013";function h(e){e=e||{};var t=this.context,a=(0,r.default)(t).getInstance(),l=(0,s.default)(t).getInstance(),h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0;function _(e,t,n){var r={},i=void 0,a=void 0;r.elements=e,r.type=t,r.resolveType=n,0===r.elements.length&&E(r);for(var o=0;o<r.elements.length;o++)i=r.elements[o],a=l.isHTTPURL(i.url)?i.url:i.originalContent.BaseURL+i.url,y.load(a,i,r)}function T(e){var t,n=void 0,r="";if(n=e.element,t=e.resolveObject,n.resolvedContent){var i=0;0===n.resolvedContent.indexOf("<?xml")&&(i=n.resolvedContent.indexOf("?>")+2),r=n.resolvedContent.substr(0,i)+"<response>"+n.resolvedContent.substr(i)+"</response>",n.resolvedContent=v.xml_str2json(r)}(function(e){var t=void 0;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(t)&&E(t)}function E(e){var t=[],n=void 0,r=void 0;if(function(e){var t=[],n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;for(a=e.elements.length-1;a>=0;a--){if(n=e.elements[a],r=n.type+"_asArray",n.resolvedContent){if(n.resolvedContent)for(o=0;o<n.resolvedContent[r].length;o++)i=n.resolvedContent[r][o],t.push(i)}else delete n.originalContent["xlink:actuate"],delete n.originalContent["xlink:href"],t.push(n.originalContent);for(n.parentElement[r].splice(n.index,1),s=0;s<t.length;s++)n.parentElement[r].splice(n.index+s,0,t[s]);t=[]}e.elements.length>0&&g.run(m)}(e),e.resolveType===c&&a.trigger(i.default.XLINK_READY,{manifest:m}),e.resolveType===d)switch(e.type){case u.default.PERIOD:for(n=0;n<m[u.default.PERIOD+"_asArray"].length;n++)(r=m[u.default.PERIOD+"_asArray"][n]).hasOwnProperty(u.default.ADAPTATION_SET+"_asArray")&&(t=t.concat(b(r[u.default.ADAPTATION_SET+"_asArray"],r,u.default.ADAPTATION_SET,d))),r.hasOwnProperty(u.default.EVENT_STREAM+"_asArray")&&(t=t.concat(b(r[u.default.EVENT_STREAM+"_asArray"],r,u.default.EVENT_STREAM,d)));_(t,u.default.ADAPTATION_SET,d);break;case u.default.ADAPTATION_SET:a.trigger(i.default.XLINK_READY,{manifest:m})}}function b(e,t,n,r){var i=[],a=void 0,o=void 0,s=void 0;for(o=e.length-1;o>=0;o--)(a=e[o]).hasOwnProperty("xlink:href")&&a["xlink:href"]===f&&e.splice(o,1);for(o=0;o<e.length;o++)(a=e[o]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===r&&(s=S(a["xlink:href"],t,n,o,r,a),i.push(s));return i}function S(e,t,n,r,i,a){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}return h={resolveManifestOnLoad:function(e){v=new o.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:p}),_(b((m=e).Period_asArray,m,u.default.PERIOD,d),u.default.PERIOD,d)},setMatchers:function(e){e&&(p=e)},setIron:function(e){e&&(g=e)},reset:function(){a.off(i.default.XLINK_ELEMENT_LOADED,T,h),y&&(y.reset(),y=null)}},a.on(i.default.XLINK_ELEMENT_LOADED,T,h),y=(0,n.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),h}h.__dashjs_factory_name="XlinkController",t.default=a.default.getClassFactory(h)});c(Ii);var Ci=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=(n=v)&&n.__esModule?n:{default:n};function a(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,i){for(var a=0,o=e.length;a<o;++a){var s=e[a];if(n[s.name])if(i[s.name]){if(s.merge){var u=n[s.name],l=i[s.name];"object"===("undefined"===typeof u?"undefined":r(u))&&"object"===("undefined"===typeof l?"undefined":r(l))?t(u,l):i[s.name]=u+l}}else i[s.name]=n[s.name]}}function i(e,t){for(var r=0,a=e.children.length;r<a;++r){var o=e.children[r],s=t[o.name+"_asArray"];if(s)for(var u=0,l=s.length;u<l;++u){var d=s[u];n(e.properties,t,d),i(o,d)}}}return{run:function(t){if(null===t||"object"!==("undefined"===typeof t?"undefined":r(t)))return t;if("period"in e)for(var n=e.period,a=t.Period_asArray,o=0,s=a.length;o<s;++o){var u=a[o];if(i(n,u),"adaptationset"in e){var l=u.AdaptationSet_asArray;if(l)for(var d=e.adaptationset,c=0,f=l.length;c<f;++c)i(d,l[c])}}return t}}}a.__dashjs_factory_name="ObjectIron";var o=i.default.getClassFactory(a);t.default=o});c(Ci);var Ri=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=n}return n(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=r});c(Ri);var Di=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Ri),r=i(g);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e,t){var n,i=(a(n={},r.default.MPD,[r.default.ID,r.default.PROFILES]),a(n,r.default.PERIOD,[r.default.ID]),a(n,r.default.BASE_URL,[r.default.SERVICE_LOCATION,r.default.BYTE_RANGE]),a(n,r.default.SEGMENT_BASE,[r.default.INDEX_RANGE]),a(n,r.default.INITIALIZATION,[r.default.RANGE]),a(n,r.default.REPRESENTATION_INDEX,[r.default.RANGE]),a(n,r.default.SEGMENT_LIST,[r.default.INDEX_RANGE]),a(n,r.default.BITSTREAM_SWITCHING,[r.default.RANGE]),a(n,r.default.SEGMENT_URL,[r.default.MEDIA_RANGE,r.default.INDEX_RANGE]),a(n,r.default.SEGMENT_TEMPLATE,[r.default.INDEX_RANGE,r.default.MEDIA,r.default.INDEX,r.default.INITIALIZATION_MINUS,r.default.BITSTREAM_SWITCHING_MINUS]),a(n,r.default.ASSET_IDENTIFIER,[r.default.VALUE,r.default.ID]),a(n,r.default.EVENT_STREAM,[r.default.VALUE]),a(n,r.default.ADAPTATION_SET,[r.default.PROFILES,r.default.MIME_TYPE,r.default.SEGMENT_PROFILES,r.default.CODECS,r.default.CONTENT_TYPE]),a(n,r.default.FRAME_PACKING,[r.default.VALUE,r.default.ID]),a(n,r.default.AUDIO_CHANNEL_CONFIGURATION,[r.default.VALUE,r.default.ID]),a(n,r.default.CONTENT_PROTECTION,[r.default.VALUE,r.default.ID]),a(n,r.default.ESSENTIAL_PROPERTY,[r.default.VALUE,r.default.ID]),a(n,r.default.SUPPLEMENTAL_PROPERTY,[r.default.VALUE,r.default.ID]),a(n,r.default.INBAND_EVENT_STREAM,[r.default.VALUE,r.default.ID]),a(n,r.default.ACCESSIBILITY,[r.default.VALUE,r.default.ID]),a(n,r.default.ROLE,[r.default.VALUE,r.default.ID]),a(n,r.default.RATING,[r.default.VALUE,r.default.ID]),a(n,r.default.VIEWPOINT,[r.default.VALUE,r.default.ID]),a(n,r.default.CONTENT_COMPONENT,[r.default.CONTENT_TYPE]),a(n,r.default.REPRESENTATION,[r.default.ID,r.default.DEPENDENCY_ID,r.default.MEDIA_STREAM_STRUCTURE_ID]),a(n,r.default.SUBSET,[r.default.ID]),a(n,r.default.METRICS,[r.default.METRICS_MINUS]),a(n,r.default.REPORTING,[r.default.VALUE,r.default.ID]),n);if(i.hasOwnProperty(t)){var o=i[t];return void 0!==o&&o.indexOf(e.name)>=0}return!1},function(e){return String(e)}))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),t}();t.default=o});c(Di);var Mi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(Ri),r=a(p),i=a(g);function a(e){return e&&e.__esModule?e:{default:e}}var o=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,s=31536e3,u=2592e3,l=86400,d=3600,c=60,f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){for(var t=[i.default.MIN_BUFFER_TIME,i.default.MEDIA_PRESENTATION_DURATION,i.default.MINIMUM_UPDATE_PERIOD,i.default.TIMESHIFT_BUFFER_DEPTH,i.default.MAX_SEGMENT_DURATION,i.default.MAX_SUBSEGMENT_DURATION,i.default.SUGGESTED_PRESENTATION_DELAY,i.default.START,r.default.START_TIME,i.default.DURATION],n=t.length,a=0;a<n;a++)if(e.nodeName===t[a])return o.test(e.value);return!1},function(e){var t=o.exec(e),n=parseFloat(t[3]||0)*s+parseFloat(t[5]||0)*u+parseFloat(t[7]||0)*l+parseFloat(t[9]||0)*d+parseFloat(t[11]||0)*c+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n}))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),t}();t.default=f});c(Mi);var Oi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Ri)&&n.__esModule?n:{default:n};var i=60,a=60,o=1e3,s=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){return s.test(e.value)},function(e){var t=s.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*o||0),t[9]&&t[10]){var r=parseInt(t[9],10)*a+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*r*i*o}return new Date(n)}))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=u});c(Oi);var Ni=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Ri)&&n.__esModule?n:{default:n};var i=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){return i.test(e.value)},function(e){return parseFloat(e)}))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a});c(Ni);var Pi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n;this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase()}return n(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=r});c(Pi);var Li=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(n=Pi)&&n.__esModule?n:{default:n};var a=function(){function e(t,n,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=r||[],Array.isArray(n)&&n.forEach(function(e){a._properties.push(new i.default(e))})}return r(e,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=a});c(Li);var ki=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Li),r=i(g);function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[r.default.PROFILES,r.default.WIDTH,r.default.HEIGHT,r.default.SAR,r.default.FRAMERATE,r.default.AUDIO_SAMPLING_RATE,r.default.MIME_TYPE,r.default.SEGMENT_PROFILES,r.default.CODECS,r.default.MAXIMUM_SAP_PERIOD,r.default.START_WITH_SAP,r.default.MAX_PLAYOUT_RATE,r.default.CODING_DEPENDENCY,r.default.SCAN_TYPE,r.default.FRAME_PACKING,r.default.AUDIO_CHANNEL_CONFIGURATION,r.default.CONTENT_PROTECTION,r.default.ESSENTIAL_PROPERTY,r.default.SUPPLEMENTAL_PROPERTY,r.default.INBAND_EVENT_STREAM];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default.ADAPTATION_SET,e,[new n.default(r.default.REPRESENTATION,e,[new n.default(r.default.SUB_REPRESENTATION,e)])]))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),t}();t.default=a});c(ki);var xi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Li),r=i(g);function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[r.default.SEGMENT_BASE,r.default.SEGMENT_TEMPLATE,r.default.SEGMENT_LIST];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default.PERIOD,e,[new n.default(r.default.ADAPTATION_SET,e,[new n.default(r.default.REPRESENTATION,e)])]))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),t}();t.default=a});c(xi);var Fi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=c(v),r=c(Ci),i=c(wi),a=c(Di),o=c(Mi),s=c(Oi),u=c(Ni),l=c(ki),d=c(xi);function c(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=e.debug,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0;return c={parse:function(e){var t=void 0,n=window.performance.now();if(!(t=p.xml_str2json(e)))throw new Error("parsing the manifest failed");var r=window.performance.now();g.run(t);var i=window.performance.now();return f.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(i-r).toPrecision(3)+"ms, total: "+((i-n)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return h},getIron:function(){return g}},f=n.getLogger(c),h=[new o.default,new s.default,new u.default,new a.default],p=new i.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!0,matchers:h}),g=(0,r.default)(t).create({adaptationset:new l.default,period:new d.default}),c}f.__dashjs_factory_name="DashParser",t.default=n.default.getClassFactory(f)});c(Fi);var Ui=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=m(p),r=m(g),i=m(Ii),a=m(ri),o=m(Dr),s=m(Si),u=m(R),l=m(T),d=m(b),c=m(Un),f=m(v),h=m(Fi);function m(e){return e&&e.__esModule?e:{default:e}}function y(e){e=e||{};var t=this.context,f=e.debug,p=(0,l.default)(t).getInstance(),g=(0,o.default)(t).getInstance(),m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=e.mssHandler,b=e.errHandler;function S(e){p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return m={load:function(e){var r=new s.default(e,w.HTTPRequest.MPD_TYPE);y.load({request:r,success:function(r,i,a){if(_){var o=void 0,s=void 0,l=void 0;if(a&&a!==e?(s=g.parseBaseUrl(a),o=a):(g.isRelative(e)&&(e=g.resolve(e,window.location.href)),s=g.parseBaseUrl(e)),null===T&&(T=function(e){var n=null;return e.indexOf("SmoothStreamingMedia")>-1?(E&&(n=E.createMssParser(),E.registerEvents()),n):e.indexOf("MPD")>-1?(0,h.default)(t).create({debug:f}):n}(r)),null!==T){_.setMatchers(T.getMatchers()),_.setIron(T.getIron());try{l=T.parse(r)}catch(m){return void p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(c.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,c.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}l?(l.url=o||e,l.originalUrl||(l.originalUrl=l.url),l.hasOwnProperty(n.default.LOCATION)&&(s=g.parseBaseUrl(l.Location_asArray[0]),v.debug("BaseURI set by Location to: "+s)),l.baseUri=s,l.loadedTime=new Date,_.resolveManifestOnLoad(l),p.trigger(d.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:r})):p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(c.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,c.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}else p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(c.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,c.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}},error:function(t,n,r){p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(c.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,c.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(e+", ")+r)})}})},reset:function(){p.off(d.default.XLINK_READY,S,m),_&&(_.reset(),_=null),y&&(y.abort(),y=null),E&&E.reset()}},v=f.getLogger(m),p.on(d.default.XLINK_READY,S,m),y=(0,a.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:g,constants:n.default,dashConstants:r.default,errors:c.default}),_=(0,i.default)(t).create({errHandler:b,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),T=null,m}y.__dashjs_factory_name="ManifestLoader";var _=f.default.getClassFactory(y);t.default=_});c(Ui);var Bi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(T),r=a(b),i=a(v);function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.context,t=(0,n.default)(e).getInstance();return{error:function(e){t.trigger(r.default.ERROR,{error:e})}}}o.__dashjs_factory_name="ErrorHandler",t.default=i.default.getSingletonFactory(o)});c(Bi);var ji=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(){var e,t=void 0;return e={supportsMediaSource:function(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsEncryptedMedia:function(){return t},supportsCodec:function(e){return!!("MediaSource"in window&&MediaSource.isTypeSupported(e))||!!("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(e))},setEncryptedMediaSupported:function(e){t=e}},t=!1,e}i.__dashjs_factory_name="Capabilities",t.default=r.default.getSingletonFactory(i)});c(ji);var Gi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null}});c(Gi);var qi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Gi),r=i(v);function i(e){return e&&e.__esModule?e:{default:e}}function a(){var e=void 0;return{initialize:function(t){if(e=new n.default,!t)return null;var r=t.indexOf("#");if(-1!==r)for(var i=t.substr(r+1).split("&"),a=0,o=i.length;a<o;++a){var s=i[a],u=s.indexOf("=");if(-1!==u){var l=s.substring(0,u);e.hasOwnProperty(l)&&(e[l]=s.substr(u+1))}}},getURIFragmentData:function(){return e}}}a.__dashjs_factory_name="URIFragmentModel",t.default=r.default.getSingletonFactory(a)});c(qi);var Hi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(T),r=a(b),i=a(v);function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.context,t=(0,n.default)(e).getInstance(),i=void 0;return{getValue:function(){return i},setValue:function(e){i=e,e&&t.trigger(r.default.MANIFEST_LOADED,{data:e})}}}o.__dashjs_factory_name="ManifestModel",t.default=i.default.getSingletonFactory(o)});c(Hi);var Vi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(qr),r=s(v),i=s(p),a=s(ir),o=s(kr);function s(e){return e&&e.__esModule?e:{default:e}}var u=12,l=20,d=3,c=10,f=5,h=4,g=5,m=!1;function y(){var e,t=void 0,r=void 0,s=void 0,p={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"},v=this.context,y=(0,o.default)(v).getInstance();function _(e){var t=void 0;for(t=0;t<s.length;t++)if(s[t].rulename===e)return t;return-1}function T(){return y.get().streaming.lowLatencyEnabled?y.get().streaming.liveDelay||d:y.get().streaming.liveDelay}function E(e,r){b(e,r);var i=new n.default;i.schemeIdUri=e,i.value=r,t.push(i)}function b(e,n){(0,k.checkParameterType)(e,"string"),(0,k.checkParameterType)(n,"string"),t.forEach(function(r,i){r.schemeIdUri===e&&r.value===n&&t.splice(i,1)})}return e={getABRCustomRules:function(){return s},addABRCustomRule:function(e,t,n){if("string"!==typeof e||e!==a.default.ABANDON_FRAGMENT_RULES&&e!==a.default.QUALITY_SWITCH_RULES||"string"!==typeof t)throw i.default.BAD_ARGUMENT_ERROR;var r=_(t);-1===r?s.push({type:e,rulename:t,rule:n}):(s[r].type=e,s[r].rule=n)},removeABRCustomRule:function(e){if(e){var t=_(e);-1!==t&&s.splice(t,1)}else s=[]},getStableBufferTime:function(){if(y.get().streaming.lowLatencyEnabled)return.6*T();var e=y.get().streaming.stableBufferTime;return e>-1?e:y.get().streaming.fastSwitchEnabled?l:u},getRetryAttemptsForType:function(e){var t=isNaN(y.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?f:y.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return y.get().streaming.lowLatencyEnabled?y.get().streaming.retryAttempts[e]*t:y.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(y.get().streaming.retryIntervals.lowLatencyReductionFactor)?c:y.get().streaming.retryIntervals.lowLatencyReductionFactor;return y.get().streaming.lowLatencyEnabled?y.get().streaming.retryIntervals[e]/t:y.get().streaming.retryIntervals[e]},getLiveDelay:T,getLiveCatchupLatencyThreshold:function(){try{var e=y.get().streaming.liveCatchup.latencyThreshold,t=T();if(null!==e&&!isNaN(e))return Math.max(e,t);var n=y.get().streaming.liveCatchup.minDrift,r=!isNaN(t)&&t?isNaN(n)?T():y.get().streaming.liveCatchup.minDrift+T():NaN;return r&&!isNaN(r)?Math.max(r*h,g):NaN}catch(i){return NaN}},addUTCTimingSource:E,removeUTCTimingSource:b,getUTCTimingSources:function(){return t},clearDefaultUTCTimingSources:function(){t=[]},restoreDefaultUTCTimingSources:function(){E(p.scheme,p.value)},setXHRWithCredentialsForType:function e(t,n){t?r[t]=!!n:Object.keys(r).forEach(function(t){e(t,n)})},getXHRWithCredentialsForType:function(e){var t=r[e];return void 0===t?r.default:t},getDefaultUtcTimingSource:function(){return p},reset:function(){}},t=[],r={default:m},s=[],e}y.__dashjs_factory_name="MediaPlayerModel",t.default=r.default.getSingletonFactory(y)});c(Vi);var Ki=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(v),r=o(T),i=o(b),a=o(S);function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=void 0,t=void 0,n=void 0,o=void 0,s=void 0,u="element is not video or audio DOM type!",l=this.context,d=(0,r.default)(l).getInstance(),c=[];function f(){n&&(n.playbackRate=s||1,n.removeEventListener("canplay",f))}function h(e){n&&(n.readyState<=2&&e>0?n.addEventListener("canplay",f):n.playbackRate=e)}function p(){return c.length>0}function g(e){var t=c.indexOf(e),r=void 0;null!==e&&(-1!==t&&c.splice(t,1),n&&!1===p()&&0===n.playbackRate&&(h(s||1),n.paused||((r=document.createEvent("Event")).initEvent("playing",!0,!1),n.dispatchEvent(r))))}function m(){if(n&&p()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function v(){return n?n.buffered:null}function y(e,t,r,i,a){if(n)for(var o=0;o<n.textTracks.length;o++)if(n.textTracks[o].kind===e&&(!t||n.textTracks[o].label==t)&&n.textTracks[o].language===r&&n.textTracks[o].isTTML===i&&n.textTracks[o].isEmbedded===a)return n.textTracks[o];return null}return e={initialize:function(){d.on(i.default.PLAYBACK_PLAYING,m,this)},setCurrentTime:function(e,t){if(n){if(n.currentTime==e)return;try{e=t?function(e){var t=v(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),u=Math.abs(o-e);if(e>=a&&e<=o)return e;s<r&&(r=s,n=a),u<r&&(r=u,n=o)}return n}(e):e,n.currentTime=e}catch(r){0===n.readyState&&r.code===r.INVALID_STATE_ERR&&setTimeout(function(){n.currentTime=e},400)}}},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!==typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&d.trigger(i.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing ("+e+")")})}},isPaused:function(){return n?n.paused:null},pause:function(){n&&(n.pause(),n.autoplay=!1)},isStalled:p,isSeeking:function(){return n?n.seeking:null},getTime:function(){return n?n.currentTime:null},getPlaybackRate:function(){return n?n.playbackRate:null},setPlaybackRate:h,getPlayedRanges:function(){return n?n.played:null},getEnded:function(){return n?n.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){var t=void 0;null!==e&&n&&!n.seeking&&-1===c.indexOf(e)&&(c.push(e),n&&1===c.length&&((t=document.createEvent("Event")).initEvent("waiting",!0,!1),s=n.playbackRate,h(0),n.dispatchEvent(t)))}(e):g(e)}(e,t)},getElement:function(){return n},setElement:function(e){if(!(null===e||void 0===e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw u;(n=e)&&(n.preload="auto")},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return o},setTTMLRenderingDiv:function(e){(o=e).style.position="absolute",o.style.display="flex",o.style.overflow="hidden",o.style.pointerEvents="none",o.style.top=0,o.style.left=0},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:function(e,t){n&&n.addEventListener(e,t)},removeEventListener:function(e,t){n&&n.removeEventListener(e,t)},getReadyState:function(){return n?n.readyState:NaN},getBufferRange:v,getClientWidth:function(){return n?n.clientWidth:NaN},getClientHeight:function(){return n?n.clientHeight:NaN},getTextTracks:function(){return n?n.textTracks:[]},getTextTrack:y,addTextTrack:function(e,t,r,i,a){if(!n)return null;var o=y(e,t,r,i,a);return o||((o=n.addTextTrack(e,t,r)).isEmbedded=a,o.isTTML=i),o},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){n&&n.removeChild(e)},getVideoWidth:function(){return n?n.videoWidth:NaN},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN},reset:function(){d.off(i.default.PLAYBACK_PLAYING,m,this)}},t=(0,a.default)(l).getInstance().getLogger(e),e}s.__dashjs_factory_name="VideoModel",t.default=n.default.getSingletonFactory(s)});c(Ki);var Yi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(v),r=a(S),i=a(p);function a(e){return e&&e.__esModule?e:{default:e}}var o=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],s="dashjs_?_bitrate",u="dashjs_?_settings",l="localStorage",d="sessionStorage",c="lastBitrate",f="lastMediaSettings";function h(e){e=e||{};var t=this.context,n=e.settings,a=void 0,h=void 0,p=void 0;function g(e){if(void 0!==p)return p;p=!1;var t=void 0;try{"undefined"!==typeof window&&(t=window[e])}catch(n){return h.warn("DOMStorage access denied: "+n.message),p}if(!t||e!==l&&e!==d)return p;try{t.setItem("1","1"),t.removeItem("1"),p=!0}catch(n){h.warn("DOMStorage is supported, but cannot be used: "+n.message)}return p}function m(){return 6e5*Math.round((new Date).getTime()/6e5)}function v(e,t){return g(e)&&n.get().streaming[t+"CachingInfo"].enabled}function y(){if(!n)throw new Error(i.default.MISSING_CONFIG_ERROR)}return a={getSavedBitrateSettings:function(e){var t=NaN;if(y(),v(l,c)){var r=s.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=n.get().streaming.lastBitrateCachingInfo.ttl||!1,o=parseFloat(i.bitrate);isNaN(o)||a?a&&localStorage.removeItem(r):(t=o,h.debug("Last saved bitrate for "+e+" was "+o))}catch(u){return null}}return t},setSavedBitrateSettings:function(e,t){if(v(l,c)&&t){var n=s.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:m()}))}catch(r){h.error(r.message)}}},getSavedMediaSettings:function(e){var t=null;if(y(),v(l,f)){var r=u.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=n.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=i.settings,a&&(localStorage.removeItem(r),t=null)}catch(o){return null}}return t},setSavedMediaSettings:function(e,t){if(v(l,f)){var n=u.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:m()}))}catch(r){h.error(r.message)}}}},h=(0,r.default)(t).getInstance().getLogger(a),g(l)&&o.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(n){h.error(n.message)}}}),a}h.__dashjs_factory_name="DOMStorage";var g=n.default.getSingletonFactory(h);t.default=g});c(Yi);var Wi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=function(){return n};var n="3.2.0"});c(Wi);Wi.getVersionString;var zi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(_r),r=s(R),i=s(v),a=s(I),o=s(ri);function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=void 0,i=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0;function E(){if(!T||!T.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function b(e){if(e.url){var t=new a.default;return t.setInfo(e),t}}function S(e,t,n,i){g.trigger(p.SEGMENTS_LOADED,{segments:n,representation:i,error:n?void 0:new r.default(m.SEGMENT_BASE_LOADER_ERROR_CODE,m.SEGMENT_BASE_LOADER_ERROR_MESSAGE)},{streamId:e,mediaType:t})}return t={setConfig:function(e){e.baseURLController&&(T=e.baseURLController),e.dashMetrics&&(d=e.dashMetrics),e.mediaPlayerModel&&(f=e.mediaPlayerModel),e.errHandler&&(s=e.errHandler),e.settings&&(c=e.settings),e.boxParser&&(u=e.boxParser),e.events&&(p=e.events),e.eventBus&&(g=e.eventBus),e.debug&&(i=e.debug.getLogger(t)),e.requestModifier&&(l=e.requestModifier),e.errors&&(m=e.errors),e.urlUtils&&(_=e.urlUtils),e.constants&&(v=e.constants),e.dashConstants&&(y=e.dashConstants)},initialize:function(){h=(0,o.default)(e).create({errHandler:s,dashMetrics:d,mediaPlayerModel:f,requestModifier:l,useFetch:c?c.get().streaming.lowLatencyEnabled:null,boxParser:u,errors:m,urlUtils:_,constants:v,dashConstants:y})},loadInitialization:function e(t,n,r,a){E();var o=null,s=r?T.resolve(r.path):null,l=a||{init:!0,url:s?s.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:n};i.debug("Start searching for initialization.");var d=b(l);h.load({request:d,success:function(i){l.bytesLoaded=l.range.end,(o=u.findInitRange(i))?(r.range=o,g.trigger(p.INITIALIZATION_LOADED,{representation:r},{streamId:t,mediaType:n})):(l.range.end=l.bytesLoaded+l.bytesToLoad,e(t,n,r,l))},error:function(){g.trigger(p.INITIALIZATION_LOADED,{representation:r},{streamId:t,mediaType:n})}}),i.debug("Perform init search: "+l.url)},loadSegments:function e(t,r,a,o,s,l){if(E(),o&&(void 0===o.start||void 0===o.end)){var d=o?o.toString().split("-"):null;o=d?{start:parseFloat(d[0]),end:parseFloat(d[1])}:null}s=s||S;var c=null,f=null,p=!!o,g=a?T.resolve(a.path):null,m={init:!1,url:g?g.url:void 0,range:p?o:{start:0,end:1500},searching:!p,bytesLoaded:l?l.bytesLoaded:0,bytesToLoad:1500,mediaType:r},v=b(m);h.load({request:v,success:function(o){var l=m.bytesToLoad,d=o.byteLength;if(m.bytesLoaded=m.range.end-m.range.start,c=u.parse(o),(f=c.getBox("sidx"))&&f.isComplete){var h=f.references,p=void 0,g=void 0;if(null!==h&&void 0!==h&&h.length>0&&(p=1===h[0].reference_type),p){i.debug("Initiate multiple SIDX load."),m.range.end=m.range.start+f.size;var v=void 0,y=void 0,_=void 0,T=void 0,E=[],b=0,S=(f.offset||m.range.start)+f.size,A=function(e,t,n){n?(E=E.concat(n),++b>=y&&(E.sort(function(e,t){return e.startTime-t.startTime<0?-1:0}),s(e,t,E,a))):s(e,t,null,a)};for(v=0,y=h.length;v<y;v++)_=S,T=S+h[v].referenced_size-1,S+=h[v].referenced_size,e(t,r,a,{start:_,end:T},A,m)}else i.debug("Parsing segments from SIDX. representation "+r+" - id: "+a.id+" for range : "+m.range.start+" - "+m.range.end),g=function(e,t){for(var r=e.references,i=r.length,a=e.timescale,o=e.earliest_presentation_time,s=t.range.start+e.offset+e.first_offset+e.size,u=[],l=void 0,d=void 0,c=void 0,f=void 0,h=0;h<i;h++)c=r[h].subsegment_duration,f=r[h].referenced_size,(l=new n.default).duration=c,l.startTime=o,l.timescale=a,d=s+f-1,l.mediaRange=s+"-"+d,u.push(l),o+=c,s+=f;return u}(f,m),s(t,r,g,a)}else{if(f)m.range.start=f.offset||m.range.start,m.range.end=m.range.start+(f.size||l);else{if(d<m.bytesLoaded)return void s(t,r,null,a);var w=c.getLastBox();w&&w.size?(m.range.start=w.offset+w.size,m.range.end=m.range.start+l):m.range.end+=l}e(t,r,a,m.range,s,m)}},error:function(){s(t,r,null,a)}}),i.debug("Perform SIDX load: "+m.url+" with range : "+m.range.start+" - "+m.range.end)},reset:function(){h.abort(),h=null,s=null,u=null,l=null}}}u.__dashjs_factory_name="SegmentBaseLoader",t.default=i.default.getSingletonFactory(u)});c(zi);var Xi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=v)&&n.__esModule?n:{default:n};function i(e){e=e||{};var t=void 0,n=new DataView(e.data),r=0;function i(e,t){var i=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(r)!==e.tag&&(i=!1),a=4):e.tag>65535?(256*n.getUint16(r)+n.getUint8(r+2)!==e.tag&&(i=!1),a=3):e.tag>255?(n.getUint16(r)!==e.tag&&(i=!1),a=2):(n.getUint8(r)!==e.tag&&(i=!1),a=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(r+=a),i}function a(e){var t=1,i=128,a=-1,o=0,s=n.getUint8(r),u=0;for(u=0;u<8;u+=1){if((s&i)===i){o=void 0===e?s&~i:s,a=u;break}i>>=1}for(u=0;u<a;u+=1,t+=1)o=o<<8|255&n.getUint8(r+t);return r+=t,o}return t={getPos:function(){return r},setPos:function(e){r=e},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&a(),n},parseTag:function(e){var n;return i(e),n=a(),t[e.parse](n)},skipOverElement:function(e,t){var n=i(e,t),o=void 0;return n&&(o=a(),r+=o),n},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t=void 0;switch(e){case 4:t=n.getFloat32(r),r+=4;break;case 8:t=n.getFloat64(r),r+=8}return t},getMatroskaUint:function(e){for(var t=0,i=0;i<e;i+=1)t<<=8,t|=255&n.getUint8(r+i);return r+=e,t},moreData:function(){return r<n.byteLength}}}i.__dashjs_factory_name="EBMLParser",t.default=r.default.getClassFactory(i)});c(Xi);var Qi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(Xi),r=l(p),i=l(v),a=l(_r),o=l(I),s=l(ri),u=l(R);function l(e){return e&&e.__esModule?e:{default:e}}function d(){var e=this.context,t=void 0,i=void 0,l=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0;function T(t,r,o,s){var u,d,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0;for(f=[],p=0,d=(u=function(t){var r=[],i=(0,n.default)(e).create({data:t}),a=void 0,o=void 0;for(i.consumeTagAndSize(l.Segment.Cues);i.moreData()&&i.consumeTagAndSize(l.Segment.Cues.CuePoint,!0);){for((a={}).CueTime=i.parseTag(l.Segment.Cues.CuePoint.CueTime),a.CueTracks=[];i.moreData()&&i.consumeTag(l.Segment.Cues.CuePoint.CueTrackPositions,!0);){var s=i.getMatroskaCodedNum(),u=i.getPos();if((o={}).Track=i.parseTag(l.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===o.Track)throw new Error("Cue track cannot be 0");o.ClusterPosition=i.parseTag(l.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),a.CueTracks.push(o),i.setPos(u+s)}if(0===a.CueTracks.length)throw new Error("Mandatory cuetrack not found");r.push(a)}if(0===r.length)throw new Error("mandatory cuepoint not found");return r}(t)).length;p<d;p+=1)h=new a.default,c=0,c=p<u.length-1?u[p+1].CueTime-u[p].CueTime:s-u[p].CueTime,h.duration=c,h.startTime=u[p].CueTime,h.timescale=1e3,g=u[p].CueTracks[0].ClusterPosition+r,m=p<u.length-1?u[p+1].CueTracks[0].ClusterPosition+r-1:o-1,h.mediaRange=g+"-"+m,f.push(h);return i.debug("Parsed cues: "+f.length+" cues."),f}function E(){if(!_||!_.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function b(e,t,n,r){m.trigger(v.SEGMENTS_LOADED,{segments:n,representation:r,error:n?void 0:new u.default(y.SEGMENT_BASE_LOADER_ERROR_CODE,y.SEGMENT_BASE_LOADER_ERROR_MESSAGE)},{streamId:e,mediaType:t})}function S(e){var t=new o.default;return t.setInfo(e),t}return t={setConfig:function(e){if(!e.baseURLController||!e.dashMetrics||!e.mediaPlayerModel||!e.errHandler)throw new Error(r.default.MISSING_CONFIG_ERROR);_=e.baseURLController,f=e.dashMetrics,h=e.mediaPlayerModel,d=e.errHandler,g=e.settings,v=e.events,m=e.eventBus,y=e.errors,i=e.debug.getLogger(t),c=e.requestModifier},initialize:function(){p=(0,s.default)(e).create({errHandler:d,dashMetrics:f,mediaPlayerModel:h,requestModifier:c,useFetch:g?g.get().streaming.lowLatencyEnabled:null,errors:y})},loadInitialization:function(e,t,n,r){E();var a=null,o=n?_.resolve(n.path):null,s=n?n.range.split("-"):null,u=r||{range:{start:s?parseFloat(s[0]):null,end:s?parseFloat(s[1]):null},request:a,url:o?o.url:void 0,init:!0,mediaType:t};i.info("Start loading initialization."),a=S(u),p.load({request:a,success:function(){m.trigger(v.INITIALIZATION_LOADED,{representation:n},{streamId:e,mediaType:t})},error:function(){m.trigger(v.INITIALIZATION_LOADED,{representation:n},{streamId:e,mediaType:t})}}),i.debug("Perform init load: "+u.url)},loadSegments:function(t,r,a,o,s){E();var u=null,d=a?_.resolve(a.path):null,c=d?d.url:void 0;s=s||b,u=S({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:u,url:c,init:!1,mediaType:r}),i.debug("Parsing ebml header"),p.load({request:u,success:function(u){!function(t,r,a,o){if(t&&0!==t.byteLength){var s,u=(0,n.default)(e).create({data:t}),d=void 0,c=void 0,f=void 0,h=a?a.split("-"):null,g=null,m={url:r,range:{start:h?parseFloat(h[0]):null,end:h?parseFloat(h[1]):null},request:g};for(i.debug("Parse EBML header: "+m.url),u.skipOverElement(l.EBML),u.consumeTag(l.Segment),f=u.getMatroskaCodedNum(),f+=u.getPos(),s=u.getPos();u.moreData()&&!u.consumeTagAndSize(l.Segment.Info,!0);)if(!(u.skipOverElement(l.Segment.SeekHead,!0)||u.skipOverElement(l.Segment.Tracks,!0)||u.skipOverElement(l.Segment.Cues,!0)||u.skipOverElement(l.Void,!0)))throw new Error("no valid top level element found");for(;void 0===d;){var v=u.getMatroskaCodedNum(!0),y=u.getMatroskaCodedNum();switch(v){case l.Segment.Info.Duration.tag:d=u[l.Segment.Info.Duration.parse](y);break;default:u.setPos(u.getPos()+y)}}g=S(m),p.load({request:g,success:function(e){c=T(e,s,f,d),o(c)},error:function(){i.error("Download Error: Cues "+m.url),o(null)}}),i.debug("Perform cues load: "+m.url+" bytes="+m.range.start+"-"+m.range.end)}else o(null)}(u,c,o,function(e){s(t,r,e,a)})},error:function(){s(t,r,null,a)}})},reset:function(){d=null,c=null}},l={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},t}d.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=i.default.getSingletonFactory(d)});c(Qi);var $i=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(v),r=a(zi),i=a(Qi);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=this.context,n=e.eventBus,a=e.events,o=e.dashMetrics,s=e.mediaPlayerModel,u=e.errHandler,l=e.baseURLController,d=e.debug,c=e.boxParser,f=e.requestModifier,h=e.errors,p=void 0,g=void 0,m=void 0;function v(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}function y(e){v(e.mimeType)?m.loadInitialization(e.streamId,e.mediaType,e.representation):g.loadInitialization(e.streamId,e.mediaType,e.representation)}function _(e){v(e.mimeType)?m.loadSegments(e.streamId,e.mediaType,e.representation,e.representation?e.representation.indexRange:null,e.callback):g.loadSegments(e.streamId,e.mediaType,e.representation,e.representation?e.representation.indexRange:null,e.callback)}return p={initialize:function(){n.on(a.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.on(a.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,_,p),g.initialize(),m.initialize()},reset:function(){n.off(a.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.off(a.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,_,p)}},g=(0,r.default)(t).getInstance(),m=(0,i.default)(t).getInstance(),g.setConfig({baseURLController:l,dashMetrics:o,mediaPlayerModel:s,errHandler:u,eventBus:n,events:a,errors:h,debug:d,boxParser:c,requestModifier:f}),m.setConfig({baseURLController:l,dashMetrics:o,mediaPlayerModel:s,errHandler:u,eventBus:n,events:a,errors:h,debug:d,requestModifier:f}),p}o.__dashjs_factory_name="SegmentBaseController";var s=n.default.getSingletonFactory(o);t.default=s});c($i);var Zi=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null}});c(Zi);var Ji=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}});c(Ji);var ea=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0}});c(ea);var ta=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null}});c(ta);var na=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=d(g),r=d(Zi),i=d(Ji),a=d(ea),o=d(ta),s=d(Hr),u=d(v),l=d(Jr);function d(e){return e&&e.__esModule?e:{default:e}}function c(){var e,t=void 0,u=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=this.context,g="urn:dvb:dash:profile:dvb-dash:2014";function m(e,r,i){var a,o=t.getAdaptationsForType(u[0].mpd.manifest,e,r);if(!o||0===o.length)return null;if(o.length>1&&i){var s=y(i,r);if(c[i.id]&&c[i.id][r])for(var l=0,d=o.length;l<d;l++)if(v(c[i.id][r],s[l]))return o[l];for(var f=0,h=o.length;f<h;f++)if(a=o[f],t.getRolesForAdaptation(a).filter(function(e){return e.value===n.default.MAIN})[0])return o[f]}return o[0]}function v(e,t){if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function y(e,n,r){var i,a=u,o=r,s=[],l=void 0,c=void 0,h=void 0,p=void 0,g=void 0,m=void 0;if(o)R(),a=_(o);else{if(!(u.length>0))return s;o=u[0].mpd.manifest}var v=A(e,a);v&&(m=v.id);var y=t.getAdaptationsForType(o,e?e.index:null,n!==f.EMBEDDED_TEXT?n:f.VIDEO);if(!y||0===y.length)return s;for(d[m]=d[m]||t.getAdaptationsForPeriod(v),p=0,i=y.length;p<i;p++)if(l=y[p],h=t.getIndexForAdaptation(l,o,e.index),c=w(d[m][h]),n===f.EMBEDDED_TEXT){var T=c.accessibility.length;for(g=0;g<T;g++)if(c){var E=c.accessibility[g];if(0===E.indexOf("cea-608:")){var b=E.substring(8).split(";");if("CC"===b[0].substring(0,2))for(g=0;g<b.length;g++)c||(c=w.call(this,d[m][h])),I(c,b[g].substring(0,3),b[g].substring(4)),s.push(c),c=null;else for(g=0;g<b.length;g++)c||(c=w.call(this,d[m][h])),I(c,"CC"+(g+1),b[g]),s.push(c),c=null}else 0===E.indexOf("cea-608")&&(I(c,f.CC1,"eng"),s.push(c),c=null)}}else n===f.IMAGE?(c.type=f.IMAGE,s.push(c),c=null):c&&s.push(c);return s}function _(e){var n=T(e);return t.getRegularPeriods(n)}function T(e){var n=b(e);return t.getMpd(n)}function E(){u=[],d={},c={}}function b(e){return e||(u.length>0?u[0].mpd.manifest:null)}function S(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&d[e.streamInfo.id]?d[e.streamInfo.id][e.index]:null}function A(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e&&e.id===i.id)return i}return null}function w(e){if(!e)return null;var n,r=new i.default,a=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return r.id=e.id,r.index=e.index,r.type=e.type,r.streamInfo=C(e.period),r.representationCount=t.getRepresentationCount(a),r.labels=t.getLabelsForAdaptation(a),r.lang=t.getLanguageForAdaptation(a),n=t.getViewpointForAdaptation(a),r.viewpoint=n?n.value:void 0,r.accessibility=t.getAccessibilityForAdaptation(a).map(function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&"undefined"!==typeof h&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n}),r.audioChannelConfiguration=t.getAudioChannelConfigurationForAdaptation(a).map(function(e){return e.value}),0===r.audioChannelConfiguration.length&&Array.isArray(a.Representation_asArray)&&a.Representation_asArray.length>0&&(r.audioChannelConfiguration=t.getAudioChannelConfigurationForRepresentation(a.Representation_asArray[0]).map(function(e){return e.value})),r.roles=t.getRolesForAdaptation(a).map(function(e){return e.value}),r.codec=t.getCodec(a),r.mimeType=t.getMimeType(a),r.contentProtection=t.getContentProtectionData(a),r.bitrateList=t.getBitrateListForAdaptation(a),r.contentProtection&&r.contentProtection.forEach(function(e){e.KID=t.getKID(e)}),r.isText=t.getIsTextTrack(r.mimeType),r.supplementalProperties=t.getSupplementalPropperties(a),r}function I(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=f.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"]}function C(e){var n=new a.default;return n.id=e.id,n.index=e.index,n.start=e.start,n.duration=e.duration,n.manifestInfo=function(e){var n=new o.default;return n.DVRWindowSize=e.timeShiftBufferDepth,n.loadedTime=e.manifest.loadedTime,n.availableFrom=e.availabilityStartTime,n.minBufferTime=e.manifest.minBufferTime,n.maxFragmentDuration=e.maxSegmentDuration,n.duration=t.getDuration(e.manifest),n.isDynamic=t.getIsDynamic(e.manifest),n.serviceDescriptions=t.getServiceDescriptions(e.manifest),n.protocol=e.manifest.protocol,n}(e.mpd),n.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(n.start+n.duration-n.manifestInfo.duration)<1,n}function R(){if(!f)throw new Error("setConfig function has to be called previously")}function D(e){return u.length>0?u[0].mpd.manifest.Period_asArray[e]:null}function M(e,t,n){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e)for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)for(a=r[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return n?s:i;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=M(D(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=M(e,t,!0);return null!==n?n:-1}(D(t),e)},getMaxIndexForBufferType:function(e,n){return function(e,n){var r=void 0,i=void 0,a=void 0,o=void 0;if(!e||!n)return-1;for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)if(r=i[o],a=r.Representation_asArray,t.getIsTypeOf(r,n))return a.length;return-1}(D(n),e)},convertDataToRepresentationInfo:function(e){if(e){var n=new r.default,i=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],a=t.getRepresentationFor(e.index,i);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(a),n.DVRWindow=e.segmentAvailabilityRange,n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.mediaInfo=w(e.adaptation),n}return null},getDataForMedia:S,getStreamsInfo:function(e,t){var n=[],r=u;if(e&&(R(),r=_(e)),r.length>0){(!t||t>r.length)&&(t=r.length);for(var i=0;i<t;i++)n.push(C(r[i]))}return n},getMediaInfoForType:function(e,n){if(0===u.length||!e)return null;var r=A(e,u);if(!r)return null;var i=r.id;d[i]=d[i]||t.getAdaptationsForPeriod(r);var a=m(e.index,n,e);if(!a)return null;var o=t.getIndexForAdaptation(a,u[0].mpd.manifest,e.index);return w(d[i][o])},getAllMediaInfoForType:y,getAdaptationForType:m,getRealAdaptation:function(e,n){var r,i=void 0,a=A(e,u);return r=n?n.id:null,u.length>0&&a&&(i=r?t.getAdaptationForId(r,u[0].mpd.manifest,a.index):t.getAdaptationForIndex(n?n.index:null,u[0].mpd.manifest,a.index)),i},getVoRepresentations:function(e){var n=S(e);return t.getRepresentationsForAdaptation(n)},getEventsFor:function(e,n){var o=[];if(u.length>0){var s=u[0].mpd.manifest;e instanceof a.default?o=t.getEventsForPeriod(A(e,u)):e instanceof i.default?o=t.getEventStreamForAdaptationSet(s,S(e)):e instanceof r.default&&(o=t.getEventStreamForRepresentation(s,n))}return o},getEvent:function(e,t,n,r){try{if(!e||!t||isNaN(n)||!r)return null;var i=new s.default,a=e.scheme_id_uri,o=e.value,u=e.timescale||1,l=r.presentationTimeOffset||0,d=r.adaptation.period.start,c=e.presentation_time_delta/u,f=void 0;f=0===e.version?d+n-l+c:d-l+c;var h=e.event_duration,p=e.id,g=e.message_data;return t[a+"/"+o]?(i.eventStream=t[a+"/"+o],i.eventStream.value=o,i.eventStream.timescale=u,i.duration=h,i.id=p,i.calculatedPresentationTime=f,i.messageData=g,i.presentationTimeDelta=c,i):null}catch(m){return null}},getMpd:T,setConfig:function(e){e&&(e.constants&&(f=e.constants),e.cea608parser&&(h=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;R(),u=_(e),d={}},getIsTextTrack:function(e){return t.getIsTextTrack(e)},getUTCTimingSources:function(){var e=b();return t.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=u.length>0?u[0].mpd:null;return t.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var n=T(e);return t.getAvailabilityStartTime(n)},getIsDynamic:function(e){var n=b(e);return t.getIsDynamic(n)},getDuration:function(e){var n=b(e);return t.getDuration(n)},getRegularPeriods:_,getLocation:function(e){return t.getLocation(e)},getManifestUpdatePeriod:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,n)},getIsDVB:function(e){return t.hasProfile(e,g)},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction()},getCodec:function(e,n,r){return t.getCodec(e,n,r)},getVoAdaptations:function(){return d},getVoPeriods:function(){return u},getPeriodById:function(e){if(!e||0===u.length)return null;var t=u.filter(function(t){return t.id===e});return t&&t.length>0?t[0]:null},setCurrentMediaInfo:function(e,t,n){c[e]=c[e]||{},c[e][t]=c[e][t]||{},c[e][t]=n},reset:E},t=(0,l.default)(p).getInstance(),E(),e}c.__dashjs_factory_name="DashAdapter",t.default=u.default.getSingletonFactory(c)});c(na);var ra=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"round10",value:function(e,t){return function(e,t,n){if("undefined"===typeof n||0===+n)return Math[e](t);if(n=+n,null===(t=+t)||isNaN(t)||"number"!==typeof n||n%1!==0)return NaN;return t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))}("round",e,t)}}]),e}();t.default=r});c(ra);var ia=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]}});c(ia);var aa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null}});c(aa);var oa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null}});c(oa);var sa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=m)&&n.__esModule?n:{default:n};t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=r.default.BUFFER_EMPTY}});c(sa);var ua=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null}});c(ua);var la=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null}});c(la);var da=f(function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.ManifestUpdate=function e(){n(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},t.ManifestUpdateStreamInfo=function e(){n(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},t.ManifestUpdateRepresentationInfo=function e(){n(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}});c(da);da.ManifestUpdate,da.ManifestUpdateStreamInfo,da.ManifestUpdateRepresentationInfo;var ca=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null}});c(ca);var fa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]}});c(fa);var ha=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=y(p),r=y(m),i=y(ia),a=y(aa),o=y(oa),s=y(sa),u=y(ua),l=y(la),d=y(ca),c=y(T),f=y(fa),h=y(b),g=y(v);function y(e){return e&&e.__esModule?e:{default:e}}function _(e){var t,p=(e=e||{}).settings,g=this.context,m=(0,c.default)(g).getInstance(),v=void 0;function y(){m.trigger(h.default.METRICS_CHANGED)}function _(e){m.trigger(h.default.METRIC_CHANGED,{mediaType:e}),y()}function T(e,t,n){m.trigger(h.default.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),_(e)}function E(e,t,n){m.trigger(h.default.METRIC_ADDED,{mediaType:e,metric:t,value:n}),_(e)}function b(e,t){var n=null;return e?(v.hasOwnProperty(e)?n=v[e]:t||(n=new i.default,v[e]=n),n):n}function S(e,t,n){var r=b(e);null!==r&&(r[t].push(n),r[t].length>p.get().streaming.metricsMaxListDepth&&r[t].shift())}function A(e,t,n){S(e,t,n),E(e,t,n)}return t={clearCurrentMetricsForType:function(e){delete v[e],_(e)},clearAllCurrentMetrics:function(){v={},y()},getMetricsFor:b,addHttpRequest:function e(t,n,i,a,o,s,u,l,d,c,f,h,p,g,m){var v=new w.HTTPRequest;s&&s!==a&&(e(t,null,i,a,o,null,null,l,d,null,null,null,p,null,null),v.actualurl=s),v.tcpid=n,v.type=i,v.url=a,v.range=l,v.trequest=d,v.tresponse=c,v.responsecode=h,v._tfinish=f,v._stream=t,v._mediaduration=p,v._quality=o,v._responseHeaders=g,v._serviceLocation=u,m?m.forEach(function(e){!function(e,t,n,r){var i=new w.HTTPRequestTrace;i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n}(v,e.s,e.d,e.b)}):(delete v.interval,delete v.trace),A(t,r.default.HTTP_REQUEST,v)},addRepresentationSwitch:function(e,t,n,i,o){var s=new a.default;s.t=t,s.mt=n,s.to=i,o?s.lto=o:delete s.lto,A(e,r.default.TRACK_SWITCH,s)},addBufferLevel:function(e,t,n){var i=new o.default;i.t=t,i.level=n,A(e,r.default.BUFFER_LEVEL,i)},addBufferState:function(e,t,n){var i=new s.default;i.target=n,i.state=t,A(e,r.default.BUFFER_STATE,i)},addDVRInfo:function(e,t,n,i){var a=new u.default;a.time=t,a.range=i,a.manifestInfo=n,A(e,r.default.DVR_INFO,a)},addDroppedFrames:function(e,t){var n=new l.default,i=b(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,i.length>0&&i[i.length-1]==n||A(e,r.default.DROPPED_FRAMES,n))},addSchedulingInfo:function(e,t,n,i,a,o,s,u,l){var c=new d.default;c.mediaType=e,c.t=t,c.type=n,c.startTime=i,c.availabilityStartTime=a,c.duration=o,c.quality=s,c.range=u,c.state=l,A(e,r.default.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,n){var i=new f.default;i.loadingRequests=t,i.executedRequests=n,b(e).RequestsQueue=i,E(e,r.default.REQUESTS_QUEUE,i)},addManifestUpdate:function(e,t,i,a,o,s,u,l,d,c){var f=new da.ManifestUpdate;f.mediaType=e,f.type=t,f.requestTime=i,f.fetchTime=a,f.availabilityStartTime=o,f.presentationStartTime=s,f.clientTimeOffset=u,f.currentTime=l,f.buffered=d,f.latency=c,S(n.default.STREAM,r.default.MANIFEST_UPDATE,f),E(e,r.default.MANIFEST_UPDATE,f)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];T(e.mediaType,r.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,i,a){if(e){var o=new da.ManifestUpdateStreamInfo;o.id=t,o.index=n,o.start=i,o.duration=a,e.streamInfo.push(o),T(e.mediaType,r.default.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,i,a,o,s,u){if(e&&e.representationInfo){var l=new da.ManifestUpdateRepresentationInfo;l.id=t,l.index=n,l.streamIndex=i,l.mediaType=a,l.startNumber=s,l.fragmentInfoType=u,l.presentationTimeOffset=o,e.representationInfo.push(l),T(e.mediaType,r.default.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,A(n.default.STREAM,r.default.PLAY_LIST,e)},addDVBErrors:function(e){A(n.default.STREAM,r.default.DVB_ERRORS,e)}},v={},t}_.__dashjs_factory_name="MetricsModel",t.default=g.default.getSingletonFactory(_)});c(ha);var pa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(p),r=s(v),i=s(m),a=s(ra),o=s(ha);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t,r=this.context,s=void 0,u=void 0,l=void 0,d=e.metricsModel;function c(e){var t=d.getMetricsFor(e,!0);if(!t)return null;var n=t.HttpList,r=null,i=void 0;if(!n||n.length<=0)return null;for(i=n.length-1;i>=0;){if(n[i].responsecode){r=n[i];break}i--}return r}function f(e){var t=d.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function h(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}function p(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}return t={getCurrentRepresentationSwitch:function(e){return h(d.getMetricsFor(e,!0),i.default.TRACK_SWITCH)},getCurrentBufferState:function(e){return h(d.getMetricsFor(e,!0),i.default.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=h(d.getMetricsFor(e,!0),i.default.BUFFER_LEVEL);return t?a.default.round10(t.level/1e3,-3):0},getCurrentHttpRequest:c,getHttpRequests:f,getCurrentDroppedFrames:function(){return h(d.getMetricsFor(n.default.VIDEO,!0),i.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return h(d.getMetricsFor(e,!0),i.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return h(e?d.getMetricsFor(e,!0):d.getMetricsFor(n.default.VIDEO,!0)||d.getMetricsFor(n.default.AUDIO,!0),i.default.DVR_INFO)},getCurrentManifestUpdate:function(){return h(d.getMetricsFor(n.default.STREAM),i.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){var n={},r=c(e);return r&&(n=p(r._responseHeaders)),void 0===n[t]?null:n[t]},getLatestMPDRequestHeaderValueByID:function(e){var t,r={},i=void 0,a=void 0;for(a=(t=f(n.default.STREAM)).length-1;a>=0;a--)if((i=t[a]).type===w.HTTPRequest.MPD_TYPE){r=p(i._responseHeaders);break}return void 0===r[e]?null:r[e]},addRepresentationSwitch:function(e,t,n,r,i){d.addRepresentationSwitch(e,t,n,r,i)},addDVRInfo:function(e,t,n,r){d.addDVRInfo(e,t,n,r)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();d.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();d.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();d.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){d.addManifestUpdate(n.default.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,n,r,i){d.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,r,i)},addSchedulingInfo:function(e,t){d.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,n){d.addRequestsQueue(e,t,n)},addBufferLevel:function(e,t,n){d.addBufferLevel(e,t,n)},addBufferState:function(e,t,n){d.addBufferState(e,t,n)},addDroppedFrames:function(e){d.addDroppedFrames(n.default.VIDEO,e)},addPlayList:function(){l&&(d.addPlayList(l),l=null)},addDVBErrors:function(e){d.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(l=new Mr.PlayList).start=new Date,l.mstart=e,l.starttype=t},createPlaylistTraceMetrics:function(e,t,n){!0===s&&(s=!1,(u=new Mr.PlayListTrace).representationid=e,u.start=new Date,u.mstart=t,u.playbackspeed=null!==n?n.toString():null)},updatePlayListTraceMetrics:function(e){if(u)for(var t in u)u[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===s&&l&&u&&u.start){var n=u.start,r=e.getTime()-n.getTime();u.duration=r,u.stopreason=t,l.trace.push(u),s=!0}},clearAllCurrentMetrics:function(){d.clearAllCurrentMetrics()}},d=d||(0,o.default)(r).getInstance({settings:e.settings}),s=!0,u=null,l=null,t}u.__dashjs_factory_name="DashMetrics",t.default=r.default.getSingletonFactory(u)});c(pa);var ga=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=u(T),r=u(b),i=u(v),a=u(g),o=u(Jr),s=u(kr);function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e,t=this.context,i=(0,n.default)(t).getInstance(),u=(0,s.default)(t).getInstance(),l=void 0,d=void 0,c=void 0,f=void 0;function h(e){d=e}function p(e,t,n,r){return r?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-d)):t.availabilityStartTime}function g(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*d)/1e3}function m(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function v(e){c||void 0!==e.offset&&(h(e.offset/1e3),c=!0)}function y(){d=0,c=!1,f=NaN}function _(){i.off(r.default.TIME_SYNCHRONIZATION_COMPLETED,v,this),y()}return e={initialize:function(){y(),i.on(r.default.TIME_SYNCHRONIZATION_COMPLETED,v,this)},isTimeSyncCompleted:function(){return c},setTimeSyncCompleted:function(e){c=e},getClientTimeOffset:function(){return d},setClientTimeOffset:h,getExpectedLiveEdge:function(){return f},setExpectedLiveEdge:function(e){f=e},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return p.call(this,e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return p.call(this,e,t,n,!0)},calcPresentationTimeFromWallTime:g,calcPresentationTimeFromMediaTime:m,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!c&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0);if(e.segmentInfoType===a.default.SEGMENT_TIMELINE&&u.get().streaming.calcSegmentAvailabilityRangeFromTimeline)return function(e){var t=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],n=l.getRepresentationFor(e.index,t),r=n.SegmentTemplate.SegmentTimeline,i=n.SegmentTemplate.timescale,a=r.S_asArray,o={start:0,end:0},s=0,u=void 0,d=void 0,c=void 0,f=void 0;for(o.start=m(a[0].t/i,e),c=0,f=a.length;c<f;c++)u=a[c],d=0,u.hasOwnProperty("r")&&(d=u.r),s+=u.d/i*(1+d);return o.end=o.start+s,o}(e);var o=g(new Date,n),s=n.start+n.duration;r.start=Math.max(o-n.mpd.timeShiftBufferDepth,n.start);var d=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<i?i-e.availabilityTimeOffset:i;return r.end=o>=s&&o-d<s?s:o-d,r},getPeriodEnd:function(e,t){var n=e.adaptation.period;if(!t)return n.start+n.duration;if(!c&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var r=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),i=g(new Date,n),a=n.start+n.duration,o=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<r?r-e.availabilityTimeOffset:r;return Math.min(i-o,a)},calcWallTimeForSegment:function(e,t){var n=void 0,r=void 0,i=void 0;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},reset:_},l=(0,o.default)(t).getInstance(),_(),e}l.__dashjs_factory_name="TimelineConverter",t.default=i.default.getSingletonFactory(l)});c(ga);var ma=f(function(e,t){var n={encode:function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},decode:function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")}},r={};!function(e){var t=function(t){for(var n=0,r=[],i=0|t.length/3;0<i--;){var a=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push(e.charAt(63&a))}if(2==t.length-n){a=(t[n]<<16)+(t[n+1]<<8);r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push("=")}else if(1==t.length-n){a=t[n]<<16;r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push("==")}return r.join("")},i=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),o=function(e){for(var t=0,n=[],r=0|e.length/4;0<r--;){var a=(i[e.charCodeAt(t)]<<18)+(i[e.charCodeAt(t+1)]<<12)+(i[e.charCodeAt(t+2)]<<6)+i[e.charCodeAt(t+3)];n.push(255&a>>16),n.push(255&a>>8),n.push(255&a),t+=4}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n},u={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}};r.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},r.encodeASCII=function(e){var n=u.encode(e);return t(n)},r.decodeASCII=function(e){var t=o(e);return u.decode(t)},r.encode=function(e){var r=n.encode(e);return t(r)},r.decode=function(e){var t=o(e);return n.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),t.decode=r.decode,t.decodeArray=r.decodeArray,t.encode=r.encode,t.encodeASCII=r.encodeASCII}),va=(ma.decode,ma.decodeArray,ma.encode,ma.encodeASCII,f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=re(h),r=re(p),i=re(g),a=re(m),o=re(A),s=re(pi),u=re(gi),l=re(mi),d=re(bi),c=re(Ui),f=re(Bi),y=re(ji),E=re(kn),I=re(Cr),C=re(qn),D=re(qi),M=re(Hi),O=re(Vi),P=re(dr),x=re(ni),F=re(Ki),U=re(ei),B=re(Yi),j=re(S),G=re(Un),q=re(T),H=re(b),V=re(_),K=re(v),Y=re(kr),W=re($i),z=re(na),X=re(pa),Q=re(ga),$=re(ma),Z=re(N),J=re(R),ee=re(di),te=re(Dr),ne=re(L);function re(e){return e&&e.__esModule?e:{default:e}}function ie(){var e="You must first call initialize() and set a source before calling this method",t="You must first call initialize() and set a valid source and view before calling this method",h="You must first call attachView() to set the video element before calling this method",p="You must first call attachSource() with a valid source before calling this method",g="MediaPlayer not initialized!",m=this.context,v=(0,q.default)(m).getInstance(),_=(0,Y.default)(m).getInstance(),T=(0,j.default)(m).getInstance({settings:_}),b=void 0,S=void 0,A=void 0,R=void 0,N=void 0,L=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,ce=void 0,fe=void 0,he=void 0,pe=void 0,ge=void 0,me=void 0,ve=void 0,ye=void 0,_e=void 0,Te=void 0,Ee=void 0,be=void 0,Se=void 0,Ae=void 0,we=void 0,Ie=void 0,Ce=void 0,Re=void 0;function De(){qe(null),je(null),R=null,le&&(le.reset(),le=null),de&&(de.reset(),de=null),Re.reset(),_.reset(),fe&&(fe.reset(),fe=null)}function Me(){return!!A&&!!Ae.getElement()}function Oe(){return(0,Wi.getVersionString)()}function Ne(){if(!re)throw t;return Te.isPaused()}function Pe(e){var t=Ee.getCurrentDVRInfo();if(!t)return 0;var n=Te.getLiveDelay(),r=t.range.start+e;return r>t.range.end-n&&(r=t.range.end-n),r}function Le(e){if(!re)throw t;var n=Be().currentTime;if(void 0!==e)n=ye.getTimeRelativeToStreamId(n,e);else if(Te.getIsDynamic()){var r=Ee.getCurrentDVRInfo();n=null===r?0:ke()-(r.range.end-r.time)}return n}function ke(){if(!re)throw t;var e=Be().duration;if(Te.getIsDynamic()){var n,r=Ee.getCurrentDVRInfo();if(!r)return 0;e=(n=r.range.end-r.range.start)<r.manifestInfo.DVRWindowSize?n:r.manifestInfo.DVRWindowSize}return e}function xe(e){(0,k.checkParameterType)(e,"boolean"),ie=e}function Fe(){pe.restoreDefaultUTCTimingSources()}function Ue(){return Ee}function Be(){if(!Ae.getElement())throw h;return Ae.getElement()}function je(e){if(!N)throw g;Ae.setElement(e),e&&(Ye(),function(){if(de)return;var e=dashjs.MetricsReporting;if("function"===typeof e){var t=e(m).create();de=t.createMetricsReporting({debug:T,eventBus:v,mediaElement:Be(),adapter:he,dashMetrics:Ee,events:H.default,constants:r.default,metricsConstants:a.default})}}(),function(){if(ce)return;var e=dashjs.MssHandler;"function"===typeof e&&(G.default.extend(e.errors),ce=e(m).create({eventBus:v,mediaPlayerModel:pe,dashMetrics:Ee,manifestModel:be,playbackController:Te,streamController:ye,protectionController:le,baseURLController:me,errHandler:ge,events:H.default,constants:r.default,debug:T,initSegmentType:w.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:$.default,ISOBoxer:Z.default,settings:_}))}(),ye&&ye.switchToVideoElement()),re&&Ve(),Xe()}function Ge(t){if(!L)throw e;var n=ye.getActiveStreamInfo();return ue.getTracksFor(t,n)}function qe(e){if(!N)throw g;"string"===typeof e&&Ie.initialize(e),A=e,(L||re)&&Ve(),Me()&&Xe()}function He(){if(!L)throw e;var t=ye.getActiveStreamInfo();return t?ye.getStreamById(t.id):null}function Ve(){re=!1,L=!1,he.reset(),ye.reset(),_e.reset(),Te.reset(),ae.reset(),ue.reset(),we.reset(),le&&(_.get().streaming.keepProtectionMediaKeys?le.stop():(le.reset(),le=null,Ye())),Se.reset()}function Ke(){return(0,c.default)(m).create({debug:T,errHandler:ge,dashMetrics:Ee,mediaPlayerModel:pe,requestModifier:(0,I.default)(m).getInstance(),mssHandler:ce,settings:_})}function Ye(){if(le)return le;var e=dashjs.Protection;if("function"===typeof e){var t=e(m).create();return H.default.extend(e.events),V.default.extend(e.events,{publicOnly:!0}),G.default.extend(e.errors),ve||(ve=(0,y.default)(m).getInstance()),le=t.createProtectionSystem({debug:T,errHandler:ge,videoModel:Ae,capabilities:ve,eventBus:v,events:H.default,BASE64:$.default,constants:r.default})}return null}function We(){if(!N)throw g;if(fe)return fe;var e=dashjs.OfflineController;if("function"===typeof e){H.default.extend(e.events),V.default.extend(e.events,{publicOnly:!0}),G.default.extend(e.errors);var t=Ke(),n=(0,ee.default)(m).create();return n.setConfig({manifestModel:be,adapter:he,manifestLoader:t,errHandler:ge}),fe=e(m).create({debug:T,manifestUpdater:n,baseURLController:me,manifestLoader:t,manifestModel:be,mediaPlayerModel:pe,abrController:ae,playbackController:Te,adapter:he,errHandler:ge,dashMetrics:Ee,timelineConverter:se,schemeLoaderFactory:oe,eventBus:v,events:H.default,errors:G.default,constants:r.default,settings:_,dashConstants:i.default,urlUtils:(0,te.default)(m).getInstance()})}return null}function ze(e){var t=Ee.getCurrentDVRInfo();return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function Xe(){fe&&fe.resetRecords(),!L&&A&&(L=!0,S.info("Streaming Initialized"),function(){var e=Ke();ye||(ye=(0,s.default)(m).getInstance()),ye.setConfig({capabilities:ve,manifestLoader:e,manifestModel:be,mediaPlayerModel:pe,protectionController:le,adapter:he,dashMetrics:Ee,errHandler:ge,timelineConverter:se,videoModel:Ae,playbackController:Te,abrController:ae,mediaController:ue,textController:we,settings:_,baseURLController:me}),_e.setConfig({settings:_,playbackController:Te,streamController:ye,videoModel:Ae,timelineConverter:se,adapter:he}),Te.setConfig({streamController:ye,dashMetrics:Ee,mediaPlayerModel:pe,adapter:he,videoModel:Ae,timelineConverter:se,uriFragmentModel:Ie,settings:_}),ae.setConfig({streamController:ye,domStorage:Ce,mediaPlayerModel:pe,dashMetrics:Ee,adapter:he,videoModel:Ae,settings:_}),we.setConfig({errHandler:ge,manifestModel:be,adapter:he,mediaController:ue,streamController:ye,videoModel:Ae}),Se.setConfig({abrController:ae,dashMetrics:Ee,playbackController:Te}),ye.initialize(ie,R),_e.initialize(),Se.initialize()}(),"string"===typeof A?ye.load(A):ye.loadWithManifest(A)),!re&&Me()&&(re=!0,S.info("Playback Initialized"))}return b={initialize:function(e,t,i){ve||(ve=(0,y.default)(m).getInstance()),ge=(0,f.default)(m).getInstance(),ve.supportsMediaSource()?N||(N=!0,se=(0,Q.default)(m).getInstance(),ae||(ae=(0,P.default)(m).getInstance()).setConfig({settings:_}),oe||(oe=(0,x.default)(m).getInstance()),Te||(Te=(0,o.default)(m).getInstance()),ue||(ue=(0,l.default)(m).getInstance()),ye||(ye=(0,s.default)(m).getInstance()),_e||(_e=(0,u.default)(m).getInstance()),he=(0,z.default)(m).getInstance(),be=(0,M.default)(m).getInstance(),Se=(0,U.default)(m).getInstance(),Ee=(0,X.default)(m).getInstance({settings:_}),we=(0,C.default)(m).getInstance(),Ce=(0,B.default)(m).getInstance({settings:_}),he.setConfig({constants:r.default,cea608parser:n.default,errHandler:ge,BASE64:$.default}),me||(me=(0,d.default)(m).create()),me.setConfig({adapter:he}),(Re=(0,W.default)(m).getInstance({dashMetrics:Ee,mediaPlayerModel:pe,errHandler:ge,baseURLController:me,events:H.default,eventBus:v,debug:T,boxParser:(0,ne.default)(m).getInstance(),requestModifier:(0,I.default)(m).getInstance(),errors:G.default})).initialize(),ue.setConfig({domStorage:Ce,settings:_}),Fe(),xe(void 0===i||i),We(),e&&je(e),t&&qe(t),S.info("[dash.js "+Oe()+"] MediaPlayer has been initialized")):ge.error(new J.default(G.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,G.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(ve=e.capabilities),e.streamController&&(ye=e.streamController),e.gapController&&(_e=e.gapController),e.playbackController&&(Te=e.playbackController),e.mediaPlayerModel&&(pe=e.mediaPlayerModel),e.abrController&&(ae=e.abrController),e.schemeLoaderFactory&&(oe=e.schemeLoaderFactory),e.mediaController&&(ue=e.mediaController),e.settings&&(_=e.settings))},on:function(e,t,n,r){v.on(e,t,n,r)},off:function(e,t,n){v.off(e,t,n)},extend:function(e,t,n){K.default.extend(e,t,n,m)},attachView:je,attachSource:qe,isReady:Me,preload:function(){if(Ae.getElement()||L)return!1;if(!A)throw p;Xe()},play:function(){if(!re)throw t;(!ie||Ne()&&re)&&Te.play()},isPaused:Ne,pause:function(){if(!re)throw t;Te.pause()},isSeeking:function(){if(!re)throw t;return Te.isSeeking()},isDynamic:function(){if(!re)throw t;return Te.getIsDynamic()},seek:function(e){if(!re)throw t;if((0,k.checkParameterType)(e,"number"),isNaN(e))throw r.default.BAD_ARGUMENT_ERROR;var n=Te.getIsDynamic()?Pe(e):e;Te.seek(n)},setPlaybackRate:function(e){Be().playbackRate=e},getPlaybackRate:function(){return Be().playbackRate},setMute:function(e){(0,k.checkParameterType)(e,"boolean"),Be().muted=e},isMuted:function(){return Be().muted},setVolume:function(e){if("number"!==typeof e||isNaN(e)||e<0||e>1)throw r.default.BAD_ARGUMENT_ERROR;Be().volume=e},getVolume:function(){return Be().volume},time:Le,duration:ke,timeAsUTC:function(){if(!re)throw t;return Le()<0?NaN:ze(Le())},durationAsUTC:function(){if(!re)throw t;return ze(ke())},getActiveStream:He,getDVRWindowSize:function(){var e=Ee.getCurrentDVRInfo();return e?e.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:Pe,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())},formatUTC:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o},getVersion:Oe,getDebug:function(){return T},getBufferLength:function(e){var t=[r.default.VIDEO,r.default.AUDIO,r.default.FRAGMENTED_TEXT];if(e){if(-1!==t.indexOf(e)){var n=Ue().getCurrentBufferLevel(e);return n||NaN}return S.warn("getBufferLength requested for invalid type"),NaN}var i=t.map(function(e){return Ge(e).length>0?Ue().getCurrentBufferLevel(e):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)});return i===Number.MAX_VALUE?NaN:i},getTTMLRenderingDiv:function(){return Ae?Ae.getTTMLRenderingDiv():null},getVideoElement:Be,getSource:function(){if(!A)throw p;return A},getCurrentLiveLatency:function(){if(!N)throw g;return re?Te.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(t){if(!L)throw e;return ae.getTopBitrateInfoFor(t)},setAutoPlay:xe,getAutoPlay:function(){return ie},getDashMetrics:Ue,getQualityFor:function(t){if(!L)throw e;if(t===r.default.IMAGE){var n=He();if(!n)return-1;var i=n.getThumbnailController();return i?i.getCurrentTrackIndex():-1}return ae.getQualityFor(t)},setQualityFor:function(t,n){if(!L)throw e;if(t===r.default.IMAGE){var i=He();if(!i)return;var a=i.getThumbnailController();a&&a.setTrackByIndex(n)}ae.setPlaybackQuality(t,ye.getActiveStreamInfo(),n)},updatePortalSize:function(){ae.setElementSize(),ae.setWindowResizeEventCalled(!0)},setTextDefaultLanguage:function(e){S.warn('setTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use setInitialMediaSettingsFor("fragmentedText", { lang: lang }) instead'),void 0===we&&(we=(0,C.default)(m).getInstance()),we.setTextDefaultLanguage(e)},getTextDefaultLanguage:function(){return S.warn('getTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use getInitialMediaSettingsFor("fragmentedText").lang instead'),void 0===we&&(we=(0,C.default)(m).getInstance()),we.getTextDefaultLanguage()},setTextDefaultEnabled:function(e){void 0===we&&(we=(0,C.default)(m).getInstance()),we.setTextDefaultEnabled(e)},getTextDefaultEnabled:function(){return void 0===we&&(we=(0,C.default)(m).getInstance()),we.getTextDefaultEnabled()},enableText:function(e){void 0===we&&(we=(0,C.default)(m).getInstance()),we.enableText(e)},enableForcedTextStreaming:function(e){void 0===we&&(we=(0,C.default)(m).getInstance()),we.enableForcedTextStreaming(e)},isTextEnabled:function(){return void 0===we&&(we=(0,C.default)(m).getInstance()),we.isTextEnabled()},setTextTrack:function(e){if(!re)throw t;void 0===we&&(we=(0,C.default)(m).getInstance()),we.setTextTrack(e)},getBitrateInfoListFor:function(t){if(!L)throw e;var n=He();return n?n.getBitrateListFor(t):[]},getStreamsFromManifest:function(t){if(!L)throw e;return he.getStreamsInfo(t)},getTracksFor:Ge,getTracksForTypeFromManifest:function(t,n,r){if(!L)throw e;return(r=r||he.getStreamsInfo(n,1)[0])?he.getAllMediaInfoForType(r,t,n):[]},getCurrentTrackFor:function(t){if(!L)throw e;var n=ye.getActiveStreamInfo();return ue.getCurrentTrackFor(t,n)},setInitialMediaSettingsFor:function(e,t){if(!N)throw g;ue.setInitialSettings(e,t),e===r.default.FRAGMENTED_TEXT&&we.setInitialSettings(t)},getInitialMediaSettingsFor:function(e){if(!N)throw g;return ue.getInitialSettings(e)},setCurrentTrack:function(t){if(!L)throw e;ue.setTrack(t)},getTrackSwitchModeFor:function(e){if(!N)throw g;return ue.getSwitchMode(e)},setTrackSwitchModeFor:function(e,t){if(!N)throw g;ue.setSwitchMode(e,t)},setSelectionModeForInitialTrack:function(e){if(!N)throw g;ue.setSelectionModeForInitialTrack(e)},getSelectionModeForInitialTrack:function(){if(!N)throw g;return ue.getSelectionModeForInitialTrack()},addABRCustomRule:function(e,t,n){pe.addABRCustomRule(e,t,n)},removeABRCustomRule:function(e){pe.removeABRCustomRule(e)},removeAllABRCustomRule:function(){pe.removeABRCustomRule()},getAverageThroughput:function(e){var t=ae.getThroughputHistory();return t?t.getAverageThroughput(e):0},retrieveManifest:function(e,t){var n=Ke(),r=this;v.on(H.default.INTERNAL_MANIFEST_LOADED,function e(i){i.error?t(null,i.error):t(i.manifest),v.off(H.default.INTERNAL_MANIFEST_LOADED,e,r),n.reset()},r),Ie.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){pe.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){pe.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){pe.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:Fe,setXHRWithCredentialsForType:function(e,t){pe.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return pe.getXHRWithCredentialsForType(e)},getProtectionController:function(){return Ye()},attachProtectionController:function(e){le=e},setProtectionData:function(e){R=e,ye&&ye.setProtectionData(R)},displayCaptionsOnTop:function(e){var t=(0,E.default)(m).getInstance();t.setConfig({videoModel:Ae}),t.initialize(),t.setDisplayCConTop(e)},attachTTMLRenderingDiv:function(e){if(!Ae.getElement())throw h;Ae.setTTMLRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=NaN;return we&&(e=we.getCurrentTrackIdx()),e},provideThumbnail:function(e,t){if("function"===typeof t)if(e<0)t(null);else{var n=Te.getIsDynamic()?Pe(e):e,r=ye.getStreamForTime(n);if(null!==r){var i=r.getThumbnailController();if(i){var a=ye.getTimeRelativeToStreamId(n,r.getId());return i.provide(a,t)}t(null)}else t(null)}},getDashAdapter:function(){return he},getOfflineController:function(){return We()},getSettings:function(){return _.get()},updateSettings:function(e){_.update(e)},resetSettings:function(){_.reset()},reset:De,destroy:function(){De(),K.default.deleteSingletonInstances(m)}},S=T.getLogger(b),N=!1,re=!1,L=!1,ie=!0,le=null,fe=null,R=null,he=null,Re=null,H.default.extend(V.default),pe=(0,O.default)(m).getInstance(),Ae=(0,F.default)(m).getInstance(),Ie=(0,D.default)(m).getInstance(),b}ie.__dashjs_factory_name="MediaPlayer";var ae=K.default.getClassFactory(ie);ae.events=V.default,ae.errors=G.default,K.default.updateClassFactory(ie.__dashjs_factory_name,ae),t.default=ae}));c(va);var ya=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=t.FactoryMaker=t.MediaPlayer=void 0;var n=a(va),r=a(v),i=a(S);function a(e){return e&&e.__esModule?e:{default:e}}var o="undefined"!==typeof window&&window||d,s=o.dashjs;s||(s=o.dashjs={}),s.MediaPlayer=n.default,s.FactoryMaker=r.default,s.Debug=i.default,s.Version=(0,Wi.getVersionString)(),t.default=s,t.MediaPlayer=n.default,t.FactoryMaker=r.default,t.Debug=i.default});c(ya);ya.Debug,ya.FactoryMaker,ya.MediaPlayer;var _a=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};n.SSL_CONNECTION_FAILED_PREFIX="SSL",n.DNS_RESOLUTION_FAILED="C00",n.HOST_UNREACHABLE="C01",n.CONNECTION_REFUSED="C02",n.CONNECTION_ERROR="C03",n.CORRUPT_MEDIA_ISOBMFF="M00",n.CORRUPT_MEDIA_OTHER="M01",n.BASE_URL_CHANGED="F00",n.BECAME_REPORTER="S00",t.default=n});c(_a);var Ta=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(_a),r=i(Fr);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=void 0,i=void 0,a=(e=e||{}).eventBus,o=e.dashMetrics,s=e.metricsConstants,u=e.events;function l(e){var t=new n.default;if(i){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.mpdurl||(t.mpdurl=i.originalUrl||i.url),t.terror||(t.terror=new Date),o.addDVBErrors(t)}}function d(e){e.error||(i=e.manifest)}function c(e){l({errorcode:n.default.BASE_URL_CHANGED,servicelocation:e.entry})}function f(){l({errorcode:n.default.BECAME_REPORTER})}function h(e){switch(e.metric){case s.HTTP_REQUEST:(0===(t=e.value).responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&l({errorcode:t.responsecode||n.default.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}var t}function p(e){var t=void 0;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=n.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=n.default.CORRUPT_MEDIA_OTHER;break;default:return}l({errorcode:t})}function g(){a.on(u.MANIFEST_UPDATED,d,t),a.on(u.SERVICE_LOCATION_BLACKLIST_CHANGED,c,t),a.on(u.METRIC_ADDED,h,t),a.on(u.METRIC_UPDATED,h,t),a.on(u.PLAYBACK_ERROR,p,t),a.on(r.default.BECAME_REPORTING_PLAYER,f,t)}return t={initialise:g,reset:function(){a.off(u.MANIFEST_UPDATED,d,t),a.off(u.SERVICE_LOCATION_BLACKLIST_CHANGED,c,t),a.off(u.METRIC_ADDED,h,t),a.off(u.METRIC_UPDATED,h,t),a.off(u.PLAYBACK_ERROR,p,t),a.off(r.default.BECAME_REPORTING_PLAYER,f,t)}},g(),t}a.__dashjs_factory_name="DVBErrorsTranslator",t.default=dashjs.FactoryMaker.getSingletonFactory(a)});c(Ta);var Ea=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=x)&&n.__esModule?n:{default:n};function i(e){e=e||{};var t,n=!1,i=this.context,a=void 0,o=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,n=t+e.duration;a.add(t,n)}),n=!!e[0]._useWallClockTime)},reset:function(){a.clear()},isEnabled:function(){var e,t=a.length;if(!t)return!0;e=n?(new Date).getTime()/1e3:o.currentTime;for(var r=0;r<t;r+=1){var i=a.start(r),s=a.end(r);if(i<=e&&e<s)return!0}return!1}},a=(0,r.default)(i).create(),t}i.__dashjs_factory_name="RangeController",t.default=dashjs.FactoryMaker.getClassFactory(i)});c(Ea);var ba=f(function(e,t){function n(){return{serialise:function e(t){var n=[],r=[],i=void 0,a=void 0;for(i in t)if(t.hasOwnProperty(i)&&0!==i.indexOf("_")){if(void 0!==(a=t[i])&&null!==a||(a=""),Array.isArray(a)){if(!a.length)continue;r=[],a.forEach(function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);r.push(n?t:e(t))}),a=r.map(encodeURIComponent).join(",")}else"string"===typeof a?a=encodeURIComponent(a):a instanceof Date?a=a.toISOString():"number"===typeof a&&(a=Math.round(a));n.push(i+"="+a)}return n.join("&")}}}Object.defineProperty(t,"__esModule",{value:!0}),n.__dashjs_factory_name="MetricSerialiser",t.default=dashjs.FactoryMaker.getSingletonFactory(n)});c(ba);var Sa=f(function(e,t){function n(){var e,t=window.crypto||window.msCrypto,n=Uint32Array,r=Math.pow(2,8*n.BYTES_PER_ELEMENT)-1,i=10,a=void 0,o=void 0;function s(){t&&(a||(a=new n(i)),t.getRandomValues(a),o=0)}return e={random:function(e,n){var i=void 0;return e||(e=0),n||(n=1),t?(o===a.length&&s(),i=a[o]/r,o+=1):i=Math.random(),i*(n-e)+e}},s(),e}Object.defineProperty(t,"__esModule",{value:!0}),n.__dashjs_factory_name="RNG",t.default=dashjs.FactoryMaker.getSingletonFactory(n)});c(Sa);var Aa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(ba),r=i(Sa);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){e=e||{};var t,i=this.context,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=[],f=e.metricsConstants;function h(){s=!1,u=!1,l=null,d=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),u&&d.isEnabled()&&t.forEach(function(t){var n=a.serialise(t);e!==f.DVB_ERRORS&&(n="metricname="+e+"&"+n),function(e,t,n){var r=new XMLHttpRequest,i=function(){var e=c.indexOf(r);-1!==e&&(c.splice(e,1),r.status>=200&&r.status<300?t&&t():n&&n())};c.push(r);try{r.open("GET",e),r.onloadend=i,r.onerror=i,r.send()}catch(a){r.onerror()}}(n=l+"?"+n,null,function(){u=!1})})},initialize:function(e,t){var n=void 0;if(d=t,!(l=e.dvb_reportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");s||((n=e.dvb_probability)&&(1e3===n||n/1e3>=o.random())&&(u=!0),s=!0)},reset:function(){h()}},a=(0,n.default)(i).getInstance(),o=(0,r.default)(i).getInstance(),h(),t}a.__dashjs_factory_name="DVBReporting",t.default=dashjs.FactoryMaker.getClassFactory(a)});c(Aa);var wa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Aa)&&n.__esModule?n:{default:n};function i(e){e=e||{};var t={"urn:dvb:dash:reporting:2014":r.default},n=this.context,i=void 0,a=e.debug?e.debug.getLogger(i):{},o=e.metricsConstants;return i={create:function(e,r){var i=void 0;try{(i=t[e.schemeIdUri](n).create({metricsConstants:o})).initialize(e,r)}catch(s){i=null,a.error("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+s.message+")")}return i},register:function(e,n){t[e]=n},unregister:function(e){delete t[e]}}}i.__dashjs_factory_name="ReportingFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(i)});c(wa);var Ia=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=wa)&&n.__esModule?n:{default:n};function i(e){var t=[],n=(0,r.default)(this.context).getInstance(e);return{initialize:function(e,r){e.some(function(e){var i=n.create(e,r);if(i)return t.push(i),!0})},reset:function(){t.forEach(function(e){return e.reset()}),t=[]},report:function(e,n){t.forEach(function(t){return t.report(e,n)})}}}i.__dashjs_factory_name="ReportingController",t.default=dashjs.FactoryMaker.getClassFactory(i)});c(Ia);var Ca=f(function(e,t){function n(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0}),n.__dashjs_factory_name="HandlerHelpers",t.default=dashjs.FactoryMaker.getSingletonFactory(n)});c(Ca);var Ra=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Ca)&&n.__esModule?n:{default:n};function i(e){e=e||{};var t=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=this.context,u=(0,r.default)(s).getInstance(),l=[],d=e.metricsConstants;function c(){var e=function(){try{return Object.keys(l).map(function(e){return l[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}();e&&o!==e.t&&(o=e.t,t.report(i,e))}return{initialize:function(e,r,o){r&&(n=u.validateN(o),t=r,i=u.reconstructFullMetricName(e,o),a=setInterval(c,n))},reset:function(){clearInterval(a),a=null,n=0,t=null,o=null},handleNewMetric:function(e,t,n){e===d.BUFFER_LEVEL&&(l[n]=t)}}}i.__dashjs_factory_name="BufferLevelHandler",t.default=dashjs.FactoryMaker.getClassFactory(i)});c(Ra);var Da=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Fr)&&n.__esModule?n:{default:n};t.default=dashjs.FactoryMaker.getClassFactory(function(e){var t=void 0,n=(e=e||{}).eventBus,i=e.metricsConstants;function a(){n.off(r.default.METRICS_INITIALISATION_COMPLETE,a,this),n.trigger(r.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,i){i&&(t=i,n.on(r.default.METRICS_INITIALISATION_COMPLETE,a,this))},reset:function(){t=null},handleNewMetric:function(e,n){e===i.DVB_ERRORS&&t&&t.report(e,n)}}})});c(Da);var Ma=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Ca)&&n.__esModule?n:{default:n};function i(e){e=e||{};var t=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=[],u=(0,r.default)(this.context).getInstance(),l=e.metricsConstants;function d(){var e=s;e.length&&t&&t.report(a,e),s=[]}return{initialize:function(e,r,s,l){r&&(n=u.validateN(s),t=r,l&&l.length&&(i=l),a=u.reconstructFullMetricName(e,s,l),o=setInterval(d,n))},reset:function(){clearInterval(o),o=null,n=null,i=null,s=[],t=null},handleNewMetric:function(e,t){e===l.HTTP_REQUEST&&(i&&i!==t.type||s.push(t))}}}i.__dashjs_factory_name="HttpListHandler",t.default=dashjs.FactoryMaker.getClassFactory(i)});c(Ma);var Oa=f(function(e,t){function n(){var e=void 0,t=void 0;return{initialize:function(n,r){e=n,t=r},reset:function(){t=null,e=void 0},handleNewMetric:function(n,r){n===e&&t&&t.report(e,r)}}}Object.defineProperty(t,"__esModule",{value:!0}),n.__dashjs_factory_name="GenericMetricHandler",t.default=dashjs.FactoryMaker.getClassFactory(n)});c(Oa);var Na=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(Ra),r=o(Da),i=o(Ma),a=o(Oa);function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=void 0,o=(e=e||{}).debug?e.debug.getLogger(t):{},s=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,u=this.context,l={BufferLevel:n.default,DVBErrors:r.default,HttpList:i.default,PlayList:a.default,RepSwitchList:a.default,TcpList:a.default};return t={create:function(t,n){var r,i=t.match(s);if(i){try{(r=l[i[1]](u).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(i[1],n,i[3],i[5])}catch(a){r=null,o.error("MetricsHandlerFactory: Could not create handler for type "+i[1]+" with args "+i[3]+", "+i[5]+" ("+a.message+")")}return r}},register:function(e,t){l[e]=t},unregister:function(e){delete l[e]}}}s.__dashjs_factory_name="MetricsHandlerFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(s)});c(Na);var Pa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Na)&&n.__esModule?n:{default:n};function i(e){e=e||{};var t=[],n=void 0,i=this.context,a=e.eventBus,o=e.events,s=(0,r.default)(i).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function u(e){t.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)})}return n={initialize:function(e,r){e.split(",").forEach(function(e,n,i){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var o=i[n+1];o&&-1===o.indexOf("(")&&-1!==o.indexOf(")")&&(e+=","+o,delete i[n+1])}(a=s.create(e,r))&&t.push(a)}),a.on(o.METRIC_ADDED,u,n),a.on(o.METRIC_UPDATED,u,n)},reset:function(){a.off(o.METRIC_ADDED,u,n),a.off(o.METRIC_UPDATED,u,n),t.forEach(function(e){return e.reset()}),t=[]}}}i.__dashjs_factory_name="MetricsHandlersController",t.default=dashjs.FactoryMaker.getClassFactory(i)});c(Pa);var La=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(Ea),r=a(Ia),i=a(Pa);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=void 0,a=void 0,o=void 0,s=this.context;function u(){t&&t.reset(),a&&a.reset(),o&&o.reset()}return{initialize:function(l){try{(o=(0,n.default)(s).create({mediaElement:e.mediaElement})).initialize(l.Range),(a=(0,r.default)(s).create({debug:e.debug,metricsConstants:e.metricsConstants})).initialize(l.Reporting,o),(t=(0,i.default)(s).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(l.metrics,a)}catch(d){throw u(),d}},reset:u}}o.__dashjs_factory_name="MetricsController",t.default=dashjs.FactoryMaker.getClassFactory(o)});c(La);var ka=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]}});c(ka);var xa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1}});c(xa);var Fa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=1e3}});c(Fa);var Ua=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(ka),r=a(xa),i=a(Fa);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).adapter,a=e.constants;return{getMetrics:function(e){var o=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach(function(s){var u=new n.default,l=t.getIsDynamic(e);s.hasOwnProperty("metrics")&&(u.metrics=s.metrics,s.Range_asArray&&s.Range_asArray.forEach(function(n){var i=new r.default;i.starttime=function(e,n,r){var i=void 0,o=void 0,s=0;return n?s=t.getAvailabilityStartTime(e)/1e3:(i=t.getRegularPeriods(e)).length&&(s=i[0].start),o=s,r&&r.hasOwnProperty(a.START_TIME)&&(o+=r.starttime),o}(e,l,n),n.hasOwnProperty("duration")?i.duration=n.duration:i.duration=t.getDuration(e),i._useWallClockTime=l,u.Range.push(i)}),s.Reporting_asArray&&(s.Reporting_asArray.forEach(function(e){var t=new i.default;e.hasOwnProperty(a.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(a.DVB_REPORTING_URL)&&(t.dvb_reportingUrl=e[a.DVB_REPORTING_URL]),e.hasOwnProperty(a.DVB_PROBABILITY)&&(t.dvb_probability=e[a.DVB_PROBABILITY]),u.Reporting.push(t))}),o.push(u)))}),o}}}o.__dashjs_factory_name="ManifestParsing",t.default=dashjs.FactoryMaker.getSingletonFactory(o)});c(Ua);var Ba=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(La),r=a(Ua),i=a(Fr);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=void 0,a={},o=this.context,s=e.eventBus,u=e.events;function l(t){if(!t.error){var u=Object.keys(a);(0,r.default)(o).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(t.manifest).forEach(function(r){var i=JSON.stringify(r);if(a.hasOwnProperty(i))u.splice(i,1);else try{var s=(0,n.default)(o).create(e);s.initialize(r),a[i]=s}catch(t){}}),u.forEach(function(e){a[e].reset(),delete a[e]}),s.trigger(i.default.METRICS_INITIALISATION_COMPLETE)}}function d(){Object.keys(a).forEach(function(e){a[e].reset()}),a={}}return t={reset:function(){s.off(u.MANIFEST_UPDATED,l,t),s.off(u.STREAM_TEARDOWN_COMPLETE,d,t)}},s.on(u.MANIFEST_UPDATED,l,t),s.on(u.STREAM_TEARDOWN_COMPLETE,d,t),t}o.__dashjs_factory_name="MetricsCollectionController",t.default=dashjs.FactoryMaker.getClassFactory(o)});c(Ba);var ja=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(Ta),r=s(Fr),i=s(Ba),a=s(Na),o=s(wa);function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context;return{createMetricsReporting:function(t){return(0,n.default)(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}),(0,i.default)(e).create(t)},getReportingFactory:function(){return(0,o.default)(e).getInstance()},getMetricsHandlerFactory:function(){return(0,a.default)(e).getInstance()}}}u.__dashjs_factory_name="MetricsReporting";var l=dashjs.FactoryMaker.getClassFactory(u);l.events=r.default,dashjs.FactoryMaker.updateClassFactory(u.__dashjs_factory_name,l),t.default=l});c(ja);var Ga=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"!==r.schemeIdUri.toLowerCase()||"cenc"!==r.value.toLowerCase()&&"cbcs"!==r.value.toLowerCase()||(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return t&&r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null===e||void 0===e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,a,o=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(a=t.getUint8(r))||1===a){r++,r+=3,o="";var u=void 0,l=void 0;for(u=0;u<4;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=4,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<6;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;r+=6,o=o.toLowerCase(),t.getUint32(r),r+=4,n[o]=t.buffer.slice(s,i),r=i}else r=i;else r=i}return n}}]),e}();t.default=r});c(Ga);var qa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n}});c(qa);var Ha=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a}});c(Ha);var Va=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=Fn)&&n.__esModule?n:{default:n};var i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}());t.default=i});c(Va);var Ka=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=u(Ga),i=u(qa),a=u(Ha),o=u(Va),s=u(R);function u(e){return e&&e.__esModule?e:{default:e}}var l=5,d=500,c=3,f=1e3,h=8e3;function p(e){var t=(e=e||{}).protectionKeyController,u=e.protectionModel,p=e.eventBus,g=e.events,m=e.debug,v=e.BASE64,y=e.constants,_=[],T=void 0,E=void 0,b=void 0,S=void 0,A=void 0,w=void 0,I=void 0,C=void 0;function R(){if(!p||!p.hasOwnProperty("on")||!t||!t.hasOwnProperty("getSupportedKeySystemsFromContentProtection"))throw new Error("Missing config parameter(s)")}function D(e,n){var i=r.default.getPSSHForKeySystem(C,e),a=N(C);if(i){for(var l=u.getAllInitData(),d=0;d<l.length;d++)if(t.initDataEquals(i,l[d]))return void E.info("DRM: Ignoring initData because we have already seen it!");try{u.createKeySession(i,a,L(C),n)}catch(c){p.trigger(g.KEY_SESSION_CREATED,{data:null,error:new s.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+c.message)})}}else e?u.createKeySession(e,a,L(C),n):p.trigger(g.KEY_SESSION_CREATED,{data:null,error:new s.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(C?C.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function M(e,t){R(),u.loadKeySession(e,t,L(C))}function O(e){R(),e?(u.setMediaElement(e),p.on(g.NEED_KEY,B,this)):null===e&&(u.setMediaElement(e),p.off(g.NEED_KEY,B,this))}function N(e){var t=null;if(e){var n=e.systemString;A&&(t=n in A?A[n]:null)}return t}function P(e){var t=N(e),n=[],r=[],o=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:I,s=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:I,u=L(e),l=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",d=t&&t.persistentState?t.persistentState:"temporary"===u?"optional":"required";return S.forEach(function(e){e.type===y.AUDIO?n.push(new i.default(e.codec,o)):e.type===y.VIDEO&&r.push(new i.default(e.codec,s))}),new a.default(n,r,l,d,[u])}function L(e){var t=N(e);return t&&t.sessionType?t.sessionType:w}function k(e,n){var r=this,i=[];e=e.sort(function(t,n){return(A&&A[t.ks.systemString]&&A[t.ks.systemString].priority>=0?A[t.ks.systemString].priority:e.length)-(A&&A[n.ks.systemString]&&A[n.ks.systemString].priority>=0?A[n.ks.systemString].priority:e.length)});var a=void 0;if(C){for(a=0;a<e.length;a++)if(C===e[a].ks){(function(){i.push({ks:e[a].ks,configs:[P(C)]});p.on(g.KEY_SYSTEM_ACCESS_COMPLETE,function i(u){if(p.off(g.KEY_SYSTEM_ACCESS_COMPLETE,i,r),u.error)n||p.trigger(g.KEY_SYSTEM_SELECTED,{error:new s.default(o.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,o.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+u.error)});else{E.info("DRM: KeySystem Access Granted"),p.trigger(g.KEY_SYSTEM_SELECTED,{data:u.data});var l=N(C);if(t.isClearKey(C)&&l&&l.hasOwnProperty("clearkeys")){var d={kids:Object.keys(l.clearkeys)};e[a].initData=(new TextEncoder).encode(JSON.stringify(d))}e[a].sessionId?M(e[a].sessionId,e[a].initData):e[a].initData&&D(e[a].initData,e[a].cdmData)}},r),u.requestKeySystemAccess(i)})();break}}else if(void 0===C){C=null,b.push(e);for(var l=0;l<e.length;l++)i.push({ks:e[l].ks,configs:[P(e[l].ks)]});var d=void 0,c=function e(t){p.off(g.KEY_SYSTEM_ACCESS_COMPLETE,e,r),t.error?(C=void 0,p.off(g.INTERNAL_KEY_SYSTEM_SELECTED,f,r),n||p.trigger(g.KEY_SYSTEM_SELECTED,{data:null,error:new s.default(o.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,o.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+t.error)})):(d=t.data,E.info("DRM: KeySystem Access Granted ("+d.keySystem.systemString+")!  Selecting key system..."),u.selectKeySystem(d))},f=function e(i){if(p.off(g.INTERNAL_KEY_SYSTEM_SELECTED,e,r),p.off(g.KEY_SYSTEM_ACCESS_COMPLETE,c,r),i.error)C=void 0,n||p.trigger(g.KEY_SYSTEM_SELECTED,{data:null,error:new s.default(o.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,o.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+i.error)});else{if(!u)return;C=u.getKeySystem(),p.trigger(g.KEY_SYSTEM_SELECTED,{data:d});var l=N(C);l&&l.serverCertificate&&l.serverCertificate.length>0&&u.setServerCertificate(v.decodeArray(l.serverCertificate).buffer);for(var f=0;f<b.length;f++)for(a=0;a<b[f].length;a++)if(C===b[f][a].ks){if(t.isClearKey(C)&&l&&l.hasOwnProperty("clearkeys")){var h={kids:Object.keys(l.clearkeys)};b[f][a].initData=(new TextEncoder).encode(JSON.stringify(h))}b[f][a].sessionId?M(b[f][a].sessionId,b[f][a].initData):null!==b[f][a].initData&&D(b[f][a].initData,b[f][a].cdmData);break}}};p.on(g.INTERNAL_KEY_SYSTEM_SELECTED,f,r),p.on(g.KEY_SYSTEM_ACCESS_COMPLETE,c,r),u.requestKeySystemAccess(i)}else b.push(e)}function x(e,t){p.trigger(g.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function F(e){e.error?p.trigger(g.KEY_STATUSES_CHANGED,{data:null,error:e.error}):E.debug("DRM: key status = "+e.status)}function U(e){E.debug("DRM: onKeyMessage");var i=e.data;p.trigger(g.KEY_MESSAGE,{data:i});var a=i.messageType?i.messageType:"license-request",l=i.message,d=i.sessionToken,m=N(C),v=C?C.systemString:null,y=t.getLicenseServer(C,m,a),_={sessionToken:d,messageType:a};if(l&&0!==l.byteLength){if(!y)return E.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+d.getSessionID()),void x(_);if(t.isClearKey(C)){var T=t.processClearKeyLicenseRequest(C,m,l);if(T)return E.debug("DRM: ClearKey license request handled by application!"),x(_),void u.updateKeySession(d,T)}var b=null;if(m&&m.serverURL){var A=m.serverURL;"string"===typeof A&&""!==A?b=A:"object"===("undefined"===typeof A?"undefined":n(A))&&A.hasOwnProperty(a)&&(b=A[a])}else if(m&&m.laURL&&""!==m.laURL)b=m.laURL;else if(t.isClearKey(C))b=C.getLicenseServerUrlFromMediaInfo(S);else{var w=r.default.getPSSHData(d.initData);(b=C.getLicenseServerURLFromInitData(w))||(b=e.data.laURL)}if(b=y.getServerURLFromMessage(b,l,a)){var I={},R=!1,D=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(R=!0),I[t]=e[t]};m&&D(m.httpRequestHeaders),D(C.getRequestHeadersFromMessage(l)),m&&"boolean"==typeof m.withCredentials&&(R=m.withCredentials);var M=function(e,t,n,r){var i=e.response?y.getErrorResponse(e.response,n,r):"NONE";x(t,new s.default(o.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,o.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+i))},O=C.getLicenseRequestFromMessage(l),P=y.getHTTPMethod(a),L=y.getResponseType(v,a),k=m&&!isNaN(m.httpTimeout)?m.httpTimeout:h,F=d.getSessionID()||null;!function e(t,n,r,i,a,o,s,u,l,d,c,h){var m=new XMLHttpRequest;m.open(r,t,!0);m.responseType=i;m.withCredentials=a;u>0&&(m.timeout=u);for(var v in n)m.setRequestHeader(v,n[v]);var y=function(){s--,setTimeout(function(){e(t,n,r,i,a,o,s,u,l,d,c,h)},f)};m.onload=function(){200===this.status||s<=0?l(this):(E.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+s),y())};m.ontimeout=m.onerror=function(){s<=0?c(this):(E.warn("License request network request failed . Retrying it... Pending retries: "+s),y())};m.onabort=function(){d(this)};p.trigger(g.LICENSE_REQUEST_SENDING,{url:t,headers:n,payload:o,sessionId:h});m.send(o)}(b,I,P,L,R,O,c,k,function(e){if(u)if(200===e.status){var t=y.getLicenseMessage(e.response,v,a);null!==t?(x(_),u.updateKeySession(d,t)):M(e,_,v,a)}else M(e,_,v,a)},function(e){x(_,new s.default(o.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,o.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+v+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},function(e){x(_,new s.default(o.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,o.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+v+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},F)}else x(_,new s.default(o.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,o.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}else x(_,new s.default(o.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,o.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function B(e,n){if(E.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===S.length&&(E.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(n="undefined"===typeof n?1:n+1)<l))_.push(setTimeout(function(){B(e,n)},d));else{var i=e.key.initData;if(ArrayBuffer.isView(i)&&(i=i.buffer),C){var a=r.default.getPSSHForKeySystem(C,i);if(a)for(var o=u.getAllInitData(),s=0;s<o.length;s++)if(t.initDataEquals(a,o[s]))return void E.warn("DRM: Ignoring initData because we have already seen it!")}E.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(i)));var c=t.getSupportedKeySystems(i,A);0!==c.length?k(c,!1):E.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else E.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType)}return T={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");R(),p.on(g.INTERNAL_KEY_MESSAGE,U,this),p.on(g.INTERNAL_KEY_STATUS_CHANGED,F,this),S.push(e);var n=t.getSupportedKeySystemsFromContentProtection(e.contentProtection);n&&n.length>0&&k(n,!0)},createKeySession:D,loadKeySession:M,removeKeySession:function(e){R(),u.removeKeySession(e)},closeKeySession:function(e){R(),u.closeKeySession(e)},setServerCertificate:function(e){R(),u.setServerCertificate(e)},setMediaElement:O,setSessionType:function(e){w=e},setRobustnessLevel:function(e){I=e},setProtectionData:function(e){A=e,t.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return R(),t.getSupportedKeySystemsFromContentProtection(e)},getKeySystems:function(){return t?t.getKeySystems():[]},setKeySystems:function(e){t&&t.setKeySystems(e)},stop:function(){u&&u.stop()},reset:function(){R(),p.off(g.INTERNAL_KEY_MESSAGE,U,this),p.off(g.INTERNAL_KEY_STATUS_CHANGED,F,this),O(null),C=void 0,u&&(u.reset(),u=null),_.forEach(function(e){return clearTimeout(e)}),_=[],S=[]}},E=m.getLogger(T),b=[],S=[],w="temporary",I="",T}p.__dashjs_factory_name="ProtectionController",t.default=dashjs.FactoryMaker.getClassFactory(p)});c(Ka);var Ya=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n}});c(Ya);var Wa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}return n(e,[{key:"toJWK",value:function(){var e=void 0,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),e}();t.default=r});c(Wa);var za=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return n(e,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),e}());t.default=r});c(za);var Xa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(Ya),r=o(Wa),i=o(Ga),a=o(za);function o(e){return e&&e.__esModule?e:{default:e}}var s="e2719d58-a985-b3c9-781a-b030af78d30e",u=a.default.CLEARKEY_KEYSTEM_STRING,l="urn:uuid:"+s;function d(e){var t=(e=e||{}).BASE64,a={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]};return{uuid:s,schemeIdURI:l,systemString:u,getInitData:function(e,n){try{var r=i.default.parseInitDataFromContentProtection(e,t);if(!r&&n){var a={kids:[function(e){try{var t=e.replace(/-/g,"");return(t=btoa(t.match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""))).replace(/=/g,"")}catch(n){return null}}(n["cenc:default_KID"])]};r=(new TextEncoder).encode(JSON.stringify(a))}return r}catch(o){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(e){return JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e)))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getLicenseServerUrlFromMediaInfo:function(e){try{if(!e||0===e.length)return null;for(var t=0,n=null;t<e.length&&!n;){var r=e[t];if(r&&r.contentProtection&&r.contentProtection.length>0){var i=r.contentProtection.filter(function(e){return e.schemeIdUri&&e.schemeIdUri===l});if(i&&i.length>0)for(var o=0;o<i.length&&!n;){for(var s=i[o],u=0;u<a.attributes.length&&!n;){for(var d=0,c=a.attributes[u];d<a.prefixes.length&&!n;){var f=a.prefixes[d];s[c]&&s[c].__prefix&&s[c].__prefix===f&&s[c].__text&&(n=s[c].__text),d+=1}u+=1}o+=1}}t+=1}return n}catch(h){return null}},getClearKeysFromProtectionData:function(e,t){var i=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),o=[],s=0;s<a.kids.length;s++){var u=a.kids[s],l=e.clearkeys&&e.clearkeys.hasOwnProperty(u)?e.clearkeys[u]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+u+") is not known!");o.push(new n.default(u,l))}i=new r.default(o)}return i}}}d.__dashjs_factory_name="KeySystemClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(d)});c(Xa);var Qa=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(Ya),r=o(Wa),i=o(Ga),a=o(za);function o(e){return e&&e.__esModule?e:{default:e}}var s="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",u=a.default.CLEARKEY_KEYSTEM_STRING,l="urn:uuid:"+s;function d(e){var t=void 0,a=e.BASE64,o=e.debug.getLogger(t);return t={uuid:s,schemeIdURI:l,systemString:u,getInitData:function(e){return i.default.parseInitDataFromContentProtection(e,a)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var i=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),s=[],u=0;u<a.kids.length;u++){var l=a.kids[u],d=e.clearkeys&&e.clearkeys.hasOwnProperty(l)?e.clearkeys[l]:null;if(!d)throw new Error("DRM: ClearKey keyID ("+l+") is not known!");s.push(new n.default(l,d))}i=new r.default(s),o.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return i}}}d.__dashjs_factory_name="KeySystemW3CClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(d)});c(Qa);var $a=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Ga),r=i(za);function i(e){return e&&e.__esModule?e:{default:e}}var a="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",o=r.default.WIDEVINE_KEYSTEM_STRING,s="urn:uuid:"+a;function u(e){var t=null,r=(e=e||{}).BASE64;return{uuid:a,schemeIdURI:s,systemString:o,init:function(e){e&&(t=e)},getInitData:function(e){return n.default.parseInitDataFromContentProtection(e,r)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(e){return t&&t.sessionId?t.sessionId:e&&e.sessionId?e.sessionId:null}}}u.__dashjs_factory_name="KeySystemWidevine",t.default=dashjs.FactoryMaker.getSingletonFactory(u)});c($a);var Za=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Ga),r=i(za);function i(e){return e&&e.__esModule?e:{default:e}}var a="9a04f079-9840-4286-ab92-e65be0885f95",o=r.default.PLAYREADY_KEYSTEM_STRING,s="urn:uuid:"+a,u='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>',l=void 0;function d(e){var t="utf-16",r=(e=e||{}).BASE64;function i(){if(!r||!r.hasOwnProperty("decodeArray")||!r.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:a,schemeIdURI:s,systemString:o,getInitData:function(e){var t,a,o,s=new Uint8Array([112,115,115,104,0,0,0,0]),u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,d=null,c=void 0,f=void 0;if(i(),!e)return null;if("pssh"in e)return n.default.parseInitDataFromContentProtection(e,r);if("pro"in e)d=r.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;d=r.decodeArray(e.prheader.__text)}return t=d.length,a=4+s.length+u.length+4+t,o=new ArrayBuffer(a),c=new Uint8Array(o),(f=new DataView(o)).setUint32(l,a),l+=4,c.set(s,l),l+=s.length,c.set(u,l),l+=u.length,f.setUint32(l,t),l+=4,c.set(d,l),l+=t,c.buffer},getRequestHeadersFromMessage:function(e){var n,r=void 0,i={},a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,o);for(var s=(r=a.parseFromString(n,"application/xml")).getElementsByTagName("name"),u=r.getElementsByTagName("value"),l=0;l<s.length;l++)i[s[l].childNodes[0].nodeValue]=u[l].childNodes[0].nodeValue;return i.hasOwnProperty("Content")&&(i["Content-Type"]=i.Content,delete i.Content),i.hasOwnProperty("Content-Type")||(i["Content-Type"]="text/xml; charset=utf-8"),i},getLicenseRequestFromMessage:function(e){var n=null,a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);i();var s=String.fromCharCode.apply(null,o),u=a.parseFromString(s,"application/xml");if(!u.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var l=u.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return l&&(n=r.decode(l)),n},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),d=i.parseFromString(l,"application/xml");if(d.getElementsByTagName("LA_URL")[0]){var c=d.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(c)return c}if(d.getElementsByTagName("LUI_URL")[0]){var f=d.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(f)return f}}else r+=s}return null},getCDMData:function(){var e=void 0,t=void 0,n=void 0,a=void 0;if(i(),l&&l.cdmData){for(e=[],a=0;a<l.cdmData.length;++a)e.push(l.cdmData.charCodeAt(a)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=r.encode(e),t=u.replace("%CUSTOMDATA%",e),n=[],a=0;a<t.length;++a)n.push(t.charCodeAt(a)),n.push(0);return new Uint8Array(n).buffer}return null},getSessionId:function(e){return l&&l.sessionId?l.sessionId:e&&e.sessionId?e.sessionId:null},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e},init:function(e){e&&(l=e)}}}d.__dashjs_factory_name="KeySystemPlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(d)});c(Za);var Ja=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=za)&&n.__esModule?n:{default:n};function i(e){var t=(e=e||{}).BASE64,n={};n[r.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[r.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,r){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[r].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}i.__dashjs_factory_name="DRMToday",t.default=dashjs.FactoryMaker.getSingletonFactory(i)});c(Ja);var eo=f(function(e,t){function n(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(n){return function(n){if(window.DOMParser){var r=t(n),i=(new window.DOMParser).parseFromString(r,"text/xml"),a=i?i.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o&&o.getElementsByTagNameNS(e,"Fault")[0])return null}return n}.call(this,n)},getErrorResponse:function(n){return function(n){var r="",i="",a="",o=-1,s=-1;if(window.DOMParser){var u=t(n),l=(new window.DOMParser).parseFromString(u,"text/xml"),d=l?l.getElementsByTagNameNS(e,"Envelope")[0]:null,c=d?d.getElementsByTagNameNS(e,"Body")[0]:null,f=c?c.getElementsByTagNameNS(e,"Fault")[0]:null,h=f?f.getElementsByTagName("detail")[0]:null,p=h?h.getElementsByTagName("Exception")[0]:null,g=null;if(null===f)return u;r=(g=f.getElementsByTagName("faultstring")[0].firstChild)?g.nodeValue:null,null!==p&&(i=(g=p.getElementsByTagName("StatusCode")[0])?g.firstChild.nodeValue:null,o=(a=(g=p.getElementsByTagName("Message")[0])?g.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"")}var m="code: "+i+", name: "+r;return a&&(m+=", message: "+a),m}.call(this,n)}}}Object.defineProperty(t,"__esModule",{value:!0}),n.__dashjs_factory_name="PlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(n)});c(eo);var to=f(function(e,t){function n(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Object.defineProperty(t,"__esModule",{value:!0}),n.__dashjs_factory_name="Widevine",t.default=dashjs.FactoryMaker.getSingletonFactory(n)});c(to);var no=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(Ya),r=i(Wa);function i(e){return e&&e.__esModule?e:{default:e}}function a(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],i=0;i<e.keys.length;i++){var a=e.keys[i],o=a.kid.replace(/=/g,""),s=a.k.replace(/=/g,"");t.push(new n.default(o,s))}return new r.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}a.__dashjs_factory_name="ClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(a)});c(no);var ro=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=f(Ga),r=f(Xa),i=f(Qa),a=f($a),o=f(Za),s=f(Ja),u=f(eo),l=f(to),d=f(no),c=f(za);function f(e){return e&&e.__esModule?e:{default:e}}function h(){var e=this.context,t=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0;return t={initialize:function(){p=[];var t=void 0;t=(0,o.default)(e).getInstance({BASE64:g}),p.push(t),t=(0,a.default)(e).getInstance({BASE64:g}),p.push(t),t=(0,r.default)(e).getInstance({BASE64:g}),p.push(t),m=t,t=(0,i.default)(e).getInstance({BASE64:g,debug:f}),p.push(t),v=t},setProtectionData:function(e){for(var t=function(t){var n=null;return e&&(n=t in e?e[t]:null),n},n=0;n<p.length;n++){var r=p[n];r.hasOwnProperty("init")&&r.init(t(r.systemString))}},isClearKey:function(e){return e===m||e===v},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1},getKeySystems:function(){return p},setKeySystems:function(e){p=e},getKeySystemBySystemString:function(e){for(var t=0;t<p.length;t++)if(p[t].systemString===e)return p[t];return null},getSupportedKeySystemsFromContentProtection:function(e){var t=void 0,r=void 0,i=void 0,a=void 0,o=[];if(e){var s=n.default.findCencContentProtection(e);for(i=0;i<p.length;++i)for(r=p[i],a=0;a<e.length;++a)if((t=e[a]).schemeIdUri.toLowerCase()===r.schemeIdURI){var u=r.getInitData(t,s);o.push({ks:p[i],initData:u,cdmData:r.getCDMData(),sessionId:r.getSessionId(t)})}}return o},getSupportedKeySystems:function(e,t){for(var r=[],i=n.default.parsePSSHList(e),a=void 0,o=void 0,s=void 0,u=0;u<p.length;++u)o=(a=p[u]).systemString,s=!t||o in t,a.uuid in i&&s&&r.push({ks:a,initData:i[a.uuid],cdmData:a.getCDMData(),sessionId:a.getSessionId()});return r},getLicenseServer:function(t,n,r){if("license-release"===r||"individualization-request"===r)return null;var i=null;return n&&n.hasOwnProperty("drmtoday")?i=(0,s.default)(e).getInstance({BASE64:g}):t.systemString===c.default.WIDEVINE_KEYSTEM_STRING?i=(0,l.default)(e).getInstance():t.systemString===c.default.PLAYREADY_KEYSTEM_STRING?i=(0,u.default)(e).getInstance():t.systemString===c.default.CLEARKEY_KEYSTEM_STRING&&(i=(0,d.default)(e).getInstance()),i},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(r){return h.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(f=e.debug,h=f.getLogger(t)),e.BASE64&&(g=e.BASE64))}}}h.__dashjs_factory_name="ProtectionKeyController",t.default=dashjs.FactoryMaker.getSingletonFactory(h)});c(ro);var io=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=y)&&n.__esModule?n:{default:n};var i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}());t.default=i});c(io);var ao=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n}});c(ao);var oo=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request"}});c(oo);var so=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n}});c(so);var uo=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(ro),r=l(ao),i=l(Va),a=l(R),o=l(oo),s=l(so),u=l(za);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,l=e.eventBus,d=e.events,c=e.debug,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0;function T(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function E(e){for(var t=0;t<v.length;t++)if(v[t]===e){v.splice(t,1);break}}function b(e){var t=void 0,n=void 0;return e&&e.length>0&&(e[0]&&("string"===typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"===typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function S(e,t,n,r){var s={session:e,initData:t,sessionId:r,handleEvent:function(e){switch(e.type){case"keystatuseschange":l.trigger(d.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=b(arguments);switch(e.status){case"expired":l.trigger(d.INTERNAL_KEY_STATUS_CHANGED,{error:new a.default(i.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,i.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:l.trigger(d.INTERNAL_KEY_STATUS_CHANGED,e)}});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;l.trigger(d.INTERNAL_KEY_MESSAGE,{data:new o.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach(function(){"usable"===b(arguments).status&&(t=!0)}),t},getSessionType:function(){return n}};return e.addEventListener("keystatuseschange",s),e.addEventListener("message",s),e.closed.then(function(){E(s),h.debug("DRM: Session closed.  SessionID = "+s.getSessionID()),l.trigger(d.KEY_SESSION_CLOSED,{data:s.getSessionID()})}),v.push(s),s}return f={getAllInitData:function(){for(var e=[],t=0;t<v.length;t++)v[t].initData&&e.push(v[t].initData);return e},requestKeySystemAccess:function(e){!function e(t,n){void 0!==navigator.requestMediaKeySystemAccess&&"function"===typeof navigator.requestMediaKeySystemAccess?function(n){var r=t[n].ks,i=t[n].configs,a=r.systemString;a===u.default.PLAYREADY_KEYSTEM_STRING&&"required"===i[0].persistentState&&(a+=".recommendation"),navigator.requestMediaKeySystemAccess(a,i).then(function(e){var t="function"===typeof e.getConfiguration?e.getConfiguration():null,n=new s.default(r,t);n.mksa=e,l.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:n})}).catch(function(r){++n<t.length?e(t,n):l.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+r.message})})}(n):l.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"})}(e,0)},getKeySystem:function(){return p},selectKeySystem:function(e){e.mksa.createMediaKeys().then(function(t){p=e.keySystem,m=t,g?g.setMediaKeys(m).then(function(){l.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)}):l.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)}).catch(function(){l.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})},setMediaElement:function(e){g!==e&&(g&&(g.removeEventListener("encrypted",y),g.setMediaKeys&&g.setMediaKeys(null)),(g=e)&&(g.addEventListener("encrypted",y),g.setMediaKeys&&m&&g.setMediaKeys(m)))},setServerCertificate:function(e){if(!p||!m)throw new Error("Can not set server certificate until you have selected a key system");m.setServerCertificate(e).then(function(){h.info("DRM: License server certificate successfully updated."),l.trigger(d.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){l.trigger(d.SERVER_CERTIFICATE_UPDATED,{error:new a.default(i.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,i.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})})},createKeySession:function(e,t,n){if(!p||!m)throw new Error("Can not create sessions until you have selected a key system");var r=m.createSession(n),o=S(r,e,n),s=this.getKeySystem().systemString===u.default.CLEARKEY_KEYSTEM_STRING&&(e||t&&t.clearkeys)?"keyids":"cenc";r.generateRequest(s,e).then(function(){h.debug("DRM: Session created.  SessionID = "+o.getSessionID()),l.trigger(d.KEY_SESSION_CREATED,{data:o})}).catch(function(e){E(o),l.trigger(d.KEY_SESSION_CREATED,{data:null,error:new a.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})})},updateKeySession:function(e,t){var n=e.session;_.isClearKey(p)&&(t=t.toJWK()),n.update(t).catch(function(t){l.trigger(d.KEY_ERROR,{data:new a.default(i.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})})},loadKeySession:function(e,t,n){if(!p||!m)throw new Error("Can not load sessions until you have selected a key system");for(var r=0;r<v.length;r++)if(e===v[r].sessionId)return void h.warn("DRM: Ignoring session ID because we have already seen it!");var o=m.createSession(n),s=S(o,t,n,e);o.load(e).then(function(t){t?(h.debug("DRM: Session loaded.  SessionID = "+s.getSessionID()),l.trigger(d.KEY_SESSION_CREATED,{data:s})):(E(s),l.trigger(d.KEY_SESSION_CREATED,{data:null,error:new a.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+e+")")}))}).catch(function(t){E(s),l.trigger(d.KEY_SESSION_CREATED,{data:null,error:new a.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+e+")! "+t.name)})})},removeKeySession:function(e){e.session.remove().then(function(){h.debug("DRM: Session removed.  SessionID = "+e.getSessionID()),l.trigger(d.KEY_SESSION_REMOVED,{data:e.getSessionID()})},function(t){l.trigger(d.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})})},closeKeySession:function(e){T(e).catch(function(t){E(e),l.trigger(d.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})})},stop:function(){for(var e=void 0,t=0;t<v.length;t++)(e=v[t]).getUsable()||T(e).catch(function(){E(e)})},reset:function(){var e=v.length,t=void 0;0!==e?function(){for(var n=function(e){E(e),0===v.length&&(g?(g.removeEventListener("encrypted",y),g.setMediaKeys(null).then(function(){l.trigger(d.TEARDOWN_COMPLETE)})):l.trigger(d.TEARDOWN_COMPLETE))},r=0;r<e;r++)!function(e){t.session.closed.then(function(){n(e)}),T(t).catch(function(){n(e)})}(t=v[r])}():l.trigger(d.TEARDOWN_COMPLETE)}},h=c.getLogger(f),p=null,g=null,m=null,v=[],_=(0,n.default)(t).getInstance(),y={handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;l.trigger(d.NEED_KEY,{key:new r.default(t,e.initDataType)})}}}},f}d.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=dashjs.FactoryMaker.getClassFactory(d)});c(uo);var lo=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(ro),r=l(ao),i=l(R),a=l(Va),o=l(oo),s=l(Ha),u=l(so);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,l=e.eventBus,d=e.events,c=e.debug,f=e.api,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0;function b(){try{for(var e=0;e<_.length;e++)S(_[e]);g&&g.removeEventListener(f.needkey,T),l.trigger(d.TEARDOWN_COMPLETE)}catch(t){l.trigger(d.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+t.message})}}function S(e){var t=e.session;t.removeEventListener(f.error,e),t.removeEventListener(f.message,e),t.removeEventListener(f.ready,e),t.removeEventListener(f.close,e);for(var n=0;n<_.length;n++)if(_[n]===e){_.splice(n,1);break}t[f.release]()}function A(){var e=null,t=function(){g.removeEventListener("loadedmetadata",e),g[f.setMediaKeys](v),l.trigger(d.VIDEO_ELEMENT_SELECTED)};g.readyState>=1?t():(e=t.bind(this),g.addEventListener("loadedmetadata",e))}return h={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,n=0;n<e.length;n++)for(var r=e[n].ks.systemString,i=e[n].configs,a=null,o=null,c=0;c<i.length;c++){var h=i[c].audioCapabilities,p=i[c].videoCapabilities;if(h&&0!==h.length){a=[];for(var g=0;g<h.length;g++)window[f.MediaKeys].isTypeSupported(r,h[g].contentType)&&a.push(h[g])}if(p&&0!==p.length){o=[];for(var m=0;m<p.length;m++)window[f.MediaKeys].isTypeSupported(r,p[m].contentType)&&o.push(p[m])}if(!(!a&&!o||a&&0===a.length||o&&0===o.length)){t=!0;var v=new s.default(a,o),y=E.getKeySystemBySystemString(r);l.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:new u.default(y,v)});break}}t||l.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return m},selectKeySystem:function(e){try{v=e.mediaKeys=new window[f.MediaKeys](e.keySystem.systemString),m=e.keySystem,y=e,g&&A(),l.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)}catch(t){l.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+m.systemString+")! Could not create MediaKeys -- TODO"})}},setMediaElement:function(e){g!==e&&(g&&g.removeEventListener(f.needkey,T),(g=e)&&(g.addEventListener(f.needkey,T),v&&A()))},createKeySession:function(e,t,n,r){if(!m||!v||!y)throw new Error("Can not create sessions until you have selected a key system");var s=null;if(y.ksConfiguration.videoCapabilities&&y.ksConfiguration.videoCapabilities.length>0&&(s=y.ksConfiguration.videoCapabilities[0]),null===s&&y.ksConfiguration.audioCapabilities&&y.ksConfiguration.audioCapabilities.length>0&&(s=y.ksConfiguration.audioCapabilities[0]),null===s)throw new Error("Can not create sessions for unknown content types.");var u=s.contentType,c=v.createSession(u,new Uint8Array(e),r?new Uint8Array(r):null),h=function(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case f.error:l.trigger(d.KEY_ERROR,{data:new i.default(a.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case f.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;l.trigger(d.INTERNAL_KEY_MESSAGE,{data:new o.default(this,t,e.destinationURL)});break;case f.ready:p.debug("DRM: Key added."),l.trigger(d.KEY_ADDED);break;case f.close:p.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),l.trigger(d.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}(c,e);c.addEventListener(f.error,h),c.addEventListener(f.message,h),c.addEventListener(f.ready,h),c.addEventListener(f.close,h),_.push(h),p.debug("DRM: Session created.  SessionID = "+h.getSessionID()),l.trigger(d.KEY_SESSION_CREATED,{data:h})},updateKeySession:function(e,t){var n=e.session;E.isClearKey(m)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:S,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:b,reset:b},p=c.getLogger(h),g=null,m=null,v=null,y=null,_=[],E=(0,n.default)(t).getInstance(),T={handleEvent:function(e){switch(e.type){case f.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;l.trigger(d.NEED_KEY,{key:new r.default(t,"cenc")})}}}},h}d.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=dashjs.FactoryMaker.getClassFactory(d)});c(lo);var co=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(ro),r=l(ao),i=l(R),a=l(oo),o=l(Ha),s=l(so),u=l(Va);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,l=e.eventBus,d=e.events,c=e.debug,f=e.api,h=e.errHandler,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,_=void 0,T=void 0,E=void 0,b=void 0;function S(){m&&I();for(var e=0;e<T.length;e++)A(T[e]);l.trigger(d.TEARDOWN_COMPLETE)}function A(e){try{m[f.cancelKeyRequest](v.systemString,e.sessionID)}catch(t){l.trigger(d.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionID+") "+t.message})}}function w(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID==t)return e[r];return null}return null}function I(){m.removeEventListener(f.keyerror,b),m.removeEventListener(f.needkey,b),m.removeEventListener(f.keymessage,b),m.removeEventListener(f.keyadded,b)}return p={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);for(var n=0;n<T.length;n++)e.push(T[n].initData);return e},requestKeySystemAccess:function(e){var t=m;t||(t=document.createElement("video"));for(var n=!1,r=0;r<e.length;r++)for(var i=e[r].ks.systemString,a=e[r].configs,u=null,c=0;c<a.length;c++){var f=a[c].videoCapabilities;if(f&&0!==f.length){u=[];for(var h=0;h<f.length;h++)""!==t.canPlayType(f[h].contentType,i)&&u.push(f[h])}if(u&&(!u||0!==u.length)){n=!0;var p=new o.default(null,u),g=y.getKeySystemBySystemString(i);l.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:new s.default(g,p)});break}}n||l.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return v},selectKeySystem:function(e){v=e.keySystem,l.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(m!==e){if(m){I();for(var t=0;t<T.length;t++)A(T[t]);T=[]}(m=e)&&(m.addEventListener(f.keyerror,b),m.addEventListener(f.needkey,b),m.addEventListener(f.keymessage,b),m.addEventListener(f.keyadded,b),l.trigger(d.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!v)throw new Error("Can not create sessions until you have selected a key system");if(E||0===T.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return _.push(t),m[f.generateKeyRequest](v.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionID;if(y.isClearKey(v))for(var r=0;r<t.keyPairs.length;r++)m[f.addKey](v.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else m[f.addKey](v.systemString,new Uint8Array(t),new Uint8Array(e.initData),n)},closeKeySession:A,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:S,reset:S},g=c.getLogger(p),m=null,v=null,_=[],T=[],y=(0,n.default)(t).getInstance(),b={handleEvent:function(e){var t=null;switch(e.type){case f.needkey:var n=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;l.trigger(d.NEED_KEY,{key:new r.default(n,"cenc")});break;case f.keyerror:if((t=w(T,e.sessionId))||(t=w(_,e.sessionId)),t){var o=u.default.MEDIA_KEYERR_CODE,s="";switch(e.errorCode.code){case 1:o=u.default.MEDIA_KEYERR_UNKNOWN_CODE,s+="MEDIA_KEYERR_UNKNOWN - "+u.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:o=u.default.MEDIA_KEYERR_CLIENT_CODE,s+="MEDIA_KEYERR_CLIENT - "+u.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:o=u.default.MEDIA_KEYERR_SERVICE_CODE,s+="MEDIA_KEYERR_SERVICE - "+u.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:o=u.default.MEDIA_KEYERR_OUTPUT_CODE,s+="MEDIA_KEYERR_OUTPUT - "+u.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:o=u.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,s+="MEDIA_KEYERR_HARDWARECHANGE - "+u.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:o=u.default.MEDIA_KEYERR_DOMAIN_CODE,s+="MEDIA_KEYERR_DOMAIN - "+u.default.MEDIA_KEYERR_DOMAIN_MESSAGE}s+="  System Code = "+e.systemCode,l.trigger(d.KEY_ERROR,{data:new i.default(o,s,t)})}else g.error("No session token found for key error");break;case f.keyadded:(t=w(T,e.sessionId))||(t=w(_,e.sessionId)),t?(g.debug("DRM: Key added."),l.trigger(d.KEY_ADDED,{data:t})):g.debug("No session token found for key added");break;case f.keymessage:if((E=null!==e.sessionId&&void 0!==e.sessionId)?!(t=w(T,e.sessionId))&&_.length>0&&(t=_.shift(),T.push(t),t.sessionID=e.sessionId,l.trigger(d.KEY_SESSION_CREATED,{data:t})):_.length>0&&(t=_.shift(),T.push(t),0!==_.length&&h.error(new i.default(u.default.MEDIA_KEY_MESSAGE_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var c=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=c,l.trigger(d.INTERNAL_KEY_MESSAGE,{data:new a.default(t,c,e.defaultURL)})}else g.warn("No session token found for key message")}}},p}d.__dashjs_factory_name="ProtectionModel_01b",t.default=dashjs.FactoryMaker.getClassFactory(d)});c(co);var fo=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(Ka),r=l(ro),i=l(io),a=l(Va),o=l(uo),s=l(lo),u=l(co);function l(e){return e&&e.__esModule?e:{default:e}}var d=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],c=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function f(){var e=void 0,t=this.context;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"===typeof e[r[Object.keys(r)[0]]])return r}return null}return e={createProtectionSystem:function(a){var l=null,f=(0,r.default)(t).getInstance();f.setConfig({debug:a.debug,BASE64:a.BASE64}),f.initialize();var h=function(n){var r=n.debug,a=r.getLogger(e),l=n.eventBus,f=n.errHandler,h=n.videoModel?n.videoModel.getElement():null;return h&&void 0===h.onencrypted||h&&void 0===h.mediaKeys?i(h,c)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,s.default)(t).create({debug:r,eventBus:l,events:n.events,api:i(h,c)})):i(h,d)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,u.default)(t).create({debug:r,eventBus:l,errHandler:f,events:n.events,api:i(h,d)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,o.default)(t).create({debug:r,eventBus:l,events:n.events}))}(a);return!l&&h&&(l=(0,n.default)(t).create({protectionModel:h,protectionKeyController:f,eventBus:a.eventBus,debug:a.debug,events:a.events,BASE64:a.BASE64,constants:a.constants}),a.capabilities.setEncryptedMediaSupported(!0)),l}}}f.__dashjs_factory_name="Protection";var h=dashjs.FactoryMaker.getClassFactory(f);h.events=i.default,h.errors=a.default,dashjs.FactoryMaker.updateClassFactory(f.__dashjs_factory_name,h),t.default=h});c(fo);var ho=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=va)&&n.__esModule?n:{default:n};var i=function(){var e="application/dash+xml",t=void 0;function n(n,i,a){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var o=void 0,s=n.id||n.name||"video element";if(!(i=i||[].slice.call(n.querySelectorAll("source")).filter(function(t){return t.type==e})[0])&&n.src)(i=document.createElement("source")).src=n.src;else if(!i&&!n.src)return null;return a=a||{},(o=(0,r.default)(a).create()).initialize(n,i.src,n.autoplay),t||(t=o.getDebug().getLogger()),t.debug("Converted "+s+" to dash.js player and added content: "+i.src),n._dashjs_player=o,o}function i(e){return/^VIDEO$/i.test(e.nodeName)?e:i(e.parentNode)}return{create:n,createAll:function(t,r){var a=[];t=t||"[data-dashjs-player]";for(var o=(r=r||document).querySelectorAll(t),s=0;s<o.length;s++){var u=n(o[s],null);a.push(u)}for(var l=r.querySelectorAll('source[type="'+e+'"]'),d=0;d<l.length;d++){var c=n(i(l[d]),null);a.push(c)}return a}}}(),a=void 0;!("undefined"!==typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!==typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?i.createAll():a=window.setInterval(function(){window.dashjs&&(window.clearInterval(a),i.createAll())},500):window.addEventListener("load",function e(){window.removeEventListener("load",e),i.createAll()})),t.default=i});c(ho);var po=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=t.MediaPlayerFactory=t.MetricsReporting=t.Protection=t.MediaPlayer=void 0;var n=o(ja),r=o(fo),i=o(ho),a=o(S);function o(e){return e&&e.__esModule?e:{default:e}}dashjs.Protection=r.default,dashjs.MetricsReporting=n.default,dashjs.MediaPlayerFactory=i.default,dashjs.Debug=a.default,t.default=dashjs,t.MediaPlayer=ya.MediaPlayer,t.Protection=r.default,t.MetricsReporting=n.default,t.MediaPlayerFactory=i.default,t.Debug=a.default}),go=c(po);po.Debug,po.MediaPlayerFactory,po.MetricsReporting,po.Protection,po.MediaPlayer;function mo(e,t){e.dash.mediaPlayer.on(go.MediaPlayer.events.PLAYBACK_METADATA_LOADED,function(e,t){var n=e.dash.mediaPlayer,i=n.getTracksFor("audio"),a=e.audioTracks();function o(e){return"dash-audio-"+e}function s(e,t){return e.find(function(e){return o(e.index)===t.id})}a.length&&t.clearTracks(["audio"]);var u=n.getCurrentTrackFor("audio");i.forEach(function(t){var n,i;if(Array.isArray(t.labels))for(var s=0;s<t.labels.length;s++)if(t.labels[s].lang&&-1!==e.language().indexOf(t.labels[s].lang.toLowerCase())){n=t.labels[s];break}n?i=n.text:Array.isArray(t.labels)&&1===t.labels.length?i=t.labels[0].text:(i=t.lang,t.roles&&t.roles.length&&(i+=" ("+t.roles.join(", ")+")")),a.addTrack(new r.default.AudioTrack({enabled:t===u,id:o(t.index),kind:t.kind||"main",label:i,language:t.lang}))});var l=function(){for(var e=0;e<a.length;e++){var t=a[e];if(t.enabled){var r=s(i,t);n.setCurrentTrack(r)}}};a.addEventListener("change",l),e.dash.mediaPlayer.on(go.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,function(){a.removeEventListener("change",l)})}.bind(null,e,t))}function vo(e,t,n){o.a.VTTCue&&!/\[native code\]/.test(o.a.VTTCue.toString())&&(o.a.VTTCue=!1);var i=[];if(t.featuresNativeTextTracks)r.default.log.error("You must pass {html: {nativeCaptions: false}} in the videojs constructor to use text tracks in videojs-contrib-dash");else{var a=e.dash.mediaPlayer;a.on(go.MediaPlayer.events.TEXT_TRACKS_ADDED,s),a.on(go.MediaPlayer.events.CAN_PLAY,function(){a.off(go.MediaPlayer.events.TEXT_TRACKS_ADDED,s)})}function s(t){t.index;var n=t.tracks;a.off(go.MediaPlayer.events.TEXT_TRACKS_ADDED,s),i.forEach(e.removeRemoteTextTrack.bind(e)),i=[],n.length&&(i=function(e,t,n){var r=[],i=n.map(function(t){var n;if(Array.isArray(t.labels))for(var r=0;r<t.labels.length;r++)if(t.labels[r].lang&&-1!==e.language().indexOf(t.labels[r].lang.toLowerCase())){n=t.labels[r];break}return{dashTrack:t,trackConfig:{label:n?n.text:Array.isArray(t.labels)&&1===t.labels.length?t.labels[0].text:t.lang||t.label,language:t.lang,srclang:t.lang,kind:t.kind}}}).map(function(t){var n=t.trackConfig,i=t.dashTrack,a=e.addRemoteTextTrack(n,!1);return r.push({textTrack:a.track,dashTrack:i}),a});function a(){for(var t=e.dash.mediaPlayer,i=e.textTracks(),a=-1,o=function(e){var t=i[e];if("showing"===t.mode){var o=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}(r,function(e){return e.textTrack===t}),s=o?o.dashTrack:null;s&&(a=n.indexOf(s))}},s=0;s<i.length;s+=1)o(s);a!==t.getCurrentTextTrackIndex()&&t.setTextTrack(a)}return e.textTracks().on("change",a),e.dash.mediaPlayer.on(go.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,function(){e.textTracks().off("change",a)}),a(),i}(e,0,n))}}var yo=function(){function e(t,n,i){var a=this;if(i=i||n.options_,this.player=Object(r.default)(i.playerId),this.player.dash=this.player.dash||{},this.tech_=n,this.el_=n.el(),this.elParent_=this.el_.parentNode,this.hasFiniteDuration_=!1,t.src){n.isReady_=!1,e.updateSourceData&&(r.default.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),t=e.updateSourceData(t)),e.hooks("updatesource").forEach(function(e){t=e(t)});var o=t.src;this.keySystemOptions_=e.buildDashJSProtData(t.keySystemOptions),this.player.dash.mediaPlayer=go.MediaPlayer().create(),this.mediaPlayer_=this.player.dash.mediaPlayer,this.mediaPlayer_.setTextDefaultEnabled(!1),e.useVideoJSDebug&&(r.default.log.warn('useVideoJSDebug has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.useVideoJSDebug(this.mediaPlayer_)),e.beforeInitialize&&(r.default.log.warn('beforeInitialize has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.beforeInitialize(this.player,this.mediaPlayer_)),e.hooks("beforeinitialize").forEach(function(e){e(a.player,a.mediaPlayer_)}),this.mediaPlayer_.initialize(),this.retriggerError_=function(e){if("capability"===e.error&&"mediasource"===e.event)a.player.error({code:4,message:"The media cannot be played because it requires a feature that your browser does not support."});else if("manifestError"!==e.error||"createParser"!==e.event.id&&"codec"!==e.event.id&&"nostreams"!==e.event.id&&"nostreamscomposed"!==e.event.id&&"parse"!==e.event.id&&"multiplexedrep"!==e.event.id)if("mediasource"===e.error)e.event.match("MEDIA_ERR_ABORTED")?a.player.error({code:1,message:e.event}):e.event.match("MEDIA_ERR_NETWORK")?a.player.error({code:2,message:e.event}):e.event.match("MEDIA_ERR_DECODE")?a.player.error({code:3,message:e.event}):e.event.match("MEDIA_ERR_SRC_NOT_SUPPORTED")?a.player.error({code:4,message:e.event}):e.event.match("MEDIA_ERR_ENCRYPTED")?a.player.error({code:5,message:e.event}):(e.event.match("UNKNOWN"),a.player.error({code:4,message:e.event}));else if("capability"===e.error&&"encryptedmedia"===e.event)a.player.error({code:5,message:"The media cannot be played because it requires encryption features that your browser does not support."});else if("key_session"===e.error)a.player.error({code:5,message:e.event});else if("download"===e.error)a.player.error({code:2,message:"The media playback was aborted because too many consecutive download errors occurred."});else{if("mssError"!==e.error)return;a.player.error({code:3,message:e.event})}else a.player.error({code:4,message:e.event.message});setTimeout(function(){a.mediaPlayer_.reset()},10)},this.mediaPlayer_.on(go.MediaPlayer.events.ERROR,this.retriggerError_),this.getDuration_=function(e){var t=e.data.Period_asArray,n=a.hasFiniteDuration_;e.data.mediaPresentationDuration||t[t.length-1].duration?a.hasFiniteDuration_=!0:a.hasFiniteDuration_=!1,a.hasFiniteDuration_!==n&&a.player.trigger("durationchange")},this.mediaPlayer_.on(go.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),i.dash&&Object.keys(i.dash).forEach(function(e){var t,n="set"+e.charAt(0).toUpperCase()+e.slice(1),o=i.dash[e];a.mediaPlayer_.hasOwnProperty(n)&&(r.default.log.warn("Using dash options in videojs-contrib-dash without the set prefix has been deprecated. Change '"+e+"' to '"+n+"'"),e=n),a.mediaPlayer_.hasOwnProperty(e)?(Array.isArray(o)||(o=[o]),(t=a.mediaPlayer_)[e].apply(t,o)):r.default.log.warn("Warning: dash configuration option unrecognized: "+e)}),this.mediaPlayer_.attachView(this.el_),this.mediaPlayer_.setAutoPlay(!1),mo.call(null,this.player,n),vo.call(null,this.player,n,i),this.mediaPlayer_.setProtectionData(this.keySystemOptions_),this.mediaPlayer_.attachSource(o),this.tech_.triggerReady()}}e.buildDashJSProtData=function(e){var t={};if(!e||!Array.isArray(e))return null;for(var n=0;n<e.length;n++){var i=e[n],a=r.default.mergeOptions({},i.options);a.licenseUrl&&(a.serverURL=a.licenseUrl,delete a.licenseUrl),t[i.name]=a}return t};var t=e.prototype;return t.dispose=function(){this.mediaPlayer_&&(this.mediaPlayer_.off(go.MediaPlayer.events.ERROR,this.retriggerError_),this.mediaPlayer_.off(go.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),this.mediaPlayer_.reset()),this.player.dash&&delete this.player.dash},t.duration=function(){return this.mediaPlayer_.isDynamic()&&!this.hasFiniteDuration_?1/0:this.mediaPlayer_.duration()},e.hooks=function(t,n){return e.hooks_[t]=e.hooks_[t]||[],n&&(e.hooks_[t]=e.hooks_[t].concat(n)),e.hooks_[t]},e.hook=function(t,n){e.hooks(t,n)},e.removeHook=function(t,n){var r=e.hooks(t).indexOf(n);return-1!==r&&(e.hooks_[t]=e.hooks_[t].slice(),e.hooks_[t].splice(r,1),!0)},e}();yo.hooks_={};r.default.DashSourceHandler=function(){return{canHandleSource:function(e){return function(e){e=JSON.parse(JSON.stringify(e)),yo.updateSourceData&&(r.default.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),e=yo.updateSourceData(e)),yo.hooks("updatesource").forEach(function(t){e=t(e)});var t=l.a.createElement("video");return!(e.keySystemOptions&&!o.a.navigator.requestMediaKeySystemAccess&&!t.msSetMediaKeys)}(e)?r.default.DashSourceHandler.canPlayType(e.type)?"probably":/\.mpd/i.test(e.src)?"maybe":"":""},handleSource:function(e,t,n){return new yo(e,t,n)},canPlayType:function(e){return r.default.DashSourceHandler.canPlayType(e)}}},r.default.DashSourceHandler.canPlayType=function(e){return/^application\/dash\+xml/i.test(e)?"probably":""},o.a.MediaSource&&r.default.getTech("Html5").registerSourceHandler(r.default.DashSourceHandler(),0),r.default.Html5DashJS=yo,t.default=yo}.call(this,n(204))},1146:function(e,t,n){"use strict";n.r(t),n.d(t,"hasSession",function(){return b}),n.d(t,"removeSession",function(){return S}),n.d(t,"handleEncryptedEvent",function(){return A}),n.d(t,"handleWebKitNeedKeyEvent",function(){return w}),n.d(t,"handleMsNeedKeyEvent",function(){return I}),n.d(t,"getOptions",function(){return C}),n.d(t,"setupSessions",function(){return R}),n.d(t,"emeErrorHandler",function(){return D});var r=n(1311),i=n.n(r),a=n(1103),o=n(1239),s=n.n(o);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<n.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0},d=function(e){return e instanceof Uint8Array||e instanceof Uint16Array?e.buffer:e},c=function(){var e=a.default.mergeOptions.apply(a.default,arguments);return Object.keys(e).forEach(function(t){null===e[t]&&delete e[t]}),e},f=function(e,t,n,r){var i=function(e){var t=(new s.a.DOMParser).parseFromString(String.fromCharCode.apply(null,new Uint16Array(e)),"application/xml"),n=t.getElementsByTagName("HttpHeaders")[0],r={};if(n)for(var i=n.getElementsByTagName("name"),a=n.getElementsByTagName("value"),o=0;o<i.length;o++)r[i[o].childNodes[0].nodeValue]=a[o].childNodes[0].nodeValue;var u,l=t.getElementsByTagName("Challenge")[0];return l&&(u=s.a.atob(l.childNodes[0].nodeValue)),{headers:r,message:u}}(t),o=i.message,u=c(i.headers,n.emeHeaders,e.licenseHeaders);a.default.xhr({uri:e.url,method:"post",headers:u,body:o,responseType:"arraybuffer"},function(e,t,n){e?r(e):t.statusCode>=400&&t.statusCode<=599?r({}):r(null,n)})},h=function(e){var t;return Object.keys(e).forEach(function(n){var r=function(e){if(e.supportedConfigurations)return e.supportedConfigurations;var t={},n=e.audioContentType,r=e.audioRobustness,i=e.videoContentType,a=e.videoRobustness,o=e.persistentState;return(n||r)&&(t.audioCapabilities=[u({},n?{contentType:n}:{},r?{robustness:r}:{})]),(i||a)&&(t.videoCapabilities=[u({},i?{contentType:i}:{},a?{robustness:a}:{})]),o&&(t.persistentState=o),[t]}(e[n]);t=t?t.catch(function(e){return s.a.navigator.requestMediaKeySystemAccess(n,r)}):s.a.navigator.requestMediaKeySystemAccess(n,r)}),t},p=function e(t){var n=t.mediaKeys,r=t.initDataType,i=t.initData,o=t.options,s=t.getLicense,u=t.removeSession,l=t.eventBus,d=n.createSession();return l.trigger("keysessioncreated"),new Promise(function(n,c){d.addEventListener("message",function(e){"license-request"!==e.messageType&&"license-renewal"!==e.messageType||s(o,e.message).then(function(e){n(d.update(e))}).catch(function(e){c(e)})},!1),d.addEventListener("keystatuseschange",function(n){var r=!1;d.keyStatuses.forEach(function(e,t){switch(l.trigger({keyId:t,status:e,target:d,type:"keystatuschange"}),e){case"expired":r=!0;break;case"internal-error":a.default.log.warn('Key status reported as "internal-error." Leaving the session open since we don\'t have enough details to know if this error is fatal.',n)}}),r&&d.close().then(function(){u(i),e(t)})},!1),d.generateRequest(r,i).catch(function(){c("Unable to create or initialize key session")})})},g=function(e,t){return function(n,r){return new Promise(function(i,a){e(n,r,function(e,n){t&&t.trigger("licenserequestattempted"),e?a(e):i(n)})})}},m=function(e,t){if("string"===typeof t&&(t={url:t}),!t.url&&!t.getLicense)throw new Error("Neither URL nor getLicense function provided to get license");return t.url&&!t.getLicense&&(t.getLicense="com.microsoft.playready"===e?function(e){return function(t,n,r){f(e,n,t,r)}}(t):function(e){return function(t,n,r){var i=c({"Content-type":"application/octet-stream"},t.emeHeaders,e.licenseHeaders);a.default.xhr({uri:e.url,method:"POST",responseType:"arraybuffer",body:n,headers:i},function(e,t,n){e?r(e):t.statusCode>=400&&t.statusCode<=599?r({}):r(null,n)})}}(t)),t},v=function(e){var t,n,r=e.video,i=e.initDataType,a=e.initData,o=e.keySystemAccess,s=e.options,u=e.removeSession,l=e.eventBus,d=Promise.resolve();"undefined"===typeof r.mediaKeysObject&&(r.mediaKeysObject=null,r.pendingSessionData=[],d=new Promise(function(e,i){r.keySystem=o.keySystem,(n=m(o.keySystem,s.keySystems[o.keySystem])).getCertificate?n.getCertificate(s,function(n,r){n?i(n):(t=r,e())}):e(o)}).then(function(){return o.createMediaKeys()}).then(function(e){return function(e){var t=e.video,n=e.certificate,r=e.createdMediaKeys;t.mediaKeysObject=r;var i=[];n&&i.push(r.setServerCertificate(n));for(var a=0;a<t.pendingSessionData.length;a++){var o=t.pendingSessionData[a];i.push(p({mediaKeys:t.mediaKeysObject,initDataType:o.initDataType,initData:o.initData,options:o.options,getLicense:o.getLicense,removeSession:o.removeSession,eventBus:o.eventBus}))}return t.pendingSessionData=[],i.push(t.setMediaKeys(r)),Promise.all(i)}({video:r,certificate:t,createdMediaKeys:e})}).catch(function(e){return e?Promise.reject(e):Promise.reject("Failed to create and initialize a MediaKeys object")}));return d.then(function(){return function(e){var t=e.video,n=e.initDataType,r=e.initData,i=e.options,a=e.getLicense,o=e.removeSession,s=e.eventBus;return t.mediaKeysObject?p({mediaKeys:t.mediaKeysObject,initDataType:n,initData:r,options:i,getLicense:a,removeSession:o,eventBus:s}):(t.pendingSessionData.push({initDataType:n,initData:r,options:i,getLicense:a,removeSession:o,eventBus:s}),Promise.resolve())}({video:r,initDataType:i,initData:a,options:s,getLicense:r.keySystem?g(m(r.keySystem,s.keySystems[r.keySystem]).getLicense,l):null,removeSession:u,eventBus:l})})},y=function(e){var t=e.initData,n=e.id,r=e.cert;"string"===typeof n&&(n=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(n));var i=0,a=new ArrayBuffer(t.byteLength+4+n.byteLength+4+r.byteLength),o=new DataView(a);new Uint8Array(a,i,t.byteLength).set(t),i+=t.byteLength,o.setUint32(i,n.byteLength,!0),i+=4;var s=new Uint16Array(a,i,n.length);return s.set(n),i+=s.byteLength,o.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(a,i,r.byteLength).set(r),new Uint8Array(a,0,a.byteLength)},_=function(e,t){return function(e){var t=i.a.createElement("a");return t.href=e,t.hostname}((n=t,String.fromCharCode.apply(null,new Uint16Array(n.buffer))));var n},T=function(e){var t=e.video,n=e.initData,r=e.options,i=e.eventBus,o=r.keySystems["com.apple.fps.1_0"],u=o.getCertificate||function(e){return function(t,n){var r=c(t.emeHeaders,e.certificateHeaders);a.default.xhr({uri:e.certificateUri,responseType:"arraybuffer",headers:r},function(e,t,r){e?n(e):n(null,new Uint8Array(r))})}}(o),l=o.getContentId||_,d=o.getLicense||function(e){return function(t,n,r,i){var o=c({"Content-type":"application/octet-stream"},t.emeHeaders,e.licenseHeaders);a.default.xhr({uri:e.licenseUri,method:"POST",responseType:"arraybuffer",body:r,headers:o},function(e,t,n){e?i(e):t.statusCode>=400&&t.statusCode<=599?i({}):i(null,n)})}}(o);return new Promise(function(e,t){u(r,function(n,r){n?t(n):e(r)})}).then(function(e){return function(e){var t=e.video,n=e.contentId,r=e.initData,i=e.cert,a=e.options,o=e.getLicense,u=e.eventBus;return new Promise(function(e,l){if(!t.webkitKeys)try{t.webkitSetMediaKeys(new s.a.WebKitMediaKeys("com.apple.fps.1_0"))}catch(c){return void l("Could not create MediaKeys")}var d;try{d=t.webkitKeys.createSession("video/mp4",y({id:n,initData:r,cert:i}))}catch(c){return void l("Could not create key session")}u.trigger("keysessioncreated"),d.contentId=n,d.addEventListener("webkitkeymessage",function(e){o(a,n,e.message,function(e,t){u&&u.trigger("licenserequestattempted"),e?l(e):d.update(new Uint8Array(t))})}),d.addEventListener("webkitkeyadded",function(){e()}),d.addEventListener("webkitkeyerror",function(){var e=d.error;l("KeySession error: code "+e.code+", systemCode "+e.systemCode)})})}({video:t,cert:e,initData:n,getLicense:d,options:r,contentId:l(r,n),eventBus:i})})},E=function(e,t,n,r){var i=e.msKeys.createSession("video/mp4",t);if(!i)throw new Error("Could not create key session.");r.trigger("keysessioncreated"),i.addEventListener("mskeymessage",function(e){!function(e,t,n,r){var i=e.keySystems["com.microsoft.playready"];if("function"!==typeof i.getKey){"string"===typeof i?i={url:i}:"boolean"===typeof i&&(i={}),i.url||(i.url=n.destinationURL);var a=function(e,n){r&&r.trigger("licenserequestattempted"),e?r.trigger({message:"Unable to request key from url: "+i.url,target:t,type:"mskeyerror"}):t.update(new Uint8Array(n))};i.getLicense?i.getLicense(e,n.message.buffer,a):f(i,n.message.buffer,e,a)}else i.getKey(e,n.destinationURL,n.message.buffer,function(e,n){e?r.trigger({message:"Unable to get key: "+e,target:t,type:"mskeyerror"}):t.update(n)})}(n,i,e,r)}),i.addEventListener("mskeyerror",function(e){r.trigger({message:"Unexpected key error from key session with code: "+i.error.code+" and systemCode: "+i.error.systemCode,target:i,type:"mskeyerror"})}),i.addEventListener("mskeyadded",function(){r.trigger({target:i,type:"mskeyadded"})})},b=function(e,t){for(var n=0;n<e.length;n++)if(e[n].initData){var r=d(e[n].initData),i=d(t);if(l(r,i))return!0}return!1},S=function(e,t){for(var n=0;n<e.length;n++)if(e[n].initData===t)return void e.splice(n,1)},A=function(e,t,n,r){if(!t||!t.keySystems)return Promise.resolve();var i=e.initData;return h(t.keySystems).then(function(a){var o=a.keySystem;return t.keySystems[o]&&t.keySystems[o].pssh&&(i=t.keySystems[o].pssh),b(n,i)||!i?Promise.resolve():(n.push({initData:i}),v({video:e.target,initDataType:e.initDataType,initData:i,keySystemAccess:a,options:t,removeSession:S.bind(null,n),eventBus:r}))})},w=function(e,t,n){return t.keySystems&&t.keySystems["com.apple.fps.1_0"]&&e.initData?T({video:e.target,initData:e.initData,options:t,eventBus:n}):Promise.resolve()},I=function(e,t,n,r){if(t.keySystems&&t.keySystems["com.microsoft.playready"]&&!n.reduce(function(e,t){return e||t.playready},!1)){var i=e.initData;t.keySystems["com.microsoft.playready"]&&t.keySystems["com.microsoft.playready"].pssh&&(i=t.keySystems["com.microsoft.playready"].pssh),i&&(n.push({playready:!0,initData:i}),function(e){var t=e.video,n=e.initData,r=e.options,i=e.eventBus;t.msKeys&&delete t.msKeys;try{t.msSetMediaKeys(new s.a.MSMediaKeys("com.microsoft.playready"))}catch(a){throw new Error("Unable to create media keys for PlayReady key system. Error: "+a.message)}E(t,n,r,i)}({video:e.target,initData:i,options:t,eventBus:r}))}},C=function(e){return a.default.mergeOptions(e.currentSource(),e.eme.options)},R=function(e){var t=e.src();t!==e.eme.activeSrc&&(e.eme.activeSrc=t,e.eme.sessions=[])},D=function(e){return function(t){var n="string"===typeof t?t:t&&t.message||null;e.error({code:5,message:n})}},M=function(e){void 0===e&&(e={});var t=this,n=D(t);t.ready(function(){return function(e,t){if("video"===e.$(".vjs-tech").tagName.toLowerCase())if(R(e),s.a.WebKitMediaKeys){var n=function(n){R(e),w(n,C(e),e.tech_).catch(t)};e.tech_.el_.addEventListener("webkitneedkey",function(t){var r=C(e).firstWebkitneedkeyTimeout||1e3,i=e.src();e.eme.webkitneedkey_=e.eme.webkitneedkey_||{},e.eme.webkitneedkey_.src!==i&&(e.eme.webkitneedkey_={handledFirstEvent:!1,src:i}),e.eme.webkitneedkey_.handledFirstEvent?n(t):(e.clearTimeout(e.eme.webkitneedkey_.timeout),e.eme.webkitneedkey_.timeout=e.setTimeout(function(){e.eme.webkitneedkey_.handledFirstEvent=!0,e.eme.webkitneedkey_.timeout=null,n(t)},r))})}else s.a.MediaKeys?e.tech_.el_.addEventListener("encrypted",function(n){R(e),A(n,C(e),e.eme.sessions,e.tech_).catch(t)}):s.a.MSMediaKeys&&(e.tech_.el_.addEventListener("msneedkey",function(n){R(e);try{I(n,C(e),e.eme.sessions,e.tech_)}catch(r){t(r)}}),e.tech_.on("mskeyerror",t),e.on("dispose",function(){e.tech_.off("mskeyerror",t)}))}(t,n)}),t.eme={initializeMediaKeys:function(r,i,o){void 0===r&&(r={}),void 0===i&&(i=function(){}),void 0===o&&(o=!1);var s=a.default.mergeOptions(t.currentSource(),e,r),u={initDataType:"cenc",initData:null,target:t.tech_.el_};if(R(t),t.tech_.el_.setMediaKeys)A(u,s,t.eme.sessions,t.tech_).then(function(){return i()}).catch(function(e){i(e),o||n(e)});else if(t.tech_.el_.msSetMediaKeys){var l=function e(r){t.tech_.off("mskeyadded",e),t.tech_.off("mskeyerror",e),"mskeyerror"===r.type?(i(r.target.error),o||n(r.message)):i()};t.tech_.one("mskeyadded",l),t.tech_.one("mskeyerror",l);try{I(u,s,t.eme.sessions,t.tech_)}catch(d){t.tech_.off("mskeyadded",l),t.tech_.off("mskeyerror",l),i(d),o||n(d)}}},options:e}};(a.default.registerPlugin||a.default.plugin)("eme",M),t.default=M},1147:function(e,t,n){"use strict";n.r(t);var r=n(1103),i=n(1311),a=n.n(i);function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var s=function e(t){var n=this;if(r.default.browser.IS_IE8)for(var i in n=a.a.createElement("custom"),e.prototype)"constructor"!==i&&(n[i]=e.prototype[i]);return n.id=t.id,n.label=n.id,n.width=t.width,n.height=t.height,n.bitrate=t.bandwidth,n.enabled_=t.enabled,Object.defineProperty(n,"enabled",{get:function(){return n.enabled_()},set:function(e){n.enabled_(e)}}),n},u=function(e){var t,n;function i(){var t,n=o(o(t=e.call(this)||this));if(r.default.browser.IS_IE8)for(var s in n=a.a.createElement("custom"),i.prototype)"constructor"!==s&&(n[s]=i.prototype[s]);return n.levels_=[],n.selectedIndex_=-1,Object.defineProperty(n,"selectedIndex",{get:function(){return n.selectedIndex_}}),Object.defineProperty(n,"length",{get:function(){return n.levels_.length}}),n||o(t)}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var u=i.prototype;return u.addQualityLevel=function(e){var t=this.getQualityLevelById(e.id);if(t)return t;var n=this.levels_.length;return t=new s(e),""+n in this||Object.defineProperty(this,n,{get:function(){return this.levels_[n]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t},u.removeQualityLevel=function(e){for(var t=null,n=0,r=this.length;n<r;n++)if(this[n]===e){t=this.levels_.splice(n,1)[0],this.selectedIndex_===n?this.selectedIndex_=-1:this.selectedIndex_>n&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t},u.getQualityLevelById=function(e){for(var t=0,n=this.length;t<n;t++){var r=this[t];if(r.id===e)return r}return null},u.dispose=function(){this.selectedIndex_=-1,this.levels_.length=0},i}(r.default.EventTarget);for(var l in u.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"},u.prototype.allowedEvents_)u.prototype["on"+l]=null;var d=r.default.registerPlugin||r.default.plugin,c=function(e){return function(e,t){var n=e.qualityLevels,r=new u;return e.on("dispose",function t(){r.dispose(),e.qualityLevels=n,e.off("dispose",t)}),e.qualityLevels=function(){return r},e.qualityLevels.VERSION="2.1.0",r}(this,r.default.mergeOptions({},e))};d("qualityLevels",c),c.VERSION="2.1.0",t.default=c},1148:function(e,t,n){"use strict";n.r(t);var r=n(1103);function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var o=r.default.getComponent("MenuItem"),s=r.default.getComponent("Component"),u=function(e){function t(t,n){return n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}i(t,e);var n=t.prototype;return n.handleClick=function(){var t=this.options_;console.log("Changing quality to:",t.label),e.prototype.handleClick.call(this);for(var n=this.player().qualityLevels(),r=0;r<n.length;r++)t.index==n.length?n[r].enabled=!0:t.index==r?n[r].enabled=!0:n[r].enabled=!1},n.update=function(){var e=this.player().qualityLevels().selectedIndex;this.selected(this.options_.index==e)},t}(o);s.registerComponent("SourceMenuItem",u);var l=r.default.getComponent("MenuButton"),d=function(e){function t(t,n){var i;i=e.call(this,t,n)||this,l.apply(a(i),arguments);var o=i.player().qualityLevels();if(n&&n.default)if("low"==n.default)for(var s=0;s<o.length;s++)o[s].enabled=0==s;else if(n.default="high")for(s=0;s<o.length;s++)o[s].enabled=s==o.length-1;return i.player().qualityLevels().on(["change","addqualitylevel"],r.default.bind(a(i),i.update)),i}i(t,e);var n=t.prototype;return n.createEl=function(){return r.default.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},n.buildCSSClass=function(){return l.prototype.buildCSSClass.call(this)+" vjs-icon-cog"},n.update=function(){return l.prototype.update.call(this)},n.createItems=function(){for(var e=[],t=this.player().qualityLevels(),n=[],r=0;r<t.length;r++){var i=t.length-(r+1),a=i===t.selectedIndex,o=""+i,s=i;t[i].height?(o=t[i].height+"p",s=parseInt(t[i].height,10)):t[i].bitrate&&(o=Math.floor(t[i].bitrate/1e3)+" kbps",s=parseInt(t[i].bitrate,10)),n.indexOf(o)>=0||(n.push(o),e.push(new u(this.player_,{label:o,index:i,selected:a,sortVal:s})))}return t.length>1&&e.push(new u(this.player_,{label:"Auto",index:t.length,selected:!1,sortVal:99999})),e.sort(function(e,t){return e.options_.sortVal<t.options_.sortVal?1:e.options_.sortVal>t.options_.sortVal?-1:0}),e},t}(l),c={},f=r.default.registerPlugin||r.default.plugin,h=function(e){var t=this;this.ready(function(){!function(e,t){if(e.addClass("vjs-http-source-selector"),console.log("videojs-http-source-selector initialized!"),console.log("player.techName_:"+e.techName_),"Html5"!=e.techName_)return!1;e.on(["loadedmetadata"],function(t){if(e.qualityLevels(),r.default.log("loadmetadata event"),"undefined"==e.videojs_http_source_selector_initialized||1==e.videojs_http_source_selector_initialized)console.log("player.videojs_http_source_selector_initialized == true");else{console.log("player.videojs_http_source_selector_initialized == false"),e.videojs_http_source_selector_initialized=!0;var n=e.controlBar,i=n.getChild("fullscreenToggle").el();n.el().insertBefore(n.addChild("SourceMenuButton").el(),i)}})}(t,r.default.mergeOptions(c,e))}),r.default.registerComponent("SourceMenuButton",d),r.default.registerComponent("SourceMenuItem",u)};f("httpSourceSelector",h),h.VERSION="1.1.6",t.default=h},1179:function(e,t,n){var r;!function(i,a){"use strict";var o="model",s="name",u="type",l="vendor",d="version",c="mobile",f="tablet",h="smarttv",p={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2===0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"===typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"===typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),"undefined"===typeof t?e:e.substring(0,255)}},g={rgx:function(e,t){for(var n,r,i,a,o,s,u=0;u<t.length&&!o;){var l=t[u],d=t[u+1];for(n=r=0;n<l.length&&!o;)if(o=l[n++].exec(e))for(i=0;i<d.length;i++)s=o[++r],"object"===typeof(a=d[i])&&a.length>0?2==a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,s):this[a[0]]=a[1]:3==a.length?"function"!==typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=s?s.replace(a[1],a[2]):void 0:this[a[0]]=s?a[1].call(this,s,a[2]):void 0:4==a.length&&(this[a[0]]=s?a[3].call(this,s.replace(a[1],a[2])):void 0):this[a]=s||void 0;u+=2}},str:function(e,t){for(var n in t)if("object"===typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(p.has(t[n][r],e))return"?"===n?void 0:n}else if(p.has(t[n],e))return"?"===n?void 0:n;return e}},m={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},v={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[s,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[s,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[s,d],[/opios[\/\s]+([\w\.]+)/i],[d,[s,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[d,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,d],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[d,[s,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[d,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[s,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[d,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],d],[/focus\/([\w\.]+)/i],[d,[s,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[d,[s,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[d,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[s,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[s,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[d,[s,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],d],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[s,d],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[s],[/;fbav\/([\w\.]+);/i],[d,[s,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[s,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[s,d],[/\bgsa\/([\w\.]+)\s.*safari\//i],[d,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],d],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[d,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,d],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[d,[s,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[d,s],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[d,g.str,m.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[s,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],d],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[d,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",p.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",p.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",p.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[o,[l,"Samsung"],[u,f]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[o,[l,"Samsung"],[u,c]],[/\((ip(?:hone|od)[\s\w]*);/i],[o,[l,"Apple"],[u,c]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[o,[l,"Apple"],[u,f]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[o,[l,"Huawei"],[u,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[o,[l,"Huawei"],[u,c]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[o,/_/g," "],[l,"Xiaomi"],[u,c]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[o,/_/g," "],[l,"Xiaomi"],[u,f]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[o,[l,"OPPO"],[u,c]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[o,[l,"Vivo"],[u,c]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[o,[l,"Realme"],[u,c]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[o,[l,"Motorola"],[u,c]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[l,"Motorola"],[u,f]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[o,[l,"LG"],[u,f]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[o,[l,"LG"],[u,c]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[o,[l,"Lenovo"],[u,f]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[o,/_/g," "],[l,"Nokia"],[u,c]],[/droid.+;\s(pixel\sc)[\s)]/i],[o,[l,"Google"],[u,f]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[o,[l,"Google"],[u,c]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[l,"Sony"],[u,c]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[o,"Xperia Tablet"],[l,"Sony"],[u,f]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[o,[l,"OnePlus"],[u,c]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[o,[l,"Amazon"],[u,f]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[o,"Fire Phone"],[l,"Amazon"],[u,c]],[/\((playbook);[\w\s\),;-]+(rim)/i],[o,l,[u,f]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[o,[l,"BlackBerry"],[u,c]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[o,[l,"ASUS"],[u,f]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[o,[l,"ASUS"],[u,c]],[/(nexus\s9)/i],[o,[l,"HTC"],[u,f]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[o,/_/g," "],[u,c]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[o,[l,"Acer"],[u,f]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[o,[l,"Meizu"],[u,c]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,o,[u,c]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[l,o,[u,f]],[/\s(surface\sduo)\s/i],[o,[l,"Microsoft"],[u,f]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[o,[l,"Fairphone"],[u,c]],[/\s(u304aa)\sbuild/i],[o,[l,"AT&T"],[u,c]],[/sie-(\w*)/i],[o,[l,"Siemens"],[u,c]],[/[;\/]\s?(rct\w+)\sbuild/i],[o,[l,"RCA"],[u,f]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[o,[l,"Dell"],[u,f]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[o,[l,"Verizon"],[u,f]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[o,[l,"Barnes & Noble"],[u,f]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[o,[l,"NuVision"],[u,f]],[/;\s(k88)\sbuild/i],[o,[l,"ZTE"],[u,f]],[/;\s(nx\d{3}j)\sbuild/i],[o,[l,"ZTE"],[u,c]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[o,[l,"Swiss"],[u,c]],[/[;\/]\s?(zur\d{3})\sbuild/i],[o,[l,"Swiss"],[u,f]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[o,[l,"Zeki"],[u,f]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[l,"Dragon Touch"],o,[u,f]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[o,[l,"Insignia"],[u,f]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[o,[l,"NextBook"],[u,f]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[l,"Voice"],o,[u,c]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[l,"LvTel"],o,[u,c]],[/;\s(ph-1)\s/i],[o,[l,"Essential"],[u,c]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[o,[l,"Envizen"],[u,f]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[o,[l,"MachSpeed"],[u,f]],[/[;\/]\s?tu_(1491)\sbuild/i],[o,[l,"Rotor"],[u,f]],[/(shield[\w\s]+)\sbuild/i],[o,[l,"Nvidia"],[u,f]],[/(sprint)\s(\w+)/i],[l,o,[u,c]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[l,"Microsoft"],[u,c]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[o,[l,"Zebra"],[u,f]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[o,[l,"Zebra"],[u,c]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[l,o,[u,"console"]],[/droid.+;\s(shield)\sbuild/i],[o,[l,"Nvidia"],[u,"console"]],[/(playstation\s[345portablevi]+)/i],[o,[l,"Sony"],[u,"console"]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[o,[l,"Microsoft"],[u,"console"]],[/smart-tv.+(samsung)/i],[l,[u,h]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[l,"Samsung"],[u,h]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[l,"LG"],[u,h]],[/(apple)\s?tv/i],[l,[o,"Apple TV"],[u,h]],[/crkey/i],[[o,"Chromecast"],[l,"Google"],[u,h]],[/droid.+aft([\w])(\sbuild\/|\))/i],[o,[l,"Amazon"],[u,h]],[/\(dtv[\);].+(aquos)/i],[o,[l,"Sharp"],[u,h]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,p.trim],[o,p.trim],[u,h]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[u,h]],[/((pebble))app\/[\d\.]+\s/i],[l,o,[u,"wearable"]],[/droid.+;\s(glass)\s\d/i],[o,[l,"Google"],[u,"wearable"]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[o,[l,"Zebra"],[u,"wearable"]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[l,[u,"embedded"]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[o,[u,c]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[o,[u,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,p.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[l,"Generic"]],[/(phone)/i],[[u,c]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[s,[d,g.str,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[d,g.str,m.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[s,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[s,"Mac OS"],[d,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[s,d],[/\(bb(10);/i],[d,[s,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[d,[s,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[s,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],d],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[s,d],[/(sunos)\s?([\w\.\d]*)/i],[[s,"Solaris"],d],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[s,d]]},y=function e(t,n){if("object"===typeof t&&(n=t,t=void 0),!(this instanceof e))return new e(t,n).getResult();var r=t||("undefined"!==typeof i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),a=n?p.extend(v,n):v;return this.getBrowser=function(){var e={name:void 0,version:void 0};return g.rgx.call(e,r,a.browser),e.major=p.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return g.rgx.call(e,r,a.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return g.rgx.call(e,r,a.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return g.rgx.call(e,r,a.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return g.rgx.call(e,r,a.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r="string"===typeof e&&e.length>255?p.trim(e,255):e,this},this.setUA(r),this};y.VERSION="0.7.28",y.BROWSER={NAME:s,MAJOR:"major",VERSION:d},y.CPU={ARCHITECTURE:"architecture"},y.DEVICE={MODEL:o,VENDOR:l,TYPE:u,CONSOLE:"console",MOBILE:c,SMARTTV:h,TABLET:f,WEARABLE:"wearable",EMBEDDED:"embedded"},y.ENGINE={NAME:s,VERSION:d},y.OS={NAME:s,VERSION:d},"undefined"!==typeof t?("undefined"!==typeof e&&e.exports&&(t=e.exports=y),t.UAParser=y):void 0===(r=function(){return y}.call(t,n,t,e))||(e.exports=r);var _="undefined"!==typeof i&&(i.jQuery||i.Zepto);if(_&&!_.ua){var T=new y;_.ua=T.getResult(),_.ua.get=function(){return T.getUA()},_.ua.set=function(e){T.setUA(e);var t=T.getResult();for(var n in t)_.ua[n]=t[n]}}}("object"===typeof window?window:this)},1239:function(e,t,n){(function(t){var n;n="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},e.exports=n}).call(this,n(204))},1311:function(e,t,n){(function(t){var r,i="undefined"!==typeof t?t:"undefined"!==typeof window?window:{},a=n(1178);"undefined"!==typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=a),e.exports=r}).call(this,n(204))},1373:function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},1427:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return o});var r=n(1239),i=n.n(r),a=function(t){return i.a.atob?i.a.atob(t):e.from(t,"base64").toString("binary")};function o(e){for(var t=a(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}}).call(this,n(672).Buffer)},1428:function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function r(e,t){var r=e.prototype;if(!(r instanceof t)){var i=function(){};i.prototype=t.prototype,n(r,i=new i),e.prototype=r=i}r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}var i="http://www.w3.org/1999/xhtml",a={},o=a.ELEMENT_NODE=1,s=a.ATTRIBUTE_NODE=2,u=a.TEXT_NODE=3,l=a.CDATA_SECTION_NODE=4,d=a.ENTITY_REFERENCE_NODE=5,c=a.ENTITY_NODE=6,f=a.PROCESSING_INSTRUCTION_NODE=7,h=a.COMMENT_NODE=8,p=a.DOCUMENT_NODE=9,g=a.DOCUMENT_TYPE_NODE=10,m=a.DOCUMENT_FRAGMENT_NODE=11,v=a.NOTATION_NODE=12,y={},_={},T=(y.INDEX_SIZE_ERR=(_[1]="Index size error",1),y.DOMSTRING_SIZE_ERR=(_[2]="DOMString size error",2),y.HIERARCHY_REQUEST_ERR=(_[3]="Hierarchy request error",3)),E=(y.WRONG_DOCUMENT_ERR=(_[4]="Wrong document",4),y.INVALID_CHARACTER_ERR=(_[5]="Invalid character",5),y.NO_DATA_ALLOWED_ERR=(_[6]="No data allowed",6),y.NO_MODIFICATION_ALLOWED_ERR=(_[7]="No modification allowed",7),y.NOT_FOUND_ERR=(_[8]="Not found",8)),b=(y.NOT_SUPPORTED_ERR=(_[9]="Not supported",9),y.INUSE_ATTRIBUTE_ERR=(_[10]="Attribute in use",10));y.INVALID_STATE_ERR=(_[11]="Invalid state",11),y.SYNTAX_ERR=(_[12]="Syntax error",12),y.INVALID_MODIFICATION_ERR=(_[13]="Invalid modification",13),y.NAMESPACE_ERR=(_[14]="Invalid namespace",14),y.INVALID_ACCESS_ERR=(_[15]="Invalid access",15);function S(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,_[e]),this.message=_[e],Error.captureStackTrace&&Error.captureStackTrace(this,S);return n.code=e,t&&(this.message=this.message+": "+t),n}function A(){}function w(e,t){this._node=e,this._refresh=t,I(this)}function I(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);ne(e,"length",r.length),n(r,e),e._inc=t}}function C(){}function R(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function D(e,t,n,r){if(r?t[R(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&x(i,e,r),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(i,e,n))}}function M(e,t,n){var r=R(t,n);if(!(r>=0))throw S(E,new Error(e.tagName+"@"+n));for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var a=e.ownerDocument;a&&(x(a,e,n),n.ownerElement=null)}}function O(e){if(this._features={},e)for(var t in e)this._features=e[t]}function N(){}function P(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function L(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(L(e,t))return!0}while(e=e.nextSibling)}function k(){}function x(e,t,n,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function F(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,a=0;i;)r[a++]=i,i=i.nextSibling;r.length=a}}}function U(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,F(e.ownerDocument,e),t}function B(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===m){var i=t.firstChild;if(null==i)return t;var a=t.lastChild}else i=a=t;var o=n?n.previousSibling:e.lastChild;i.previousSibling=o,a.nextSibling=n,o?o.nextSibling=i:e.firstChild=i,null==n?e.lastChild=a:n.previousSibling=a;do{i.parentNode=e}while(i!==a&&(i=i.nextSibling));return F(e.ownerDocument||e,e),t.nodeType==m&&(t.firstChild=t.lastChild=null),t}function j(){this._nsMap={}}function G(){}function q(){}function H(){}function V(){}function K(){}function Y(){}function W(){}function z(){}function X(){}function Q(){}function $(){}function Z(){}function J(e,t){var n=[],r=9==this.nodeType&&this.documentElement||this,i=r.prefix,a=r.namespaceURI;if(a&&null==i&&null==(i=r.lookupPrefix(a)))var o=[{namespace:a,prefix:null}];return te(this,n,e,t,o),n.join("")}function ee(e,t,n){var r=e.prefix||"",i=e.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var a=n.length;a--;){var o=n[a];if(o.prefix==r)return o.namespace!=i}return!0}function te(e,t,n,r,a){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case o:a||(a=[]);a.length;var c=e.attributes,v=c.length,y=e.firstChild,_=e.tagName;n=i===e.namespaceURI||n,t.push("<",_);for(var T=0;T<v;T++){"xmlns"==(E=c.item(T)).prefix?a.push({prefix:E.localName,namespace:E.value}):"xmlns"==E.nodeName&&a.push({prefix:"",namespace:E.value})}for(T=0;T<v;T++){var E;if(ee(E=c.item(T),0,a)){var b=E.prefix||"",S=E.namespaceURI,A=b?" xmlns:"+b:" xmlns";t.push(A,'="',S,'"'),a.push({prefix:b,namespace:S})}te(E,t,n,r,a)}if(ee(e,0,a)){b=e.prefix||"",S=e.namespaceURI,A=b?" xmlns:"+b:" xmlns";t.push(A,'="',S,'"'),a.push({prefix:b,namespace:S})}if(y||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(_)){if(t.push(">"),n&&/^script$/i.test(_))for(;y;)y.data?t.push(y.data):te(y,t,n,r,a),y=y.nextSibling;else for(;y;)te(y,t,n,r,a),y=y.nextSibling;t.push("</",_,">")}else t.push("/>");return;case p:case m:for(y=e.firstChild;y;)te(y,t,n,r,a),y=y.nextSibling;return;case s:return t.push(" ",e.name,'="',e.value.replace(/[&"]/g,P),'"');case u:return t.push(e.data.replace(/[<&]/g,P).replace(/]]>/g,"]]&gt;"));case l:return t.push("<![CDATA[",e.data,"]]>");case h:return t.push("\x3c!--",e.data,"--\x3e");case g:var w=e.publicId,I=e.systemId;if(t.push("<!DOCTYPE ",e.name),w)t.push(" PUBLIC ",w),I&&"."!=I&&t.push(" ",I),t.push(">");else if(I&&"."!=I)t.push(" SYSTEM ",I,">");else{var C=e.internalSubset;C&&t.push(" [",C,"]"),t.push(">")}return;case f:return t.push("<?",e.target," ",e.data,"?>");case d:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ne(e,t,n){e[t]=n}S.prototype=Error.prototype,n(y,S),A.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)te(this[r],n,e,t);return n.join("")}},w.prototype.item=function(e){return I(this),this[e]},r(w,A),C.prototype={length:0,item:A.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new S(b);var n=this.getNamedItem(e.nodeName);return D(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new S(b);return t=this.getNamedItemNS(e.namespaceURI,e.localName),D(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return M(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return M(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},O.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new k;if(r.implementation=this,r.childNodes=new A,r.doctype=n,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new Y;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},N.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return B(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return U(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,r){var i=new n.constructor;for(var a in n){var u=n[a];"object"!=typeof u&&u!=i[a]&&(i[a]=u)}n.childNodes&&(i.childNodes=new A);i.ownerDocument=t;switch(i.nodeType){case o:var l=n.attributes,d=i.attributes=new C,c=l.length;d._ownerElement=i;for(var f=0;f<c;f++)i.setAttributeNode(e(t,l.item(f),!0));break;case s:r=!0}if(r)for(var h=n.firstChild;h;)i.appendChild(e(t,h,r)),h=h.nextSibling;return i}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==u&&e.nodeType==u?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(a,N),n(a,N.prototype),k.prototype={nodeName:"#document",nodeType:p,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==m){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return null==this.documentElement&&e.nodeType==o&&(this.documentElement=e),B(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),U(this,e)},importNode:function(e,t){return function e(t,n,r){var i;switch(n.nodeType){case o:(i=n.cloneNode(!1)).ownerDocument=t;case m:break;case s:r=!0}i||(i=n.cloneNode(!1));i.ownerDocument=t;i.parentNode=null;if(r)for(var a=n.firstChild;a;)i.appendChild(e(t,a,r)),a=a.nextSibling;return i}(this,e,t)},getElementById:function(e){var t=null;return L(this.documentElement,function(n){if(n.nodeType==o&&n.getAttribute("id")==e)return t=n,!0}),t},getElementsByClassName:function(e){var t=new RegExp("(^|\\s)"+e+"(\\s|$)");return new w(this,function(e){var n=[];return L(e.documentElement,function(r){r!==e&&r.nodeType==o&&t.test(r.getAttribute("class"))&&n.push(r)}),n})},createElement:function(e){var t=new j;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new A,(t.attributes=new C)._ownerElement=t,t},createDocumentFragment:function(){var e=new Q;return e.ownerDocument=this,e.childNodes=new A,e},createTextNode:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new V;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new K;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new $;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new G;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new X;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new j,r=t.split(":"),i=n.attributes=new C;return n.childNodes=new A,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new G,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},r(k,N),j.prototype={nodeType:o,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===m?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t),r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,F(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new w(this,function(t){var n=[];return L(t,function(r){r===t||r.nodeType!=o||"*"!==e&&r.tagName!=e||n.push(r)}),n})},getElementsByTagNameNS:function(e,t){return new w(this,function(n){var r=[];return L(n,function(i){i===n||i.nodeType!==o||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||r.push(i)}),r})}},k.prototype.getElementsByTagName=j.prototype.getElementsByTagName,k.prototype.getElementsByTagNameNS=j.prototype.getElementsByTagNameNS,r(j,N),G.prototype.nodeType=s,r(G,N),q.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(_[T])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},r(q,N),H.prototype={nodeName:"#text",nodeType:u,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(H,q),V.prototype={nodeName:"#comment",nodeType:h},r(V,q),K.prototype={nodeName:"#cdata-section",nodeType:l},r(K,q),Y.prototype.nodeType=g,r(Y,N),W.prototype.nodeType=v,r(W,N),z.prototype.nodeType=c,r(z,N),X.prototype.nodeType=d,r(X,N),Q.prototype.nodeName="#document-fragment",Q.prototype.nodeType=m,r(Q,N),$.prototype.nodeType=f,r($,N),Z.prototype.serializeToString=function(e,t,n){return J.call(e,t,n)},N.prototype.toString=J;try{if(Object.defineProperty){Object.defineProperty(w.prototype,"length",{get:function(){return I(this),this.$$length}}),Object.defineProperty(N.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case o:case m:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case o:case m:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ne=function(e,t,n){e["$$"+t]=n}}}catch(re){}t.Node=N,t.DOMException=S,t.DOMImplementation=O,t.XMLSerializer=Z},1484:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,n.apply(this,arguments)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},1485:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},1486:function(e,t,n){var r=n(1373);e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},1487:function(e,t){e.exports=function(e,t){var n,r=null;try{n=JSON.parse(e,t)}catch(i){r=i}return[r,n]}},1488:function(e,t){function n(e){if(e&&"object"===typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"===typeof e)return o[e];var n,a=String(e);return(n=r[a.toLowerCase()])?n:(n=i[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"===typeof e){var n=e.which||e.keyCode||e.charCode;if(null===n||void 0===n)return!1;if("string"===typeof t){var a;if(a=r[t.toLowerCase()])return a===n;if(a=i[t.toLowerCase()])return a===n}else if("number"===typeof t)return t===n;return!1}};var r=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=t.aliases={windows:91,"\u21e7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(a=97;a<123;a++)r[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)r[a-48]=a;for(a=1;a<13;a++)r["f"+a]=a+111;for(a=0;a<10;a++)r["numpad "+a]=a+96;var o=t.names=t.title={};for(a in r)o[r[a]]=a;for(var s in i)r[s]=i[s]},1489:function(e,t,n){"use strict";var r=n(1239),i=n(1490),a=n(1491),o=function(e){var t={};return e?(e.trim().split("\n").forEach(function(e){var n=e.indexOf(":"),r=e.slice(0,n).trim().toLowerCase(),i=e.slice(n+1).trim();"undefined"===typeof t[r]?t[r]=i:Array.isArray(t[r])?t[r].push(i):t[r]=[t[r],i]}),t):t};function s(e,t,n){var r=e;return a(t)?(n=t,"string"===typeof e&&(r={uri:e})):r=i({},t,{uri:e}),r.callback=n,r}function u(e,t,n){return l(t=s(e,t,n))}function l(e){if("undefined"===typeof e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,i){t||(t=!0,e.callback(n,r,i))};function r(){var e=void 0;if(e=d.response?d.response:d.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(n){}return null}(d),v)try{e=JSON.parse(e)}catch(t){}return e}function i(e){return clearTimeout(c),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,y)}function a(){if(!l){var t;clearTimeout(c),t=e.useXDR&&void 0===d.status?200:1223===d.status?204:d.status;var i=y,a=null;return 0!==t?(i={body:r(),statusCode:t,method:h,headers:{},url:f,rawRequest:d},d.getAllResponseHeaders&&(i.headers=o(d.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),n(a,i,i.body)}}var s,l,d=e.xhr||null;d||(d=e.cors||e.useXDR?new u.XDomainRequest:new u.XMLHttpRequest);var c,f=d.url=e.uri||e.url,h=d.method=e.method||"GET",p=e.body||e.data,g=d.headers=e.headers||{},m=!!e.sync,v=!1,y={body:void 0,headers:{},statusCode:0,method:h,url:f,rawRequest:d};if("json"in e&&!1!==e.json&&(v=!0,g.accept||g.Accept||(g.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json"),p=JSON.stringify(!0===e.json?p:e.json))),d.onreadystatechange=function(){4===d.readyState&&setTimeout(a,0)},d.onload=a,d.onerror=i,d.onprogress=function(){},d.onabort=function(){l=!0},d.ontimeout=i,d.open(h,f,!m,e.username,e.password),m||(d.withCredentials=!!e.withCredentials),!m&&e.timeout>0&&(c=setTimeout(function(){if(!l){l=!0,d.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}},e.timeout)),d.setRequestHeader)for(s in g)g.hasOwnProperty(s)&&d.setRequestHeader(s,g[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(d.responseType=e.responseType),"beforeSend"in e&&"function"===typeof e.beforeSend&&e.beforeSend(d),d.send(p||null),d}e.exports=u,e.exports.default=u,u.XMLHttpRequest=r.XMLHttpRequest||function(){},u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:r.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){u["delete"===e?"del":e]=function(t,n,r){return(n=s(t,n,r)).method=e.toUpperCase(),l(n)}})},1490:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,n.apply(this,arguments)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},1491:function(e,t){e.exports=function(e){if(!e)return!1;var t=n.call(e);return"[object Function]"===t||"function"===typeof e&&"[object RegExp]"!==t||"undefined"!==typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString},1492:function(e,t,n){var r=n(1239),i=e.exports={WebVTT:n(1493),VTTCue:n(1494),VTTRegion:n(1495)};r.vttjs=i,r.WebVTT=i.WebVTT;var a=i.VTTCue,o=i.VTTRegion,s=r.VTTCue,u=r.VTTRegion;i.shim=function(){r.VTTCue=a,r.VTTRegion=o},i.restore=function(){r.VTTCue=s,r.VTTRegion=u},r.VTTCue||i.shim()},1493:function(e,t,n){var r=n(1311),i=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function a(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function o(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function s(){this.values=i(null)}function u(e,t,n,r){var i=r?e.split(r):[e];for(var a in i)if("string"===typeof i[a]){var o=i[a].split(n);if(2===o.length)t(o[0],o[1])}}function l(e,t,n){var r=e;function i(){var t=o(e);if(null===t)throw new a(a.Errors.BadTimeStamp,"Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function l(){e=e.replace(/^\s+/,"")}if(l(),t.startTime=i(),l(),"--\x3e"!==e.substr(0,3))throw new a(a.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),l(),t.endTime=i(),l(),function(e,t){var r=new s;u(e,function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];r.integer(e,o),r.percent(e,o)&&r.set("snapToLines",!1),r.alt(e,o,["auto"]),2===a.length&&r.alt("lineAlign",a[1],["start","center","end"]);break;case"position":a=t.split(","),r.percent(e,a[0]),2===a.length&&r.alt("positionAlign",a[1],["start","center","end"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start","center","end","left","right"])}},/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");try{t.line=r.get("line","auto")}catch(i){}t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100);try{t.align=r.get("align","center")}catch(i){t.align=r.get("align","middle")}try{t.position=r.get("position","auto")}catch(i){t.position=r.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=r.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}a.prototype=i(Error.prototype),a.prototype.constructor=a,a.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var d=r.createElement&&r.createElement("textarea"),c={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},f={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},h={v:"title",lang:"lang"},p={rt:"ruby"};function g(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function r(e,t){return!p[t.localName]||p[t.localName]===e.localName}function i(t,n){var r=c[t];if(!r)return null;var i=e.document.createElement(r),a=h[t];return a&&n&&(i[a]=n.trim()),i}for(var a,s,u=e.document.createElement("div"),l=u,g=[];null!==(a=n());)if("<"!==a[0])l.appendChild(e.document.createTextNode((s=a,d.innerHTML=s,s=d.textContent,d.textContent="",s)));else{if("/"===a[1]){g.length&&g[g.length-1]===a.substr(2).replace(">","")&&(g.pop(),l=l.parentNode);continue}var m,v=o(a.substr(1,a.length-2));if(v){m=e.document.createProcessingInstruction("timestamp",v),l.appendChild(m);continue}var y=a.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(!(m=i(y[1],y[3])))continue;if(!r(l,m))continue;if(y[2]){var _=y[2].split(".");_.forEach(function(e){var t=/^bg_/.test(e),n=t?e.slice(3):e;if(f.hasOwnProperty(n)){var r=t?"background-color":"color",i=f[n];m.style[r]=i}}),m.className=_.join(" ")}g.push(y[1]),l.appendChild(m),l=m}return u}var m=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function v(e){for(var t=0;t<m.length;t++){var n=m[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function y(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function i(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===t.tagName?i(e):t.childNodes?(r(e,t),i(e)):void 0}for(r(t,e);n=i(t);)for(var a=0;a<n.length;a++)if(v(n.charCodeAt(a)))return"rtl";return"ltr"}function _(){}function T(e,t,n){_.call(this),this.cue=t,this.cueDiv=g(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:y(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var i=0;switch(t.positionAlign){case"start":i=t.position;break;case"center":i=t.position-t.size/2;break;case"end":i=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(i,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(i,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function E(e){var t,n,r,i;if(e.div){n=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||n,this.bottom=e.bottom||i+(e.height||n),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight}function b(e,t,n,r){var i=new E(t),a=t.cue,o=function(e){if("number"===typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}(a),s=[];if(a.snapToLines){var u;switch(a.vertical){case"":s=["+y","-y"],u="height";break;case"rl":s=["+x","-x"],u="width";break;case"lr":s=["-x","+x"],u="width"}var l=i.lineHeight,d=l*Math.round(o),c=n[u]+l,f=s[0];Math.abs(d)>c&&(d=d<0?-1:1,d*=Math.ceil(c/l)*l),o<0&&(d+=""===a.vertical?n.height:n.width,s=s.reverse()),i.move(f,d)}else{var h=i.lineHeight/n.height*100;switch(a.lineAlign){case"center":o-=h/2;break;case"end":o-=h}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],i=new E(t)}var p=function(e,t){for(var i,a=new E(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(r);)e.move(t[s]);if(e.within(n))return e;var u=e.intersectPercentage(n);o>u&&(i=new E(e),o=u),e=new E(a)}return i||a}(i,s);t.move(p.toCSSCompatValues(n))}function S(){}_.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},_.prototype.formatStyle=function(e,t){return 0===e?0:e+t},T.prototype=i(_.prototype),T.prototype.constructor=T,E.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},E.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},E.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},E.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},E.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},E.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},E.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},E.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n}},S.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},S.convertCueToDOMTree=function(e,t){return e&&t?g(e,t):null};S.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",n.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],a=E.getSimpleBoxPosition(r),o={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var n,s,u=0;u<t.length;u++)s=t[u],n=new T(e,s,o),r.appendChild(n.div),b(0,n,a,i),s.displayState=n.div,i.push(E.getSimpleBoxPosition(n))}()}else for(var s=0;s<t.length;s++)r.appendChild(t[s].displayState)},S.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},S.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof a))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var r=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),r}function r(e){e.match(/X-TIMESTAMP-MAP/)?u(e,function(e,n){switch(e){case"X-TIMESTAMP-MAP":!function(e){var n=new s;u(e,function(e,t){switch(e){case"MPEGT":n.integer(e+"S",t);break;case"LOCA":n.set(e+"L",o(t))}},/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:n.get("MPEGTS"),LOCAL:n.get("LOCAL")})}(n)}},/=/):u(e,function(e,n){switch(e){case"Region":!function(e){var n=new s;if(u(e,function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var r=t.split(",");if(2!==r.length)break;var i=new s;if(i.percent("x",r[0]),i.percent("y",r[1]),!i.has("x")||!i.has("y"))break;n.set(e+"X",i.get("x")),n.set(e+"Y",i.get("y"));break;case"scroll":n.alt(e,t,["up"])}},/=/,/\s/),n.has("id")){var r=new(t.vttjs.VTTRegion||t.window.VTTRegion);r.width=n.get("width",100),r.lines=n.get("lines",3),r.regionAnchorX=n.get("regionanchorX",0),r.regionAnchorY=n.get("regionanchorY",100),r.viewportAnchorX=n.get("viewportanchorX",0),r.viewportAnchorY=n.get("viewportanchorY",100),r.scroll=n.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:n.get("id"),region:r})}}(n)}},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var d=(i=n()).match(/^WEBVTT([ \t].*)?$/);if(!d||!d[0])throw new a(a.Errors.BadSignature);t.state="HEADER"}for(var c=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(c?c=!1:i=n(),t.state){case"HEADER":/:/.test(i)?r(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(h){t.cue.align="middle"}if(t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":try{l(i,t.cue,t.regionList)}catch(h){t.reportOrThrowError(h),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var f=-1!==i.indexOf("--\x3e");if(!i||f&&(c=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":i||(t.state="ID");continue}}}catch(h){t.reportOrThrowError(h),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new a(a.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}},e.exports=S},1494:function(e,t){var n="auto",r={"":1,lr:1,rl:1},i={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function a(e){return"string"===typeof e&&(!!i[e.toLowerCase()]&&e.toLowerCase())}function o(e,t,i){this.hasBeenReset=!1;var o="",s=!1,u=e,l=t,d=i,c=null,f="",h=!0,p="auto",g="start",m="auto",v="auto",y=100,_="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return o},set:function(e){o=""+e}},pauseOnExit:{enumerable:!0,get:function(){return s},set:function(e){s=!!e}},startTime:{enumerable:!0,get:function(){return u},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");u=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return l},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return d},set:function(e){d=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return f},set:function(e){var t=function(e){return"string"===typeof e&&!!r[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");f=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return p},set:function(e){if("number"!==typeof e&&e!==n)throw new SyntaxError("Line: an invalid number or illegal string was specified.");p=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return g},set:function(e){var t=a(e);t?(g=t,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");m=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return v},set:function(e){var t=a(e);t?(v=t,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return _},set:function(e){var t=a(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");_=t,this.hasBeenReset=!0}}}),this.displayState=void 0}o.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=o},1495:function(e,t){var n={"":!0,up:!0};function r(e){return"number"===typeof e&&e>=0&&e<=100}e.exports=function(){var e=100,t=3,i=0,a=100,o=0,s=100,u="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!r(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!==typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!r(e))throw new Error("RegionAnchorX must be between 0 and 100.");a=e}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!r(e))throw new Error("RegionAnchorY must be between 0 and 100.");i=e}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!r(e))throw new Error("ViewportAnchorY must be between 0 and 100.");s=e}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(e){if(!r(e))throw new Error("ViewportAnchorX must be between 0 and 100.");o=e}},scroll:{enumerable:!0,get:function(){return u},set:function(e){var t=function(e){return"string"===typeof e&&!!n[e.toLowerCase()]&&e.toLowerCase()}(e);!1===t?console.warn("Scroll: an invalid or illegal string was specified."):u=t}}})}},1496:function(e,t,n){var r=n(1373),i=n(1497);function a(t,n,o){return i()?(e.exports=a=Reflect.construct,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=a=function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r(a,n.prototype),a},e.exports.default=e.exports,e.exports.__esModule=!0),a.apply(null,arguments)}e.exports=a,e.exports.default=e.exports,e.exports.__esModule=!0},1497:function(e,t){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}},e.exports.default=e.exports,e.exports.__esModule=!0},1498:function(e,t,n){var r=n(1373);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},1499:function(e,t,n){!function(t){var n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,r=/^([^\/?#]*)([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var i=o.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=o.normalizePath(i.path),o.buildURLFromParts(i)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var u=r.exec(s.path);s.netLoc=u[1],s.path=u[2]}s.netLoc&&!s.path&&(s.path="/");var l={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var d=s.path,c=d.substring(0,d.lastIndexOf("/")+1)+a.path;l.path=o.normalizePath(c)}else l.path=s.path,a.params||(l.params=s.params,a.query||(l.query=s.query));return null===l.path&&(l.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(l)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=o}()},1500:function(e,t,n){var r=n(1501);e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},1501:function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},1502:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,n.apply(this,arguments)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},1503:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},1504:function(e,t,n){function r(e){this.options=e||{locator:{}}}function i(){this.cdata=!1}function a(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function o(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function s(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function u(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}r.prototype.parseFromString=function(e,t){var n=this.options,r=new c,a=n.domBuilder||new i,s=n.errorHandler,u=n.locator,d=n.xmlns||{},f=/\/x?html?$/.test(t),h=f?l.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&a.setDocumentLocator(u),r.errorHandler=function(e,t,n){if(!e){if(t instanceof i)return t;e=t}var r={},a=e instanceof Function;function s(t){var i=e[t];!i&&a&&(i=2==e.length?function(n){e(t,n)}:e),r[t]=i&&function(e){i("[xmldom "+t+"]\t"+e+o(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),r}(s,a,u),r.domBuilder=n.domBuilder||a,f&&(d[""]="http://www.w3.org/1999/xhtml"),d.xml=d.xml||"http://www.w3.org/XML/1998/namespace",e&&"string"===typeof e?r.parse(e,d,h):r.errorHandler.error("invalid doc source"),a.doc},i.prototype={startDocument:function(){this.doc=(new h).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,o=i.createElementNS(e,n||t),s=r.length;u(this,o),this.currentElement=o,this.locator&&a(this.locator,o);for(var l=0;l<s;l++){e=r.getURI(l);var d=r.getValue(l),c=(n=r.getQName(l),i.createAttributeNS(e,n));this.locator&&a(r.getLocator(l),c),c.value=c.nodeValue=d,o.setAttributeNode(c)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&a(this.locator,n),u(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=s.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&a(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=s.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&a(this.locator,r),u(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&a(this.locator,i),u(this,i)}},warning:function(e){console.warn("[xmldom warning]\t"+e,o(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,o(this.locator))},fatalError:function(e){throw new f(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){i.prototype[e]=function(){return null}});var l=n(1505),d=n(1506),c=d.XMLReader,f=d.ParseError,h=t.DOMImplementation=n(1428).DOMImplementation;t.XMLSerializer=n(1428).XMLSerializer,t.DOMParser=r,t.__DOMHandler=i},1505:function(e,t){t.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xc0",Aacute:"\xc1",Acirc:"\xc2",Atilde:"\xc3",Auml:"\xc4",Aring:"\xc5",AElig:"\xc6",Ccedil:"\xc7",Egrave:"\xc8",Eacute:"\xc9",Ecirc:"\xca",Euml:"\xcb",Igrave:"\xcc",Iacute:"\xcd",Icirc:"\xce",Iuml:"\xcf",ETH:"\xd0",Ntilde:"\xd1",Ograve:"\xd2",Oacute:"\xd3",Ocirc:"\xd4",Otilde:"\xd5",Ouml:"\xd6",Oslash:"\xd8",Ugrave:"\xd9",Uacute:"\xda",Ucirc:"\xdb",Uuml:"\xdc",Yacute:"\xdd",THORN:"\xde",szlig:"\xdf",agrave:"\xe0",aacute:"\xe1",acirc:"\xe2",atilde:"\xe3",auml:"\xe4",aring:"\xe5",aelig:"\xe6",ccedil:"\xe7",egrave:"\xe8",eacute:"\xe9",ecirc:"\xea",euml:"\xeb",igrave:"\xec",iacute:"\xed",icirc:"\xee",iuml:"\xef",eth:"\xf0",ntilde:"\xf1",ograve:"\xf2",oacute:"\xf3",ocirc:"\xf4",otilde:"\xf5",ouml:"\xf6",oslash:"\xf8",ugrave:"\xf9",uacute:"\xfa",ucirc:"\xfb",uuml:"\xfc",yacute:"\xfd",thorn:"\xfe",yuml:"\xff",nbsp:"\xa0",iexcl:"\xa1",cent:"\xa2",pound:"\xa3",curren:"\xa4",yen:"\xa5",brvbar:"\xa6",sect:"\xa7",uml:"\xa8",copy:"\xa9",ordf:"\xaa",laquo:"\xab",not:"\xac",shy:"\xad\xad",reg:"\xae",macr:"\xaf",deg:"\xb0",plusmn:"\xb1",sup2:"\xb2",sup3:"\xb3",acute:"\xb4",micro:"\xb5",para:"\xb6",middot:"\xb7",cedil:"\xb8",sup1:"\xb9",ordm:"\xba",raquo:"\xbb",frac14:"\xbc",frac12:"\xbd",frac34:"\xbe",iquest:"\xbf",times:"\xd7",divide:"\xf7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220b",prod:"\u220f",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221a",prop:"\u221d",infin:"\u221e",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222a",int:"\u222b",there4:"\u2234",sim:"\u223c",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22a5",sdot:"\u22c5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039a",Lambda:"\u039b",Mu:"\u039c",Nu:"\u039d",Xi:"\u039e",Omicron:"\u039f",Pi:"\u03a0",Rho:"\u03a1",Sigma:"\u03a3",Tau:"\u03a4",Upsilon:"\u03a5",Phi:"\u03a6",Chi:"\u03a7",Psi:"\u03a8",Omega:"\u03a9",alpha:"\u03b1",beta:"\u03b2",gamma:"\u03b3",delta:"\u03b4",epsilon:"\u03b5",zeta:"\u03b6",eta:"\u03b7",theta:"\u03b8",iota:"\u03b9",kappa:"\u03ba",lambda:"\u03bb",mu:"\u03bc",nu:"\u03bd",xi:"\u03be",omicron:"\u03bf",pi:"\u03c0",rho:"\u03c1",sigmaf:"\u03c2",sigma:"\u03c3",tau:"\u03c4",upsilon:"\u03c5",phi:"\u03c6",chi:"\u03c7",psi:"\u03c8",omega:"\u03c9",thetasym:"\u03d1",upsih:"\u03d2",piv:"\u03d6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02c6",tilde:"\u02dc",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200c",zwj:"\u200d",lrm:"\u200e",rlm:"\u200f",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201a",ldquo:"\u201c",rdquo:"\u201d",bdquo:"\u201e",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203a",oline:"\u203e",euro:"\u20ac",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21b5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230a",rfloor:"\u230b",loz:"\u25ca",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}},1506:function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$"),a=0,o=1,s=2,u=3,l=4,d=5,c=6,f=7;function h(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,h)}function p(){}function g(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function m(e,t,n,r,i,h){function p(e,t,r){e in n.attributeNames&&h.fatalError("Attribute "+e+" redefined"),n.addValue(e,t,r)}for(var g,m=++t,v=a;;){var y=e.charAt(m);switch(y){case"=":if(v===o)g=e.slice(t,m),v=u;else{if(v!==s)throw new Error("attribute equal must after attrName");v=u}break;case"'":case'"':if(v===u||v===o){if(v===o&&(h.warning('attribute value must after "="'),g=e.slice(t,m)),t=m+1,!((m=e.indexOf(y,t))>0))throw new Error("attribute value no end '"+y+"' match");p(g,_=e.slice(t,m).replace(/&#?\w+;/g,i),t-1),v=d}else{if(v!=l)throw new Error('attribute value must after "="');p(g,_=e.slice(t,m).replace(/&#?\w+;/g,i),t),h.warning('attribute "'+g+'" missed start quot('+y+")!!"),t=m+1,v=d}break;case"/":switch(v){case a:n.setTagName(e.slice(t,m));case d:case c:case f:v=f,n.closed=!0;case l:case o:case s:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return h.error("unexpected end of input"),v==a&&n.setTagName(e.slice(t,m)),m;case">":switch(v){case a:n.setTagName(e.slice(t,m));case d:case c:case f:break;case l:case o:"/"===(_=e.slice(t,m)).slice(-1)&&(n.closed=!0,_=_.slice(0,-1));case s:v===s&&(_=g),v==l?(h.warning('attribute "'+_+'" missed quot(")!'),p(g,_.replace(/&#?\w+;/g,i),t)):("http://www.w3.org/1999/xhtml"===r[""]&&_.match(/^(?:disabled|checked|selected)$/i)||h.warning('attribute "'+_+'" missed value!! "'+_+'" instead!!'),p(_,_,t));break;case u:throw new Error("attribute value missed!!")}return m;case"\x80":y=" ";default:if(y<=" ")switch(v){case a:n.setTagName(e.slice(t,m)),v=c;break;case o:g=e.slice(t,m),v=s;break;case l:var _=e.slice(t,m).replace(/&#?\w+;/g,i);h.warning('attribute "'+_+'" missed quot(")!!'),p(g,_,t);case d:v=c}else switch(v){case s:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&g.match(/^(?:disabled|checked|selected)$/i)||h.warning('attribute "'+g+'" missed value!! "'+g+'" instead2!!'),p(g,g,t),t=m,v=o;break;case d:h.warning('attribute space is required"'+g+'"!!');case c:v=o,t=m;break;case u:v=l,t=m;break;case f:throw new Error("elements closed character '/' and '>' must be connected to")}}m++}}function v(e,t,n){for(var r=e.tagName,i=null,a=e.length;a--;){var o=e[a],s=o.qName,u=o.value;if((f=s.indexOf(":"))>0)var l=o.prefix=s.slice(0,f),d=s.slice(f+1),c="xmlns"===l&&d;else d=s,l=null,c="xmlns"===s&&"";o.localName=d,!1!==c&&(null==i&&(i={},T(n,n={})),n[c]=i[c]=u,o.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(c,u))}for(a=e.length;a--;){(l=(o=e[a]).prefix)&&("xml"===l&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(o.uri=n[l||""]))}var f;(f=r.indexOf(":"))>0?(l=e.prefix=r.slice(0,f),d=e.localName=r.slice(f+1)):(l=null,d=e.localName=r);var h=e.uri=n[l||""];if(t.startElement(h,d,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,!0;if(t.endElement(h,d,r),i)for(l in i)t.endPrefixMapping(l)}function y(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf("</"+n+">",t),o=e.substring(t+1,a);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),a)}return t+1}function _(e,t,n,r){var i=r[n];return null==i&&((i=e.lastIndexOf("</"+n+">"))<t&&(i=e.lastIndexOf("</"+n)),r[n]=i),i<t}function T(e,t){for(var n in e)t[n]=e[n]}function E(e,t,n,r){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(i=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,i-t-4),i+3):(r.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var i=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var a=function(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;n=i.exec(e);)if(r.push(n),n[1])return r}(e,t),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],u=!1,l=!1;o>3&&(/^public$/i.test(a[2][0])?(u=a[3][0],l=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(l=a[3][0]));var d=a[o-1];return n.startDTD(s,u,l),n.endDTD(),d.index+d[0].length}}return-1}function b(e,t,n){var r=e.indexOf("?>",t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function S(){this.attributeNames={}}h.prototype=new Error,h.prototype.name=h.name,p.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),T(t,t={}),function(e,t,n,r,i){function a(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function o(t){if(t>T){var n=e.substring(T,t).replace(/&#?\w+;/g,a);c&&s(T),r.characters(n,0,t-T),T=t}}function s(t,n){for(;t>=l&&(n=d.exec(e));)u=n.index,l=u+n[0].length,c.lineNumber++;c.columnNumber=t-u+1}var u=0,l=0,d=/.*(?:\r\n?|\n)|.*$/g,c=r.locator,f=[{currentNSMap:t}],p={},T=0;for(;;){try{var A=e.indexOf("<",T);if(A<0){if(!e.substr(T).match(/^\s*$/)){var w=r.doc,I=w.createTextNode(e.substr(T));w.appendChild(I),r.currentElement=I}return}switch(A>T&&o(A),e.charAt(A+1)){case"/":var C=e.indexOf(">",A+3),R=e.substring(A+2,C),D=f.pop();C<0?(R=e.substring(A+2).replace(/[\s<].*/,""),i.error("end tag name: "+R+" is not complete:"+D.tagName),C=A+1+R.length):R.match(/\s</)&&(R=R.replace(/[\s<].*/,""),i.error("end tag name: "+R+" maybe not complete"),C=A+1+R.length);var M=D.localNSMap,O=D.tagName==R,N=O||D.tagName&&D.tagName.toLowerCase()==R.toLowerCase();if(N){if(r.endElement(D.uri,D.localName,R),M)for(var P in M)r.endPrefixMapping(P);O||i.fatalError("end tag name: "+R+" is not match the current start tagName:"+D.tagName)}else f.push(D);C++;break;case"?":c&&s(A),C=b(e,A,r);break;case"!":c&&s(A),C=E(e,A,r,i);break;default:c&&s(A);var L=new S,k=f[f.length-1].currentNSMap,C=m(e,A,L,k,a,i),x=L.length;if(!L.closed&&_(e,C,L.tagName,p)&&(L.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),c&&x){for(var F=g(c,{}),U=0;U<x;U++){var B=L[U];s(B.offset),B.locator=g(c,{})}r.locator=F,v(L,r,k)&&f.push(L),r.locator=c}else v(L,r,k)&&f.push(L);"http://www.w3.org/1999/xhtml"!==L.uri||L.closed?C++:C=y(e,C,L.tagName,a,r)}}catch(j){if(j instanceof h)throw j;i.error("element parse error: "+j),C=-1}C>T?T=C:o(Math.max(A,T)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},S.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,n){if(!i.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=p,t.ParseError=h},1507:function(e,t){var n=Math.pow(2,32);e.exports=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8)},i=12;0===r.version?(r.earliestPresentationTime=t.getUint32(i),r.firstOffset=t.getUint32(i+4),i+=8):(r.earliestPresentationTime=t.getUint32(i)*n+t.getUint32(i+4),r.firstOffset=t.getUint32(i+8)*n+t.getUint32(i+12),i+=16),i+=2;var a=t.getUint16(i);for(i+=2;a>0;i+=12,a--)r.references.push({referenceType:(128&e[i])>>>7,referencedSize:2147483647&t.getUint32(i),subsegmentDuration:t.getUint32(i+4),startsWithSap:!!(128&e[i+8]),sapType:(112&e[i+8])>>>4,sapDeltaTime:268435455&t.getUint32(i+8)});return r}},1508:function(e,t){var n,r,i,a,o,s,u;n=function(e){return 9e4*e},r=function(e,t){return e*t},i=function(e){return e/9e4},a=function(e,t){return e/t},o=function(e,t){return n(a(e,t))},s=function(e,t){return r(i(e),t)},u=function(e,t,n){return i(n?e:e-t)},e.exports={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:n,secondsToAudioTs:r,videoTsToSeconds:i,audioTsToSeconds:a,audioTsToVideoTs:o,videoTsToAudioTs:s,metadataTsToSeconds:u}}}]);
//# sourceMappingURL=1.8821e903.chunk.js.map